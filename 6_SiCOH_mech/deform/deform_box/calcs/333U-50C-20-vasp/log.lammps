LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

variable FF string "CHONSi.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333U-50C-20-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333U-50C-20-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -10.66 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.3 | 127.6 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -39436.432      0             -39436.432      134598.85    
        28   0             -40880.138      0             -40880.138      6574.7047    
Loop time of 3.13116 on 16 procs for 28 steps with 350 atoms

96.9% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -39436.4315188006  -40880.1381661954  -40880.1382202762
  Force two-norm initial, final = 2114.0065 256.29574
  Force max component initial, final = 288.69826 136.26884
  Final line search alpha, max atom move = 0.0094790797 1.2917032
  Iterations, force evaluations = 28 66

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.1327     | 2.4207     | 2.5153     |   7.5 | 77.31
Bond    | 3.3492e-05 | 4.2342e-05 | 5.2401e-05 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.07295    | 0.1667     | 0.45369    |  28.4 |  5.32
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0.53825    | 0.53845    | 0.53858    |   0.0 | 17.20
Other   |            | 0.005236   |            |       |  0.17

Nlocal:          43.75 ave          50 max          39 min
Histogram: 2 0 1 0 2 0 2 0 0 1
Nghost:        3170.62 ave        3200 max        3138 min
Histogram: 2 0 0 1 1 0 0 2 0 2
Neighs:        28557.5 ave       32206 max       25644 min
Histogram: 2 0 0 1 1 1 2 0 0 1

Total # of neighbors = 228460
Ave neighs/atom = 652.74286
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-20-vasp_opt.data
System init for write_data ...
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.4 | 124.6 | 125.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -40880.138      10369.879      1.7278661      3758.8201    
       100   312.15686     -40857.265     -2002.401       1.7278661      3758.8201    
       200   340.38292     -40903.728      12319.568      1.7278661      3758.8201    
       300   328.49677     -40945.538     -2463.3159      1.7278661      3758.8201    
       400   302.72164     -40969.064     -10431.137      1.7278661      3758.8201    
       500   312.17766     -41020.789     -11602.23       1.7278661      3758.8201    
       600   297.51702     -41042.369     -8220.5378      1.7278661      3758.8201    
       700   310.82492     -41067.363     -4809.3637      1.7278661      3758.8201    
       800   302.44787     -41068.978     -2519.751       1.7278661      3758.8201    
       900   301.22127     -41074.272     -6876.2183      1.7278661      3758.8201    
      1000   307.07166     -41092.72       92.046689      1.7278661      3758.8201    
      1100   287.02516     -41096.975      610.32164      1.7278661      3758.8201    
      1200   285.72434     -41094.798     -13388.258      1.7278661      3758.8201    
      1300   310.1524      -41094.64      -2840.9648      1.7278661      3758.8201    
      1400   321.86673     -41077.096      1899.9144      1.7278661      3758.8201    
      1500   315.09749     -41087.994     -9763.541       1.7278661      3758.8201    
      1600   306.15283     -41101.291     -7656.2656      1.7278661      3758.8201    
      1700   289.59035     -41096.664      5599.5839      1.7278661      3758.8201    
      1800   306.68479     -41127.304      6521.0558      1.7278661      3758.8201    
      1900   296.34411     -41131.078      7570.9603      1.7278661      3758.8201    
      2000   297.91942     -41154.281     -3509.6921      1.7278661      3758.8201    
      2100   267.01975     -41135.62      -2647.0086      1.7278661      3758.8201    
      2200   286.18602     -41121.532      3912.0576      1.7278661      3758.8201    
      2300   296.22        -41108.182     -3435.7166      1.7278661      3758.8201    
      2400   299.72563     -41102.723     -5237.0642      1.7278661      3758.8201    
      2500   320.86838     -41130.298     -12887.651      1.7278661      3758.8201    
      2600   283.64514     -41122.461     -6379.1595      1.7278661      3758.8201    
      2700   300.42664     -41144.244     -6883.1356      1.7278661      3758.8201    
      2800   310.28715     -41141.915      2402.6927      1.7278661      3758.8201    
      2900   317.55781     -41138.732      3032.9163      1.7278661      3758.8201    
      3000   314.3433      -41128.216     -9748.3877      1.7278661      3758.8201    
      3100   323.71122     -41154.756     -12737.338      1.7278661      3758.8201    
      3200   298.51518     -41164.979     -16893.487      1.7278661      3758.8201    
      3300   284.05436     -41157.302     -5093.3624      1.7278661      3758.8201    
      3400   306.9631      -41167.53      -2856.7857      1.7278661      3758.8201    
      3500   307.66308     -41154.246     -19778.029      1.7278661      3758.8201    
      3600   302.46182     -41143.083     -7203.8995      1.7278661      3758.8201    
      3700   316.68967     -41168.952      764.73725      1.7278661      3758.8201    
      3800   287.98313     -41171.271      7530.9098      1.7278661      3758.8201    
      3900   274.43988     -41167.26      -7778.5956      1.7278661      3758.8201    
      4000   300.75707     -41174.066     -12345.764      1.7278661      3758.8201    
      4100   315.62292     -41175.161     -6370.3982      1.7278661      3758.8201    
      4200   303.4127      -41165.082     -3326.9757      1.7278661      3758.8201    
      4300   303.42517     -41181.788     -10766.434      1.7278661      3758.8201    
      4400   282.23293     -41207.526     -6193.2226      1.7278661      3758.8201    
      4500   280.62515     -41198.986     -4097.2693      1.7278661      3758.8201    
      4600   298.27907     -41183.58      -10180.58       1.7278661      3758.8201    
      4700   299.85719     -41166.161      101.16929      1.7278661      3758.8201    
      4800   291.33311     -41151.171     -11542.014      1.7278661      3758.8201    
      4900   317.66848     -41179.737     -6203.3754      1.7278661      3758.8201    
      5000   290.8002      -41184.819     -11806.426      1.7278661      3758.8201    
Loop time of 248.951 on 16 procs for 5000 steps with 350 atoms

Performance: 0.868 ns/day, 27.661 hours/ns, 20.084 timesteps/s, 7.029 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 187.05     | 190.33     | 196.76     |  24.7 | 76.45
Bond    | 0.0016413  | 0.001936   | 0.0021965  |   0.4 |  0.00
Neigh   | 15.27      | 15.607     | 16.017     |   6.7 |  6.27
Comm    | 14.283     | 20.516     | 23.867     |  75.1 |  8.24
Output  | 0.0050227  | 0.0057067  | 0.010142   |   2.2 |  0.00
Modify  | 20.99      | 21.568     | 21.907     |   7.5 |  8.66
Other   |            | 0.9182     |            |       |  0.37

Nlocal:          43.75 ave          49 max          37 min
Histogram: 2 0 0 0 1 2 0 0 0 3
Nghost:        3164.88 ave        3224 max        3116 min
Histogram: 2 0 1 0 1 1 1 1 0 1
Neighs:        28542.2 ave       31813 max       24421 min
Histogram: 2 0 0 1 0 2 0 0 0 3

Total # of neighbors = 228338
Ave neighs/atom = 652.39429
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-20-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.2382
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.5028
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.0085

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.642
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.4482
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -6.2627

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.2382
variable dlen equal lx-${len0}
variable dlen equal lx-15.2382
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.2382
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.52382 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.52382 xy delta 0.62627 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.52382 xy delta 0.62627 xz delta 0.04482 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.32583     -41218.819      8142.9692      3751.3025      15.207724      14.5028        17.0085      
       200   307.79545     -41193.598      4987.9852      3743.7848      15.177247      14.5028        17.0085      
       300   314.11277     -41186.038     -10280.72       3736.2672      15.146771      14.5028        17.0085      
       400   289.03344     -41182.024      13227.372      3728.7495      15.116294      14.5028        17.0085      
       500   280.80526     -41192.246      4850.4633      3721.2319      15.085818      14.5028        17.0085      
       600   305.00379     -41204.316      2772.3646      3713.7143      15.055342      14.5028        17.0085      
       700   326.67774     -41197.485     -22209.375      3706.1966      15.024865      14.5028        17.0085      
       800   319.92349     -41186.986     -6219.8449      3698.679       14.994389      14.5028        17.0085      
       900   309.42053     -41210.805      5521.0548      3691.1613      14.963912      14.5028        17.0085      
      1000   292.60772     -41198.215     -14012.685      3683.6437      14.933436      14.5028        17.0085      
      1100   292.33427     -41199.372      10383.229      3676.1261      14.90296       14.5028        17.0085      
      1200   309.73028     -41197.541      1563.1675      3668.6084      14.872483      14.5028        17.0085      
      1300   303.10494     -41171.45      -6246.2131      3661.0908      14.842007      14.5028        17.0085      
      1400   318.34021     -41210.408      1683.2831      3653.5731      14.81153       14.5028        17.0085      
      1500   286.85719     -41196.707     -2328.236       3646.0555      14.781054      14.5028        17.0085      
      1600   301.91211     -41205.062      6860.0614      3638.5379      14.750578      14.5028        17.0085      
      1700   328.19256     -41223.992     -4101.8418      3631.0202      14.720101      14.5028        17.0085      
      1800   309.65777     -41211.85      -681.88246      3623.5026      14.689625      14.5028        17.0085      
      1900   298.80124     -41217.401      17154.786      3615.9849      14.659148      14.5028        17.0085      
      2000   276.57898     -41200.107      1223.2982      3608.4673      14.628672      14.5028        17.0085      
      2100   303.1108      -41199.584      10468.094      3600.9497      14.598196      14.5028        17.0085      
      2200   317.75015     -41181.456     -6516.0003      3593.432       14.567719      14.5028        17.0085      
      2300   332.16048     -41186.379      5154.2891      3585.9144      14.537243      14.5028        17.0085      
      2400   298.87762     -41191.011      19340.637      3578.3967      14.506766      14.5028        17.0085      
      2500   309.94684     -41212.681     -4106.16        3570.8791      14.47629       14.5028        17.0085      
      2600   304.8733      -41211.509      592.13208      3563.3615      14.445814      14.5028        17.0085      
      2700   289.31135     -41199.559      14699.163      3555.8438      14.415337      14.5028        17.0085      
      2800   287.44245     -41190.475      23671.073      3548.3262      14.384861      14.5028        17.0085      
      2900   312.38054     -41179.22       25421.591      3540.8085      14.354384      14.5028        17.0085      
      3000   311.17328     -41160.6        14913.363      3533.2909      14.323908      14.5028        17.0085      
      3100   311.21614     -41188.274      31437.693      3525.7733      14.293432      14.5028        17.0085      
      3200   318.63884     -41199.193      20342.565      3518.2556      14.262955      14.5028        17.0085      
      3300   311.85153     -41193.096      3431.9177      3510.738       14.232479      14.5028        17.0085      
      3400   288.50684     -41176.593      7701.0734      3503.2203      14.202002      14.5028        17.0085      
      3500   287.77652     -41177.997      17299.202      3495.7027      14.171526      14.5028        17.0085      
      3600   312.01082     -41184.417      14974.374      3488.1851      14.14105       14.5028        17.0085      
      3700   310.69242     -41156.487      27502.573      3480.6674      14.110573      14.5028        17.0085      
      3800   333.09336     -41154.571      35117.938      3473.1498      14.080097      14.5028        17.0085      
      3900   314.53835     -41163.694      17697.926      3465.6321      14.04962       14.5028        17.0085      
      4000   306.64502     -41168.75       36109.787      3458.1145      14.019144      14.5028        17.0085      
      4100   276.84063     -41144.581      31547.121      3450.5969      13.988668      14.5028        17.0085      
      4200   313.82215     -41185.272      11682.748      3443.0792      13.958191      14.5028        17.0085      
      4300   309.86194     -41186.843      18580.583      3435.5616      13.927715      14.5028        17.0085      
      4400   286.44985     -41175.794      25876.15       3428.0439      13.897238      14.5028        17.0085      
      4500   296.02318     -41194.801      20642.337      3420.5263      13.866762      14.5028        17.0085      
      4600   274.57427     -41180.977      25780.612      3413.0087      13.836286      14.5028        17.0085      
      4700   292.2044      -41160.735      21690.571      3405.491       13.805809      14.5028        17.0085      
      4800   319.37844     -41155.116      32996.191      3397.9734      13.775333      14.5028        17.0085      
      4900   299.35038     -41124.295      23657.906      3390.4557      13.744856      14.5028        17.0085      
      5000   308.62081     -41140.345      16197.494      3382.9381      13.71438       14.5028        17.0085      
Loop time of 271.161 on 16 procs for 5000 steps with 350 atoms

Performance: 0.797 ns/day, 30.129 hours/ns, 18.439 timesteps/s, 6.454 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 205.09     | 207.56     | 211.24     |  13.2 | 76.55
Bond    | 0.0018173  | 0.0019729  | 0.0021564  |   0.3 |  0.00
Neigh   | 15.625     | 16.357     | 17.115     |  10.3 |  6.03
Comm    | 18.689     | 22.207     | 24.744     |  40.5 |  8.19
Output  | 0.028515   | 0.034841   | 0.040033   |   2.2 |  0.01
Modify  | 23.239     | 24.058     | 24.719     |   8.5 |  8.87
Other   |            | 0.9391     |            |       |  0.35

Nlocal:          43.75 ave          50 max          36 min
Histogram: 1 0 0 2 0 2 0 1 1 1
Nghost:        3421.75 ave        3475 max        3382 min
Histogram: 3 0 0 0 3 0 0 0 1 1
Neighs:        31669.5 ave       36155 max       26410 min
Histogram: 1 0 0 2 0 2 1 0 1 1

Total # of neighbors = 253356
Ave neighs/atom = 723.87429
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.2382
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.52382 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.52382 xy delta -0.62627 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.52382 xy delta -0.62627 xz delta -0.04482 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.6 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   314.93833     -41219.226      8096.957       3766.3377      15.268676      14.5028        17.0085      
       200   307.14301     -41196.82      -2022.6697      3773.8554      15.299153      14.5028        17.0085      
       300   305.72823     -41169.474     -8323.4762      3781.373       15.329629      14.5028        17.0085      
       400   335.46968     -41162.497      14534.363      3788.8907      15.360106      14.5028        17.0085      
       500   330.45775     -41138.984     -16302.011      3796.4083      15.390582      14.5028        17.0085      
       600   307.71243     -41152.368      374.3048       3803.926       15.421058      14.5028        17.0085      
       700   309.89977     -41172.525     -14203.42       3811.4436      15.451535      14.5028        17.0085      
       800   287.08087     -41168.872     -7907.302       3818.9612      15.482011      14.5028        17.0085      
       900   276.16784     -41157.16      -11998.179      3826.4789      15.512488      14.5028        17.0085      
      1000   304.97964     -41163.025     -15888.313      3833.9965      15.542964      14.5028        17.0085      
      1100   287.58001     -41113.799     -19383.974      3841.5142      15.57344       14.5028        17.0085      
      1200   316.00612     -41143.493     -3663.2699      3849.0318      15.603917      14.5028        17.0085      
      1300   298.75022     -41142.227     -3121.1338      3856.5494      15.634393      14.5028        17.0085      
      1400   294.63301     -41143.088     -7579.3202      3864.0671      15.66487       14.5028        17.0085      
      1500   294.49592     -41147.885     -7979.7759      3871.5847      15.695346      14.5028        17.0085      
      1600   291.25529     -41143.891     -12737.702      3879.1024      15.725822      14.5028        17.0085      
      1700   303.21895     -41159.698     -15171.552      3886.62        15.756299      14.5028        17.0085      
      1800   277.80989     -41153.121     -15715.434      3894.1376      15.786775      14.5028        17.0085      
      1900   277.59662     -41144.454     -22229.453      3901.6553      15.817252      14.5028        17.0085      
      2000   323.84693     -41159.978     -2826.2813      3909.1729      15.847728      14.5028        17.0085      
      2100   293.45189     -41114.973     -24050.503      3916.6906      15.878204      14.5028        17.0085      
      2200   298.27991     -41123.417     -13220.696      3924.2082      15.908681      14.5028        17.0085      
      2300   304.36115     -41138.331     -13622.946      3931.7258      15.939157      14.5028        17.0085      
      2400   297.88798     -41137.321     -9356.3752      3939.2435      15.969634      14.5028        17.0085      
      2500   309.2579      -41144.1       -12511.342      3946.7611      16.00011       14.5028        17.0085      
      2600   293.27031     -41128.733     -31046.893      3954.2788      16.030586      14.5028        17.0085      
      2700   284.17545     -41147.957     -30814.885      3961.7964      16.061063      14.5028        17.0085      
      2800   285.52916     -41137.337     -18440.17       3969.314       16.091539      14.5028        17.0085      
      2900   297.77133     -41117.669     -30124.309      3976.8317      16.122016      14.5028        17.0085      
      3000   310.55271     -41108.227     -7431.8625      3984.3493      16.152492      14.5028        17.0085      
      3100   287.67438     -41103.094     -16615.925      3991.867       16.182968      14.5028        17.0085      
      3200   289.56176     -41116.133     -9448.5307      3999.3846      16.213445      14.5028        17.0085      
      3300   274.28586     -41087.099     -16136.837      4006.9022      16.243921      14.5028        17.0085      
      3400   305.71035     -41096.487     -28994.723      4014.4199      16.274398      14.5028        17.0085      
      3500   324.27286     -41097.824     -23473.98       4021.9375      16.304874      14.5028        17.0085      
      3600   295.56033     -41088.569     -19173.851      4029.4552      16.33535       14.5028        17.0085      
      3700   263.59168     -41065.129     -19200.669      4036.9728      16.365827      14.5028        17.0085      
      3800   305.99541     -41097.732     -33815.852      4044.4904      16.396303      14.5028        17.0085      
      3900   305.58158     -41077.473     -31890.71       4052.0081      16.42678       14.5028        17.0085      
      4000   312.90914     -41072.861     -15250.252      4059.5257      16.457256      14.5028        17.0085      
      4100   282.7878      -41061.452     -27562.414      4067.0434      16.487732      14.5028        17.0085      
      4200   276.14854     -41060.508     -30653.918      4074.561       16.518209      14.5028        17.0085      
      4300   303.09826     -41069.483     -26030.833      4082.0786      16.548685      14.5028        17.0085      
      4400   306.50913     -41037.338     -26208.135      4089.5963      16.579162      14.5028        17.0085      
      4500   327.9552      -41028.493     -29723.312      4097.1139      16.609638      14.5028        17.0085      
      4600   293.45551     -41026.148     -38370.61       4104.6316      16.640114      14.5028        17.0085      
      4700   303.43177     -41039.479     -36446.162      4112.1492      16.670591      14.5028        17.0085      
      4800   300.6359      -41036.61      -28881.63       4119.6668      16.701067      14.5028        17.0085      
      4900   304.75111     -41046.209     -25155.914      4127.1845      16.731544      14.5028        17.0085      
      5000   280.03694     -41017.845     -24109.827      4134.7021      16.76202       14.5028        17.0085      
Loop time of 236.807 on 16 procs for 5000 steps with 350 atoms

Performance: 0.912 ns/day, 26.312 hours/ns, 21.114 timesteps/s, 7.390 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 174.02     | 178.7      | 184.25     |  24.2 | 75.46
Bond    | 0.0016597  | 0.001957   | 0.0022994  |   0.4 |  0.00
Neigh   | 14.513     | 14.823     | 15.166     |   6.2 |  6.26
Comm    | 14.997     | 20.413     | 25.108     |  72.2 |  8.62
Output  | 0.029817   | 0.035899   | 0.041528   |   2.1 |  0.02
Modify  | 21.512     | 21.876     | 22.338     |   6.0 |  9.24
Other   |            | 0.9538     |            |       |  0.40

Nlocal:          43.75 ave          52 max          37 min
Histogram: 2 0 2 0 0 0 2 0 0 2
Nghost:        2996.38 ave        3044 max        2951 min
Histogram: 1 1 1 2 0 0 0 0 1 2
Neighs:        25878.2 ave       30388 max       22116 min
Histogram: 2 1 1 0 0 0 2 0 0 2

Total # of neighbors = 207026
Ave neighs/atom = 591.50286
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 14.5028
variable dlen equal ly-${len0}
variable dlen equal ly-14.5028
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.45028 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.45028 yz delta 0.0642 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.33289     -41219.221      8105.0203      3751.3025      15.2382        14.473794      17.0085      
       200   310.70629     -41200.539      1843.2908      3743.7848      15.2382        14.444789      17.0085      
       300   308.96627     -41175.166     -146.49292      3736.2672      15.2382        14.415783      17.0085      
       400   311.76586     -41144.085      7088.451       3728.7495      15.2382        14.386778      17.0085      
       500   312.12306     -41138.01      -13779.113      3721.2319      15.2382        14.357772      17.0085      
       600   304.47511     -41170.676      6623.3806      3713.7143      15.2382        14.328766      17.0085      
       700   313.95028     -41193.942     -5339.2088      3706.1966      15.2382        14.299761      17.0085      
       800   301.47737     -41201.179      4996.9454      3698.679       15.2382        14.270755      17.0085      
       900   298.03052     -41207.077      7239.2324      3691.1613      15.2382        14.24175       17.0085      
      1000   295.98401     -41201.035      676.77391      3683.6437      15.2382        14.212744      17.0085      
      1100   296.96216     -41176.663     -8827.8596      3676.1261      15.2382        14.183738      17.0085      
      1200   300.00054     -41144.264     -5192.7933      3668.6084      15.2382        14.154733      17.0085      
      1300   313.04        -41158.741      9046.3355      3661.0908      15.2382        14.125727      17.0085      
      1400   304.93797     -41175.356      700.28335      3653.5731      15.2382        14.096722      17.0085      
      1500   284.26314     -41164.396      84.711697      3646.0555      15.2382        14.067716      17.0085      
      1600   286.36083     -41175.361      5775.5647      3638.5379      15.2382        14.03871       17.0085      
      1700   292.61361     -41189.161     -1846.2653      3631.0202      15.2382        14.009705      17.0085      
      1800   292.56915     -41205.551      9936.5214      3623.5026      15.2382        13.980699      17.0085      
      1900   302.90659     -41211.657      2023.7254      3615.9849      15.2382        13.951694      17.0085      
      2000   313.21996     -41185.089      3432.6833      3608.4673      15.2382        13.922688      17.0085      
      2100   347.21261     -41190.406      3840.96        3600.9497      15.2382        13.893682      17.0085      
      2200   317.12596     -41186.654      5427.1214      3593.432       15.2382        13.864677      17.0085      
      2300   297.46509     -41189.775      11667.36       3585.9144      15.2382        13.835671      17.0085      
      2400   287.11177     -41186.399      7891.5346      3578.3967      15.2382        13.806666      17.0085      
      2500   284.93635     -41178.063     -5896.3497      3570.8791      15.2382        13.77766       17.0085      
      2600   311.92484     -41190.768     -1818.0009      3563.3615      15.2382        13.748654      17.0085      
      2700   305.16467     -41168.289      6761.1347      3555.8438      15.2382        13.719649      17.0085      
      2800   302.20747     -41191.21       16416.801      3548.3262      15.2382        13.690643      17.0085      
      2900   305.76165     -41200.033      16351.911      3540.8085      15.2382        13.661638      17.0085      
      3000   295.48172     -41184.107      10145.3        3533.2909      15.2382        13.632632      17.0085      
      3100   296.0193      -41169.768      15076.841      3525.7733      15.2382        13.603626      17.0085      
      3200   328.53728     -41191.783      20397.882      3518.2556      15.2382        13.574621      17.0085      
      3300   297.38132     -41185.602      8484.3717      3510.738       15.2382        13.545615      17.0085      
      3400   305.99309     -41203.505      9002.7401      3503.2203      15.2382        13.51661       17.0085      
      3500   301.91513     -41192.709      18261.664      3495.7027      15.2382        13.487604      17.0085      
      3600   305.74036     -41179.059      18502.711      3488.1851      15.2382        13.458598      17.0085      
      3700   320.31578     -41163.17       5344.5985      3480.6674      15.2382        13.429593      17.0085      
      3800   313.97976     -41152.855      23069.968      3473.1498      15.2382        13.400587      17.0085      
      3900   306.20136     -41172.49       15806.961      3465.6321      15.2382        13.371582      17.0085      
      4000   291.20886     -41169.619      30580.311      3458.1145      15.2382        13.342576      17.0085      
      4100   297.98084     -41168.251      6428.5575      3450.5969      15.2382        13.31357       17.0085      
      4200   304.63346     -41162.132      15712.102      3443.0792      15.2382        13.284565      17.0085      
      4300   312.83654     -41170.043      30334.978      3435.5616      15.2382        13.255559      17.0085      
      4400   304.53654     -41181.585      20157.917      3428.0439      15.2382        13.226554      17.0085      
      4500   301.97725     -41176.803      18813.431      3420.5263      15.2382        13.197548      17.0085      
      4600   295.80791     -41167.591      23761.573      3413.0087      15.2382        13.168542      17.0085      
      4700   281.03779     -41155.011      17341.534      3405.491       15.2382        13.139537      17.0085      
      4800   293.34013     -41167.688      40783.591      3397.9734      15.2382        13.110531      17.0085      
      4900   292.42827     -41166.52       14314.985      3390.4557      15.2382        13.081526      17.0085      
      5000   285.60751     -41172.148      17698.229      3382.9381      15.2382        13.05252       17.0085      
Loop time of 272.745 on 16 procs for 5000 steps with 350 atoms

Performance: 0.792 ns/day, 30.305 hours/ns, 18.332 timesteps/s, 6.416 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 204.72     | 210.23     | 214.98     |  23.8 | 77.08
Bond    | 0.0017211  | 0.0019259  | 0.0021439  |   0.3 |  0.00
Neigh   | 16.125     | 16.655     | 16.998     |   6.0 |  6.11
Comm    | 16.682     | 21.415     | 26.983     |  75.2 |  7.85
Output  | 0.029309   | 0.033268   | 0.037898   |   1.7 |  0.01
Modify  | 23.294     | 23.647     | 24.257     |   5.6 |  8.67
Other   |            | 0.7626     |            |       |  0.28

Nlocal:          43.75 ave          52 max          38 min
Histogram: 1 2 1 0 1 0 2 0 0 1
Nghost:         3439.5 ave        3506 max        3398 min
Histogram: 1 2 1 1 0 0 2 0 0 1
Neighs:          31743 ave       37316 max       27823 min
Histogram: 1 2 1 0 1 0 2 0 0 1

Total # of neighbors = 253944
Ave neighs/atom = 725.55429
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.45028 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.45028 yz delta -0.0642 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.6 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.18309     -41219.116      8074.2585      3766.3377      15.2382        14.531806      17.0085      
       200   309.84656     -41197.727      1425.8934      3773.8554      15.2382        14.560811      17.0085      
       300   315.03067     -41180.327     -10047.649      3781.373       15.2382        14.589817      17.0085      
       400   317.61904     -41142.513      2316.5513      3788.8907      15.2382        14.618822      17.0085      
       500   319.2158      -41134.03      -9426.7816      3796.4083      15.2382        14.647828      17.0085      
       600   319.85037     -41170.501      6460.0363      3803.926       15.2382        14.676834      17.0085      
       700   321.43427     -41184.812     -10103.97       3811.4436      15.2382        14.705839      17.0085      
       800   303.28309     -41183.659     -8587.5423      3818.9612      15.2382        14.734845      17.0085      
       900   282.9406      -41169.791     -20291.753      3826.4789      15.2382        14.76385       17.0085      
      1000   303.60464     -41183.222     -13937.867      3833.9965      15.2382        14.792856      17.0085      
      1100   298.34234     -41178.789     -2188.1397      3841.5142      15.2382        14.821862      17.0085      
      1200   303.87657     -41183.947     -13359.026      3849.0318      15.2382        14.850867      17.0085      
      1300   280.55051     -41167.674     -7217.8446      3856.5494      15.2382        14.879873      17.0085      
      1400   303.10058     -41180.884     -17024.792      3864.0671      15.2382        14.908878      17.0085      
      1500   307.58113     -41148.895     -29457.777      3871.5847      15.2382        14.937884      17.0085      
      1600   294.27243     -41117.327     -32269.787      3879.1024      15.2382        14.96689       17.0085      
      1700   303.70744     -41135.097     -20205.785      3886.62        15.2382        14.995895      17.0085      
      1800   297.45417     -41137.236     -20463.098      3894.1376      15.2382        15.024901      17.0085      
      1900   311.04728     -41146.022     -20029.632      3901.6553      15.2382        15.053906      17.0085      
      2000   300.46128     -41130.223     -12010.859      3909.1729      15.2382        15.082912      17.0085      
      2100   316.6187      -41134.047     -23524.118      3916.6906      15.2382        15.111918      17.0085      
      2200   300.96392     -41115.019     -16111.297      3924.2082      15.2382        15.140923      17.0085      
      2300   291.37394     -41126.459     -17721.029      3931.7258      15.2382        15.169929      17.0085      
      2400   286.13182     -41128.611     -11299.487      3939.2435      15.2382        15.198934      17.0085      
      2500   289.80992     -41133.301     -16092.634      3946.7611      15.2382        15.22794       17.0085      
      2600   287.91412     -41107.82      -20155.312      3954.2788      15.2382        15.256946      17.0085      
      2700   310.44037     -41092.056     -16102.895      3961.7964      15.2382        15.285951      17.0085      
      2800   313.38501     -41105.001     -17674.349      3969.314       15.2382        15.314957      17.0085      
      2900   294.02376     -41105.307     -17527.273      3976.8317      15.2382        15.343962      17.0085      
      3000   296.79151     -41113.811     -21754.631      3984.3493      15.2382        15.372968      17.0085      
      3100   280.32683     -41085.048     -6483.5739      3991.867       15.2382        15.401974      17.0085      
      3200   289.99335     -41061.82      -26888.936      3999.3846      15.2382        15.430979      17.0085      
      3300   322.65404     -41075.6       -3969.7979      4006.9022      15.2382        15.459985      17.0085      
      3400   330.93759     -41099.518     -15076.794      4014.4199      15.2382        15.48899       17.0085      
      3500   303.75479     -41085.569     -27574.219      4021.9375      15.2382        15.517996      17.0085      
      3600   298.69927     -41084.512     -27439.573      4029.4552      15.2382        15.547002      17.0085      
      3700   308.55844     -41100.564     -21632.583      4036.9728      15.2382        15.576007      17.0085      
      3800   277.08485     -41074.972     -33208.408      4044.4904      15.2382        15.605013      17.0085      
      3900   278.16501     -41089.02      -23836.655      4052.0081      15.2382        15.634018      17.0085      
      4000   272.52685     -41074.883     -14254.607      4059.5257      15.2382        15.663024      17.0085      
      4100   310.08127     -41069.69      -31196.143      4067.0434      15.2382        15.69203       17.0085      
      4200   327.82063     -41069.034     -34215.654      4074.561       15.2382        15.721035      17.0085      
      4300   309.91418     -41051.11      -29997.381      4082.0786      15.2382        15.750041      17.0085      
      4400   313.53844     -41063.496     -34195.303      4089.5963      15.2382        15.779046      17.0085      
      4500   294.16998     -41063.492     -24161.132      4097.1139      15.2382        15.808052      17.0085      
      4600   282.68017     -41043.536     -28447.769      4104.6316      15.2382        15.837058      17.0085      
      4700   303.2621      -41024.556     -36145.267      4112.1492      15.2382        15.866063      17.0085      
      4800   297.9686      -40995.661     -28535.444      4119.6668      15.2382        15.895069      17.0085      
      4900   305.99807     -41010.502     -22445.231      4127.1845      15.2382        15.924074      17.0085      
      5000   300.30744     -41015.204     -22111.722      4134.7021      15.2382        15.95308       17.0085      
Loop time of 234.105 on 16 procs for 5000 steps with 350 atoms

Performance: 0.923 ns/day, 26.012 hours/ns, 21.358 timesteps/s, 7.475 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 169.43     | 176.25     | 180.05     |  25.1 | 75.29
Bond    | 0.0017601  | 0.001963   | 0.0022387  |   0.4 |  0.00
Neigh   | 14.418     | 14.628     | 14.892     |   4.3 |  6.25
Comm    | 16.388     | 20.181     | 27.103     |  75.7 |  8.62
Output  | 0.028407   | 0.03368    | 0.0384     |   1.9 |  0.01
Modify  | 21.631     | 21.998     | 22.283     |   5.0 |  9.40
Other   |            | 1.015      |            |       |  0.43

Nlocal:          43.75 ave          55 max          35 min
Histogram: 2 0 1 1 1 1 0 0 1 1
Nghost:        2919.62 ave        2944 max        2881 min
Histogram: 1 0 0 1 1 1 0 0 3 1
Neighs:        25862.1 ave       32168 max       20972 min
Histogram: 2 0 1 1 1 1 0 0 1 1

Total # of neighbors = 206897
Ave neighs/atom = 591.13429
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.0085
variable dlen equal lz-${len0}
variable dlen equal lz-17.0085
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.70085 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.48462     -41219.06       8231.4871      3751.3025      15.2382        14.5028        16.974483    
       200   306.18146     -41192.436      1139.1082      3743.7848      15.2382        14.5028        16.940466    
       300   309.11904     -41178.989     -4820.4634      3736.2672      15.2382        14.5028        16.906449    
       400   321.94869     -41168.367      2379.0963      3728.7495      15.2382        14.5028        16.872432    
       500   307.33907     -41149.939      1789.911       3721.2319      15.2382        14.5028        16.838415    
       600   301.56068     -41177.236     -10342.841      3713.7143      15.2382        14.5028        16.804398    
       700   303.40799     -41191.852     -10656.508      3706.1966      15.2382        14.5028        16.770381    
       800   300.38097     -41196.555     -6887.2762      3698.679       15.2382        14.5028        16.736364    
       900   288.52618     -41195.132     -7609.2097      3691.1613      15.2382        14.5028        16.702347    
      1000   298.00816     -41204.297     -3797.2829      3683.6437      15.2382        14.5028        16.66833     
      1100   317.9561      -41196.663      9312.3486      3676.1261      15.2382        14.5028        16.634313    
      1200   312.79995     -41164.46      -11508.374      3668.6084      15.2382        14.5028        16.600296    
      1300   312.50409     -41174.557      7627.8292      3661.0908      15.2382        14.5028        16.566279    
      1400   293.773       -41173.838      11706.994      3653.5731      15.2382        14.5028        16.532262    
      1500   294.64362     -41182.422      7866.4902      3646.0555      15.2382        14.5028        16.498245    
      1600   300.94299     -41189.401      36.178184      3638.5379      15.2382        14.5028        16.464228    
      1700   284.43006     -41182.824     -11196.902      3631.0202      15.2382        14.5028        16.430211    
      1800   288.65899     -41185.359     -18844.62       3623.5026      15.2382        14.5028        16.396194    
      1900   301.41022     -41162.109      18781.333      3615.9849      15.2382        14.5028        16.362177    
      2000   323.26629     -41171.772      2601.1433      3608.4673      15.2382        14.5028        16.32816     
      2100   308.56399     -41181.856      7887.1381      3600.9497      15.2382        14.5028        16.294143    
      2200   310.91053     -41199.407     -2007.0873      3593.432       15.2382        14.5028        16.260126    
      2300   303.52204     -41197.8       -341.68715      3585.9144      15.2382        14.5028        16.226109    
      2400   309.223       -41222.007      20431.442      3578.3967      15.2382        14.5028        16.192092    
      2500   289.70504     -41210.404      20140.152      3570.8791      15.2382        14.5028        16.158075    
      2600   323.81587     -41246.852      7945.9302      3563.3615      15.2382        14.5028        16.124058    
      2700   293.04353     -41218.529      19187.288      3555.8438      15.2382        14.5028        16.090041    
      2800   304.94535     -41225.927      12655.125      3548.3262      15.2382        14.5028        16.056024    
      2900   309.42091     -41220.88       6821.9663      3540.8085      15.2382        14.5028        16.022007    
      3000   294.70197     -41205.125      9472.6503      3533.2909      15.2382        14.5028        15.98799     
      3100   297.57718     -41217.333      8664.3823      3525.7733      15.2382        14.5028        15.953973    
      3200   281.57295     -41215.635      14561.615      3518.2556      15.2382        14.5028        15.919956    
      3300   288.18467     -41209.594      19769.636      3510.738       15.2382        14.5028        15.885939    
      3400   306.33886     -41192.906      16607.091      3503.2203      15.2382        14.5028        15.851922    
      3500   328.92695     -41190.493      9097.3703      3495.7027      15.2382        14.5028        15.817905    
      3600   303.0568      -41178.997      11604.589      3488.1851      15.2382        14.5028        15.783888    
      3700   296.97164     -41189.344      18366.568      3480.6674      15.2382        14.5028        15.749871    
      3800   298.94506     -41195.814      12810.853      3473.1498      15.2382        14.5028        15.715854    
      3900   291.90968     -41201.944      22560.797      3465.6321      15.2382        14.5028        15.681837    
      4000   293.31144     -41200.445      20940.684      3458.1145      15.2382        14.5028        15.64782     
      4100   286.88427     -41199.257      37950.96       3450.5969      15.2382        14.5028        15.613803    
      4200   275.75009     -41205.933      22396.786      3443.0792      15.2382        14.5028        15.579786    
      4300   298.83233     -41225.294      16372.374      3435.5616      15.2382        14.5028        15.545769    
      4400   313.70527     -41199.028      25246.732      3428.0439      15.2382        14.5028        15.511752    
      4500   310.8396      -41173.596      8926.9265      3420.5263      15.2382        14.5028        15.477735    
      4600   303.60692     -41182.769      28348.972      3413.0087      15.2382        14.5028        15.443718    
      4700   297.47635     -41187.254      19880.314      3405.491       15.2382        14.5028        15.409701    
      4800   309.58272     -41200.982      17449.755      3397.9734      15.2382        14.5028        15.375684    
      4900   295.87396     -41182.2        25192.476      3390.4557      15.2382        14.5028        15.341667    
      5000   289.37997     -41161.817      27612.237      3382.9381      15.2382        14.5028        15.30765     
Loop time of 270.71 on 16 procs for 5000 steps with 350 atoms

Performance: 0.798 ns/day, 30.079 hours/ns, 18.470 timesteps/s, 6.464 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 202.24     | 206.88     | 212.18     |  23.6 | 76.42
Bond    | 0.0016647  | 0.0019282  | 0.0021557  |   0.3 |  0.00
Neigh   | 15.867     | 16.318     | 16.669     |   5.8 |  6.03
Comm    | 17.423     | 22.842     | 27.549     |  71.9 |  8.44
Output  | 0.029139   | 0.034702   | 0.038846   |   1.7 |  0.01
Modify  | 23.283     | 23.783     | 24.336     |   6.5 |  8.79
Other   |            | 0.8551     |            |       |  0.32

Nlocal:          43.75 ave          53 max          38 min
Histogram: 3 0 1 1 1 0 0 0 0 2
Nghost:           3417 ave        3466 max        3379 min
Histogram: 2 1 0 1 1 1 0 0 1 1
Neighs:        31712.1 ave       37938 max       27843 min
Histogram: 3 0 1 1 1 0 0 0 0 2

Total # of neighbors = 253697
Ave neighs/atom = 724.84857
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.70085 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.08119     -41219.174      7967.6977      3766.3377      15.2382        14.5028        17.042517    
       200   303.58066     -41194.553      7599.3169      3773.8554      15.2382        14.5028        17.076534    
       300   313.38528     -41182.096     -5250.8953      3781.373       15.2382        14.5028        17.110551    
       400   314.42228     -41156.554      437.50832      3788.8907      15.2382        14.5028        17.144568    
       500   326.21377     -41149.865     -7894.8516      3796.4083      15.2382        14.5028        17.178585    
       600   318.45102     -41163.633     -9337.2896      3803.926       15.2382        14.5028        17.212602    
       700   296.2429      -41162.679     -21385.031      3811.4436      15.2382        14.5028        17.246619    
       800   287.35666     -41168.841     -19268.637      3818.9612      15.2382        14.5028        17.280636    
       900   293.93714     -41185.447     -14593.11       3826.4789      15.2382        14.5028        17.314653    
      1000   280.94631     -41174.797     -11346.477      3833.9965      15.2382        14.5028        17.34867     
      1100   283.26475     -41167.232     -23066.531      3841.5142      15.2382        14.5028        17.382687    
      1200   293.65333     -41147.571     -19231.153      3849.0318      15.2382        14.5028        17.416704    
      1300   325.4853      -41163.167     -6225.7092      3856.5494      15.2382        14.5028        17.450721    
      1400   294.81658     -41155.514     -22979.651      3864.0671      15.2382        14.5028        17.484738    
      1500   290.73468     -41162.856     -10839.935      3871.5847      15.2382        14.5028        17.518755    
      1600   310.39035     -41174.627     -18477.669      3879.1024      15.2382        14.5028        17.552772    
      1700   307.04284     -41155.152     -36317.632      3886.62        15.2382        14.5028        17.586789    
      1800   294.57917     -41137.431     -11163.265      3894.1376      15.2382        14.5028        17.620806    
      1900   288.00339     -41156.076     -14138.368      3901.6553      15.2382        14.5028        17.654823    
      2000   298.36139     -41173.36      -12663.105      3909.1729      15.2382        14.5028        17.68884     
      2100   289.06676     -41144.956     -33736.055      3916.6906      15.2382        14.5028        17.722857    
      2200   302.99848     -41125.215     -24283.239      3924.2082      15.2382        14.5028        17.756874    
      2300   307.8371      -41120.851     -9472.1581      3931.7258      15.2382        14.5028        17.790891    
      2400   315.57418     -41131.401     -16234.858      3939.2435      15.2382        14.5028        17.824908    
      2500   302.38595     -41127.71      -20151.675      3946.7611      15.2382        14.5028        17.858925    
      2600   290.93828     -41132.338     -32367.572      3954.2788      15.2382        14.5028        17.892942    
      2700   299.72167     -41132.816     -21299.993      3961.7964      15.2382        14.5028        17.926959    
      2800   323.59233     -41147.29      -22991.642      3969.314       15.2382        14.5028        17.960976    
      2900   273.39091     -41128.178     -10327.658      3976.8317      15.2382        14.5028        17.994993    
      3000   281.83293     -41129.02      -15091.081      3984.3493      15.2382        14.5028        18.02901     
      3100   311.38493     -41127.872     -36767.998      3991.867       15.2382        14.5028        18.063027    
      3200   308.1635      -41098.569     -31425.878      3999.3846      15.2382        14.5028        18.097044    
      3300   306.44439     -41088.587     -14316.287      4006.9022      15.2382        14.5028        18.131061    
      3400   301.2527      -41118.68      -31792.088      4014.4199      15.2382        14.5028        18.165078    
      3500   309.49382     -41139.385     -8997.7883      4021.9375      15.2382        14.5028        18.199095    
      3600   270.54783     -41097.273     -27229.681      4029.4552      15.2382        14.5028        18.233112    
      3700   291.86346     -41088.914     -11244.044      4036.9728      15.2382        14.5028        18.267129    
      3800   300.78671     -41071.379     -23752.227      4044.4904      15.2382        14.5028        18.301146    
      3900   301.55309     -41074.558     -33093.402      4052.0081      15.2382        14.5028        18.335163    
      4000   296.64041     -41100.577     -25506.423      4059.5257      15.2382        14.5028        18.36918     
      4100   310.36909     -41110.679     -23764.729      4067.0434      15.2382        14.5028        18.403197    
      4200   306.61111     -41101.737     -31888.096      4074.561       15.2382        14.5028        18.437214    
      4300   300.11455     -41102.055     -30579.937      4082.0786      15.2382        14.5028        18.471231    
      4400   297.1528      -41113.239     -20178.031      4089.5963      15.2382        14.5028        18.505248    
      4500   298.98496     -41107.025     -19838.707      4097.1139      15.2382        14.5028        18.539265    
      4600   311.38403     -41074.313     -25585.076      4104.6316      15.2382        14.5028        18.573282    
      4700   305.63675     -41053.141     -20681.473      4112.1492      15.2382        14.5028        18.607299    
      4800   297.37882     -41055.189     -21339.96       4119.6668      15.2382        14.5028        18.641316    
      4900   301.10263     -41069.994     -15729.958      4127.1845      15.2382        14.5028        18.675333    
      5000   300.29774     -41077.059     -17328.428      4134.7021      15.2382        14.5028        18.70935     
Loop time of 235.339 on 16 procs for 5000 steps with 350 atoms

Performance: 0.918 ns/day, 26.149 hours/ns, 21.246 timesteps/s, 7.436 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 173.85     | 178.27     | 181.62     |  19.4 | 75.75
Bond    | 0.0017035  | 0.001931   | 0.0021777  |   0.3 |  0.00
Neigh   | 13.771     | 14.032     | 14.344     |   4.3 |  5.96
Comm    | 16.626     | 20.115     | 24.602     |  58.9 |  8.55
Output  | 0.031665   | 0.038492   | 0.045807   |   2.4 |  0.02
Modify  | 21.393     | 21.904     | 22.309     |   6.1 |  9.31
Other   |            | 0.9813     |            |       |  0.42

Nlocal:          43.75 ave          49 max          39 min
Histogram: 2 1 1 0 0 0 1 0 0 3
Nghost:        2925.88 ave        2990 max        2887 min
Histogram: 3 0 1 0 1 1 0 1 0 1
Neighs:        25872.8 ave       28900 max       23293 min
Histogram: 3 1 0 0 0 1 0 0 1 2

Total # of neighbors = 206982
Ave neighs/atom = 591.37714
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.2382
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.642)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.003 seconds
  read_restart CPU = 0.009 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.2382
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.52382 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.22592     -41219.083      8085.3432      3758.8201      15.2382        14.5028        17.0085      
       200   307.92169     -41199.11       3109.4652      3758.8201      15.2382        14.5028        17.0085      
       300   308.59453     -41180.375     -9578.7013      3758.8201      15.2382        14.5028        17.0085      
       400   308.40215     -41152.027      6089.0553      3758.8201      15.2382        14.5028        17.0085      
       500   309.86117     -41117.128     -8416.6139      3758.8201      15.2382        14.5028        17.0085      
       600   315.96457     -41143.414     -6075.3017      3758.8201      15.2382        14.5028        17.0085      
       700   327.98628     -41186.854     -16877.341      3758.8201      15.2382        14.5028        17.0085      
       800   290.89764     -41176.239     -305.63186      3758.8201      15.2382        14.5028        17.0085      
       900   285.5305      -41196.675     -8233.9517      3758.8201      15.2382        14.5028        17.0085      
      1000   290.07827     -41205.125     -15145.184      3758.8201      15.2382        14.5028        17.0085      
      1100   278.64324     -41183.413     -5789.2987      3758.8201      15.2382        14.5028        17.0085      
      1200   312.02502     -41188.59       5903.4703      3758.8201      15.2382        14.5028        17.0085      
      1300   291.21462     -41150.665     -2110.1527      3758.8201      15.2382        14.5028        17.0085      
      1400   310.16202     -41175.636     -4107.1989      3758.8201      15.2382        14.5028        17.0085      
      1500   283.51366     -41190.391     -4401.7269      3758.8201      15.2382        14.5028        17.0085      
      1600   294.59636     -41202.38      -6264.5868      3758.8201      15.2382        14.5028        17.0085      
      1700   299.01836     -41198.532     -3182.2162      3758.8201      15.2382        14.5028        17.0085      
      1800   290.49768     -41176.163     -16246.116      3758.8201      15.2382        14.5028        17.0085      
      1900   298.00527     -41169.022     -7209.6752      3758.8201      15.2382        14.5028        17.0085      
      2000   301.41105     -41157.093     -7890.3131      3758.8201      15.2382        14.5028        17.0085      
      2100   313.33953     -41173.621     -13720.171      3758.8201      15.2382        14.5028        17.0085      
      2200   296.05528     -41188.263     -862.6231       3758.8201      15.2382        14.5028        17.0085      
      2300   290.07822     -41192.212      5897.4956      3758.8201      15.2382        14.5028        17.0085      
      2400   278.60276     -41170.939     -18938.145      3758.8201      15.2382        14.5028        17.0085      
      2500   305.91006     -41173.706     -18636.509      3758.8201      15.2382        14.5028        17.0085      
      2600   320.88075     -41164.914     -8627.9982      3758.8201      15.2382        14.5028        17.0085      
      2700   307.51093     -41159.037     -14171.179      3758.8201      15.2382        14.5028        17.0085      
      2800   297.28541     -41181.591     -8277.4374      3758.8201      15.2382        14.5028        17.0085      
      2900   303.94654     -41199.427     -12234.455      3758.8201      15.2382        14.5028        17.0085      
      3000   294.16153     -41191.797     -12101.01       3758.8201      15.2382        14.5028        17.0085      
      3100   286.45054     -41194.093     -12960.199      3758.8201      15.2382        14.5028        17.0085      
      3200   285.36753     -41208.537     -11607.827      3758.8201      15.2382        14.5028        17.0085      
      3300   275.51232     -41203.313     -6910.7017      3758.8201      15.2382        14.5028        17.0085      
      3400   322.88871     -41213.552     -16463.035      3758.8201      15.2382        14.5028        17.0085      
      3500   301.66317     -41178.357     -19928.482      3758.8201      15.2382        14.5028        17.0085      
      3600   296.59182     -41175.41      -10620.193      3758.8201      15.2382        14.5028        17.0085      
      3700   297.13455     -41192.008     -10071.272      3758.8201      15.2382        14.5028        17.0085      
      3800   282.73067     -41197.506     -23195.389      3758.8201      15.2382        14.5028        17.0085      
      3900   291.30221     -41208.892     -3173.4056      3758.8201      15.2382        14.5028        17.0085      
      4000   306.32845     -41179.494      3146.9921      3758.8201      15.2382        14.5028        17.0085      
      4100   318.02187     -41175.816     -6131.9697      3758.8201      15.2382        14.5028        17.0085      
      4200   324.25792     -41189.439     -11736.147      3758.8201      15.2382        14.5028        17.0085      
      4300   292.36166     -41185.108     -21470.659      3758.8201      15.2382        14.5028        17.0085      
      4400   300.56703     -41193.448     -24693.457      3758.8201      15.2382        14.5028        17.0085      
      4500   314.56267     -41194.293     -6693.8574      3758.8201      15.2382        14.5028        17.0085      
      4600   303.18047     -41172.951     -15055.114      3758.8201      15.2382        14.5028        17.0085      
      4700   299.57065     -41173.634     -15501.039      3758.8201      15.2382        14.5028        17.0085      
      4800   287.05889     -41194.474     -16468.691      3758.8201      15.2382        14.5028        17.0085      
      4900   286.37563     -41190.05      -4091.8088      3758.8201      15.2382        14.5028        17.0085      
      5000   306.85442     -41189.629     -9223.1145      3758.8201      15.2382        14.5028        17.0085      
Loop time of 254.417 on 16 procs for 5000 steps with 350 atoms

Performance: 0.849 ns/day, 28.269 hours/ns, 19.653 timesteps/s, 6.878 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 188.59     | 193.02     | 200.23     |  27.4 | 75.87
Bond    | 0.0016833  | 0.001985   | 0.0024973  |   0.5 |  0.00
Neigh   | 15.84      | 16.192     | 16.435     |   4.3 |  6.36
Comm    | 14.109     | 21.218     | 25.821     |  83.6 |  8.34
Output  | 0.031997   | 0.037919   | 0.043881   |   2.1 |  0.01
Modify  | 22.505     | 22.861     | 23.393     |   5.4 |  8.99
Other   |            | 1.086      |            |       |  0.43

Nlocal:          43.75 ave          48 max          36 min
Histogram: 1 0 0 0 1 2 0 0 1 3
Nghost:        3187.75 ave        3215 max        3161 min
Histogram: 1 2 1 0 0 0 1 0 1 2
Neighs:        28498.6 ave       30998 max       23694 min
Histogram: 1 0 0 0 1 1 1 0 1 3

Total # of neighbors = 227989
Ave neighs/atom = 651.39714
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.2382
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.52382 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.6 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.30013     -41219.147      8090.5185      3758.8201      15.2382        14.5028        17.0085      
       200   309.14081     -41200.339      638.70378      3758.8201      15.2382        14.5028        17.0085      
       300   310.63058     -41176.298     -5460.3588      3758.8201      15.2382        14.5028        17.0085      
       400   323.43568     -41156.177      9432.8078      3758.8201      15.2382        14.5028        17.0085      
       500   319.01245     -41139.801     -9438.7939      3758.8201      15.2382        14.5028        17.0085      
       600   323.69964     -41182.799     -3696.0859      3758.8201      15.2382        14.5028        17.0085      
       700   318.97237     -41187.728     -4393.35        3758.8201      15.2382        14.5028        17.0085      
       800   296.78161     -41187.444     -14919.52       3758.8201      15.2382        14.5028        17.0085      
       900   295.19071     -41196.1       -14083          3758.8201      15.2382        14.5028        17.0085      
      1000   305.96205     -41198.397     -11749.719      3758.8201      15.2382        14.5028        17.0085      
      1100   306.70544     -41170.163     -10801.177      3758.8201      15.2382        14.5028        17.0085      
      1200   305.90953     -41146.895     -10156.506      3758.8201      15.2382        14.5028        17.0085      
      1300   319.35653     -41167.093     -11666.505      3758.8201      15.2382        14.5028        17.0085      
      1400   313.25448     -41186.046      4607.2312      3758.8201      15.2382        14.5028        17.0085      
      1500   305.87494     -41181.819      6323.0319      3758.8201      15.2382        14.5028        17.0085      
      1600   297.62261     -41167.339     -12464.979      3758.8201      15.2382        14.5028        17.0085      
      1700   298.71627     -41153.045     -4765.4273      3758.8201      15.2382        14.5028        17.0085      
      1800   308.14973     -41154.587     -12767.926      3758.8201      15.2382        14.5028        17.0085      
      1900   279.02347     -41142.368     -660.85211      3758.8201      15.2382        14.5028        17.0085      
      2000   282.40932     -41169.043     -9324.2717      3758.8201      15.2382        14.5028        17.0085      
      2100   298.52629     -41180.063     -7072.1229      3758.8201      15.2382        14.5028        17.0085      
      2200   311.88766     -41179.572     -11820.437      3758.8201      15.2382        14.5028        17.0085      
      2300   334.66727     -41166.122     -5496.447       3758.8201      15.2382        14.5028        17.0085      
      2400   314.67919     -41138.877     -11888.373      3758.8201      15.2382        14.5028        17.0085      
      2500   297.16241     -41144.99      -4242.8077      3758.8201      15.2382        14.5028        17.0085      
      2600   287.89146     -41148.375     -1841.9719      3758.8201      15.2382        14.5028        17.0085      
      2700   314.3027      -41178.343     -10278.898      3758.8201      15.2382        14.5028        17.0085      
      2800   303.07171     -41176.94      -10224.176      3758.8201      15.2382        14.5028        17.0085      
      2900   294.82447     -41176.224     -8056.6409      3758.8201      15.2382        14.5028        17.0085      
      3000   291.55808     -41168.347     -6517.1916      3758.8201      15.2382        14.5028        17.0085      
      3100   309.73437     -41162.851     -3817.6269      3758.8201      15.2382        14.5028        17.0085      
      3200   304.36502     -41143.545     -16006.513      3758.8201      15.2382        14.5028        17.0085      
      3300   298.50528     -41146.691     -16590.303      3758.8201      15.2382        14.5028        17.0085      
      3400   289.57648     -41165.232      1923.6293      3758.8201      15.2382        14.5028        17.0085      
      3500   279.64692     -41158.442      5451.1235      3758.8201      15.2382        14.5028        17.0085      
      3600   282.97008     -41148.887     -153.40793      3758.8201      15.2382        14.5028        17.0085      
      3700   294.39031     -41147.516     -10564.491      3758.8201      15.2382        14.5028        17.0085      
      3800   298.41684     -41145.59      -3760.4175      3758.8201      15.2382        14.5028        17.0085      
      3900   308.84463     -41149.609     -12823.011      3758.8201      15.2382        14.5028        17.0085      
      4000   288.86352     -41157.376     -7274.0265      3758.8201      15.2382        14.5028        17.0085      
      4100   289.06307     -41171.006     -4900.2848      3758.8201      15.2382        14.5028        17.0085      
      4200   290.00455     -41155.989     -2577.8429      3758.8201      15.2382        14.5028        17.0085      
      4300   319.11052     -41158.274      1995.7505      3758.8201      15.2382        14.5028        17.0085      
      4400   298.42444     -41134.439     -12006.988      3758.8201      15.2382        14.5028        17.0085      
      4500   282.06977     -41119.884     -14247.405      3758.8201      15.2382        14.5028        17.0085      
      4600   290.16807     -41125.867     -7973.1303      3758.8201      15.2382        14.5028        17.0085      
      4700   283.56931     -41126.579     -25073.978      3758.8201      15.2382        14.5028        17.0085      
      4800   287.7936      -41152.762     -12667.006      3758.8201      15.2382        14.5028        17.0085      
      4900   284.49434     -41143.109     -12035.717      3758.8201      15.2382        14.5028        17.0085      
      5000   304.34735     -41128.83      -10101.621      3758.8201      15.2382        14.5028        17.0085      
Loop time of 249.648 on 16 procs for 5000 steps with 350 atoms

Performance: 0.865 ns/day, 27.739 hours/ns, 20.028 timesteps/s, 7.010 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 185.92     | 190.02     | 192.3      |  18.2 | 76.11
Bond    | 0.001664   | 0.0019419  | 0.0022739  |   0.4 |  0.00
Neigh   | 14.994     | 15.386     | 15.816     |   7.1 |  6.16
Comm    | 18.407     | 20.776     | 24.99      |  56.7 |  8.32
Output  | 0.028164   | 0.032697   | 0.03709    |   1.7 |  0.01
Modify  | 22.005     | 22.502     | 22.841     |   6.7 |  9.01
Other   |            | 0.931      |            |       |  0.37

Nlocal:          43.75 ave          50 max          34 min
Histogram: 2 0 0 0 0 1 1 0 2 2
Nghost:        3171.62 ave        3254 max        3102 min
Histogram: 2 0 1 0 1 2 0 0 1 1
Neighs:        28503.4 ave       32339 max       22422 min
Histogram: 2 0 0 0 0 1 1 0 2 2

Total # of neighbors = 228027
Ave neighs/atom = 651.50571
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 14.5028
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.4482)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_restart CPU = 0.007 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.45028 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.17822     -41219.073      8065.6497      3758.8201      15.2382        14.5028        17.0085      
       200   308.69022     -41201.128      2204.9247      3758.8201      15.2382        14.5028        17.0085      
       300   310.58144     -41179.637     -8550.9722      3758.8201      15.2382        14.5028        17.0085      
       400   318.40345     -41156.093      12319.265      3758.8201      15.2382        14.5028        17.0085      
       500   311.52911     -41121.481     -7750.1709      3758.8201      15.2382        14.5028        17.0085      
       600   311.1113      -41158.566      4107.945       3758.8201      15.2382        14.5028        17.0085      
       700   312.65693     -41181.64      -11851.065      3758.8201      15.2382        14.5028        17.0085      
       800   285.12747     -41178.391     -3482.4965      3758.8201      15.2382        14.5028        17.0085      
       900   290.11965     -41190.824      8096.8983      3758.8201      15.2382        14.5028        17.0085      
      1000   287.72279     -41183.269     -8119.4124      3758.8201      15.2382        14.5028        17.0085      
      1100   284.69988     -41157.321     -11192.211      3758.8201      15.2382        14.5028        17.0085      
      1200   319.44151     -41167.447     -9243.3167      3758.8201      15.2382        14.5028        17.0085      
      1300   303.18692     -41152.081      3056.119       3758.8201      15.2382        14.5028        17.0085      
      1400   305.46344     -41192.113     -18229.448      3758.8201      15.2382        14.5028        17.0085      
      1500   297.32689     -41185.767     -7154.0995      3758.8201      15.2382        14.5028        17.0085      
      1600   294.56405     -41171.596     -4610.0627      3758.8201      15.2382        14.5028        17.0085      
      1700   303.96324     -41170.46      -11156.549      3758.8201      15.2382        14.5028        17.0085      
      1800   302.50092     -41182.88      -2351.3947      3758.8201      15.2382        14.5028        17.0085      
      1900   282.98152     -41184.925     -5362.9635      3758.8201      15.2382        14.5028        17.0085      
      2000   283.7276      -41179.788     -8276.8169      3758.8201      15.2382        14.5028        17.0085      
      2100   319.17294     -41196.476      8964.2636      3758.8201      15.2382        14.5028        17.0085      
      2200   310.0361      -41175.14      -7281.3168      3758.8201      15.2382        14.5028        17.0085      
      2300   318.71515     -41138.09       7666.8387      3758.8201      15.2382        14.5028        17.0085      
      2400   322.47175     -41149.278     -13524.595      3758.8201      15.2382        14.5028        17.0085      
      2500   312.38626     -41172.369     -8591.1416      3758.8201      15.2382        14.5028        17.0085      
      2600   290.11637     -41167.617     -9996.4478      3758.8201      15.2382        14.5028        17.0085      
      2700   285.78181     -41174.114     -13284.117      3758.8201      15.2382        14.5028        17.0085      
      2800   316.5761      -41194.501      532.93067      3758.8201      15.2382        14.5028        17.0085      
      2900   303.50834     -41155.595     -5953.8988      3758.8201      15.2382        14.5028        17.0085      
      3000   302.02314     -41137.655     -13615.649      3758.8201      15.2382        14.5028        17.0085      
      3100   328.97703     -41151.468     -4046.6167      3758.8201      15.2382        14.5028        17.0085      
      3200   306.53687     -41143.407      3102.314       3758.8201      15.2382        14.5028        17.0085      
      3300   311.52501     -41179.76      -10032.198      3758.8201      15.2382        14.5028        17.0085      
      3400   277.29035     -41159.539     -13206.745      3758.8201      15.2382        14.5028        17.0085      
      3500   293.14664     -41171.473      1480.4406      3758.8201      15.2382        14.5028        17.0085      
      3600   313.90792     -41174.043     -24915.302      3758.8201      15.2382        14.5028        17.0085      
      3700   317.62818     -41149.792     -5682.7831      3758.8201      15.2382        14.5028        17.0085      
      3800   304.18589     -41147.844     -7359.3568      3758.8201      15.2382        14.5028        17.0085      
      3900   292.59803     -41167.942     -15076.067      3758.8201      15.2382        14.5028        17.0085      
      4000   314.78474     -41201.578     -11291.32       3758.8201      15.2382        14.5028        17.0085      
      4100   294.43106     -41186.135     -11915.764      3758.8201      15.2382        14.5028        17.0085      
      4200   304.97656     -41188.412     -2994.2962      3758.8201      15.2382        14.5028        17.0085      
      4300   307.60403     -41189.506     -7783.2492      3758.8201      15.2382        14.5028        17.0085      
      4400   286.03278     -41171.585     -5819.8625      3758.8201      15.2382        14.5028        17.0085      
      4500   299.19132     -41180.668      696.97491      3758.8201      15.2382        14.5028        17.0085      
      4600   288.48788     -41162.363     -535.25893      3758.8201      15.2382        14.5028        17.0085      
      4700   315.73866     -41184.001     -5036.511       3758.8201      15.2382        14.5028        17.0085      
      4800   305.26874     -41188.136     -10502.472      3758.8201      15.2382        14.5028        17.0085      
      4900   286.04864     -41195.272     -7385.5212      3758.8201      15.2382        14.5028        17.0085      
      5000   281.65864     -41188.622     -12405.473      3758.8201      15.2382        14.5028        17.0085      
Loop time of 251.631 on 16 procs for 5000 steps with 350 atoms

Performance: 0.858 ns/day, 27.959 hours/ns, 19.870 timesteps/s, 6.955 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 185.11     | 190.12     | 196.42     |  24.3 | 75.55
Bond    | 0.0017088  | 0.0019572  | 0.0021839  |   0.3 |  0.00
Neigh   | 15.544     | 15.805     | 15.985     |   3.9 |  6.28
Comm    | 15.605     | 22.094     | 27.191     |  72.7 |  8.78
Output  | 0.029025   | 0.034117   | 0.038808   |   1.9 |  0.01
Modify  | 22.429     | 22.623     | 22.965     |   4.2 |  8.99
Other   |            | 0.9544     |            |       |  0.38

Nlocal:          43.75 ave          48 max          37 min
Histogram: 2 0 0 0 0 1 0 2 0 3
Nghost:         3183.5 ave        3220 max        3147 min
Histogram: 1 1 0 2 0 1 1 0 0 2
Neighs:          28520 ave       31166 max       24358 min
Histogram: 2 0 0 0 0 1 1 1 0 3

Total # of neighbors = 228160
Ave neighs/atom = 651.88571
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.007 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.45028 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.6 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.36309     -41219.145      8122.667       3758.8201      15.2382        14.5028        17.0085      
       200   307.19894     -41196.997      1895.2179      3758.8201      15.2382        14.5028        17.0085      
       300   308.4397      -41176.558     -4184.4636      3758.8201      15.2382        14.5028        17.0085      
       400   317.35368     -41153.171      10342.249      3758.8201      15.2382        14.5028        17.0085      
       500   323.17766     -41135.314     -6081.8747      3758.8201      15.2382        14.5028        17.0085      
       600   305.91405     -41155.369     -16277.165      3758.8201      15.2382        14.5028        17.0085      
       700   313.51422     -41191.728     -8295.3037      3758.8201      15.2382        14.5028        17.0085      
       800   295.02046     -41190.782     -6321.4888      3758.8201      15.2382        14.5028        17.0085      
       900   260.96734     -41162.346      1466.8158      3758.8201      15.2382        14.5028        17.0085      
      1000   302.45954     -41188.139     -12759.837      3758.8201      15.2382        14.5028        17.0085      
      1100   301.936       -41152.882     -8679.3329      3758.8201      15.2382        14.5028        17.0085      
      1200   301.23027     -41152.251     -19798.682      3758.8201      15.2382        14.5028        17.0085      
      1300   321.35449     -41186.671     -2293.9287      3758.8201      15.2382        14.5028        17.0085      
      1400   298.71055     -41179.021     -15781.232      3758.8201      15.2382        14.5028        17.0085      
      1500   304.08424     -41190.348     -2870.7167      3758.8201      15.2382        14.5028        17.0085      
      1600   303.14958     -41196.089     -1522.0142      3758.8201      15.2382        14.5028        17.0085      
      1700   295.3729      -41201.332     -7008.9129      3758.8201      15.2382        14.5028        17.0085      
      1800   271.48421     -41207.63      -12320.035      3758.8201      15.2382        14.5028        17.0085      
      1900   291.23568     -41216.952     -14445.792      3758.8201      15.2382        14.5028        17.0085      
      2000   305.72194     -41197.91      -2367.1632      3758.8201      15.2382        14.5028        17.0085      
      2100   299.5645      -41181.583     -8146.7028      3758.8201      15.2382        14.5028        17.0085      
      2200   311.48352     -41181.209     -21428.912      3758.8201      15.2382        14.5028        17.0085      
      2300   289.21915     -41146.576     -9307.1842      3758.8201      15.2382        14.5028        17.0085      
      2400   293.17235     -41164.395     -6983.3128      3758.8201      15.2382        14.5028        17.0085      
      2500   291.2808      -41188.993     -6769.4257      3758.8201      15.2382        14.5028        17.0085      
      2600   276.87024     -41182.195     -13319.572      3758.8201      15.2382        14.5028        17.0085      
      2700   283.34313     -41173.998     -2712.9952      3758.8201      15.2382        14.5028        17.0085      
      2800   311.65426     -41179.699      11243.888      3758.8201      15.2382        14.5028        17.0085      
      2900   281.41034     -41145.849      3094.4996      3758.8201      15.2382        14.5028        17.0085      
      3000   300.01326     -41167.875     -9143.9264      3758.8201      15.2382        14.5028        17.0085      
      3100   316.90705     -41183.019     -9807.2064      3758.8201      15.2382        14.5028        17.0085      
      3200   300.06795     -41184.335     -9327.1914      3758.8201      15.2382        14.5028        17.0085      
      3300   312.13572     -41217.643     -10567.05       3758.8201      15.2382        14.5028        17.0085      
      3400   309.50088     -41219.933     -5974.6392      3758.8201      15.2382        14.5028        17.0085      
      3500   311.49858     -41219.693     -20812.356      3758.8201      15.2382        14.5028        17.0085      
      3600   304.71693     -41192.019     -21472.753      3758.8201      15.2382        14.5028        17.0085      
      3700   311.20246     -41166.66      -7299.217       3758.8201      15.2382        14.5028        17.0085      
      3800   323.73376     -41187.676     -18667.656      3758.8201      15.2382        14.5028        17.0085      
      3900   303.04868     -41180.584     -9772.1779      3758.8201      15.2382        14.5028        17.0085      
      4000   306.18867     -41190.112     -2890.5595      3758.8201      15.2382        14.5028        17.0085      
      4100   288.52769     -41175.318      3730.6448      3758.8201      15.2382        14.5028        17.0085      
      4200   293.63196     -41185.746     -19082.507      3758.8201      15.2382        14.5028        17.0085      
      4300   286.33163     -41198.058      5804.5462      3758.8201      15.2382        14.5028        17.0085      
      4400   286.30223     -41219.381     -962.58483      3758.8201      15.2382        14.5028        17.0085      
      4500   290.60999     -41212.899     -3729.3352      3758.8201      15.2382        14.5028        17.0085      
      4600   282.40055     -41181.821     -15266.591      3758.8201      15.2382        14.5028        17.0085      
      4700   284.73596     -41168.31      -27681.959      3758.8201      15.2382        14.5028        17.0085      
      4800   295.98686     -41170.81      -16661.19       3758.8201      15.2382        14.5028        17.0085      
      4900   322.28135     -41197.989     -4458.8059      3758.8201      15.2382        14.5028        17.0085      
      5000   287.98287     -41184.3       -4975.586       3758.8201      15.2382        14.5028        17.0085      
Loop time of 251.091 on 16 procs for 5000 steps with 350 atoms

Performance: 0.860 ns/day, 27.899 hours/ns, 19.913 timesteps/s, 6.970 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 186.22     | 191.23     | 193.6      |  15.6 | 76.16
Bond    | 0.0017348  | 0.0019812  | 0.0022047  |   0.4 |  0.00
Neigh   | 15.13      | 15.61      | 16.027     |   7.5 |  6.22
Comm    | 18.299     | 20.585     | 25.597     |  48.1 |  8.20
Output  | 0.033176   | 0.038832   | 0.044524   |   2.0 |  0.02
Modify  | 22.026     | 22.568     | 23.122     |   7.0 |  8.99
Other   |            | 1.054      |            |       |  0.42

Nlocal:          43.75 ave          50 max          35 min
Histogram: 1 0 0 1 2 0 1 0 1 2
Nghost:         3189.5 ave        3256 max        3129 min
Histogram: 1 1 1 0 1 1 1 0 1 1
Neighs:        28531.1 ave       32433 max       23160 min
Histogram: 1 0 0 1 2 0 1 1 0 2

Total # of neighbors = 228249
Ave neighs/atom = 652.14
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.0085
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--6.2627)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.70085 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.16966     -41219.068      8064.764       3758.8201      15.2382        14.5028        17.0085      
       200   305.84897     -41196.562      1944.1898      3758.8201      15.2382        14.5028        17.0085      
       300   307.183       -41176.324     -4200.4995      3758.8201      15.2382        14.5028        17.0085      
       400   313.28447     -41151.447      10410.752      3758.8201      15.2382        14.5028        17.0085      
       500   324.12991     -41134.032     -5629.4017      3758.8201      15.2382        14.5028        17.0085      
       600   311.5101      -41162.993     -11235.977      3758.8201      15.2382        14.5028        17.0085      
       700   312.086       -41185.776     -19998.879      3758.8201      15.2382        14.5028        17.0085      
       800   298.68621     -41194.611     -10249.321      3758.8201      15.2382        14.5028        17.0085      
       900   280.72274     -41187.123     -4286.3622      3758.8201      15.2382        14.5028        17.0085      
      1000   287.31965     -41187.117     -11646.277      3758.8201      15.2382        14.5028        17.0085      
      1100   300.50748     -41174.171     -802.27898      3758.8201      15.2382        14.5028        17.0085      
      1200   307.50965     -41160.817     -4713.4879      3758.8201      15.2382        14.5028        17.0085      
      1300   324.91679     -41185.614     -4160.2796      3758.8201      15.2382        14.5028        17.0085      
      1400   301.7448      -41200.407     -11062.143      3758.8201      15.2382        14.5028        17.0085      
      1500   299.41962     -41200.425     -4779.1822      3758.8201      15.2382        14.5028        17.0085      
      1600   278.2196      -41174.526     -4741.6213      3758.8201      15.2382        14.5028        17.0085      
      1700   299.06284     -41194.565     -3632.7383      3758.8201      15.2382        14.5028        17.0085      
      1800   303.92962     -41185.538     -4527.6429      3758.8201      15.2382        14.5028        17.0085      
      1900   305.84312     -41164.058     -7730.9141      3758.8201      15.2382        14.5028        17.0085      
      2000   307.20554     -41155.35      -19630.238      3758.8201      15.2382        14.5028        17.0085      
      2100   304.79263     -41173.516     -21828.423      3758.8201      15.2382        14.5028        17.0085      
      2200   310.35797     -41204.589     -11386.698      3758.8201      15.2382        14.5028        17.0085      
      2300   288.62161     -41189.101     -3874.9584      3758.8201      15.2382        14.5028        17.0085      
      2400   293.95281     -41189.226     -8103.0545      3758.8201      15.2382        14.5028        17.0085      
      2500   299.53752     -41191.378     -9983.2403      3758.8201      15.2382        14.5028        17.0085      
      2600   295.30523     -41189.271     -11957.384      3758.8201      15.2382        14.5028        17.0085      
      2700   301.54802     -41210.695     -9665.0399      3758.8201      15.2382        14.5028        17.0085      
      2800   284.17372     -41189.621     -11203.663      3758.8201      15.2382        14.5028        17.0085      
      2900   285.73562     -41167.619      3415.8907      3758.8201      15.2382        14.5028        17.0085      
      3000   318.54115     -41166.913     -4891.3647      3758.8201      15.2382        14.5028        17.0085      
      3100   318.45777     -41165.495     -25628.861      3758.8201      15.2382        14.5028        17.0085      
      3200   299.06898     -41156.785     -27533.973      3758.8201      15.2382        14.5028        17.0085      
      3300   313.63819     -41170.733     -11808.523      3758.8201      15.2382        14.5028        17.0085      
      3400   300.65511     -41166.187     -540.84464      3758.8201      15.2382        14.5028        17.0085      
      3500   309.79917     -41183.232     -9690.1963      3758.8201      15.2382        14.5028        17.0085      
      3600   283.74175     -41155.05      -5453.376       3758.8201      15.2382        14.5028        17.0085      
      3700   303.16692     -41167.35      -17432.056      3758.8201      15.2382        14.5028        17.0085      
      3800   297.6382      -41157.569     -3688.4396      3758.8201      15.2382        14.5028        17.0085      
      3900   301.91232     -41163.939     -720.49472      3758.8201      15.2382        14.5028        17.0085      
      4000   273.91941     -41170.15      -6532.0242      3758.8201      15.2382        14.5028        17.0085      
      4100   282.34711     -41170.847     -18574.43       3758.8201      15.2382        14.5028        17.0085      
      4200   298.92235     -41171.367     -14736.265      3758.8201      15.2382        14.5028        17.0085      
      4300   315.57487     -41164.851     -4007.45        3758.8201      15.2382        14.5028        17.0085      
      4400   326.66921     -41152.333     -18533.024      3758.8201      15.2382        14.5028        17.0085      
      4500   333.95911     -41147.506     -10157.211      3758.8201      15.2382        14.5028        17.0085      
      4600   288.37548     -41135.768     -4446.4438      3758.8201      15.2382        14.5028        17.0085      
      4700   308.355       -41169.657     -11866.173      3758.8201      15.2382        14.5028        17.0085      
      4800   305.24383     -41168.295     -17135.078      3758.8201      15.2382        14.5028        17.0085      
      4900   290.53418     -41148.605     -12582.026      3758.8201      15.2382        14.5028        17.0085      
      5000   303.06026     -41178.174     -10480.342      3758.8201      15.2382        14.5028        17.0085      
Loop time of 254.429 on 16 procs for 5000 steps with 350 atoms

Performance: 0.849 ns/day, 28.270 hours/ns, 19.652 timesteps/s, 6.878 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 188.14     | 192.12     | 194.1      |  16.4 | 75.51
Bond    | 0.0016496  | 0.001949   | 0.0021857  |   0.4 |  0.00
Neigh   | 15.563     | 16.081     | 16.709     |   9.7 |  6.32
Comm    | 20.66      | 22.596     | 26.504     |  48.0 |  8.88
Output  | 0.029904   | 0.036489   | 0.04208    |   2.2 |  0.01
Modify  | 21.979     | 22.631     | 23.176     |   8.9 |  8.89
Other   |            | 0.9657     |            |       |  0.38

Nlocal:          43.75 ave          49 max          37 min
Histogram: 1 0 1 0 0 1 3 1 0 1
Nghost:        3285.75 ave        3366 max        3218 min
Histogram: 1 1 1 1 0 2 0 0 1 1
Neighs:        28541.2 ave       31662 max       24447 min
Histogram: 1 0 1 0 1 0 2 2 0 1

Total # of neighbors = 228330
Ave neighs/atom = 652.37143
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.70085 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.5 | 126.6 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.8002      -41184.819     -11806.452      3758.8201      15.2382        14.5028        17.0085      
       100   315.35139     -41219.21       8043.3226      3758.8201      15.2382        14.5028        17.0085      
       200   309.22473     -41198.562      3772.4487      3758.8201      15.2382        14.5028        17.0085      
       300   304.51033     -41170.408     -6348.6917      3758.8201      15.2382        14.5028        17.0085      
       400   315.14066     -41146.485      5880.5409      3758.8201      15.2382        14.5028        17.0085      
       500   308.48777     -41125.343      16801.341      3758.8201      15.2382        14.5028        17.0085      
       600   300.94191     -41158.89       2344.2223      3758.8201      15.2382        14.5028        17.0085      
       700   307.25868     -41183.621     -19268.875      3758.8201      15.2382        14.5028        17.0085      
       800   288.22246     -41183.284     -8212.162       3758.8201      15.2382        14.5028        17.0085      
       900   269.69651     -41172.676     -2974.7465      3758.8201      15.2382        14.5028        17.0085      
      1000   276.72178     -41172.994     -23820.041      3758.8201      15.2382        14.5028        17.0085      
      1100   304.05514     -41166.248     -2265.4762      3758.8201      15.2382        14.5028        17.0085      
      1200   331.92582     -41170.655     -9832.8413      3758.8201      15.2382        14.5028        17.0085      
      1300   305.90036     -41154.686     -21941.235      3758.8201      15.2382        14.5028        17.0085      
      1400   330.29044     -41194.451     -10204.167      3758.8201      15.2382        14.5028        17.0085      
      1500   301.47479     -41178.246     -11962.179      3758.8201      15.2382        14.5028        17.0085      
      1600   302.33765     -41189.682     -9743.3718      3758.8201      15.2382        14.5028        17.0085      
      1700   306.75096     -41203.085     -14680.547      3758.8201      15.2382        14.5028        17.0085      
      1800   275.63262     -41194.27      -16601.616      3758.8201      15.2382        14.5028        17.0085      
      1900   291.68807     -41213.966     -3023.5568      3758.8201      15.2382        14.5028        17.0085      
      2000   281.14701     -41171.375     -15806.397      3758.8201      15.2382        14.5028        17.0085      
      2100   296.03063     -41169.051     -16042.585      3758.8201      15.2382        14.5028        17.0085      
      2200   300.61243     -41170.18      -8364.8959      3758.8201      15.2382        14.5028        17.0085      
      2300   294.86861     -41169.363      422.37577      3758.8201      15.2382        14.5028        17.0085      
      2400   272.40602     -41165.994     -12303.682      3758.8201      15.2382        14.5028        17.0085      
      2500   291.79738     -41188.151     -5380.2859      3758.8201      15.2382        14.5028        17.0085      
      2600   308.99038     -41165.158     -2516.6121      3758.8201      15.2382        14.5028        17.0085      
      2700   316.1611      -41154.942     -8939.9211      3758.8201      15.2382        14.5028        17.0085      
      2800   296.06461     -41147.307     -5078.124       3758.8201      15.2382        14.5028        17.0085      
      2900   285.62599     -41150.777     -10969.484      3758.8201      15.2382        14.5028        17.0085      
      3000   299.56991     -41162.586     -1826.5098      3758.8201      15.2382        14.5028        17.0085      
      3100   299.52983     -41162.624     -9945.2077      3758.8201      15.2382        14.5028        17.0085      
      3200   296.04889     -41154.656     -606.91201      3758.8201      15.2382        14.5028        17.0085      
      3300   301.60536     -41148.575     -4504.7221      3758.8201      15.2382        14.5028        17.0085      
      3400   331.65213     -41158.701     -15172.02       3758.8201      15.2382        14.5028        17.0085      
      3500   304.54255     -41135.157     -10574.881      3758.8201      15.2382        14.5028        17.0085      
      3600   297.20171     -41154.097     -3389.2934      3758.8201      15.2382        14.5028        17.0085      
      3700   285.28575     -41155.661     -15440.207      3758.8201      15.2382        14.5028        17.0085      
      3800   298.44138     -41162.618     -8297.2987      3758.8201      15.2382        14.5028        17.0085      
      3900   303.57195     -41143.914     -7547.8759      3758.8201      15.2382        14.5028        17.0085      
      4000   339.52732     -41147.315     -14820.46       3758.8201      15.2382        14.5028        17.0085      
      4100   288.76187     -41113.276     -13027.039      3758.8201      15.2382        14.5028        17.0085      
      4200   301.50855     -41141.335     -4193.8144      3758.8201      15.2382        14.5028        17.0085      
      4300   301.15648     -41143.218     -12168.241      3758.8201      15.2382        14.5028        17.0085      
      4400   317.98446     -41159.692     -6858.8111      3758.8201      15.2382        14.5028        17.0085      
      4500   289.1021      -41135.074     -1574.9282      3758.8201      15.2382        14.5028        17.0085      
      4600   310.17501     -41161.327     -10027.725      3758.8201      15.2382        14.5028        17.0085      
      4700   298.83797     -41138.956     -11742.528      3758.8201      15.2382        14.5028        17.0085      
      4800   314.69492     -41124.259     -20169.571      3758.8201      15.2382        14.5028        17.0085      
      4900   322.50509     -41118.365     -16991.536      3758.8201      15.2382        14.5028        17.0085      
      5000   281.433       -41105.801     -6255.887       3758.8201      15.2382        14.5028        17.0085      
Loop time of 222.707 on 16 procs for 5000 steps with 350 atoms

Performance: 0.970 ns/day, 24.745 hours/ns, 22.451 timesteps/s, 7.858 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 128.43     | 152.58     | 184.78     | 183.3 | 68.51
Bond    | 0.0012983  | 0.0015857  | 0.001888   |   0.5 |  0.00
Neigh   | 10.99      | 13.174     | 16.233     |  61.0 |  5.92
Comm    | 4.0606     | 36.27      | 60.431     | 376.1 | 16.29
Output  | 0.014964   | 0.016586   | 0.017819   |   0.8 |  0.01
Modify  | 17.495     | 20.553     | 22.744     |  48.8 |  9.23
Other   |            | 0.1096     |            |       |  0.05

Nlocal:          43.75 ave          50 max          36 min
Histogram: 2 0 1 0 0 1 0 1 1 2
Nghost:         3108.5 ave        3181 max        3039 min
Histogram: 2 1 0 1 0 0 1 1 0 2
Neighs:        28517.5 ave       32389 max       23345 min
Histogram: 1 1 1 0 0 0 1 1 1 2

Total # of neighbors = 228140
Ave neighs/atom = 651.82857
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:54:18
