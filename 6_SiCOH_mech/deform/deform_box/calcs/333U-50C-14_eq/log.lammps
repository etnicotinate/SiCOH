LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
# boundary        s s s
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 0.1
variable FF string "SiOCHN_2018.ff C H O Si"          # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff C H O Si
# pair_coeff * * CHOSiNa.ff C H O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff C H O Si
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-14_eq

read_data       ${structure}.data
read_data       333U-50C-14_eq.data
Reading data file ...
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  371 atoms
  reading velocities ...
  371 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# # Energy minimization
# print "*****Minimization starts.*****"
# minimize 1.0e-6 1.0e-6 100 1000
# min_style cg
# # Save the optimized structure
# write_data ${structure}_opt.data
# velocity        all create ${temp} ${seed} dist gaussian

# # Equilibration
# include ff.mod.lmp
# if "$(is_defined(fix,avgp))" then "unfix avgp"
# if "$(is_defined(fix,avgl))" then "unfix avgl"
# thermo_style custom step temp pe press density vol
# run ${nequil}
# # Save the equilibrated structure
# write_data ${structure}_eq.data

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.3186
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.8149
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.6403

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.2054
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.4589
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.851

# Write restart
write_restart equil.res
System init for write_restart ...
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 17.3186
variable dlen equal lx-${len0}
variable dlen equal lx-17.3186
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3186
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.08851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.004589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.002054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.173186 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.173186 xy delta 0.08851 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.173186 xy delta 0.08851 xz delta -0.004589 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform1.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.97055     -38178.074     -9459.1065      4136.1286    
       200   316.10416     -38169.759     -12954.008      4135.3012    
       300   311.58496     -38155.329      3117.3519      4134.4738    
       400   303.18324     -38172.104     -1687.701       4133.6464    
       500   318.11075     -38197.853     -7658.6137      4132.819     
       600   293.07127     -38181.462      6761.3853      4131.9916    
       700   285.02878     -38179.755     -19099.388      4131.1643    
       800   291.26536     -38177.711     -9169.3765      4130.3369    
       900   310.85581     -38164.943     -3227.1594      4129.5095    
      1000   298.90944     -38160.401      1828.8179      4128.6821    
      1100   283.03803     -38165.027     -8199.9474      4127.8547    
      1200   288.26603     -38176.247     -818.21143      4127.0273    
      1300   303.60944     -38189.597      395.85758      4126.1999    
      1400   304.09705     -38194.908     -2960.417       4125.3725    
      1500   281.68115     -38170.038      12236.263      4124.5451    
      1600   315.85879     -38203.815     -14427.131      4123.7177    
      1700   292.55801     -38177.614     -13587.093      4122.8903    
      1800   306.04905     -38192.331      31.723644      4122.0629    
      1900   296.61558     -38181.882      7519.2969      4121.2356    
      2000   304.84835     -38175.572      18661.747      4120.4082    
      2100   295.77095     -38172.652      7048.3082      4119.5808    
      2200   291.70175     -38189.485     -2297.8901      4118.7534    
      2300   277.78268     -38185.138      8672.574       4117.926     
      2400   306.47469     -38199.166     -1926.6024      4117.0986    
      2500   318.47722     -38176.511      520.41076      4116.2712    
      2600   309.25508     -38170.738     -7272.3991      4115.4438    
      2700   288.57385     -38172.289     -9768.8755      4114.6164    
      2800   312.43598     -38207.078     -10883.673      4113.789     
      2900   302.8249      -38202.59      -10416.137      4112.9616    
      3000   300.58287     -38201.63       5329.0988      4112.1343    
      3100   318.06907     -38194.735     -3478.6258      4111.3069    
      3200   310.11091     -38163.204     -2599.2215      4110.4795    
      3300   313.67173     -38182.879      11503.59       4109.6521    
      3400   301.57162     -38202.68       1268.5124      4108.8247    
      3500   292.83638     -38200.137     -12802.116      4107.9973    
      3600   298.70029     -38191.408     -2861.66        4107.1699    
      3700   313.64707     -38187.609     -1855.3829      4106.3425    
      3800   296.47384     -38156.085     -6103.6499      4105.5151    
      3900   307.63506     -38168.301     -17155.257      4104.6877    
      4000   295.7978      -38175.776     -22739.726      4103.8603    
      4100   286.42396     -38190.595     -10857.348      4103.033     
      4200   303.16543     -38213.599      2692.9762      4102.2056    
      4300   307.62264     -38199.729      10088.576      4101.3782    
      4400   316.30578     -38180.083      7947.4283      4100.5508    
      4500   310.41971     -38171.946     -12491.071      4099.7234    
      4600   299.15178     -38170.683      4631.3238      4098.896     
      4700   289.76669     -38172.475     -8142.0251      4098.0686    
      4800   301.82986     -38195.635      2775.2124      4097.2412    
      4900   305.71894     -38212.824      7157.9687      4096.4138    
      5000   272.19398     -38201.218      6061.6535      4095.5864    
Loop time of 214.603 on 16 procs for 5000 steps with 371 atoms

Performance: 1.007 ns/day, 23.845 hours/ns, 23.299 timesteps/s, 8.644 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 130.37     | 179.76     | 192.54     | 140.9 | 83.77
Bond    | 0.012927   | 0.014188   | 0.015115   |   0.6 |  0.01
Neigh   | 1.3108     | 1.8105     | 1.938      |  14.2 |  0.84
Comm    | 1.6618     | 14.442     | 63.776     | 496.5 |  6.73
Output  | 0.014731   | 0.036776   | 0.08232    |  12.4 |  0.02
Modify  | 18.281     | 18.402     | 18.926     |   4.7 |  8.57
Other   |            | 0.1346     |            |       |  0.06

Nlocal:         46.375 ave          51 max          37 min
Histogram: 1 0 0 0 0 2 1 0 2 2
Nghost:        3426.12 ave        3484 max        3378 min
Histogram: 1 2 0 0 1 0 3 0 0 1
Neighs:        29255.9 ave       31866 max       23685 min
Histogram: 1 0 0 0 0 1 2 0 2 2

Total # of neighbors = 234047
Ave neighs/atom = 630.85445
Ave special neighs/atom = 0
Neighbor list builds = 66
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3186
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.173186 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.173186 xy delta -0.08851 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.173186 xy delta -0.08851 xz delta 0.004589 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform1.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.94009     -38178.067     -9454.6458      4137.7834    
       200   316.46715     -38170.17      -12473.743      4138.6108    
       300   311.61112     -38155.178      2715.6443      4139.4382    
       400   301.45849     -38169.701     -2306.4453      4140.2656    
       500   317.43004     -38196.237     -8259.3381      4141.0929    
       600   294.6877      -38182.211      7449.2342      4141.9203    
       700   285.50722     -38180.338     -19859.448      4142.7477    
       800   290.71055     -38178.655     -13026.342      4143.5751    
       900   307.42077     -38161.892     -5809.4584      4144.4025    
      1000   301.6118      -38161.655      3711.006       4145.2299    
      1100   279.21384     -38158.584     -7138.9838      4146.0573    
      1200   291.20486     -38175.237      1747.5722      4146.8847    
      1300   306.65533     -38190.435      5674.6322      4147.7121    
      1400   302.81168     -38192.424      4776.3451      4148.5395    
      1500   289.47364     -38177.437      4026.4663      4149.3669    
      1600   313.26983     -38201.199     -7569.3694      4150.1942    
      1700   292.72679     -38184.032     -11039.487      4151.0216    
      1800   302.13908     -38208.653     -11905.178      4151.849     
      1900   287.53902     -38205.626     -2740.8723      4152.6764    
      2000   303.55911     -38206.681      9935.8194      4153.5038    
      2100   307.82333     -38184.151     -3012.6569      4154.3312    
      2200   300.17246     -38167.939     -9352.1005      4155.1586    
      2300   294.67122     -38164.944     -10091.34       4155.986     
      2400   297.05351     -38202.328      4828.0611      4156.8134    
      2500   286.61802     -38204.738     -666.36267      4157.6408    
      2600   267.38211     -38166.918     -365.53554      4158.4682    
      2700   306.36334     -38190.373     -603.49991      4159.2956    
      2800   280.20492     -38156.119     -3811.4639      4160.1229    
      2900   301.1001      -38169.878     -49.996649      4160.9503    
      3000   304.51834     -38167.872     -433.7391       4161.7777    
      3100   300.39137     -38163.154     -7664.7227      4162.6051    
      3200   298.42165     -38178.135     -10476.516      4163.4325    
      3300   296.91759     -38197.98       1950.5536      4164.2599    
      3400   303.43333     -38200.529     -4985.7057      4165.0873    
      3500   298.56189     -38166.66      -10255.291      4165.9147    
      3600   302.51064     -38146.687     -7856.8022      4166.7421    
      3700   310.32971     -38160.403     -1075.1672      4167.5695    
      3800   315.18037     -38178.238     -1350.2879      4168.3969    
      3900   300.65638     -38175.139     -3867.2529      4169.2242    
      4000   298.89463     -38182.806     -4367.5495      4170.0516    
      4100   292.06289     -38174.608     -4060.2105      4170.879     
      4200   309.02002     -38178.919     -10769.961      4171.7064    
      4300   308.02745     -38126.951     -6415.2279      4172.5338    
      4400   321.30832     -38147.491     -5743.6096      4173.3612    
      4500   312.60256     -38176.022     -2707.8068      4174.1886    
      4600   298.96599     -38179.844     -19706.969      4175.016     
      4700   281.25516     -38175.795     -13432.22       4175.8434    
      4800   298.31526     -38200.732      4323.9427      4176.6708    
      4900   306.86548     -38192.61      -4925.4687      4177.4982    
      5000   307.09732     -38157.259     -1587.7718      4178.3256    
Loop time of 208.393 on 16 procs for 5000 steps with 371 atoms

Performance: 1.037 ns/day, 23.155 hours/ns, 23.993 timesteps/s, 8.901 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 125.53     | 174.85     | 186.43     | 142.6 | 83.90
Bond    | 0.012803   | 0.014406   | 0.015193   |   0.6 |  0.01
Neigh   | 1.3882     | 1.8798     | 2.0323     |  13.9 |  0.90
Comm    | 1.7205     | 13.311     | 62.629     | 516.9 |  6.39
Output  | 0.01506    | 0.037006   | 0.082535   |  12.3 |  0.02
Modify  | 17.982     | 18.124     | 18.629     |   4.6 |  8.70
Other   |            | 0.1762     |            |       |  0.08

Nlocal:         46.375 ave          51 max          39 min
Histogram: 2 0 0 0 0 2 0 0 1 3
Nghost:        3344.38 ave        3422 max        3256 min
Histogram: 2 0 0 1 1 0 1 1 0 2
Neighs:        28666.8 ave       31570 max       24236 min
Histogram: 2 0 0 0 0 2 0 0 1 3

Total # of neighbors = 229334
Ave neighs/atom = 618.15094
Ave special neighs/atom = 0
Neighbor list builds = 70
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.8149
variable dlen equal ly-${len0}
variable dlen equal ly-12.8149
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.8149
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.08851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.004589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.002054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.128149 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.128149 yz delta -0.002054 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform2.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.95085     -38178.075     -9456.7747      4136.1286    
       200   316.17538     -38169.81      -12440.104      4135.3012    
       300   312.4689      -38156.16       3420.4084      4134.4738    
       400   303.52779     -38171.94      -1276.6243      4133.6464    
       500   318.25553     -38197.523     -7348.2133      4132.819     
       600   293.58624     -38181.927      8229.2905      4131.9916    
       700   283.9057      -38179.454     -18799.135      4131.1643    
       800   289.53409     -38176.639     -14082.083      4130.3369    
       900   309.96319     -38164.228     -6002.5785      4129.5095    
      1000   303.34509     -38165.617      8712.7935      4128.6821    
      1100   279.25287     -38160.463     -5022.4289      4127.8547    
      1200   289.68396     -38177.154     -3237.0296      4127.0273    
      1300   308.92247     -38193.431      3457.202       4126.1999    
      1400   298.93017     -38189.034      8248.4481      4125.3725    
      1500   301.2136      -38190.158     -460.99681      4124.5451    
      1600   319.12598     -38208.187     -8964.1752      4123.7177    
      1700   283.99368     -38175.228     -8640.1166      4122.8903    
      1800   311.60971     -38193.821     -10511.649      4122.0629    
      1900   314.39102     -38174.578     -1774.195       4121.2356    
      2000   300.86787     -38157.107      7013.7487      4120.4082    
      2100   298.92146     -38187.589     -5414.0901      4119.5808    
      2200   281.62409     -38182.262     -11867.724      4118.7534    
      2300   290.77371     -38185.434     -7363.4163      4117.926     
      2400   304.92282     -38181.081      6371.5836      4117.0986    
      2500   312.24211     -38186.943     -748.60178      4116.2712    
      2600   299.80484     -38193.057     -9289.1676      4115.4438    
      2700   287.68992     -38216.337      1265.0076      4114.6164    
      2800   298.82989     -38212.287     -4702.1299      4113.789     
      2900   293.40982     -38177.595     -11287.663      4112.9616    
      3000   311.00549     -38186.769     -10572.512      4112.1343    
      3100   312.45677     -38200.127     -17947.264      4111.3069    
      3200   298.82567     -38200.615     -11373.555      4110.4795    
      3300   265.42542     -38188.177      3337.939       4109.6521    
      3400   280.20628     -38207.762      8892.5981      4108.8247    
      3500   310.16732     -38203.842      6836.7204      4107.9973    
      3600   308.51193     -38187.012      1935.1144      4107.1699    
      3700   304.81463     -38179.364      2302.1849      4106.3425    
      3800   285.71419     -38158.44       1968.7022      4105.5151    
      3900   296.29339     -38190.019     -6510.5547      4104.6877    
      4000   287.86225     -38205.683     -11463.641      4103.8603    
      4100   281.10575     -38189.451     -936.04062      4103.033     
      4200   302.81126     -38183.454     -251.0677       4102.2056    
      4300   310.09943     -38188.951      10298.75       4101.3782    
      4400   305.8046      -38190.564     -6870.6995      4100.5508    
      4500   292.69047     -38196.27      -14497.747      4099.7234    
      4600   275.24344     -38189.085      173.71735      4098.896     
      4700   304.29012     -38190.922      1190.7215      4098.0686    
      4800   316.79702     -38182.264      2686.5093      4097.2412    
      4900   299.22903     -38177.724      4696.5833      4096.4138    
      5000   293.1724      -38184.823      7466.9539      4095.5864    
Loop time of 214.497 on 16 procs for 5000 steps with 371 atoms

Performance: 1.007 ns/day, 23.833 hours/ns, 23.310 timesteps/s, 8.648 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 129.86     | 179.54     | 192.45     | 141.7 | 83.70
Bond    | 0.013412   | 0.014381   | 0.014999   |   0.5 |  0.01
Neigh   | 1.4673     | 1.9839     | 2.1305     |  14.1 |  0.92
Comm    | 1.3825     | 14.309     | 63.93      | 501.5 |  6.67
Output  | 0.014601   | 0.035725   | 0.080141   |  12.1 |  0.02
Modify  | 18.362     | 18.488     | 19.031     |   4.8 |  8.62
Other   |            | 0.1284     |            |       |  0.06

Nlocal:         46.375 ave          53 max          36 min
Histogram: 1 0 1 0 1 0 0 2 2 1
Nghost:           3456 ave        3561 max        3380 min
Histogram: 2 1 0 1 1 0 2 0 0 1
Neighs:        29246.6 ave       33116 max       23074 min
Histogram: 1 0 1 1 0 0 0 1 3 1

Total # of neighbors = 233973
Ave neighs/atom = 630.65499
Ave special neighs/atom = 0
Neighbor list builds = 72
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.128149 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.128149 yz delta 0.002054 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform2.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.95965     -38178.066     -9456.7955      4137.7834    
       200   316.34285     -38170.063     -13106.521      4138.6108    
       300   310.78302     -38154.48       2871.7865      4139.4382    
       400   300.84074     -38169.678     -1832.1462      4140.2656    
       500   316.92193     -38196.471     -8098.5173      4141.0929    
       600   295.15143     -38183.177      6982.7852      4141.9203    
       700   286.70427     -38180.485     -19890.985      4142.7477    
       800   292.77005     -38178.321     -11907.199      4143.5751    
       900   309.72141     -38163.132     -3909.8443      4144.4025    
      1000   303.20463     -38162.493      4722.5697      4145.2299    
      1100   281.81583     -38161.746     -5793.0724      4146.0573    
      1200   290.70413     -38175.052      204.35745      4146.8847    
      1300   305.59865     -38189.731      4083.5217      4147.7121    
      1400   303.29153     -38195.711      5203.2409      4148.5395    
      1500   281.26562     -38173.135      8501.1642      4149.3669    
      1600   315.42453     -38205.318     -6256.8212      4150.1942    
      1700   297.83971     -38183.624     -6754.8043      4151.0216    
      1800   309.90948     -38195.188      5857.5719      4151.849     
      1900   287.34186     -38166.483      9256.7825      4152.6764    
      2000   331.10417     -38177.58       8435.6586      4153.5038    
      2100   312.7591      -38159.857     -9074.9301      4154.3312    
      2200   297.74254     -38172.06      -6841.792       4155.1586    
      2300   291.30989     -38183.091     -7193.6262      4155.986     
      2400   296.90544     -38191.169     -364.68554      4156.8134    
      2500   294.54735     -38178.474     -14626.889      4157.6408    
      2600   318.68448     -38162.659     -9851.5082      4158.4682    
      2700   322.28934     -38169.94       5360.5064      4159.2956    
      2800   313.36034     -38187.278      878.29701      4160.1229    
      2900   298.80565     -38190.805     -16207.96       4160.9503    
      3000   293.76129     -38189.281      11601.088      4161.7777    
      3100   312.58866     -38193.003     -3775.3236      4162.6051    
      3200   310.76171     -38162.214     -4367.0319      4163.4325    
      3300   313.28538     -38153.758     -8303.4985      4164.2599    
      3400   295.23925     -38157.221     -3779.444       4165.0873    
      3500   301.54783     -38194.567     -10117.546      4165.9147    
      3600   294.60612     -38201.012     -12192.83       4166.7421    
      3700   278.21335     -38171.541     -11946.733      4167.5695    
      3800   320.74837     -38191.135     -12077.597      4168.3969    
      3900   324.94865     -38185.056     -16454.068      4169.2242    
      4000   303.61988     -38172.27      -6482.8589      4170.0516    
      4100   269.84397     -38179.91      -11097.779      4170.879     
      4200   277.43586     -38186.358     -12946.607      4171.7064    
      4300   289.09377     -38177.175     -6805.309       4172.5338    
      4400   307.06415     -38174.592     -2449.5291      4173.3612    
      4500   312.88195     -38178.243     -6651.7446      4174.1886    
      4600   281.4831      -38169.126      1737.5862      4175.016     
      4700   285.75559     -38203.488     -6675.4096      4175.8434    
      4800   278.04773     -38187.273     -12823.034      4176.6708    
      4900   303.47047     -38171.865     -21087.62       4177.4982    
      5000   315.43362     -38181.371     -10092.82       4178.3256    
Loop time of 207.947 on 16 procs for 5000 steps with 371 atoms

Performance: 1.039 ns/day, 23.105 hours/ns, 24.045 timesteps/s, 8.921 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 125.45     | 174.82     | 186.07     | 142.4 | 84.07
Bond    | 0.012883   | 0.01418    | 0.015008   |   0.5 |  0.01
Neigh   | 1.3118     | 1.7688     | 1.9075     |  13.3 |  0.85
Comm    | 1.9352     | 13.197     | 62.575     | 518.2 |  6.35
Output  | 0.014942   | 0.036933   | 0.082535   |  12.4 |  0.02
Modify  | 17.804     | 17.933     | 18.394     |   4.2 |  8.62
Other   |            | 0.1757     |            |       |  0.08

Nlocal:         46.375 ave          51 max          40 min
Histogram: 1 0 1 1 0 1 0 1 1 2
Nghost:         3342.5 ave        3396 max        3276 min
Histogram: 1 1 0 0 1 1 2 0 0 2
Neighs:        28684.1 ave       31710 max       24960 min
Histogram: 1 0 1 1 0 1 1 1 1 1

Total # of neighbors = 229473
Ave neighs/atom = 618.52561
Ave special neighs/atom = 0
Neighbor list builds = 66
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 18.6403
variable dlen equal lz-${len0}
variable dlen equal lz-18.6403
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.08851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.004589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.002054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.186403 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform3.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.95934     -38178.063     -9459.142       4136.1286    
       200   316.59663     -38170.17      -12471.193      4135.3012    
       300   311.58326     -38155.535      3441.6479      4134.4738    
       400   302.72191     -38172.165     -1518.7664      4133.6464    
       500   318.11302     -38198.48      -7750.3252      4132.819     
       600   293.94673     -38182.684      7518.8709      4131.9916    
       700   284.35112     -38178.992     -19105.654      4131.1643    
       800   289.66501     -38176.167     -8869.9715      4130.3369    
       900   309.0892      -38163.054     -3117.1221      4129.5095    
      1000   298.62241     -38158.988      6954.884       4128.6821    
      1100   282.00522     -38162.042     -1246.5173      4127.8547    
      1200   295.98117     -38183.813     -8272.8313      4127.0273    
      1300   307.93937     -38195.248     -686.28084      4126.1999    
      1400   304.95965     -38197.536      34.963157      4125.3725    
      1500   287.23551     -38177.845      11338.987      4124.5451    
      1600   302.02273     -38187.809     -11198.308      4123.7177    
      1700   290.08968     -38168.828     -11462.748      4122.8903    
      1800   307.31743     -38158.845     -6879.5557      4122.0629    
      1900   317.69949     -38148.112     -9985.763       4121.2356    
      2000   313.64492     -38165.193      2026.07        4120.4082    
      2100   318.71183     -38196.699     -14473.21       4119.5808    
      2200   297.94594     -38183.714     -5275.5018      4118.7534    
      2300   303.5496      -38186.555     -4732.1168      4117.926     
      2400   305.24456     -38170.533      7606.3069      4117.0986    
      2500   328.40705     -38171.539      6445.935       4116.2712    
      2600   316.73809     -38176.136     -8139.3497      4115.4438    
      2700   298.30891     -38179.63       5517.9619      4114.6164    
      2800   288.10484     -38173.36      -2602.3237      4113.789     
      2900   298.90969     -38190.711     -20326.246      4112.9616    
      3000   290.0604      -38181.197      3571.3156      4112.1343    
      3100   303.22346     -38170.17       12248.998      4111.3069    
      3200   302.69058     -38152.535      5629.259       4110.4795    
      3300   311.20595     -38178.572      727.08685      4109.6521    
      3400   292.04313     -38194.852     -990.30024      4108.8247    
      3500   309.71864     -38211.483      8662.538       4107.9973    
      3600   293.43984     -38183.142      343.61333      4107.1699    
      3700   311.17914     -38194.953      6809.9079      4106.3425    
      3800   288.24848     -38160.926      61.948326      4105.5151    
      3900   324.97014     -38179.976      869.32967      4104.6877    
      4000   308.83651     -38170.529      12628.082      4103.8603    
      4100   299.68255     -38197.686      17332.686      4103.033     
      4200   279.2964      -38180.729      2761.4349      4102.2056    
      4300   314.25514     -38204.748      1008.7839      4101.3782    
      4400   296.81559     -38171.992      13143.559      4100.5508    
      4500   329.87708     -38185.142      406.98597      4099.7234    
      4600   306.43368     -38142.864     -5501.9276      4098.896     
      4700   313.64678     -38169.202     -7944.6844      4098.0686    
      4800   295.98512     -38183.393     -9310.2464      4097.2412    
      4900   273.36702     -38171.844      594.79801      4096.4138    
      5000   284.39449     -38180.843      847.52522      4095.5864    
Loop time of 213.996 on 16 procs for 5000 steps with 371 atoms

Performance: 1.009 ns/day, 23.777 hours/ns, 23.365 timesteps/s, 8.668 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 141.32     | 179.01     | 191.69     | 112.9 | 83.65
Bond    | 0.013435   | 0.014206   | 0.014753   |   0.4 |  0.01
Neigh   | 1.5747     | 1.9498     | 2.0902     |  11.0 |  0.91
Comm    | 1.7679     | 14.436     | 52.078     | 396.9 |  6.75
Output  | 0.015463   | 0.038657   | 0.086313   |  12.7 |  0.02
Modify  | 18.28      | 18.41      | 18.803     |   3.7 |  8.60
Other   |            | 0.1314     |            |       |  0.06

Nlocal:         46.375 ave          52 max          39 min
Histogram: 2 0 0 1 0 0 1 1 2 1
Nghost:           3429 ave        3505 max        3367 min
Histogram: 2 0 1 0 0 2 2 0 0 1
Neighs:        29273.6 ave       32426 max       24737 min
Histogram: 1 1 0 1 0 0 1 1 2 1

Total # of neighbors = 234189
Ave neighs/atom = 631.2372
Ave special neighs/atom = 0
Neighbor list builds = 71
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.186403 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform3.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.94583     -38178.078     -9450.5121      4137.7834    
       200   315.89941     -38169.57      -13097.625      4138.6108    
       300   311.75463     -38155.242      2748.092       4139.4382    
       400   302.31003     -38170.192     -1930.6058      4140.2656    
       500   318.06821     -38196.752     -7216.457       4141.0929    
       600   293.84887     -38181.484      7033.4593      4141.9203    
       700   284.89406     -38179.612     -19870.946      4142.7477    
       800   290.70367     -38177.579     -12012.104      4143.5751    
       900   312.39795     -38166.497     -5009.4494      4144.4025    
      1000   303.50014     -38164.221      1049.5468      4145.2299    
      1100   278.12592     -38158.876     -7211.1063      4146.0573    
      1200   286.01299     -38170.496      846.43134      4146.8847    
      1300   313.48166     -38195.15       8120.9654      4147.7121    
      1400   309.40252     -38198.185     -5043.0547      4148.5395    
      1500   287.90573     -38177.509      5543.4342      4149.3669    
      1600   317.85295     -38206.204     -8256.626       4150.1942    
      1700   290.40553     -38176.588     -13132.225      4151.0216    
      1800   302.45295     -38195.117     -3848.8953      4151.849     
      1900   294.20155     -38187.658      8812.453       4152.6764    
      2000   311.68534     -38197.197      9834.9313      4153.5038    
      2100   307.35155     -38186.313     -8143.4617      4154.3312    
      2200   313.59332     -38183.783     -6043.2991      4155.1586    
      2300   303.43554     -38159.812      4502.1513      4155.986     
      2400   305.71612     -38161.983     -2916.5799      4156.8134    
      2500   313.00768     -38193.792      1063.253       4157.6408    
      2600   275.7564      -38173.74      -9950.2905      4158.4682    
      2700   307.69776     -38207.72      -9608.7015      4159.2956    
      2800   307.961       -38190.424     -4140.7313      4160.1229    
      2900   309.2983      -38153.938      43.898907      4160.9503    
      3000   313.36293     -38166.006     -4532.6959      4161.7777    
      3100   299.23018     -38171.476     -8067.0612      4162.6051    
      3200   315.80248     -38198.585     -2190.8389      4163.4325    
      3300   311.94717     -38197.515      2701.3738      4164.2599    
      3400   311.41213     -38201.536     -8597.1408      4165.0873    
      3500   310.82286     -38201.833      2264.1356      4165.9147    
      3600   297.40157     -38182.338     -717.00312      4166.7421    
      3700   302.1957      -38180.993     -9474.9947      4167.5695    
      3800   298.99487     -38166.196     -1409.072       4168.3969    
      3900   309.5038      -38168.515      6765.1939      4169.2242    
      4000   293.30247     -38175.094     -268.84438      4170.0516    
      4100   294.72189     -38201.382     -439.27729      4170.879     
      4200   304.19529     -38204.089     -17011.496      4171.7064    
      4300   300.21566     -38179.087     -987.95975      4172.5338    
      4400   304.34382     -38171.987     -7522.404       4173.3612    
      4500   287.63455     -38154.727     -8010.2111      4174.1886    
      4600   289.14303     -38166.762     -7556.1374      4175.016     
      4700   291.37057     -38173.947      6152.3369      4175.8434    
      4800   314.9141      -38193.39      -10746.752      4176.6708    
      4900   329.05799     -38182.149     -14600.77       4177.4982    
      5000   299.18854     -38146.233     -1476.4644      4178.3256    
Loop time of 211.406 on 16 procs for 5000 steps with 371 atoms

Performance: 1.022 ns/day, 23.490 hours/ns, 23.651 timesteps/s, 8.775 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 139.26     | 176.91     | 188.98     | 111.7 | 83.68
Bond    | 0.013681   | 0.01414    | 0.014906   |   0.3 |  0.01
Neigh   | 1.4044     | 1.7972     | 1.9318     |  11.8 |  0.85
Comm    | 2.0023     | 14.062     | 51.747     | 396.7 |  6.65
Output  | 0.016135   | 0.044072   | 0.1026     |  14.4 |  0.02
Modify  | 18.317     | 18.444     | 18.845     |   3.7 |  8.72
Other   |            | 0.1314     |            |       |  0.06

Nlocal:         46.375 ave          53 max          39 min
Histogram: 1 0 3 0 0 0 0 1 1 2
Nghost:        3391.62 ave        3447 max        3329 min
Histogram: 1 1 2 0 0 0 0 1 1 2
Neighs:        28677.2 ave       32464 max       24478 min
Histogram: 1 2 1 0 0 0 0 0 2 2

Total # of neighbors = 229418
Ave neighs/atom = 618.37736
Ave special neighs/atom = 0
Neighbor list builds = 66
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 17.3186
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.2054)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3186
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.08851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.004589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.002054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.173186 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform4.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.94832     -38178.053     -9450.4113      4136.956     
       200   316.36965     -38170.19      -12779.598      4136.956     
       300   311.7435      -38155.586      3012.2271      4136.956     
       400   302.31185     -38171.121     -1597.8427      4136.956     
       500   317.64956     -38197.214     -7333.0313      4136.956     
       600   294.10712     -38182.33       7763.2636      4136.956     
       700   285.69457     -38180.87      -19104.532      4136.956     
       800   290.29952     -38177.306     -10350.733      4136.956     
       900   310.44028     -38164.774     -5335.0592      4136.956     
      1000   297.56224     -38157.771      3602.2668      4136.956     
      1100   284.86721     -38165.123     -4820.006       4136.956     
      1200   294.48602     -38179.692     -1109.8136      4136.956     
      1300   301.52574     -38183.32       3302.2424      4136.956     
      1400   308.90134     -38199.294     -2551.3879      4136.956     
      1500   283.20857     -38172.607      10548.436      4136.956     
      1600   299.28918     -38185.109     -13165.701      4136.956     
      1700   295.83396     -38169.508     -11436.282      4136.956     
      1800   303.44484     -38153.884     -9357.1834      4136.956     
      1900   328.92399     -38163.025     -2193.4526      4136.956     
      2000   319.56219     -38173.791      7141.9002      4136.956     
      2100   287.64003     -38175.297     -6074.4429      4136.956     
      2200   303.23112     -38194.256     -12566.285      4136.956     
      2300   280.67255     -38167.634      3075.1739      4136.956     
      2400   303.37725     -38183.825     -1410.8752      4136.956     
      2500   319.59894     -38179.188     -10585.423      4136.956     
      2600   304.8308      -38158.051     -7743.2598      4136.956     
      2700   302.7635      -38194.064     -9640.5653      4136.956     
      2800   291.81317     -38194.223      3770.2248      4136.956     
      2900   301.06741     -38198.531      2182.5734      4136.956     
      3000   306.46871     -38182.789     -2764.2674      4136.956     
      3100   293.13399     -38147.881     -9784.4764      4136.956     
      3200   324.21438     -38156.645      298.20877      4136.956     
      3300   324.04738     -38164.243     -4536.1527      4136.956     
      3400   309.76673     -38184.163     -3170.6624      4136.956     
      3500   302.19017     -38194.53      -1126.9853      4136.956     
      3600   289.01237     -38191.078      2958.013       4136.956     
      3700   293.50314     -38192.463     -6322.861       4136.956     
      3800   308.80134     -38179.857      2676.3458      4136.956     
      3900   323.68347     -38175.755      2258.1444      4136.956     
      4000   312.46916     -38175.601     -1510.6434      4136.956     
      4100   309.5984      -38194.209      320.27725      4136.956     
      4200   295.67838     -38188.952      3297.8331      4136.956     
      4300   308.32624     -38202.034      7391.1775      4136.956     
      4400   287.18667     -38173.129     -5754.9676      4136.956     
      4500   307.88616     -38181.738     -259.3777       4136.956     
      4600   323.16624     -38174.693     -7189.9102      4136.956     
      4700   300.98656     -38170.098     -2757.4456      4136.956     
      4800   285.2563      -38183.236      6807.937       4136.956     
      4900   286.25652     -38179.943      3837.3687      4136.956     
      5000   310.52513     -38186.106     -9641.6232      4136.956     
Loop time of 212.173 on 16 procs for 5000 steps with 371 atoms

Performance: 1.018 ns/day, 23.575 hours/ns, 23.566 timesteps/s, 8.743 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 127.96     | 177.94     | 190.08     | 143.1 | 83.86
Bond    | 0.013519   | 0.014111   | 0.014674   |   0.4 |  0.01
Neigh   | 1.356      | 1.9098     | 2.0499     |  15.4 |  0.90
Comm    | 1.9113     | 14.048     | 64.024     | 509.2 |  6.62
Output  | 0.016012   | 0.043444   | 0.10085    |  14.3 |  0.02
Modify  | 17.956     | 18.09      | 18.65      |   5.0 |  8.53
Other   |            | 0.1304     |            |       |  0.06

Nlocal:         46.375 ave          53 max          37 min
Histogram: 1 0 0 2 0 1 0 1 2 1
Nghost:        3417.62 ave        3518 max        3332 min
Histogram: 2 1 0 1 0 0 1 2 0 1
Neighs:        28955.8 ave       32647 max       23515 min
Histogram: 1 0 0 1 2 0 0 1 2 1

Total # of neighbors = 231646
Ave neighs/atom = 624.38275
Ave special neighs/atom = 0
Neighbor list builds = 70
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3186
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.173186 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform4.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.95663     -38178.087     -9459.0944      4136.956     
       200   316.0881      -38169.802     -12802.948      4136.956     
       300   311.58375     -38155.377      3123.4963      4136.956     
       400   302.62499     -38171.204     -1813.9583      4136.956     
       500   317.94651     -38197.543     -7427.2765      4136.956     
       600   294.28167     -38182.536      7377.9375      4136.956     
       700   285.168       -38179.465     -19821.25       4136.956     
       800   290.17328     -38174.726     -11397.638      4136.956     
       900   310.92223     -38162.945     -6212.617       4136.956     
      1000   297.60257     -38158.282      4894.5433      4136.956     
      1100   284.10642     -38164.171     -3940.7837      4136.956     
      1200   293.9211      -38179.204      1213.0202      4136.956     
      1300   304.10283     -38186.622      2022.1189      4136.956     
      1400   308.58936     -38200.57      -6457.1115      4136.956     
      1500   273.04708     -38182.467     -623.46751      4136.956     
      1600   278.33341     -38219.124     -14025.61       4136.956     
      1700   278.83757     -38201.416      4844.3339      4136.956     
      1800   293.37579     -38187.419     -2510.727       4136.956     
      1900   305.13266     -38179.04      -561.181        4136.956     
      2000   318.86647     -38183.973      7038.6239      4136.956     
      2100   304.01618     -38186.701     -10451.835      4136.956     
      2200   284.40507     -38189.538     -10659.348      4136.956     
      2300   287.88258     -38196.001      4125.2588      4136.956     
      2400   291.11705     -38175.48       1991.1755      4136.956     
      2500   311.05226     -38167.428     -5445.2452      4136.956     
      2600   298.69838     -38169.588     -14580.053      4136.956     
      2700   283.42583     -38170.325     -6769.7366      4136.956     
      2800   301.83378     -38195.135     -4259.6263      4136.956     
      2900   306.5815      -38199.925     -8695.6811      4136.956     
      3000   301.42857     -38179.8       -11789.53       4136.956     
      3100   318.41957     -38184.422     -782.64217      4136.956     
      3200   321.6525      -38177.822      5346.1605      4136.956     
      3300   301.55314     -38179.118     -7943.1099      4136.956     
      3400   283.44222     -38185.906     -12.865144      4136.956     
      3500   308.08447     -38205.916     -11517.404      4136.956     
      3600   299.6722      -38189.302     -6518.0811      4136.956     
      3700   275.80631     -38161.163      5500.9237      4136.956     
      3800   306.0248      -38169.962     -3035.9156      4136.956     
      3900   316.0463      -38163.539      770.42513      4136.956     
      4000   299.38137     -38169.701     -90.172837      4136.956     
      4100   284.40523     -38176.676      1711.5054      4136.956     
      4200   300.39638     -38188.628      5320.1491      4136.956     
      4300   315.459       -38189.158     -146.51957      4136.956     
      4400   317.94418     -38170.824     -11062.879      4136.956     
      4500   321.40614     -38159.846     -10095.865      4136.956     
      4600   312.41335     -38173.011     -4514.354       4136.956     
      4700   299.44821     -38187.829      9405.2675      4136.956     
      4800   294.31227     -38192.73       2439.0664      4136.956     
      4900   299.9151      -38192.786     -2844.5302      4136.956     
      5000   317.67732     -38180.627      2506.3132      4136.956     
Loop time of 209.522 on 16 procs for 5000 steps with 371 atoms

Performance: 1.031 ns/day, 23.280 hours/ns, 23.864 timesteps/s, 8.853 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 126.75     | 176.25     | 187.37     | 142.3 | 84.12
Bond    | 0.013229   | 0.014228   | 0.014951   |   0.5 |  0.01
Neigh   | 1.3027     | 1.8514     | 2.0019     |  15.5 |  0.88
Comm    | 2.3789     | 13.519     | 63.028     | 513.8 |  6.45
Output  | 0.016167   | 0.04512    | 0.10519    |  14.8 |  0.02
Modify  | 17.497     | 17.651     | 18.209     |   5.1 |  8.42
Other   |            | 0.193      |            |       |  0.09

Nlocal:         46.375 ave          50 max          40 min
Histogram: 1 1 0 0 1 0 0 0 1 4
Nghost:        3399.25 ave        3446 max        3337 min
Histogram: 1 1 1 0 1 0 0 0 2 2
Neighs:        28952.9 ave       31304 max       25238 min
Histogram: 2 0 0 1 0 0 0 1 1 3

Total # of neighbors = 231623
Ave neighs/atom = 624.32075
Ave special neighs/atom = 0
Neighbor list builds = 68
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.8149
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.4589)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.8149
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.08851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.004589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.002054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.128149 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform5.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.95925     -38178.066     -9453.6755      4136.956     
       200   316.27382     -38169.971     -12812.183      4136.956     
       300   311.67686     -38155.565      3131.2085      4136.956     
       400   302.58299     -38171.182     -1649.013       4136.956     
       500   317.95413     -38197.522     -7107.9115      4136.956     
       600   293.96343     -38182.082      7867.7569      4136.956     
       700   284.48838     -38179.722     -19043.985      4136.956     
       800   290.4385      -38176.275     -10862.846      4136.956     
       900   309.93538     -38163.074     -5561.1519      4136.956     
      1000   297.51259     -38158.894      6190.7586      4136.956     
      1100   280.02011     -38159.934     -6421.0593      4136.956     
      1200   294.42197     -38178.709     -532.93611      4136.956     
      1300   300.14177     -38182.09       4731.8169      4136.956     
      1400   306.78095     -38196.327     -2217.9792      4136.956     
      1500   283.18421     -38172.355      7227.7684      4136.956     
      1600   307.51847     -38188.589     -17407.31       4136.956     
      1700   295.37568     -38171.898     -9073.392       4136.956     
      1800   299.50326     -38186.638     -9015.6359      4136.956     
      1900   291.75405     -38198.344     -584.14506      4136.956     
      2000   307.07861     -38212.152      14434.944      4136.956     
      2100   296.90344     -38170.793     -9655.396       4136.956     
      2200   300.42491     -38168.504     -10477.629      4136.956     
      2300   303.17473     -38178.564      1798.1445      4136.956     
      2400   288.91592     -38168.713     -2971.9291      4136.956     
      2500   297.24381     -38179.739     -2772.4814      4136.956     
      2600   298.90172     -38181.839     -15252.071      4136.956     
      2700   290.72262     -38178.027      5272.4045      4136.956     
      2800   287.47387     -38157.969      13533.073      4136.956     
      2900   303.69967     -38148.395     -13542.747      4136.956     
      3000   323.99816     -38175.816     -5322.9005      4136.956     
      3100   297.28474     -38185.87      -8628.6438      4136.956     
      3200   296.93528     -38191.312      5641.9391      4136.956     
      3300   291.6598      -38181.127     -5152.7658      4136.956     
      3400   303.14811     -38178.584     -1004.2305      4136.956     
      3500   327.99432     -38177.954     -4979.1722      4136.956     
      3600   321.32768     -38176.747     -7183.1068      4136.956     
      3700   291.18806     -38167.205      9295.3015      4136.956     
      3800   295.80522     -38174.368     -1288.9444      4136.956     
      3900   301.20026     -38180.02      -2533.8085      4136.956     
      4000   294.94405     -38187.021     -11485.383      4136.956     
      4100   280.76346     -38195.869     -6938.4577      4136.956     
      4200   283.66081     -38202.755      4996.4783      4136.956     
      4300   300.11068     -38178.487      8096.3354      4136.956     
      4400   309.70894     -38180.698     -10871.005      4136.956     
      4500   304.75582     -38186.311      3180.9852      4136.956     
      4600   301.87572     -38202.377     -7374.3443      4136.956     
      4700   289.2108      -38188.762     -1484.637       4136.956     
      4800   318.40823     -38190.212     -5670.1421      4136.956     
      4900   320.52313     -38171.298      7059.8092      4136.956     
      5000   314.42773     -38176.417     -3926.8515      4136.956     
Loop time of 211.726 on 16 procs for 5000 steps with 371 atoms

Performance: 1.020 ns/day, 23.525 hours/ns, 23.615 timesteps/s, 8.761 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 128.96     | 173.52     | 190.09     | 156.2 | 81.96
Bond    | 0.013634   | 0.014152   | 0.014853   |   0.4 |  0.01
Neigh   | 1.238      | 1.7281     | 1.8982     |  17.1 |  0.82
Comm    | 1.652      | 18.205     | 62.765     | 482.2 |  8.60
Output  | 0.015881   | 0.043754   | 0.10222    |  14.5 |  0.02
Modify  | 17.915     | 18.082     | 18.581     |   5.4 |  8.54
Other   |            | 0.1283     |            |       |  0.06

Nlocal:         46.375 ave          52 max          38 min
Histogram: 1 0 1 0 1 1 1 0 1 2
Nghost:           3387 ave        3453 max        3324 min
Histogram: 1 1 1 0 1 2 0 0 1 1
Neighs:        28959.5 ave       32169 max       24082 min
Histogram: 1 0 1 0 1 1 1 0 1 2

Total # of neighbors = 231676
Ave neighs/atom = 624.46361
Ave special neighs/atom = 0
Neighbor list builds = 65
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.128149 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform5.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.94558     -38178.074     -9455.8589      4136.956     
       200   316.22561     -38169.881     -12810.475      4136.956     
       300   311.73056     -38155.397      3020.9337      4136.956     
       400   302.57981     -38171.18      -1944.6786      4136.956     
       500   318.61054     -38197.865     -7822.3809      4136.956     
       600   294.38295     -38182.308      7481.5879      4136.956     
       700   285.49357     -38180.226     -19766.372      4136.956     
       800   289.53685     -38176.276     -11241.624      4136.956     
       900   312.24572     -38166.158     -6074.4638      4136.956     
      1000   298.05772     -38158.536      4012.1033      4136.956     
      1100   283.18092     -38163.01      -3639.3259      4136.956     
      1200   293.47714     -38177.994     -85.889941      4136.956     
      1300   301.84894     -38183.694      5327.7538      4136.956     
      1400   305.36763     -38199.014     -2368.6181      4136.956     
      1500   281.78348     -38179.021      1748.1975      4136.956     
      1600   321.69996     -38188.372     -11688.01       4136.956     
      1700   303.1948      -38150.74      -8968.3037      4136.956     
      1800   293.71155     -38157.662     -6126.2529      4136.956     
      1900   292.05472     -38177.742      875.20107      4136.956     
      2000   304.85016     -38198.451      2950.04        4136.956     
      2100   295.98597     -38199.46      -8653.8055      4136.956     
      2200   292.64701     -38209.277     -13393.951      4136.956     
      2300   297.28419     -38202.495      1384.5505      4136.956     
      2400   320.28588     -38193.647     -1818.7288      4136.956     
      2500   324.08436     -38192.081     -8975.7252      4136.956     
      2600   285.40028     -38165.813     -5145.9901      4136.956     
      2700   296.7756      -38199.793     -7872.8338      4136.956     
      2800   290.79276     -38207.912     -6218.7643      4136.956     
      2900   289.8648      -38207.625     -3406.4393      4136.956     
      3000   292.35998     -38181.606     -9284.5323      4136.956     
      3100   297.58455     -38166.096      961.23721      4136.956     
      3200   311.65368     -38169.804      12817.02       4136.956     
      3300   299.59654     -38170.751     -9024.6033      4136.956     
      3400   293.24065     -38194.946     -7188.9956      4136.956     
      3500   305.14678     -38205.209     -4610.8222      4136.956     
      3600   297.15235     -38186.805      8142.9657      4136.956     
      3700   302.57596     -38181.199      5751.2229      4136.956     
      3800   313.88469     -38155.579     -11546.605      4136.956     
      3900   309.40488     -38143.484     -19521.423      4136.956     
      4000   310.32587     -38169.722     -11152.267      4136.956     
      4100   305.11726     -38177.303     -4853.5689      4136.956     
      4200   292.72228     -38177.248      2238.2324      4136.956     
      4300   308.09371     -38197.913     -16000.812      4136.956     
      4400   301.21056     -38177.745     -7642.9782      4136.956     
      4500   315.07847     -38164.788     -6034.3575      4136.956     
      4600   312.30747     -38161.101      864.90641      4136.956     
      4700   304.14195     -38184.195      668.19209      4136.956     
      4800   273.13229     -38163.793     -5737.4085      4136.956     
      4900   291.00108     -38178.423     -19531.966      4136.956     
      5000   313.87473     -38190.915     -19135.563      4136.956     
Loop time of 207.375 on 16 procs for 5000 steps with 371 atoms

Performance: 1.042 ns/day, 23.042 hours/ns, 24.111 timesteps/s, 8.945 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 126.51     | 164.17     | 186.07     | 184.6 | 79.17
Bond    | 0.013373   | 0.014126   | 0.015181   |   0.5 |  0.01
Neigh   | 1.3114     | 1.7652     | 2.0418     |  21.7 |  0.85
Comm    | 1.9217     | 23.838     | 61.512     | 484.4 | 11.50
Output  | 0.016024   | 0.045099   | 0.10533    |  14.8 |  0.02
Modify  | 17.057     | 17.355     | 17.834     |   7.2 |  8.37
Other   |            | 0.1865     |            |       |  0.09

Nlocal:         46.375 ave          50 max          39 min
Histogram: 1 0 1 0 0 0 0 1 3 2
Nghost:        3387.25 ave        3446 max        3322 min
Histogram: 1 1 0 1 0 0 3 1 0 1
Neighs:        28962.2 ave       31168 max       24702 min
Histogram: 1 0 1 0 0 0 0 3 1 2

Total # of neighbors = 231698
Ave neighs/atom = 624.52291
Ave special neighs/atom = 0
Neighbor list builds = 70
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 18.6403
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.851)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.08851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.004589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.002054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.186403 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform6.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.95141     -38178.066     -9457.1586      4136.956     
       200   316.08869     -38169.827     -12455.114      4136.956     
       300   311.77666     -38155.616      2911.1768      4136.956     
       400   302.59308     -38170.662     -1557.0062      4136.956     
       500   318.02276     -38197.233     -7290.2637      4136.956     
       600   294.99593     -38183.265      7585.1012      4136.956     
       700   285.93452     -38181.26      -20018.214      4136.956     
       800   289.31694     -38176.319     -10829.921      4136.956     
       900   306.3101      -38159.926     -5177.2007      4136.956     
      1000   299.85147     -38159.36       3962.3765      4136.956     
      1100   281.74352     -38161.323     -6457.3333      4136.956     
      1200   288.62014     -38174.125      2968.7671      4136.956     
      1300   310.93201     -38198.17       2500.091       4136.956     
      1400   306.18489     -38200.391     -3162.1105      4136.956     
      1500   284.62042     -38175.408      13285.572      4136.956     
      1600   309.328       -38196.723     -2684.3313      4136.956     
      1700   302.10795     -38177.939     -6529.3245      4136.956     
      1800   323.15367     -38182.59       6559.1557      4136.956     
      1900   312.37396     -38159.387      1793.3902      4136.956     
      2000   318.99806     -38177.346      5476.0522      4136.956     
      2100   298.7036      -38192.871     -10749.369      4136.956     
      2200   278.88752     -38177.411     -16669.552      4136.956     
      2300   300.30578     -38183.219      15096.231      4136.956     
      2400   321.93973     -38187.616      9267.8004      4136.956     
      2500   286.84632     -38159.878      10445.766      4136.956     
      2600   279.94366     -38194.648      5678.6993      4136.956     
      2700   288.04701     -38206.886     -4161.2971      4136.956     
      2800   303.09644     -38203.192     -6840.6351      4136.956     
      2900   291.94019     -38171.36      -10297.715      4136.956     
      3000   286.57699     -38160.373     -5390.5587      4136.956     
      3100   300.06282     -38174.193     -6192.6078      4136.956     
      3200   295.4409      -38170.897     -11471.064      4136.956     
      3300   290.28586     -38179.735     -10301.623      4136.956     
      3400   305.27512     -38211.529     -8383.0053      4136.956     
      3500   284.77842     -38190.472     -5314.6618      4136.956     
      3600   287.23304     -38167.343     -408.1148       4136.956     
      3700   305.69297     -38167.027     -6663.0907      4136.956     
      3800   302.4923      -38167.887     -10638.631      4136.956     
      3900   305.73957     -38185.766     -10235.533      4136.956     
      4000   303.08638     -38217.374      9929.0479      4136.956     
      4100   276.29499     -38187.214     -387.47062      4136.956     
      4200   287.25138     -38176.382      5537.7679      4136.956     
      4300   310.34885     -38181.378     -9433.5077      4136.956     
      4400   311.83288     -38182.921     -11255.406      4136.956     
      4500   290.20058     -38185.34      -10309.049      4136.956     
      4600   285.25811     -38197.022      2691.9551      4136.956     
      4700   292.35081     -38195.439     -9945.335       4136.956     
      4800   279.41662     -38171.684      9611.4711      4136.956     
      4900   305.11491     -38191.719     -11501.96       4136.956     
      5000   297.73687     -38177.018      14729.087      4136.956     
Loop time of 203.168 on 16 procs for 5000 steps with 371 atoms

Performance: 1.063 ns/day, 22.574 hours/ns, 24.610 timesteps/s, 9.130 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 126.04     | 148.95     | 181.43     | 154.5 | 73.31
Bond    | 0.012683   | 0.013298   | 0.014175   |   0.4 |  0.01
Neigh   | 1.3136     | 1.5653     | 1.936      |  17.6 |  0.77
Comm    | 2.8169     | 35.318     | 58.251     | 317.5 | 17.38
Output  | 0.014854   | 0.038471   | 0.087986   |  13.1 |  0.02
Modify  | 16.789     | 17.163     | 17.426     |   5.5 |  8.45
Other   |            | 0.1196     |            |       |  0.06

Nlocal:         46.375 ave          52 max          38 min
Histogram: 1 0 1 0 1 0 1 2 1 1
Nghost:        3437.12 ave        3522 max        3370 min
Histogram: 2 1 0 0 1 1 1 1 0 1
Neighs:        28937.4 ave       32115 max       24077 min
Histogram: 1 0 1 0 1 0 1 0 3 1

Total # of neighbors = 231499
Ave neighs/atom = 623.98652
Ave special neighs/atom = 0
Neighbor list builds = 67
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.186403 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform6.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34456     -38178.952      3018.8818      4136.956     
       100   297.95911     -38178.075     -9456.416       4136.956     
       200   316.45114     -38170.034     -13151.93       4136.956     
       300   311.71767     -38155.338      3269.4503      4136.956     
       400   302.24975     -38171.691     -1889.4656      4136.956     
       500   317.67566     -38197.86      -7840.4756      4136.956     
       600   292.75894     -38180.853      8276.3145      4136.956     
       700   284.57236     -38178.285     -18935.449      4136.956     
       800   293.69025     -38178.371     -13137.328      4136.956     
       900   314.07049     -38167.253     -4912.3489      4136.956     
      1000   297.13512     -38157.439      8180.4956      4136.956     
      1100   273.93684     -38152.925     -9321.2298      4136.956     
      1200   288.79232     -38172.514     -2764.1189      4136.956     
      1300   307.82441     -38189.476     -1404.1783      4136.956     
      1400   301.43463     -38191.149     -3864.7692      4136.956     
      1500   281.98409     -38169.647     -2099.2585      4136.956     
      1600   326.60772     -38213.582     -5667.6104      4136.956     
      1700   290.57728     -38185.294     -6277.7011      4136.956     
      1800   283.17432     -38212.795     -4940.1259      4136.956     
      1900   280.68481     -38212.006     -5055.7023      4136.956     
      2000   282.55027     -38184.201      16597.722      4136.956     
      2100   294.46664     -38182.418     -5263.9626      4136.956     
      2200   288.96898     -38165.813     -23565.069      4136.956     
      2300   297.96885     -38172.758     -10726.045      4136.956     
      2400   278.56352     -38168.349      370.44931      4136.956     
      2500   277.61221     -38193.193     -9913.1914      4136.956     
      2600   276.30251     -38192.61      -6191.5819      4136.956     
      2700   292.20796     -38173.8        619.31604      4136.956     
      2800   323.62683     -38193.735     -5016.9958      4136.956     
      2900   312.34822     -38187.282     -10994.608      4136.956     
      3000   290.79507     -38182.103     -12933.839      4136.956     
      3100   282.26436     -38192.609     -9752.9424      4136.956     
      3200   304.49064     -38210.891     -7214.1439      4136.956     
      3300   286.25711     -38147.685     -7138.4033      4136.956     
      3400   302.86748     -38162.782     -7073.0697      4136.956     
      3500   303.8002      -38177.997      4755.2623      4136.956     
      3600   290.97068     -38190.398      14085.727      4136.956     
      3700   290.83456     -38190.506     -9523.9228      4136.956     
      3800   304.87149     -38195.898     -3164.1315      4136.956     
      3900   279.24334     -38160.724     -6910.6802      4136.956     
      4000   320.74479     -38198.012     -9182.2624      4136.956     
      4100   299.15816     -38180.548     -5406.8215      4136.956     
      4200   288.38097     -38188.998     -7.9381933      4136.956     
      4300   270.56437     -38193.627      692.1196       4136.956     
      4400   279.98897     -38194.348     -687.05862      4136.956     
      4500   305.43309     -38185.944      4003.9475      4136.956     
      4600   288.22816     -38157.713     -8439.8076      4136.956     
      4700   311.92516     -38177.727     -7981.3143      4136.956     
      4800   299.96605     -38180.141     -3661.1929      4136.956     
      4900   286.21152     -38199.039      12007.514      4136.956     
      5000   262.47787     -38174.04      -5789.3747      4136.956     
Loop time of 143.886 on 16 procs for 5000 steps with 371 atoms

Performance: 1.501 ns/day, 15.987 hours/ns, 34.750 timesteps/s, 12.892 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 117.71     | 122.21     | 127.63     |  26.6 | 84.93
Bond    | 0.011991   | 0.012734   | 0.013823   |   0.5 |  0.01
Neigh   | 1.2424     | 1.2797     | 1.3369     |   3.0 |  0.89
Comm    | 1.0515     | 6.4837     | 10.983     | 115.6 |  4.51
Output  | 0.013714   | 0.035159   | 0.079814   |  12.4 |  0.02
Modify  | 13.639     | 13.697     | 13.728     |   0.8 |  9.52
Other   |            | 0.1692     |            |       |  0.12

Nlocal:         46.375 ave          52 max          40 min
Histogram: 2 0 0 0 1 1 1 1 1 1
Nghost:        3387.88 ave        3430 max        3341 min
Histogram: 1 1 1 0 1 0 0 1 2 1
Neighs:        28968.9 ave       32373 max       25131 min
Histogram: 2 0 0 0 1 1 1 1 1 1

Total # of neighbors = 231751
Ave neighs/atom = 624.66577
Ave special neighs/atom = 0
Neighbor list builds = 64
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:41:00
