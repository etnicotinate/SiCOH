LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

variable FF string "CHONSi.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333U-50C-26-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333U-50C-26-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -6.56 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.1 | 115.9 | 116.7 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -38406.192      0             -38406.192      62615.506    
       100   0             -41289.644      0             -41289.644     -7749.2784    
Loop time of 12.1621 on 16 procs for 100 steps with 365 atoms

97.6% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
      -38406.192225012  -41289.0616880479  -41289.6438358594
  Force two-norm initial, final = 2026.4839 95.533632
  Force max component initial, final = 281.91524 29.561557
  Final line search alpha, max atom move = 8.2535435e-05 0.002439876
  Iterations, force evaluations = 100 352

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.4895     | 8.1906     | 9.5356     |  43.6 | 67.35
Bond    | 8.6934e-05 | 0.00014401 | 0.00018976 |   0.0 |  0.00
Neigh   | 0.03702    | 0.042448   | 0.051263   |   2.3 |  0.35
Comm    | 0.3211     | 1.6661     | 3.3687     |  96.7 | 13.70
Output  | 7.2041e-05 | 7.8991e-05 | 0.00011454 |   0.0 |  0.00
Modify  | 2.2382     | 2.2466     | 2.2518     |   0.3 | 18.47
Other   |            | 0.01612    |            |       |  0.13

Nlocal:         45.625 ave          54 max          38 min
Histogram: 1 2 0 1 0 1 0 1 1 1
Nghost:        2880.38 ave        2899 max        2864 min
Histogram: 1 1 1 0 0 2 2 0 0 1
Neighs:        25049.5 ave       29317 max       21228 min
Histogram: 1 2 1 0 0 1 0 1 1 1

Total # of neighbors = 200396
Ave neighs/atom = 549.03014
Ave special neighs/atom = 0
Neighbor list builds = 2
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-26-vasp_opt.data
System init for write_data ...
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 113.5 | 114.3 | 115 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -41289.644     -4521.1024      1.4343051      4609.3376    
       100   348.38411     -41306.552     -13132.88       1.4343051      4609.3376    
       200   454.326       -41501.858     -419.41833      1.4343051      4609.3376    
       300   459.94771     -41687.49      -19023.558      1.4343051      4609.3376    
       400   384.1229      -41781.154     -19879.192      1.4343051      4609.3376    
       500   365.63138     -41851.306     -2156.0447      1.4343051      4609.3376    
       600   333.34742     -41920.326     -6864.8595      1.4343051      4609.3376    
       700   343.63851     -42035.297     -3468.8537      1.4343051      4609.3376    
       800   313.19393     -42080.801     -9692.2963      1.4343051      4609.3376    
       900   302.7182      -42128.541      3782.3915      1.4343051      4609.3376    
      1000   283.90773     -42151.656     -10008.359      1.4343051      4609.3376    
      1100   290.65887     -42168.736     -7793.5863      1.4343051      4609.3376    
      1200   302.58998     -42159.429     -13514.898      1.4343051      4609.3376    
      1300   308.39883     -42122.313     -14172.623      1.4343051      4609.3376    
      1400   305.64948     -42092.957     -9284.6321      1.4343051      4609.3376    
      1500   305.85986     -42104.372     -12018.152      1.4343051      4609.3376    
      1600   323.95253     -42176.27      -315.97436      1.4343051      4609.3376    
      1700   288.56658     -42169.351     -6949.0911      1.4343051      4609.3376    
      1800   304.75338     -42190.824     -18348.615      1.4343051      4609.3376    
      1900   275.43661     -42152.844     -11176.228      1.4343051      4609.3376    
      2000   301.55355     -42162.746     -6577.0771      1.4343051      4609.3376    
      2100   321.80964     -42169.683     -15507.906      1.4343051      4609.3376    
      2200   325.00839     -42181.882     -14055.817      1.4343051      4609.3376    
      2300   301.2941      -42186.551     -3214.5031      1.4343051      4609.3376    
      2400   279.87496     -42187.236     -10364.493      1.4343051      4609.3376    
      2500   302.21059     -42204.662     -15718.66       1.4343051      4609.3376    
      2600   319.22383     -42200.985     -9001.4301      1.4343051      4609.3376    
      2700   300.10825     -42189.123     -16219.873      1.4343051      4609.3376    
      2800   292.61813     -42202.375     -16969.874      1.4343051      4609.3376    
      2900   284.34838     -42212.928     -17326.696      1.4343051      4609.3376    
      3000   299.497       -42236.221     -7213.6137      1.4343051      4609.3376    
      3100   298.23407     -42211.396     -9298.7644      1.4343051      4609.3376    
      3200   320.33729     -42207.77      -9581.654       1.4343051      4609.3376    
      3300   303.97076     -42194.49      -1430.3522      1.4343051      4609.3376    
      3400   308.37935     -42216.445     -5097.2823      1.4343051      4609.3376    
      3500   304.25507     -42222.854     -18450.5        1.4343051      4609.3376    
      3600   297.98319     -42219.566     -13844.835      1.4343051      4609.3376    
      3700   299.09551     -42228.793     -5999.9628      1.4343051      4609.3376    
      3800   278.0347      -42235.007     -7716.2076      1.4343051      4609.3376    
      3900   275.61641     -42245.805     -13852.045      1.4343051      4609.3376    
      4000   287.54645     -42229.48      -21048.22       1.4343051      4609.3376    
      4100   294.89045     -42221.2       -21212.797      1.4343051      4609.3376    
      4200   281.11394     -42202.377     -24078.627      1.4343051      4609.3376    
      4300   286.71924     -42198.779     -14692.23       1.4343051      4609.3376    
      4400   302.89162     -42215.395     -24876.252      1.4343051      4609.3376    
      4500   318.10126     -42257.399     -12696.651      1.4343051      4609.3376    
      4600   286.65676     -42243.077     -14213.956      1.4343051      4609.3376    
      4700   303.93744     -42242.531     -8746.6898      1.4343051      4609.3376    
      4800   311.69667     -42237.761     -5861.3546      1.4343051      4609.3376    
      4900   312.3691      -42229.803     -22842.514      1.4343051      4609.3376    
      5000   303.20468     -42216.46      -7019.8064      1.4343051      4609.3376    
Loop time of 189.317 on 16 procs for 5000 steps with 365 atoms

Performance: 1.141 ns/day, 21.035 hours/ns, 26.411 timesteps/s, 9.640 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.97     | 133.34     | 154.76     | 125.4 | 70.43
Bond    | 0.0013469  | 0.0016329  | 0.0021053  |   0.6 |  0.00
Neigh   | 8.8843     | 11.118     | 12.583     |  34.2 |  5.87
Comm    | 3.5506     | 24.973     | 51.323     | 289.8 | 13.19
Output  | 0.0027028  | 0.0028729  | 0.0039248  |   0.7 |  0.00
Modify  | 18.321     | 19.785     | 22.042     |  25.8 | 10.45
Other   |            | 0.09518    |            |       |  0.05

Nlocal:         45.625 ave          54 max          37 min
Histogram: 2 0 0 0 1 2 1 0 1 1
Nghost:        2867.38 ave        2886 max        2842 min
Histogram: 1 0 1 1 1 0 0 1 0 3
Neighs:        25031.4 ave       29287 max       20558 min
Histogram: 2 0 0 0 1 2 1 1 0 1

Total # of neighbors = 200251
Ave neighs/atom = 548.63288
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-26-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.6144
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.9838
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.4642

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.8795
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 2.088
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -6.9346

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 17.6144
variable dlen equal lx-${len0}
variable dlen equal lx-17.6144
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.6144
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.69346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.2088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.08795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.76144 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.76144 xy delta 0.69346 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.76144 xy delta 0.69346 xz delta -0.2088 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.8 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.48883     -42230.06      -16178.93       4600.1189      17.579171      14.9838        17.4642      
       200   307.95032     -42212.57      -10501.463      4590.9003      17.543942      14.9838        17.4642      
       300   300.93635     -42226.595     -17956.345      4581.6816      17.508714      14.9838        17.4642      
       400   288.36573     -42234.272     -744.93091      4572.4629      17.473485      14.9838        17.4642      
       500   295.20869     -42235.107     -3728.0577      4563.2442      17.438256      14.9838        17.4642      
       600   293.26337     -42210.279     -16022.556      4554.0255      17.403027      14.9838        17.4642      
       700   327.38981     -42216.121     -6798.7791      4544.8069      17.367798      14.9838        17.4642      
       800   321.32868     -42224.79      -6908.2037      4535.5882      17.33257       14.9838        17.4642      
       900   316.33301     -42239.229     -9625.8414      4526.3695      17.297341      14.9838        17.4642      
      1000   302.32257     -42233.751      1948.4308      4517.1508      17.262112      14.9838        17.4642      
      1100   290.4324      -42221.027     -9781.9871      4507.9322      17.226883      14.9838        17.4642      
      1200   292.10997     -42234.49      -8458.3264      4498.7135      17.191654      14.9838        17.4642      
      1300   300.09228     -42254.687     -3844.6114      4489.4948      17.156426      14.9838        17.4642      
      1400   309.92219     -42256.731     -11412.328      4480.2761      17.121197      14.9838        17.4642      
      1500   293.21544     -42247.975     -3855.775       4471.0575      17.085968      14.9838        17.4642      
      1600   299.85158     -42251.448     -17738.064      4461.8388      17.050739      14.9838        17.4642      
      1700   274.76655     -42229.196      458.46442      4452.6201      17.01551       14.9838        17.4642      
      1800   323.7874      -42254.553     -5196.915       4443.4014      16.980282      14.9838        17.4642      
      1900   303.03014     -42259.114     -6344.4555      4434.1828      16.945053      14.9838        17.4642      
      2000   307.3219      -42287.017      579.2029       4424.9641      16.909824      14.9838        17.4642      
      2100   295.24741     -42260.248      7651.0734      4415.7454      16.874595      14.9838        17.4642      
      2200   304.14647     -42246.247     -6966.1537      4406.5267      16.839366      14.9838        17.4642      
      2300   298.20649     -42212.658     -11075.899      4397.3081      16.804138      14.9838        17.4642      
      2400   314.5167      -42224.546      2755.8139      4388.0894      16.768909      14.9838        17.4642      
      2500   304.1434      -42251.011      2402.3396      4378.8707      16.73368       14.9838        17.4642      
      2600   298.6047      -42254.127     -11978.677      4369.652       16.698451      14.9838        17.4642      
      2700   296.0331      -42265.345     -6009.7331      4360.4334      16.663222      14.9838        17.4642      
      2800   301.68086     -42266.144     -7081.4822      4351.2147      16.627994      14.9838        17.4642      
      2900   296.15949     -42247.341     -7931.6476      4341.996       16.592765      14.9838        17.4642      
      3000   316.95045     -42242.322     -8515.594       4332.7773      16.557536      14.9838        17.4642      
      3100   300.89956     -42250.611     -8052.0712      4323.5587      16.522307      14.9838        17.4642      
      3200   309.85541     -42288.074     -11509.727      4314.34        16.487078      14.9838        17.4642      
      3300   299.80029     -42280.183     -1084.345       4305.1213      16.45185       14.9838        17.4642      
      3400   320.51239     -42283.511      2879.6715      4295.9026      16.416621      14.9838        17.4642      
      3500   284.69523     -42269.512     -3455.9333      4286.684       16.381392      14.9838        17.4642      
      3600   281.79898     -42275.508      1636.2795      4277.4653      16.346163      14.9838        17.4642      
      3700   307.78074     -42289.137      246.87636      4268.2466      16.310934      14.9838        17.4642      
      3800   318.35267     -42282.837      11321.74       4259.0279      16.275706      14.9838        17.4642      
      3900   304.18741     -42263.954     -6749.6403      4249.8093      16.240477      14.9838        17.4642      
      4000   294.77259     -42283.64      -1452.5416      4240.5906      16.205248      14.9838        17.4642      
      4100   287.45145     -42286.847     -6977.5754      4231.3719      16.170019      14.9838        17.4642      
      4200   299.47427     -42294.626     -9006.8847      4222.1532      16.13479       14.9838        17.4642      
      4300   297.74674     -42285.473      7236.3012      4212.9346      16.099562      14.9838        17.4642      
      4400   317.78606     -42310.293     -5484.1204      4203.7159      16.064333      14.9838        17.4642      
      4500   283.66209     -42278.274     -9688.6843      4194.4972      16.029104      14.9838        17.4642      
      4600   317.30152     -42317.31       5866.5027      4185.2785      15.993875      14.9838        17.4642      
      4700   303.49936     -42314.411      4212.1881      4176.0599      15.958646      14.9838        17.4642      
      4800   306.09912     -42312.005     -5263.1677      4166.8412      15.923418      14.9838        17.4642      
      4900   303.02624     -42302.97      -7330.2297      4157.6225      15.888189      14.9838        17.4642      
      5000   294.85941     -42291.269     -13924.101      4148.4038      15.85296       14.9838        17.4642      
Loop time of 200.976 on 16 procs for 5000 steps with 365 atoms

Performance: 1.075 ns/day, 22.331 hours/ns, 24.879 timesteps/s, 9.081 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 111.78     | 140.44     | 166.19     | 198.6 | 69.88
Bond    | 0.0013684  | 0.001631   | 0.0020384  |   0.5 |  0.00
Neigh   | 9.3976     | 11.475     | 13.361     |  54.7 |  5.71
Comm    | 2.0465     | 27.809     | 56.471     | 446.3 | 13.84
Output  | 0.015987   | 0.018194   | 0.020106   |   1.0 |  0.01
Modify  | 19.232     | 21.133     | 23.237     |  40.4 | 10.52
Other   |            | 0.102      |            |       |  0.05

Nlocal:         45.625 ave          52 max          40 min
Histogram: 1 1 0 0 3 1 0 0 1 1
Nghost:        3093.62 ave        3151 max        3031 min
Histogram: 1 1 0 2 0 0 2 0 0 2
Neighs:        27874.8 ave       31566 max       24560 min
Histogram: 1 1 0 1 3 0 0 0 1 1

Total # of neighbors = 222998
Ave neighs/atom = 610.95342
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.6144
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.76144 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.76144 xy delta -0.69346 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.76144 xy delta -0.69346 xz delta 0.2088 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.9 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.79569     -42230.653     -16340.744      4618.5563      17.649629      14.9838        17.4642      
       200   309.14289     -42208.854     -10868.314      4627.775       17.684858      14.9838        17.4642      
       300   300.68367     -42217.431     -11802.454      4636.9936      17.720086      14.9838        17.4642      
       400   299.30922     -42231.691     -7496.6956      4646.2123      17.755315      14.9838        17.4642      
       500   300.53235     -42226.663     -15556.682      4655.431       17.790544      14.9838        17.4642      
       600   308.89806     -42207.865     -6388.5207      4664.6497      17.825773      14.9838        17.4642      
       700   317.55733     -42185.875     -22415.784      4673.8683      17.861002      14.9838        17.4642      
       800   318.58334     -42197.663     -12033.71       4683.087       17.89623       14.9838        17.4642      
       900   318.44801     -42195.132     -18750.907      4692.3057      17.931459      14.9838        17.4642      
      1000   294.24787     -42181.884     -17055.999      4701.5244      17.966688      14.9838        17.4642      
      1100   292.12906     -42197.613     -22541.458      4710.743       18.001917      14.9838        17.4642      
      1200   300.26277     -42208.636     -16247.507      4719.9617      18.037146      14.9838        17.4642      
      1300   297.30815     -42202.741     -10264.7        4729.1804      18.072374      14.9838        17.4642      
      1400   282.40478     -42199.538     -16752.598      4738.3991      18.107603      14.9838        17.4642      
      1500   274.87094     -42206.215      266.27129      4747.6177      18.142832      14.9838        17.4642      
      1600   295.3433      -42198.285     -13989.241      4756.8364      18.178061      14.9838        17.4642      
      1700   311.31943     -42190.577     -21339.618      4766.0551      18.21329       14.9838        17.4642      
      1800   306.6151      -42169.037     -12263.838      4775.2738      18.248518      14.9838        17.4642      
      1900   314.47101     -42190.89      -15927.918      4784.4924      18.283747      14.9838        17.4642      
      2000   283.41917     -42166.816      747.97421      4793.7111      18.318976      14.9838        17.4642      
      2100   287.78781     -42177.26      -23310.831      4802.9298      18.354205      14.9838        17.4642      
      2200   294.7508      -42187.679     -16349.036      4812.1485      18.389434      14.9838        17.4642      
      2300   281.98242     -42194.653     -14124.72       4821.3671      18.424662      14.9838        17.4642      
      2400   283.99217     -42201.861     -18916.387      4830.5858      18.459891      14.9838        17.4642      
      2500   279.61797     -42170.26      -18127.453      4839.8045      18.49512       14.9838        17.4642      
      2600   289.98765     -42157.846     -7054.7212      4849.0232      18.530349      14.9838        17.4642      
      2700   302.26255     -42156.822     -21743.54       4858.2418      18.565578      14.9838        17.4642      
      2800   324.62239     -42178.693     -16846.87       4867.4605      18.600806      14.9838        17.4642      
      2900   296.94635     -42165.621     -10506.469      4876.6792      18.636035      14.9838        17.4642      
      3000   288.20404     -42159.665     -23276.492      4885.8979      18.671264      14.9838        17.4642      
      3100   301.55771     -42161.306     -22342.633      4895.1165      18.706493      14.9838        17.4642      
      3200   306.65838     -42147.752     -21975.786      4904.3352      18.741722      14.9838        17.4642      
      3300   295.64868     -42134.335     -6422.8913      4913.5539      18.77695       14.9838        17.4642      
      3400   290.83586     -42143.609     -17124.282      4922.7726      18.812179      14.9838        17.4642      
      3500   273.98503     -42155.817     -18953.646      4931.9912      18.847408      14.9838        17.4642      
      3600   292.10353     -42158.551     -24198.022      4941.2099      18.882637      14.9838        17.4642      
      3700   326.86372     -42164.455     -10775.085      4950.4286      18.917866      14.9838        17.4642      
      3800   312.71386     -42139.625     -12353.188      4959.6473      18.953094      14.9838        17.4642      
      3900   302.46703     -42163.352      3146.1184      4968.8659      18.988323      14.9838        17.4642      
      4000   294.55524     -42156.128     -5637.6467      4978.0846      19.023552      14.9838        17.4642      
      4100   286.83784     -42124.014     -5697.4783      4987.3033      19.058781      14.9838        17.4642      
      4200   297.46188     -42121.582     -4074.2943      4996.522       19.09401       14.9838        17.4642      
      4300   300.73832     -42126.304     -25096.524      5005.7406      19.129238      14.9838        17.4642      
      4400   289.40114     -42144.935     -9883.9033      5014.9593      19.164467      14.9838        17.4642      
      4500   269.7788      -42120.859     -28922.024      5024.178       19.199696      14.9838        17.4642      
      4600   289.55906     -42109.693     -10797.709      5033.3967      19.234925      14.9838        17.4642      
      4700   325.95944     -42127.238     -11698.408      5042.6153      19.270154      14.9838        17.4642      
      4800   308.64165     -42112.969     -18849.249      5051.834       19.305382      14.9838        17.4642      
      4900   333.50152     -42146.363     -11704.848      5061.0527      19.340611      14.9838        17.4642      
      5000   294.0541      -42114.401     -20467.267      5070.2714      19.37584       14.9838        17.4642      
Loop time of 183.577 on 16 procs for 5000 steps with 365 atoms

Performance: 1.177 ns/day, 20.397 hours/ns, 27.237 timesteps/s, 9.941 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.795     | 126.84     | 148.67     | 191.1 | 69.09
Bond    | 0.0013361  | 0.0016297  | 0.0021245  |   0.6 |  0.00
Neigh   | 8.5867     | 10.529     | 12.181     |  49.0 |  5.74
Comm    | 3.8854     | 25.728     | 52.78      | 424.4 | 14.02
Output  | 0.017051   | 0.019616   | 0.021364   |   0.9 |  0.01
Modify  | 18.675     | 20.358     | 22.323     |  35.3 | 11.09
Other   |            | 0.1022     |            |       |  0.06

Nlocal:         45.625 ave          57 max          36 min
Histogram: 3 0 0 0 1 1 1 0 0 2
Nghost:           2712 ave        2769 max        2656 min
Histogram: 2 0 0 0 2 1 1 0 1 1
Neighs:        22693.1 ave       27866 max       18117 min
Histogram: 3 0 0 0 1 0 2 0 0 2

Total # of neighbors = 181545
Ave neighs/atom = 497.38356
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 14.9838
variable dlen equal ly-${len0}
variable dlen equal ly-14.9838
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*14.9838
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.69346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.2088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.08795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.49838 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.49838 yz delta -0.08795 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.8 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   326.20284     -42230.157     -16309.731      4600.1189      17.6144        14.953832      17.4642      
       200   308.52893     -42214.45      -6857.5964      4590.9003      17.6144        14.923865      17.4642      
       300   308.48346     -42238.085     -15885.897      4581.6816      17.6144        14.893897      17.4642      
       400   290.05242     -42231.338     -6229.661       4572.4629      17.6144        14.86393       17.4642      
       500   294.57761     -42238.446     -15597.881      4563.2442      17.6144        14.833962      17.4642      
       600   311.70907     -42244.218     -6549.3581      4554.0255      17.6144        14.803994      17.4642      
       700   320.75031     -42217.685     -21193.337      4544.8069      17.6144        14.774027      17.4642      
       800   317.88643     -42212.564     -11726.595      4535.5882      17.6144        14.744059      17.4642      
       900   317.53261     -42242.847     -6677.5634      4526.3695      17.6144        14.714092      17.4642      
      1000   325.48164     -42255.411     -13874.809      4517.1508      17.6144        14.684124      17.4642      
      1100   284.33484     -42225.851     -16536.532      4507.9322      17.6144        14.654156      17.4642      
      1200   290.58032     -42240.223     -14459.599      4498.7135      17.6144        14.624189      17.4642      
      1300   302.77944     -42250.736     -10572.788      4489.4948      17.6144        14.594221      17.4642      
      1400   299.14561     -42260.708     -10767.535      4480.2761      17.6144        14.564254      17.4642      
      1500   289.91336     -42269.815     -9163.1028      4471.0575      17.6144        14.534286      17.4642      
      1600   301.93652     -42278.64      -3885.2411      4461.8388      17.6144        14.504318      17.4642      
      1700   310.26792     -42256.578     -4179.2639      4452.6201      17.6144        14.474351      17.4642      
      1800   339.42231     -42233.895      2250.3237      4443.4014      17.6144        14.444383      17.4642      
      1900   327.2225      -42215.865     -5387.4545      4434.1828      17.6144        14.414416      17.4642      
      2000   320.34094     -42233.412     -8136.8525      4424.9641      17.6144        14.384448      17.4642      
      2100   311.56143     -42227.874     -4133.1771      4415.7454      17.6144        14.35448       17.4642      
      2200   305.29553     -42255.723      5754.6343      4406.5267      17.6144        14.324513      17.4642      
      2300   276.98159     -42239.841     -1512.5762      4397.3081      17.6144        14.294545      17.4642      
      2400   295.20597     -42260.594      11894.356      4388.0894      17.6144        14.264578      17.4642      
      2500   311.66898     -42268.064      950.74922      4378.8707      17.6144        14.23461       17.4642      
      2600   283.21712     -42236.715     -12505.037      4369.652       17.6144        14.204642      17.4642      
      2700   297.08859     -42247.072      6697.7142      4360.4334      17.6144        14.174675      17.4642      
      2800   327.9066      -42292.594     -10263.434      4351.2147      17.6144        14.144707      17.4642      
      2900   301.75237     -42285.359     -5411.1009      4341.996       17.6144        14.11474       17.4642      
      3000   303.29844     -42291.042     -6240.3065      4332.7773      17.6144        14.084772      17.4642      
      3100   310.88451     -42310.28      -11209.967      4323.5587      17.6144        14.054804      17.4642      
      3200   318.28297     -42326.902     -12636.05       4314.34        17.6144        14.024837      17.4642      
      3300   312.4104      -42331.64      -5618.2892      4305.1213      17.6144        13.994869      17.4642      
      3400   300.38318     -42326.858      6409.0211      4295.9026      17.6144        13.964902      17.4642      
      3500   324.94243     -42363.633     -11508.094      4286.684       17.6144        13.934934      17.4642      
      3600   310.21734     -42355.793     -4823.1872      4277.4653      17.6144        13.904966      17.4642      
      3700   293.54864     -42335.474     -7934.3339      4268.2466      17.6144        13.874999      17.4642      
      3800   297.27585     -42362.58      -5368.9481      4259.0279      17.6144        13.845031      17.4642      
      3900   308.71571     -42377.433     -12263.229      4249.8093      17.6144        13.815064      17.4642      
      4000   300.94911     -42374.748      789.81933      4240.5906      17.6144        13.785096      17.4642      
      4100   294.94585     -42365.2       -12657.818      4231.3719      17.6144        13.755128      17.4642      
      4200   299.02367     -42374.843     -6007.2067      4222.1532      17.6144        13.725161      17.4642      
      4300   304.2543      -42375.261     -13169.199      4212.9346      17.6144        13.695193      17.4642      
      4400   296.64135     -42378.825     -66.423035      4203.7159      17.6144        13.665226      17.4642      
      4500   299.54565     -42416.69      -2488.3741      4194.4972      17.6144        13.635258      17.4642      
      4600   294.07368     -42410.445     -19906.635      4185.2785      17.6144        13.60529       17.4642      
      4700   293.7317      -42390.348      8739.3117      4176.0599      17.6144        13.575323      17.4642      
      4800   289.45059     -42360.399     -3577.8199      4166.8412      17.6144        13.545355      17.4642      
      4900   319.9641      -42399.761     -6424.713       4157.6225      17.6144        13.515388      17.4642      
      5000   293.34089     -42402.648      10135.642      4148.4038      17.6144        13.48542       17.4642      
Loop time of 204.466 on 16 procs for 5000 steps with 365 atoms

Performance: 1.056 ns/day, 22.718 hours/ns, 24.454 timesteps/s, 8.926 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 115.87     | 137.48     | 168.71     | 192.7 | 67.24
Bond    | 0.0012212  | 0.0015797  | 0.0020183  |   0.7 |  0.00
Neigh   | 9.5806     | 11.191     | 13.595     |  53.9 |  5.47
Comm    | 2.4217     | 33.638     | 55.291     | 389.6 | 16.45
Output  | 0.015782   | 0.017774   | 0.019618   |   0.9 |  0.01
Modify  | 19.582     | 22.025     | 23.634     |  38.7 | 10.77
Other   |            | 0.1077     |            |       |  0.05

Nlocal:         45.625 ave          51 max          40 min
Histogram: 2 1 0 0 0 2 0 1 0 2
Nghost:        3152.62 ave        3189 max        3124 min
Histogram: 1 2 0 0 2 0 1 1 0 1
Neighs:          27866 ave       31011 max       24745 min
Histogram: 2 1 0 0 0 2 0 1 0 2

Total # of neighbors = 222928
Ave neighs/atom = 610.76164
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*14.9838
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.49838 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.49838 yz delta 0.08795 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.9 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.21993     -42230.571     -16200.111      4618.5563      17.6144        15.013768      17.4642      
       200   310.35071     -42210.587     -9357.8342      4627.775       17.6144        15.043735      17.4642      
       300   293.9143      -42214.943     -10708.543      4636.9936      17.6144        15.073703      17.4642      
       400   288.62551     -42224.221      6213.6912      4646.2123      17.6144        15.10367       17.4642      
       500   296.58899     -42231.734     -26743.789      4655.431       17.6144        15.133638      17.4642      
       600   303.74032     -42219.774     -2950.7234      4664.6497      17.6144        15.163606      17.4642      
       700   322.55994     -42201.044     -15791.431      4673.8683      17.6144        15.193573      17.4642      
       800   308.4099      -42193.738     -14558.886      4683.087       17.6144        15.223541      17.4642      
       900   316.35206     -42217.728     -7058.2447      4692.3057      17.6144        15.253508      17.4642      
      1000   314.43636     -42222.774     -24023.163      4701.5244      17.6144        15.283476      17.4642      
      1100   286.27104     -42198.701     -11948.46       4710.743       17.6144        15.313444      17.4642      
      1200   301.67451     -42223.822     -23690.902      4719.9617      17.6144        15.343411      17.4642      
      1300   300.80714     -42228.332     -14532.779      4729.1804      17.6144        15.373379      17.4642      
      1400   272.20313     -42217.623     -11950.578      4738.3991      17.6144        15.403346      17.4642      
      1500   297.38705     -42229.372     -2834.7734      4747.6177      17.6144        15.433314      17.4642      
      1600   316.99199     -42216.518     -18140.865      4756.8364      17.6144        15.463282      17.4642      
      1700   307.24482     -42190.211     -19197.197      4766.0551      17.6144        15.493249      17.4642      
      1800   282.66215     -42167.697     -10618.716      4775.2738      17.6144        15.523217      17.4642      
      1900   302.95115     -42201.463     -22326.441      4784.4924      17.6144        15.553184      17.4642      
      2000   294.26477     -42209.159     -17034.2        4793.7111      17.6144        15.583152      17.4642      
      2100   267.2259      -42195.851     -15048.907      4802.9298      17.6144        15.61312       17.4642      
      2200   278.88333     -42203.618     -19252.06       4812.1485      17.6144        15.643087      17.4642      
      2300   306.52832     -42191.408     -20250.628      4821.3671      17.6144        15.673055      17.4642      
      2400   308.22393     -42158.773     -10836.191      4830.5858      17.6144        15.703022      17.4642      
      2500   295.49777     -42141.919     -5815.0356      4839.8045      17.6144        15.73299       17.4642      
      2600   313.89295     -42180.125     -12766.62       4849.0232      17.6144        15.762958      17.4642      
      2700   288.70684     -42165.658     -15805.53       4858.2418      17.6144        15.792925      17.4642      
      2800   286.15703     -42164.245     -17087.422      4867.4605      17.6144        15.822893      17.4642      
      2900   315.77975     -42170.425     -26494.792      4876.6792      17.6144        15.85286       17.4642      
      3000   328.04983     -42125.648     -30635.288      4885.8979      17.6144        15.882828      17.4642      
      3100   312.26546     -42117.751     -15691.841      4895.1165      17.6144        15.912796      17.4642      
      3200   304.46463     -42136.279     -26812.295      4904.3352      17.6144        15.942763      17.4642      
      3300   301.23716     -42146.844     -17429.413      4913.5539      17.6144        15.972731      17.4642      
      3400   309.19409     -42168.327     -25719.528      4922.7726      17.6144        16.002698      17.4642      
      3500   297.23202     -42159.074     -11731.514      4931.9912      17.6144        16.032666      17.4642      
      3600   287.08575     -42136.514     -22612.126      4941.2099      17.6144        16.062634      17.4642      
      3700   309.73293     -42111.58      -23366.192      4950.4286      17.6144        16.092601      17.4642      
      3800   306.52148     -42106.615     -28480.939      4959.6473      17.6144        16.122569      17.4642      
      3900   308.37121     -42128.227     -16766.197      4968.8659      17.6144        16.152536      17.4642      
      4000   297.3009      -42128.23      -18618.981      4978.0846      17.6144        16.182504      17.4642      
      4100   287.49588     -42116.128     -16901.377      4987.3033      17.6144        16.212472      17.4642      
      4200   306.02372     -42117.85      -24605.237      4996.522       17.6144        16.242439      17.4642      
      4300   333.63033     -42103.357     -25339.903      5005.7406      17.6144        16.272407      17.4642      
      4400   309.47054     -42079.259     -13485.966      5014.9593      17.6144        16.302374      17.4642      
      4500   293.36773     -42094.162     -21694.759      5024.178       17.6144        16.332342      17.4642      
      4600   302.37056     -42105.462     -26613.493      5033.3967      17.6144        16.36231       17.4642      
      4700   306.30637     -42106.187     -24437.64       5042.6153      17.6144        16.392277      17.4642      
      4800   295.29374     -42103.701     -23870.439      5051.834       17.6144        16.422245      17.4642      
      4900   268.77112     -42085.696     -30035.78       5061.0527      17.6144        16.452212      17.4642      
      5000   277.60266     -42095.825     -27722.001      5070.2714      17.6144        16.48218       17.4642      
Loop time of 176.366 on 16 procs for 5000 steps with 365 atoms

Performance: 1.225 ns/day, 19.596 hours/ns, 28.350 timesteps/s, 10.348 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 96.113     | 117.01     | 144.49     | 187.4 | 66.34
Bond    | 0.0011542  | 0.0015696  | 0.0020736  |   0.7 |  0.00
Neigh   | 8.1401     | 9.4622     | 11.66      |  51.7 |  5.37
Comm    | 2.1472     | 29.62      | 50.539     | 372.2 | 16.79
Output  | 0.015587   | 0.01759    | 0.018952   |   0.8 |  0.01
Modify  | 17.924     | 20.157     | 21.502     |  35.8 | 11.43
Other   |            | 0.1007     |            |       |  0.06

Nlocal:         45.625 ave          54 max          35 min
Histogram: 2 0 0 1 0 0 2 1 0 2
Nghost:        2612.88 ave        2645 max        2588 min
Histogram: 1 0 1 2 2 0 0 1 0 1
Neighs:        22632.1 ave       26555 max       17644 min
Histogram: 2 0 0 1 0 0 2 1 0 2

Total # of neighbors = 181057
Ave neighs/atom = 496.04658
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.4642
variable dlen equal lz-${len0}
variable dlen equal lz-17.4642
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.4642
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.69346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.2088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.08795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.74642 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.8 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.82364     -42230.016     -17330.858      4600.1189      17.6144        14.9838        17.429272    
       200   310.34747     -42214.908     -11030.904      4590.9003      17.6144        14.9838        17.394343    
       300   291.92382     -42222.785     -12232.715      4581.6816      17.6144        14.9838        17.359415    
       400   289.31101     -42225.899     -10552.704      4572.4629      17.6144        14.9838        17.324486    
       500   301.73053     -42241.483     -18029.321      4563.2442      17.6144        14.9838        17.289558    
       600   314.93829     -42245.553     -13437.093      4554.0255      17.6144        14.9838        17.25463     
       700   307.37736     -42217.792     -14661.401      4544.8069      17.6144        14.9838        17.219701    
       800   322.21464     -42228.597     -5195.5482      4535.5882      17.6144        14.9838        17.184773    
       900   306.95783     -42239.813      2742.0642      4526.3695      17.6144        14.9838        17.149844    
      1000   295.82555     -42230.226     -7038.9465      4517.1508      17.6144        14.9838        17.114916    
      1100   305.39257     -42225.652     -13356.787      4507.9322      17.6144        14.9838        17.079988    
      1200   288.90689     -42221.643     -16924.492      4498.7135      17.6144        14.9838        17.045059    
      1300   282.89622     -42231.651     -8729.2948      4489.4948      17.6144        14.9838        17.010131    
      1400   304.59215     -42245.011     -18201.349      4480.2761      17.6144        14.9838        16.975202    
      1500   301.59228     -42239.273     -6987.5925      4471.0575      17.6144        14.9838        16.940274    
      1600   304.24534     -42249.158     -9869.9459      4461.8388      17.6144        14.9838        16.905346    
      1700   310.02372     -42277.792     -1906.5156      4452.6201      17.6144        14.9838        16.870417    
      1800   291.92805     -42257.039     -5250.2635      4443.4014      17.6144        14.9838        16.835489    
      1900   306.75973     -42250.065     -6638.1722      4434.1828      17.6144        14.9838        16.80056     
      2000   304.05706     -42240.47      -1426.6169      4424.9641      17.6144        14.9838        16.765632    
      2100   306.88849     -42255.794     -5399.6494      4415.7454      17.6144        14.9838        16.730704    
      2200   282.35178     -42226.672      725.0797       4406.5267      17.6144        14.9838        16.695775    
      2300   306.72114     -42241.501     -8154.093       4397.3081      17.6144        14.9838        16.660847    
      2400   314.32635     -42259.453     -17545.785      4388.0894      17.6144        14.9838        16.625918    
      2500   315.55819     -42267.535     -9772.9795      4378.8707      17.6144        14.9838        16.59099     
      2600   298.75603     -42251.693      167.28943      4369.652       17.6144        14.9838        16.556062    
      2700   300.23172     -42270.38      -11260.238      4360.4334      17.6144        14.9838        16.521133    
      2800   282.33495     -42266.457     -2087.1597      4351.2147      17.6144        14.9838        16.486205    
      2900   282.72769     -42257.736     -4667.9884      4341.996       17.6144        14.9838        16.451276    
      3000   288.26591     -42245.974     -6492.2411      4332.7773      17.6144        14.9838        16.416348    
      3100   312.48432     -42257.507      2253.9742      4323.5587      17.6144        14.9838        16.38142     
      3200   316.91822     -42265.543      1812.0253      4314.34        17.6144        14.9838        16.346491    
      3300   305.77986     -42271.834     -1388.2647      4305.1213      17.6144        14.9838        16.311563    
      3400   291.77233     -42256.69      -8994.1181      4295.9026      17.6144        14.9838        16.276634    
      3500   302.60725     -42264.145      64.499773      4286.684       17.6144        14.9838        16.241706    
      3600   290.41963     -42248.104     -1178.612       4277.4653      17.6144        14.9838        16.206778    
      3700   293.66308     -42271.269     -13424.326      4268.2466      17.6144        14.9838        16.171849    
      3800   292.17545     -42272.732     -10776.019      4259.0279      17.6144        14.9838        16.136921    
      3900   296.59295     -42260.608     -5725.4404      4249.8093      17.6144        14.9838        16.101992    
      4000   317.16866     -42236.808     -2068.9349      4240.5906      17.6144        14.9838        16.067064    
      4100   317.07556     -42234.876     -556.05565      4231.3719      17.6144        14.9838        16.032136    
      4200   325.377       -42261.718     -3775.6016      4222.1532      17.6144        14.9838        15.997207    
      4300   318.66706     -42269.147     -19200.658      4212.9346      17.6144        14.9838        15.962279    
      4400   316.93818     -42281.288      7117.4894      4203.7159      17.6144        14.9838        15.92735     
      4500   298.61575     -42264.383     -2335.289       4194.4972      17.6144        14.9838        15.892422    
      4600   318.93917     -42283.164      22852.539      4185.2785      17.6144        14.9838        15.857494    
      4700   311.95806     -42281.907     -9768.4851      4176.0599      17.6144        14.9838        15.822565    
      4800   298.77459     -42275.457     -10855.249      4166.8412      17.6144        14.9838        15.787637    
      4900   300.04073     -42288.691     -11647.953      4157.6225      17.6144        14.9838        15.752708    
      5000   293.21827     -42291.969      6414.1308      4148.4038      17.6144        14.9838        15.71778     
Loop time of 206.438 on 16 procs for 5000 steps with 365 atoms

Performance: 1.046 ns/day, 22.938 hours/ns, 24.220 timesteps/s, 8.840 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 121.02     | 143.19     | 160.57     | 105.8 | 69.36
Bond    | 0.0013203  | 0.0016466  | 0.0021363  |   0.7 |  0.00
Neigh   | 10.122     | 11.527     | 13.284     |  28.8 |  5.58
Comm    | 12.267     | 29.593     | 51.775     | 232.8 | 14.33
Output  | 0.01854    | 0.021086   | 0.023638   |   1.1 |  0.01
Modify  | 20.084     | 21.865     | 23.294     |  21.3 | 10.59
Other   |            | 0.2362     |            |       |  0.11

Nlocal:         45.625 ave          52 max          35 min
Histogram: 1 1 0 0 0 0 2 1 2 1
Nghost:        3094.88 ave        3120 max        3070 min
Histogram: 1 0 1 1 1 1 1 1 0 1
Neighs:        27843.6 ave       31396 max       21759 min
Histogram: 1 1 0 0 0 0 2 1 1 2

Total # of neighbors = 222749
Ave neighs/atom = 610.27123
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.4642
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.74642 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.8 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.69971     -42230.77      -14985.147      4618.5563      17.6144        14.9838        17.499128    
       200   310.49822     -42211.294     -7305.0341      4627.775       17.6144        14.9838        17.534057    
       300   298.76958     -42216.661     -11947.145      4636.9936      17.6144        14.9838        17.568985    
       400   305.40918     -42238.475     -6266.7116      4646.2123      17.6144        14.9838        17.603914    
       500   289.15194     -42220.095     -11080.487      4655.431       17.6144        14.9838        17.638842    
       600   306.25399     -42217.389     -9413.5492      4664.6497      17.6144        14.9838        17.67377     
       700   312.3756      -42182.031     -25820.156      4673.8683      17.6144        14.9838        17.708699    
       800   314.5444      -42188.786     -15933.266      4683.087       17.6144        14.9838        17.743627    
       900   316.06275     -42202.56      -6617.96        4692.3057      17.6144        14.9838        17.778556    
      1000   292.36402     -42187.568     -19361.696      4701.5244      17.6144        14.9838        17.813484    
      1100   301.86694     -42206.974     -19537.458      4710.743       17.6144        14.9838        17.848412    
      1200   292.29974     -42203.353     -18467.287      4719.9617      17.6144        14.9838        17.883341    
      1300   280.14015     -42194.935     -11346.629      4729.1804      17.6144        14.9838        17.918269    
      1400   301.4387      -42218.183     -10428.139      4738.3991      17.6144        14.9838        17.953198    
      1500   297.25872     -42209.013     -3800.8219      4747.6177      17.6144        14.9838        17.988126    
      1600   294.58251     -42181.883     -16587.388      4756.8364      17.6144        14.9838        18.023054    
      1700   330.91184     -42193.534     -11161.487      4766.0551      17.6144        14.9838        18.057983    
      1800   308.79007     -42179.657     -26971.643      4775.2738      17.6144        14.9838        18.092911    
      1900   302.37645     -42193.562     -10635.706      4784.4924      17.6144        14.9838        18.12784     
      2000   297.55988     -42193.107     -11006.682      4793.7111      17.6144        14.9838        18.162768    
      2100   296.56961     -42178.351     -16264.205      4802.9298      17.6144        14.9838        18.197696    
      2200   315.16656     -42170.236     -12153.502      4812.1485      17.6144        14.9838        18.232625    
      2300   297.00518     -42168.844     -14521.026      4821.3671      17.6144        14.9838        18.267553    
      2400   276.72857     -42173.315     -23715.872      4830.5858      17.6144        14.9838        18.302482    
      2500   306.72916     -42190.818     -13550.406      4839.8045      17.6144        14.9838        18.33741     
      2600   314.81859     -42190.164     -17240.855      4849.0232      17.6144        14.9838        18.372338    
      2700   306.77899     -42182.686     -10938.845      4858.2418      17.6144        14.9838        18.407267    
      2800   289.71843     -42182.125     -13441.722      4867.4605      17.6144        14.9838        18.442195    
      2900   289.57604     -42192.355     -19734.701      4876.6792      17.6144        14.9838        18.477124    
      3000   310.59837     -42195.085     -26920.865      4885.8979      17.6144        14.9838        18.512052    
      3100   306.81347     -42157.371     -33916.322      4895.1165      17.6144        14.9838        18.54698     
      3200   317.89425     -42146.042     -6005.9769      4904.3352      17.6144        14.9838        18.581909    
      3300   288.70549     -42146.344     -17988.011      4913.5539      17.6144        14.9838        18.616837    
      3400   291.99855     -42166.727     -9171.7023      4922.7726      17.6144        14.9838        18.651766    
      3500   298.03622     -42167.323     -20136.304      4931.9912      17.6144        14.9838        18.686694    
      3600   308.83037     -42167.07      -16333.658      4941.2099      17.6144        14.9838        18.721622    
      3700   325.93603     -42167.344     -28141.882      4950.4286      17.6144        14.9838        18.756551    
      3800   298.04898     -42140.151     -20637.8        4959.6473      17.6144        14.9838        18.791479    
      3900   290.03005     -42154.41      -22560.346      4968.8659      17.6144        14.9838        18.826408    
      4000   290.56983     -42147.072     -28606.809      4978.0846      17.6144        14.9838        18.861336    
      4100   297.66095     -42139.35      -22534.289      4987.3033      17.6144        14.9838        18.896264    
      4200   293.32132     -42126.274     -16093.55       4996.522       17.6144        14.9838        18.931193    
      4300   295.76989     -42148.68      -23147.347      5005.7406      17.6144        14.9838        18.966121    
      4400   292.00694     -42154.792     -14310.68       5014.9593      17.6144        14.9838        19.00105     
      4500   276.14797     -42122.805     -26752.482      5024.178       17.6144        14.9838        19.035978    
      4600   297.96903     -42111.435     -15669.281      5033.3967      17.6144        14.9838        19.070906    
      4700   290.80576     -42086.872     -16380.324      5042.6153      17.6144        14.9838        19.105835    
      4800   325.65812     -42122.987     -33882.311      5051.834       17.6144        14.9838        19.140763    
      4900   289.00557     -42099.121     -29390.737      5061.0527      17.6144        14.9838        19.175692    
      5000   290.3418      -42098.709     -25668.664      5070.2714      17.6144        14.9838        19.21062     
Loop time of 179.281 on 16 procs for 5000 steps with 365 atoms

Performance: 1.205 ns/day, 19.920 hours/ns, 27.889 timesteps/s, 10.180 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.091     | 130.07     | 145.55     | 153.3 | 72.55
Bond    | 0.0014047  | 0.0016301  | 0.0022371  |   0.7 |  0.00
Neigh   | 7.6059     | 9.8923     | 11.125     |  43.4 |  5.52
Comm    | 4.5572     | 20.041     | 51.029     | 390.4 | 11.18
Output  | 0.01638    | 0.018506   | 0.020337   |   0.9 |  0.01
Modify  | 17.908     | 19.16      | 21.478     |  31.5 | 10.69
Other   |            | 0.1001     |            |       |  0.06

Nlocal:         45.625 ave          54 max          38 min
Histogram: 1 0 1 2 0 1 2 0 0 1
Nghost:        2627.88 ave        2656 max        2584 min
Histogram: 1 1 0 0 0 2 0 1 1 2
Neighs:        22665.6 ave       26474 max       19098 min
Histogram: 1 0 1 1 1 1 2 0 0 1

Total # of neighbors = 181325
Ave neighs/atom = 496.78082
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 17.6144
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.8795)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.6144
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.69346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.2088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.08795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.76144 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.8 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.65073     -42230.419     -16675.485      4609.3376      17.6144        14.9838        17.4642      
       200   304.49242     -42208.736     -8593.1454      4609.3376      17.6144        14.9838        17.4642      
       300   299.27579     -42222.208     -11688.711      4609.3376      17.6144        14.9838        17.4642      
       400   293.98734     -42232.684     -10913.707      4609.3376      17.6144        14.9838        17.4642      
       500   287.39499     -42223.311     -15043.025      4609.3376      17.6144        14.9838        17.4642      
       600   313.35281     -42216.539      2762.1399      4609.3376      17.6144        14.9838        17.4642      
       700   314.79527     -42201.357     -14692.763      4609.3376      17.6144        14.9838        17.4642      
       800   303.63908     -42206.203     -14342.849      4609.3376      17.6144        14.9838        17.4642      
       900   314.61949     -42234.589     -7063.6544      4609.3376      17.6144        14.9838        17.4642      
      1000   305.53402     -42227.445     -16024.317      4609.3376      17.6144        14.9838        17.4642      
      1100   280.8105      -42204.982     -28675.057      4609.3376      17.6144        14.9838        17.4642      
      1200   289.98824     -42214.813     -3072.1846      4609.3376      17.6144        14.9838        17.4642      
      1300   286.94357     -42210.853     -7539.2001      4609.3376      17.6144        14.9838        17.4642      
      1400   299.49246     -42220.608     -5138.0325      4609.3376      17.6144        14.9838        17.4642      
      1500   284.98645     -42215.116     -6792.5979      4609.3376      17.6144        14.9838        17.4642      
      1600   295.45482     -42245.38      -9469.8152      4609.3376      17.6144        14.9838        17.4642      
      1700   282.67274     -42231.889     -15539.014      4609.3376      17.6144        14.9838        17.4642      
      1800   306.17443     -42238.337     -8579.044       4609.3376      17.6144        14.9838        17.4642      
      1900   317.7478      -42218.613     -12560.589      4609.3376      17.6144        14.9838        17.4642      
      2000   311.02498     -42205.325     -19633.851      4609.3376      17.6144        14.9838        17.4642      
      2100   311.13979     -42226.328     -7437.9302      4609.3376      17.6144        14.9838        17.4642      
      2200   293.45638     -42231.373     -13767.54       4609.3376      17.6144        14.9838        17.4642      
      2300   288.97328     -42224.284     -17550.044      4609.3376      17.6144        14.9838        17.4642      
      2400   287.4358      -42201.927     -1694.1235      4609.3376      17.6144        14.9838        17.4642      
      2500   314.21613     -42206.831     -12001.554      4609.3376      17.6144        14.9838        17.4642      
      2600   294.7533      -42193.578     -9370.0527      4609.3376      17.6144        14.9838        17.4642      
      2700   299.98941     -42217.857     -2810.7044      4609.3376      17.6144        14.9838        17.4642      
      2800   280.42008     -42215.5       -18912.849      4609.3376      17.6144        14.9838        17.4642      
      2900   295.96493     -42222.861     -14734.13       4609.3376      17.6144        14.9838        17.4642      
      3000   297.59363     -42214.558     -12051.476      4609.3376      17.6144        14.9838        17.4642      
      3100   303.19833     -42216.821     -11770.415      4609.3376      17.6144        14.9838        17.4642      
      3200   309.61563     -42221.852     -19109.501      4609.3376      17.6144        14.9838        17.4642      
      3300   305.70142     -42228.888     -8013.9465      4609.3376      17.6144        14.9838        17.4642      
      3400   298.96572     -42243.28      -8318.3932      4609.3376      17.6144        14.9838        17.4642      
      3500   279.45955     -42238.448      3237.0598      4609.3376      17.6144        14.9838        17.4642      
      3600   291.07365     -42238.714     -18703.359      4609.3376      17.6144        14.9838        17.4642      
      3700   288.94296     -42217.043     -12322.482      4609.3376      17.6144        14.9838        17.4642      
      3800   308.41695     -42226.486     -1055.971       4609.3376      17.6144        14.9838        17.4642      
      3900   296.7845      -42209.562     -2794.2085      4609.3376      17.6144        14.9838        17.4642      
      4000   287.75318     -42198.17      -13068.812      4609.3376      17.6144        14.9838        17.4642      
      4100   294.91654     -42222.556     -16389.468      4609.3376      17.6144        14.9838        17.4642      
      4200   281.58925     -42243.134     -6374.4865      4609.3376      17.6144        14.9838        17.4642      
      4300   283.34874     -42227.044     -5609.6607      4609.3376      17.6144        14.9838        17.4642      
      4400   303.45548     -42222.491     -8506.3377      4609.3376      17.6144        14.9838        17.4642      
      4500   313.71659     -42216.498     -5356.7067      4609.3376      17.6144        14.9838        17.4642      
      4600   294.3882      -42197.886     -15358.876      4609.3376      17.6144        14.9838        17.4642      
      4700   282.49339     -42211.916     -22392.747      4609.3376      17.6144        14.9838        17.4642      
      4800   293.0425      -42208.853     -2640.5095      4609.3376      17.6144        14.9838        17.4642      
      4900   312.36461     -42213.686     -2395.3623      4609.3376      17.6144        14.9838        17.4642      
      5000   309.42824     -42222.932      1152.4612      4609.3376      17.6144        14.9838        17.4642      
Loop time of 191.779 on 16 procs for 5000 steps with 365 atoms

Performance: 1.126 ns/day, 21.309 hours/ns, 26.072 timesteps/s, 9.516 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.18     | 136.93     | 158.11     | 194.5 | 71.40
Bond    | 0.0013043  | 0.0016513  | 0.0022831  |   0.8 |  0.00
Neigh   | 8.6865     | 11.03      | 12.573     |  53.0 |  5.75
Comm    | 2.1525     | 23.334     | 54.091     | 471.2 | 12.17
Output  | 0.016643   | 0.018998   | 0.020786   |   1.0 |  0.01
Modify  | 18.815     | 20.355     | 22.712     |  39.2 | 10.61
Other   |            | 0.1044     |            |       |  0.05

Nlocal:         45.625 ave          55 max          38 min
Histogram: 1 1 1 0 2 1 0 1 0 1
Nghost:        2826.88 ave        2838 max        2814 min
Histogram: 1 0 2 0 1 1 0 0 1 2
Neighs:        25037.4 ave       29971 max       21010 min
Histogram: 1 1 0 1 2 1 0 1 0 1

Total # of neighbors = 200299
Ave neighs/atom = 548.76438
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.6144
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.76144 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.9 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.76776     -42230.28      -15830.181      4609.3376      17.6144        14.9838        17.4642      
       200   310.00553     -42214.183     -5531.1463      4609.3376      17.6144        14.9838        17.4642      
       300   292.42273     -42219.465     -8772.0028      4609.3376      17.6144        14.9838        17.4642      
       400   288.40538     -42229.087     -7325.6952      4609.3376      17.6144        14.9838        17.4642      
       500   288.81278     -42225.488     -16408.243      4609.3376      17.6144        14.9838        17.4642      
       600   320.95291     -42229.785     -17810.193      4609.3376      17.6144        14.9838        17.4642      
       700   343.72913     -42232.689     -17379.493      4609.3376      17.6144        14.9838        17.4642      
       800   312.43538     -42210.892     -12509.427      4609.3376      17.6144        14.9838        17.4642      
       900   326.93188     -42238.858     -15638.894      4609.3376      17.6144        14.9838        17.4642      
      1000   297.83598     -42224.008     -11645.867      4609.3376      17.6144        14.9838        17.4642      
      1100   284.79161     -42224.135     -14904.392      4609.3376      17.6144        14.9838        17.4642      
      1200   304.83388     -42235.327     -13990.384      4609.3376      17.6144        14.9838        17.4642      
      1300   328.52771     -42225.677     -10450.188      4609.3376      17.6144        14.9838        17.4642      
      1400   316.69997     -42202.571     -9774.5603      4609.3376      17.6144        14.9838        17.4642      
      1500   284.12746     -42204.575      107.68219      4609.3376      17.6144        14.9838        17.4642      
      1600   293.1101      -42219.294     -10854.685      4609.3376      17.6144        14.9838        17.4642      
      1700   307.66498     -42231.721     -22997.069      4609.3376      17.6144        14.9838        17.4642      
      1800   297.31958     -42227.444     -7935.0197      4609.3376      17.6144        14.9838        17.4642      
      1900   295.40098     -42227.922     -9661.3299      4609.3376      17.6144        14.9838        17.4642      
      2000   285.84388     -42242.562     -13887.705      4609.3376      17.6144        14.9838        17.4642      
      2100   299.26243     -42266.202     -10893.782      4609.3376      17.6144        14.9838        17.4642      
      2200   287.33135     -42234.467     -7380.1262      4609.3376      17.6144        14.9838        17.4642      
      2300   306.37771     -42218.464     -10398.416      4609.3376      17.6144        14.9838        17.4642      
      2400   335.52667     -42247.652     -11189.243      4609.3376      17.6144        14.9838        17.4642      
      2500   298.94322     -42226.718     -19862.976      4609.3376      17.6144        14.9838        17.4642      
      2600   312.1149      -42258.879     -20598.871      4609.3376      17.6144        14.9838        17.4642      
      2700   303.35386     -42255.586     -21807.716      4609.3376      17.6144        14.9838        17.4642      
      2800   308.32253     -42253.908     -2668.2789      4609.3376      17.6144        14.9838        17.4642      
      2900   290.23066     -42252.23      -7676.035       4609.3376      17.6144        14.9838        17.4642      
      3000   285.26343     -42267.241     -7451.3774      4609.3376      17.6144        14.9838        17.4642      
      3100   301.49101     -42263.968     -10662.843      4609.3376      17.6144        14.9838        17.4642      
      3200   316.08729     -42253.929     -8889.2491      4609.3376      17.6144        14.9838        17.4642      
      3300   300.8708      -42233.923     -17199.535      4609.3376      17.6144        14.9838        17.4642      
      3400   288.75286     -42226.766     -3419.8494      4609.3376      17.6144        14.9838        17.4642      
      3500   289.68394     -42230.311     -7467.9001      4609.3376      17.6144        14.9838        17.4642      
      3600   306.48574     -42243.932     -7678.3961      4609.3376      17.6144        14.9838        17.4642      
      3700   308.36327     -42204.408     -9358.4572      4609.3376      17.6144        14.9838        17.4642      
      3800   315.49805     -42194.17      -3981.7091      4609.3376      17.6144        14.9838        17.4642      
      3900   300.09842     -42206.699     -13572.193      4609.3376      17.6144        14.9838        17.4642      
      4000   308.16279     -42226.614     -16988.154      4609.3376      17.6144        14.9838        17.4642      
      4100   294.05074     -42222.817      914.5098       4609.3376      17.6144        14.9838        17.4642      
      4200   284.72518     -42219.68      -5919.7658      4609.3376      17.6144        14.9838        17.4642      
      4300   285.49017     -42236.555     -17855.246      4609.3376      17.6144        14.9838        17.4642      
      4400   276.76524     -42254.225     -8679.8434      4609.3376      17.6144        14.9838        17.4642      
      4500   275.82268     -42266.973     -28404.536      4609.3376      17.6144        14.9838        17.4642      
      4600   281.68914     -42238.741     -21941.662      4609.3376      17.6144        14.9838        17.4642      
      4700   299.35801     -42229.061     -18175.337      4609.3376      17.6144        14.9838        17.4642      
      4800   300.81395     -42223.452     -16231.962      4609.3376      17.6144        14.9838        17.4642      
      4900   299.10513     -42225.743     -9606.9285      4609.3376      17.6144        14.9838        17.4642      
      5000   297.66142     -42237.232     -11118.54       4609.3376      17.6144        14.9838        17.4642      
Loop time of 194.685 on 16 procs for 5000 steps with 365 atoms

Performance: 1.109 ns/day, 21.632 hours/ns, 25.682 timesteps/s, 9.374 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 109.38     | 139.16     | 159.55     | 194.3 | 71.48
Bond    | 0.0012381  | 0.0016356  | 0.0022367  |   0.7 |  0.00
Neigh   | 9.0426     | 11.398     | 12.89      |  51.1 |  5.85
Comm    | 3.1951     | 23.574     | 53.352     | 472.0 | 12.11
Output  | 0.016427   | 0.018927   | 0.020568   |   0.9 |  0.01
Modify  | 18.918     | 20.427     | 22.788     |  38.4 | 10.49
Other   |            | 0.1093     |            |       |  0.06

Nlocal:         45.625 ave          55 max          38 min
Histogram: 1 0 2 0 2 1 1 0 0 1
Nghost:        2901.12 ave        2920 max        2885 min
Histogram: 2 0 0 1 1 2 1 0 0 1
Neighs:          25042 ave       29776 max       21180 min
Histogram: 1 0 1 2 1 1 1 0 0 1

Total # of neighbors = 200336
Ave neighs/atom = 548.86575
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 14.9838
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-2.088)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*14.9838
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.69346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.2088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.08795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.49838 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.8 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.36124     -42229.617     -12403.216      4609.3376      17.6144        14.9838        17.4642      
       200   307.5811      -42211.883     -7811.9886      4609.3376      17.6144        14.9838        17.4642      
       300   296.49446     -42205.282     -17770.587      4609.3376      17.6144        14.9838        17.4642      
       400   298.97988     -42230.616     -9478.1136      4609.3376      17.6144        14.9838        17.4642      
       500   295.59663     -42214.81      -6101.5569      4609.3376      17.6144        14.9838        17.4642      
       600   281.11221     -42212.148     -9253.8136      4609.3376      17.6144        14.9838        17.4642      
       700   282.26256     -42214.396     -25175.647      4609.3376      17.6144        14.9838        17.4642      
       800   301.74036     -42236.744     -19170.123      4609.3376      17.6144        14.9838        17.4642      
       900   309.58903     -42228.8       -16308.406      4609.3376      17.6144        14.9838        17.4642      
      1000   308.08595     -42198.496     -13216.226      4609.3376      17.6144        14.9838        17.4642      
      1100   309.36484     -42200.798     -19536.518      4609.3376      17.6144        14.9838        17.4642      
      1200   304.31149     -42205.289     -13744.941      4609.3376      17.6144        14.9838        17.4642      
      1300   308.97084     -42221.715     -12742.828      4609.3376      17.6144        14.9838        17.4642      
      1400   295.27242     -42217.367     -14739.105      4609.3376      17.6144        14.9838        17.4642      
      1500   311.54036     -42220.371     -3979.3249      4609.3376      17.6144        14.9838        17.4642      
      1600   302.60904     -42187.555     -11470.572      4609.3376      17.6144        14.9838        17.4642      
      1700   306.97773     -42177.58      -8387.2523      4609.3376      17.6144        14.9838        17.4642      
      1800   298.81454     -42183.134     -6144.1543      4609.3376      17.6144        14.9838        17.4642      
      1900   304.342       -42213.488     -15048.535      4609.3376      17.6144        14.9838        17.4642      
      2000   288.67036     -42205.336     -7866.0792      4609.3376      17.6144        14.9838        17.4642      
      2100   295.99788     -42223.393     -7669.1764      4609.3376      17.6144        14.9838        17.4642      
      2200   288.56214     -42222.493     -13189.267      4609.3376      17.6144        14.9838        17.4642      
      2300   290.61967     -42222.291     -19864.23       4609.3376      17.6144        14.9838        17.4642      
      2400   286.14322     -42228.085     -13873.389      4609.3376      17.6144        14.9838        17.4642      
      2500   311.7544      -42250.528     -18769.682      4609.3376      17.6144        14.9838        17.4642      
      2600   285.54438     -42197.196     -8084.7708      4609.3376      17.6144        14.9838        17.4642      
      2700   310.46795     -42195.009     -15064.682      4609.3376      17.6144        14.9838        17.4642      
      2800   278.13345     -42176.975     -18011.326      4609.3376      17.6144        14.9838        17.4642      
      2900   289.26977     -42196.534     -9360.142       4609.3376      17.6144        14.9838        17.4642      
      3000   283.93348     -42199.858     -15630.62       4609.3376      17.6144        14.9838        17.4642      
      3100   293.44567     -42213.539     -13713.685      4609.3376      17.6144        14.9838        17.4642      
      3200   292.09826     -42219.415     -8801.1846      4609.3376      17.6144        14.9838        17.4642      
      3300   298.21799     -42246.112     -14587.886      4609.3376      17.6144        14.9838        17.4642      
      3400   273.33166     -42237.05      -21820.443      4609.3376      17.6144        14.9838        17.4642      
      3500   304.07536     -42252.679     -3429.3791      4609.3376      17.6144        14.9838        17.4642      
      3600   302.9893      -42217.272     -17513.317      4609.3376      17.6144        14.9838        17.4642      
      3700   304.87641     -42211.613     -20094.411      4609.3376      17.6144        14.9838        17.4642      
      3800   292.69348     -42205.71      -22412.541      4609.3376      17.6144        14.9838        17.4642      
      3900   288.62694     -42229.68      -13677.872      4609.3376      17.6144        14.9838        17.4642      
      4000   276.39403     -42222.087     -22123.438      4609.3376      17.6144        14.9838        17.4642      
      4100   301.42195     -42231.852     -11959.435      4609.3376      17.6144        14.9838        17.4642      
      4200   311.23596     -42228.371     -5599.0971      4609.3376      17.6144        14.9838        17.4642      
      4300   292.63283     -42218.71      -7884.5486      4609.3376      17.6144        14.9838        17.4642      
      4400   295.93024     -42248.296     -16160.588      4609.3376      17.6144        14.9838        17.4642      
      4500   301.91488     -42252.586     -13485.906      4609.3376      17.6144        14.9838        17.4642      
      4600   302.56868     -42226.36      -19821.946      4609.3376      17.6144        14.9838        17.4642      
      4700   295.29234     -42203.913     -10573.789      4609.3376      17.6144        14.9838        17.4642      
      4800   315.04493     -42229.091     -10831.362      4609.3376      17.6144        14.9838        17.4642      
      4900   311.35945     -42234.186     -10023.047      4609.3376      17.6144        14.9838        17.4642      
      5000   296.43277     -42231.693     -14929.135      4609.3376      17.6144        14.9838        17.4642      
Loop time of 189.771 on 16 procs for 5000 steps with 365 atoms

Performance: 1.138 ns/day, 21.086 hours/ns, 26.348 timesteps/s, 9.617 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 105.08     | 140.57     | 156.2      | 172.8 | 74.07
Bond    | 0.0014316  | 0.0016765  | 0.0023106  |   0.7 |  0.00
Neigh   | 8.7119     | 11.563     | 12.658     |  46.9 |  6.09
Comm    | 2.4565     | 18.097     | 53.584     | 481.5 |  9.54
Output  | 0.016609   | 0.01886    | 0.020699   |   1.0 |  0.01
Modify  | 18.312     | 19.419     | 22.294     |  36.4 | 10.23
Other   |            | 0.1034     |            |       |  0.05

Nlocal:         45.625 ave          56 max          34 min
Histogram: 1 0 0 1 0 4 1 0 0 1
Nghost:        2855.38 ave        2898 max        2809 min
Histogram: 2 0 1 0 0 1 2 0 0 2
Neighs:        25031.6 ave       30338 max       18960 min
Histogram: 1 0 0 1 1 2 1 1 0 1

Total # of neighbors = 200253
Ave neighs/atom = 548.63836
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*14.9838
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.49838 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.9 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   326.00293     -42230.984     -16821.901      4609.3376      17.6144        14.9838        17.4642      
       200   307.41907     -42207.18      -9937.8435      4609.3376      17.6144        14.9838        17.4642      
       300   304.45862     -42225.319     -14236.51       4609.3376      17.6144        14.9838        17.4642      
       400   310.5869      -42241.178     -16678.969      4609.3376      17.6144        14.9838        17.4642      
       500   298.83892     -42229.414     -20982.054      4609.3376      17.6144        14.9838        17.4642      
       600   293.59634     -42223.674     -3388.3061      4609.3376      17.6144        14.9838        17.4642      
       700   300.68567     -42218.949     -14390.633      4609.3376      17.6144        14.9838        17.4642      
       800   294.06701     -42189.554     -17033.295      4609.3376      17.6144        14.9838        17.4642      
       900   316.60474     -42200.215     -11245.377      4609.3376      17.6144        14.9838        17.4642      
      1000   311.75324     -42207.629     -14771.128      4609.3376      17.6144        14.9838        17.4642      
      1100   300.52017     -42214.701     -6385.2774      4609.3376      17.6144        14.9838        17.4642      
      1200   302.68758     -42210.789     -15789.455      4609.3376      17.6144        14.9838        17.4642      
      1300   306.23511     -42215.65      -16369.929      4609.3376      17.6144        14.9838        17.4642      
      1400   284.61283     -42211.813     -7515.7407      4609.3376      17.6144        14.9838        17.4642      
      1500   261.34891     -42207.757     -19609.493      4609.3376      17.6144        14.9838        17.4642      
      1600   305.26502     -42237.924     -4437.2116      4609.3376      17.6144        14.9838        17.4642      
      1700   299.1509      -42222.126     -8470.8609      4609.3376      17.6144        14.9838        17.4642      
      1800   306.92332     -42206.656     -7576.1289      4609.3376      17.6144        14.9838        17.4642      
      1900   329.59769     -42203.775     -13488.53       4609.3376      17.6144        14.9838        17.4642      
      2000   325.40763     -42224.318     -8474.1911      4609.3376      17.6144        14.9838        17.4642      
      2100   286.27222     -42199.472     -14081.297      4609.3376      17.6144        14.9838        17.4642      
      2200   299.07083     -42217.715     -14605.454      4609.3376      17.6144        14.9838        17.4642      
      2300   320.02394     -42244.139     -10558.887      4609.3376      17.6144        14.9838        17.4642      
      2400   303.26        -42243.896     -12511.757      4609.3376      17.6144        14.9838        17.4642      
      2500   299.94357     -42244.914      662.8299       4609.3376      17.6144        14.9838        17.4642      
      2600   290.82746     -42227.2       -15880.289      4609.3376      17.6144        14.9838        17.4642      
      2700   291.71429     -42222.132     -11879.82       4609.3376      17.6144        14.9838        17.4642      
      2800   295.79336     -42200.82      -11528.104      4609.3376      17.6144        14.9838        17.4642      
      2900   310.11707     -42177.756     -202.7437       4609.3376      17.6144        14.9838        17.4642      
      3000   313.17093     -42191.158     -8559.5406      4609.3376      17.6144        14.9838        17.4642      
      3100   304.19698     -42212.255     -18385.825      4609.3376      17.6144        14.9838        17.4642      
      3200   298.69254     -42224.391     -13063.307      4609.3376      17.6144        14.9838        17.4642      
      3300   308.87699     -42240.991     -16710.981      4609.3376      17.6144        14.9838        17.4642      
      3400   301.28378     -42248.014     -10495.354      4609.3376      17.6144        14.9838        17.4642      
      3500   298.43768     -42251.034     -14759.516      4609.3376      17.6144        14.9838        17.4642      
      3600   275.04479     -42242.233     -26984.571      4609.3376      17.6144        14.9838        17.4642      
      3700   269.62078     -42240.184     -13908.923      4609.3376      17.6144        14.9838        17.4642      
      3800   292.14928     -42231.664     -14478.054      4609.3376      17.6144        14.9838        17.4642      
      3900   303.17821     -42225.885     -8435.7481      4609.3376      17.6144        14.9838        17.4642      
      4000   297.9097      -42223.714     -13316.278      4609.3376      17.6144        14.9838        17.4642      
      4100   297.33075     -42236.518     -23101.408      4609.3376      17.6144        14.9838        17.4642      
      4200   310.05135     -42275.818     -10328.634      4609.3376      17.6144        14.9838        17.4642      
      4300   285.31956     -42263.076     -18214.034      4609.3376      17.6144        14.9838        17.4642      
      4400   287.85543     -42247.923     -10972.134      4609.3376      17.6144        14.9838        17.4642      
      4500   294.83445     -42226.596     -24706.437      4609.3376      17.6144        14.9838        17.4642      
      4600   312.54849     -42233.581     -9506.9096      4609.3376      17.6144        14.9838        17.4642      
      4700   299.22521     -42218.897     -8642.5774      4609.3376      17.6144        14.9838        17.4642      
      4800   288.78278     -42222.412     -17948.795      4609.3376      17.6144        14.9838        17.4642      
      4900   283.32301     -42238.601     -12142.527      4609.3376      17.6144        14.9838        17.4642      
      5000   294.15542     -42246.585     -12143.823      4609.3376      17.6144        14.9838        17.4642      
Loop time of 192.761 on 16 procs for 5000 steps with 365 atoms

Performance: 1.121 ns/day, 21.418 hours/ns, 25.939 timesteps/s, 9.468 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 107.4      | 143.05     | 158.6      | 152.2 | 74.21
Bond    | 0.0013951  | 0.0016626  | 0.0023616  |   0.8 |  0.00
Neigh   | 9.0971     | 11.988     | 13.081     |  39.3 |  6.22
Comm    | 2.2645     | 17.83      | 53.465     | 431.2 |  9.25
Output  | 0.016945   | 0.019435   | 0.021231   |   0.9 |  0.01
Modify  | 18.649     | 19.76      | 22.678     |  30.8 | 10.25
Other   |            | 0.1074     |            |       |  0.06

Nlocal:         45.625 ave          56 max          37 min
Histogram: 2 0 1 1 0 1 1 1 0 1
Nghost:        2884.25 ave        2925 max        2856 min
Histogram: 1 2 1 1 0 0 2 0 0 1
Neighs:        25032.9 ave       30192 max       20635 min
Histogram: 2 0 1 1 0 1 1 1 0 1

Total # of neighbors = 200263
Ave neighs/atom = 548.66575
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.4642
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--6.9346)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.4642
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.69346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.2088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.08795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.74642 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.8 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.66132     -42230.463     -16353.533      4609.3376      17.6144        14.9838        17.4642      
       200   315.05602     -42218.795     -9713.7739      4609.3376      17.6144        14.9838        17.4642      
       300   298.12712     -42223.589     -11163.985      4609.3376      17.6144        14.9838        17.4642      
       400   302.38617     -42246.941     -15125.555      4609.3376      17.6144        14.9838        17.4642      
       500   300.95179     -42239.09      -14240.057      4609.3376      17.6144        14.9838        17.4642      
       600   318.42889     -42225.872     -3959.842       4609.3376      17.6144        14.9838        17.4642      
       700   308.27304     -42198.83      -8953.9574      4609.3376      17.6144        14.9838        17.4642      
       800   301.79292     -42205.082     -9765.6732      4609.3376      17.6144        14.9838        17.4642      
       900   324.99108     -42238.246     -3395.1731      4609.3376      17.6144        14.9838        17.4642      
      1000   297.18036     -42225.745     -12300.366      4609.3376      17.6144        14.9838        17.4642      
      1100   289.31689     -42220.006     -11295.826      4609.3376      17.6144        14.9838        17.4642      
      1200   287.19505     -42215.599     -6261.8956      4609.3376      17.6144        14.9838        17.4642      
      1300   304.14139     -42209.678     -5556.5262      4609.3376      17.6144        14.9838        17.4642      
      1400   320.94547     -42208.55      -13804.496      4609.3376      17.6144        14.9838        17.4642      
      1500   303.14636     -42205.833     -3361.4835      4609.3376      17.6144        14.9838        17.4642      
      1600   305.44219     -42227.309     -16861.956      4609.3376      17.6144        14.9838        17.4642      
      1700   289.24668     -42218.029     -11212.008      4609.3376      17.6144        14.9838        17.4642      
      1800   312.241       -42236.649     -17968.885      4609.3376      17.6144        14.9838        17.4642      
      1900   301.19988     -42209.492     -16933.149      4609.3376      17.6144        14.9838        17.4642      
      2000   299.40594     -42199.704     -15544.953      4609.3376      17.6144        14.9838        17.4642      
      2100   304.56881     -42238.41      -3926.3071      4609.3376      17.6144        14.9838        17.4642      
      2200   291.82944     -42234.637     -14985.936      4609.3376      17.6144        14.9838        17.4642      
      2300   295.68925     -42215.558     -5098.2563      4609.3376      17.6144        14.9838        17.4642      
      2400   300.63166     -42192.218     -12564.916      4609.3376      17.6144        14.9838        17.4642      
      2500   312.03984     -42199.211      1456.2279      4609.3376      17.6144        14.9838        17.4642      
      2600   308.32897     -42210.894     -18545.712      4609.3376      17.6144        14.9838        17.4642      
      2700   292.60238     -42229.626     -5458.9157      4609.3376      17.6144        14.9838        17.4642      
      2800   284.15916     -42226.821     -9753.2124      4609.3376      17.6144        14.9838        17.4642      
      2900   295.16219     -42221.748     -16279.516      4609.3376      17.6144        14.9838        17.4642      
      3000   290.64741     -42195.746     -10252.624      4609.3376      17.6144        14.9838        17.4642      
      3100   297.91329     -42184.086     -25987.969      4609.3376      17.6144        14.9838        17.4642      
      3200   319.82871     -42202.265     -15280.016      4609.3376      17.6144        14.9838        17.4642      
      3300   284.91844     -42204.24      -15012.933      4609.3376      17.6144        14.9838        17.4642      
      3400   288.79278     -42210.618     -11016.747      4609.3376      17.6144        14.9838        17.4642      
      3500   318.06833     -42222.95      -21089.226      4609.3376      17.6144        14.9838        17.4642      
      3600   313.63164     -42202.145     -17175.133      4609.3376      17.6144        14.9838        17.4642      
      3700   312.41259     -42180.014     -2755.222       4609.3376      17.6144        14.9838        17.4642      
      3800   301.83179     -42188.921     -10426.221      4609.3376      17.6144        14.9838        17.4642      
      3900   302.93621     -42219.634      3734.2017      4609.3376      17.6144        14.9838        17.4642      
      4000   288.63661     -42203.872     -11373.953      4609.3376      17.6144        14.9838        17.4642      
      4100   290.31612     -42196.215     -8596.277       4609.3376      17.6144        14.9838        17.4642      
      4200   303.3147      -42191.788     -7787.9953      4609.3376      17.6144        14.9838        17.4642      
      4300   313.58171     -42192.699     -18150.158      4609.3376      17.6144        14.9838        17.4642      
      4400   305.96652     -42197.794     -12261.473      4609.3376      17.6144        14.9838        17.4642      
      4500   304.12247     -42220.769     -14255.078      4609.3376      17.6144        14.9838        17.4642      
      4600   285.77366     -42191.438      325.82638      4609.3376      17.6144        14.9838        17.4642      
      4700   294.50702     -42179.932     -8984.9472      4609.3376      17.6144        14.9838        17.4642      
      4800   292.55375     -42141.965     -1955.1544      4609.3376      17.6144        14.9838        17.4642      
      4900   310.90535     -42149.92      -23289.079      4609.3376      17.6144        14.9838        17.4642      
      5000   292.06037     -42160.41      -59.025109      4609.3376      17.6144        14.9838        17.4642      
Loop time of 196.102 on 16 procs for 5000 steps with 365 atoms

Performance: 1.101 ns/day, 21.789 hours/ns, 25.497 timesteps/s, 9.306 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 105.2      | 146.32     | 160.91     | 162.9 | 74.61
Bond    | 0.001357   | 0.0016786  | 0.0023471  |   0.8 |  0.00
Neigh   | 9.3313     | 12.388     | 13.372     |  41.8 |  6.32
Comm    | 2.5464     | 17.146     | 58.27      | 475.7 |  8.74
Output  | 0.016758   | 0.019022   | 0.02089    |   1.0 |  0.01
Modify  | 19.128     | 20.125     | 23.189     |  33.0 | 10.26
Other   |            | 0.1079     |            |       |  0.06

Nlocal:         45.625 ave          58 max          38 min
Histogram: 3 0 0 1 0 2 0 1 0 1
Nghost:         2998.5 ave        3031 max        2950 min
Histogram: 1 0 0 1 1 1 1 0 2 1
Neighs:        25000.5 ave       31442 max       20969 min
Histogram: 3 0 0 1 0 2 1 0 0 1

Total # of neighbors = 200004
Ave neighs/atom = 547.95616
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.4642
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.74642 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.9 | 113.6 | 114.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   303.20468     -42216.46      -7019.8004      4609.3376      17.6144        14.9838        17.4642      
       100   325.73577     -42230.298     -16211.324      4609.3376      17.6144        14.9838        17.4642      
       200   305.78067     -42210.676     -8896.2843      4609.3376      17.6144        14.9838        17.4642      
       300   299.07319     -42225.362     -18445.081      4609.3376      17.6144        14.9838        17.4642      
       400   296.26679     -42240.141     -832.36739      4609.3376      17.6144        14.9838        17.4642      
       500   291.70644     -42230.511     -11322.656      4609.3376      17.6144        14.9838        17.4642      
       600   316.77401     -42226.264     -21295.154      4609.3376      17.6144        14.9838        17.4642      
       700   320.32964     -42205.168     -14729.609      4609.3376      17.6144        14.9838        17.4642      
       800   325.96278     -42228.875     -11389.929      4609.3376      17.6144        14.9838        17.4642      
       900   311.95132     -42233.416     -11240.501      4609.3376      17.6144        14.9838        17.4642      
      1000   305.3393      -42239.534     -20114.335      4609.3376      17.6144        14.9838        17.4642      
      1100   295.92377     -42228.476      60.309815      4609.3376      17.6144        14.9838        17.4642      
      1200   287.53978     -42231.568     -7677.0357      4609.3376      17.6144        14.9838        17.4642      
      1300   292.09787     -42260.067     -10714.808      4609.3376      17.6144        14.9838        17.4642      
      1400   285.98281     -42247.764     -8880.3467      4609.3376      17.6144        14.9838        17.4642      
      1500   301.23987     -42227.598      208.23757      4609.3376      17.6144        14.9838        17.4642      
      1600   311.83134     -42224.43      -22473.826      4609.3376      17.6144        14.9838        17.4642      
      1700   292.36736     -42215.889     -13560.949      4609.3376      17.6144        14.9838        17.4642      
      1800   291.32912     -42237.138     -22699.92       4609.3376      17.6144        14.9838        17.4642      
      1900   310.34906     -42257.082     -5003.6186      4609.3376      17.6144        14.9838        17.4642      
      2000   300.10688     -42242.67      -6628.6818      4609.3376      17.6144        14.9838        17.4642      
      2100   295.36656     -42229.387     -6529.4775      4609.3376      17.6144        14.9838        17.4642      
      2200   288.31852     -42211.462     -8866.3689      4609.3376      17.6144        14.9838        17.4642      
      2300   322.48179     -42243.57      -9794.2758      4609.3376      17.6144        14.9838        17.4642      
      2400   301.40362     -42229.137     -7201.9363      4609.3376      17.6144        14.9838        17.4642      
      2500   287.23967     -42213.2       -20167.652      4609.3376      17.6144        14.9838        17.4642      
      2600   303.2654      -42230.746     -9803.1693      4609.3376      17.6144        14.9838        17.4642      
      2700   300.73784     -42237.846     -10501.544      4609.3376      17.6144        14.9838        17.4642      
      2800   275.459       -42234.846     -24452.66       4609.3376      17.6144        14.9838        17.4642      
      2900   280.59211     -42245.634     -10777.734      4609.3376      17.6144        14.9838        17.4642      
      3000   290.01613     -42234.621     -4842.4503      4609.3376      17.6144        14.9838        17.4642      
      3100   302.06204     -42220.334     -4404.3548      4609.3376      17.6144        14.9838        17.4642      
      3200   288.20311     -42199.112     -2172.4808      4609.3376      17.6144        14.9838        17.4642      
      3300   312.31334     -42217.292     -2680.0071      4609.3376      17.6144        14.9838        17.4642      
      3400   300.98479     -42220.61      -11184.865      4609.3376      17.6144        14.9838        17.4642      
      3500   283.60202     -42232.406     -15092.352      4609.3376      17.6144        14.9838        17.4642      
      3600   290.17871     -42228.125     -17759.004      4609.3376      17.6144        14.9838        17.4642      
      3700   304.00735     -42216.831     -9272.9429      4609.3376      17.6144        14.9838        17.4642      
      3800   323.34287     -42224.37      -11570.661      4609.3376      17.6144        14.9838        17.4642      
      3900   325.9948      -42229.631     -10286.169      4609.3376      17.6144        14.9838        17.4642      
      4000   293.8801      -42233.106      730.89522      4609.3376      17.6144        14.9838        17.4642      
      4100   301.88026     -42243.773     -8792.4356      4609.3376      17.6144        14.9838        17.4642      
      4200   306.83624     -42232.2       -9765.4966      4609.3376      17.6144        14.9838        17.4642      
      4300   321.78971     -42230.518     -3765.2613      4609.3376      17.6144        14.9838        17.4642      
      4400   304.77258     -42201.443     -6344.5833      4609.3376      17.6144        14.9838        17.4642      
      4500   292.24837     -42210.954     -19340.104      4609.3376      17.6144        14.9838        17.4642      
      4600   290.0189      -42223.408     -3022.2908      4609.3376      17.6144        14.9838        17.4642      
      4700   294.33402     -42217.263     -15172.455      4609.3376      17.6144        14.9838        17.4642      
      4800   324.83905     -42226.291     -18101.85       4609.3376      17.6144        14.9838        17.4642      
      4900   304.16772     -42189.902     -3358.2872      4609.3376      17.6144        14.9838        17.4642      
      5000   331.84291     -42214.051     -12230.793      4609.3376      17.6144        14.9838        17.4642      
Loop time of 189.943 on 16 procs for 5000 steps with 365 atoms

Performance: 1.137 ns/day, 21.105 hours/ns, 26.324 timesteps/s, 9.608 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 100.66     | 137.65     | 156.22     | 174.3 | 72.47
Bond    | 0.0014218  | 0.0016803  | 0.0022032  |   0.6 |  0.00
Neigh   | 8.6443     | 11.152     | 12.435     |  44.3 |  5.87
Comm    | 2.4804     | 21.064     | 58.043     | 445.6 | 11.09
Output  | 0.017446   | 0.019726   | 0.021841   |   1.0 |  0.01
Modify  | 18.679     | 19.953     | 22.472     |  33.2 | 10.50
Other   |            | 0.1023     |            |       |  0.05

Nlocal:         45.625 ave          58 max          39 min
Histogram: 2 0 3 0 1 1 0 0 0 1
Nghost:        2776.25 ave        2818 max        2746 min
Histogram: 2 1 0 0 2 1 0 1 0 1
Neighs:          25039 ave       31249 max       21610 min
Histogram: 2 0 3 0 1 1 0 0 0 1

Total # of neighbors = 200312
Ave neighs/atom = 548.8
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:41:49
