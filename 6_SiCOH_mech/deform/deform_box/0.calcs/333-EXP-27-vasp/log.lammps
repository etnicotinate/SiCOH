LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

variable FF string "CHONSi.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333-EXP-27-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333-EXP-27-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 117.7 | 119.4 | 120.8 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -32892.733      0             -32892.733      83490.824    
        98   0             -34213.919      0             -34213.919      656.42562    
Loop time of 12.2085 on 16 procs for 98 steps with 295 atoms

97.5% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -32892.7325831185  -34213.9166879802  -34213.9187824634
  Force two-norm initial, final = 1689.2992 128.81967
  Force max component initial, final = 238.14146 65.600667
  Final line search alpha, max atom move = 0.00082787258 0.054308993
  Iterations, force evaluations = 98 317

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 8.2732     | 8.9825     | 9.594      |  14.5 | 73.58
Bond    | 0.00017035 | 0.00018095 | 0.0001962  |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.56527    | 1.1749     | 1.8847     |  40.1 |  9.62
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 2.0325     | 2.0333     | 2.0339     |   0.0 | 16.65
Other   |            | 0.01761    |            |       |  0.14

Nlocal:         36.875 ave          42 max          32 min
Histogram: 1 0 1 1 1 0 1 2 0 1
Nghost:         2987.5 ave        3016 max        2961 min
Histogram: 2 0 1 1 0 0 1 1 1 1
Neighs:        22518.1 ave       25367 max       19741 min
Histogram: 1 0 1 1 1 1 0 2 0 1

Total # of neighbors = 180145
Ave neighs/atom = 610.66102
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-27-vasp_opt.data
System init for write_data ...
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.1 | 117.3 | 119.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -34213.919      4191.0133      1.5382232      3400.2575    
       100   250.32682     -34137.574      3237.8525      1.5382232      3400.2575    
       200   297.58004     -34133.467     -6244.9334      1.5382232      3400.2575    
       300   337.09224     -34140.364      2291.952       1.5382232      3400.2575    
       400   307.63546     -34143.01       1958.3914      1.5382232      3400.2575    
       500   295.85189     -34170.158     -10075.803      1.5382232      3400.2575    
       600   289.26223     -34188.397      5400.6099      1.5382232      3400.2575    
       700   298.6598      -34215.589      3288.7501      1.5382232      3400.2575    
       800   300.82249     -34223.243     -6674.4879      1.5382232      3400.2575    
       900   303.69007     -34230.962      4215.9905      1.5382232      3400.2575    
      1000   295.71835     -34229.76      -5209.466       1.5382232      3400.2575    
      1100   305.53311     -34245.984     -8782.2458      1.5382232      3400.2575    
      1200   294.41396     -34261.511     -8313.3251      1.5382232      3400.2575    
      1300   277.1445      -34256.13      -5792.135       1.5382232      3400.2575    
      1400   297.36696     -34255.262     -11962.579      1.5382232      3400.2575    
      1500   313.37561     -34246.281      4183.148       1.5382232      3400.2575    
      1600   303.41613     -34238.553     -11049.8        1.5382232      3400.2575    
      1700   314.43671     -34253.661     -5226.1733      1.5382232      3400.2575    
      1800   276.70429     -34238.593     -15551.648      1.5382232      3400.2575    
      1900   288.51644     -34264.593     -15157.364      1.5382232      3400.2575    
      2000   279.90578     -34275.713      4864.6905      1.5382232      3400.2575    
      2100   279.68863     -34276.684     -5572.6999      1.5382232      3400.2575    
      2200   312.06483     -34271.806     -6697.4355      1.5382232      3400.2575    
      2300   316.02771     -34262.944     -2510.3459      1.5382232      3400.2575    
      2400   316.0791      -34261.504     -6195.3351      1.5382232      3400.2575    
      2500   324.66335     -34279.988     -5424.363       1.5382232      3400.2575    
      2600   305.13729     -34295.153     -6474.5136      1.5382232      3400.2575    
      2700   286.83678     -34286.172      3348.7518      1.5382232      3400.2575    
      2800   301.51575     -34285.044      680.36073      1.5382232      3400.2575    
      2900   313.60355     -34273.788      4582.9068      1.5382232      3400.2575    
      3000   320.5542      -34282.257     -5661.5339      1.5382232      3400.2575    
      3100   292.86269     -34272.536      1425.5998      1.5382232      3400.2575    
      3200   306.90941     -34295.296     -3690.0787      1.5382232      3400.2575    
      3300   282.82463     -34287.719      9509.0015      1.5382232      3400.2575    
      3400   299.58012     -34292.452     -5052.5302      1.5382232      3400.2575    
      3500   316.81161     -34274.151     -5347.1832      1.5382232      3400.2575    
      3600   297.09052     -34260.199      8105.3498      1.5382232      3400.2575    
      3700   295.50664     -34287.283      14718.259      1.5382232      3400.2575    
      3800   309.81838     -34312.116     -6541.0173      1.5382232      3400.2575    
      3900   301.94241     -34308.232     -3339.0083      1.5382232      3400.2575    
      4000   294.83277     -34286.845     -178.16798      1.5382232      3400.2575    
      4100   318.97672     -34279.144     -11485.588      1.5382232      3400.2575    
      4200   306.01731     -34275.021     -10888.984      1.5382232      3400.2575    
      4300   315.39709     -34300.473     -7456.6222      1.5382232      3400.2575    
      4400   295.51227     -34293.872     -9991.6104      1.5382232      3400.2575    
      4500   300.46824     -34307.602      4738.1735      1.5382232      3400.2575    
      4600   307.61384     -34304.08      -1415.7328      1.5382232      3400.2575    
      4700   330.01709     -34293.225     -7263.3747      1.5382232      3400.2575    
      4800   296.52252     -34265.883     -7187.6504      1.5382232      3400.2575    
      4900   302.92021     -34298.768     -3684.7404      1.5382232      3400.2575    
      5000   290.02496     -34300.166      592.3722       1.5382232      3400.2575    
Loop time of 219.098 on 16 procs for 5000 steps with 295 atoms

Performance: 0.986 ns/day, 24.344 hours/ns, 22.821 timesteps/s, 6.732 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.78     | 164.08     | 169.91     |  30.0 | 74.89
Bond    | 0.0016774  | 0.0018791  | 0.0021158  |   0.3 |  0.00
Neigh   | 13.427     | 13.544     | 13.72      |   2.8 |  6.18
Comm    | 15.601     | 21.251     | 27.605     |  82.3 |  9.70
Output  | 0.0031319  | 0.0037192  | 0.0077009  |   2.5 |  0.00
Modify  | 19.044     | 19.26      | 19.363     |   2.1 |  8.79
Other   |            | 0.956      |            |       |  0.44

Nlocal:         36.875 ave          43 max          31 min
Histogram: 2 1 0 0 0 2 0 1 1 1
Nghost:           2982 ave        3015 max        2945 min
Histogram: 2 0 0 0 2 0 1 1 0 2
Neighs:        22471.1 ave       26155 max       18996 min
Histogram: 2 1 0 0 0 2 0 2 0 1

Total # of neighbors = 179769
Ave neighs/atom = 609.38644
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-27-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.1447
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.6088
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.498

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.5805
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.6366
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.6974

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.1447
variable dlen equal lx-${len0}
variable dlen equal lx-15.1447
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.1447
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.76974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.06366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.05805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.51447 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.51447 xy delta 0.76974 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.51447 xy delta 0.76974 xz delta 0.06366 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.97454     -34284.661      6500.8117      3393.457       15.114411      13.6088        16.498       
       200   311.21931     -34287.772     -1540.248       3386.6565      15.084121      13.6088        16.498       
       300   312.97118     -34291.496      7626.8625      3379.8559      15.053832      13.6088        16.498       
       400   282.96334     -34285.881     -13315.965      3373.0554      15.023542      13.6088        16.498       
       500   300.31701     -34305.647     -6499.8095      3366.2549      14.993253      13.6088        16.498       
       600   297.05922     -34299.887     -3233.6053      3359.4544      14.962964      13.6088        16.498       
       700   312.02759     -34316.591     -3269.5221      3352.6539      14.932674      13.6088        16.498       
       800   294.57224     -34322.581      5491.0181      3345.8534      14.902385      13.6088        16.498       
       900   291.4828      -34325.691      275.94616      3339.0529      14.872095      13.6088        16.498       
      1000   269.44155     -34292.16      -9698.4892      3332.2523      14.841806      13.6088        16.498       
      1100   301.02997     -34299.986      1383.8884      3325.4518      14.811517      13.6088        16.498       
      1200   330.45813     -34324.756      4896.4379      3318.6513      14.781227      13.6088        16.498       
      1300   322.36161     -34319.03       5964.5292      3311.8508      14.750938      13.6088        16.498       
      1400   314.11952     -34315.015      1013.6434      3305.0503      14.720648      13.6088        16.498       
      1500   280.6198      -34295.052     -1636.6861      3298.2498      14.690359      13.6088        16.498       
      1600   289.70536     -34298.198      11858.688      3291.4492      14.66007       13.6088        16.498       
      1700   290.4151      -34295.647      7962.1871      3284.6487      14.62978       13.6088        16.498       
      1800   283.1726      -34285.413      2784.5612      3277.8482      14.599491      13.6088        16.498       
      1900   297.37671     -34305.349      6236.5335      3271.0477      14.569201      13.6088        16.498       
      2000   287.9134      -34308.68      -1293.4982      3264.2472      14.538912      13.6088        16.498       
      2100   297.98348     -34315.846      10869.545      3257.4467      14.508623      13.6088        16.498       
      2200   320.47166     -34296.477     -3794.9668      3250.6462      14.478333      13.6088        16.498       
      2300   322.77482     -34274.82       7943.858       3243.8456      14.448044      13.6088        16.498       
      2400   306.03393     -34271.944      2604.1336      3237.0451      14.417754      13.6088        16.498       
      2500   325.46918     -34289.473      8893.0841      3230.2446      14.387465      13.6088        16.498       
      2600   318.64987     -34299.242      3303.442       3223.4441      14.357176      13.6088        16.498       
      2700   302.63508     -34289.693      4998.8816      3216.6436      14.326886      13.6088        16.498       
      2800   291.23085     -34290.308      4499.5111      3209.8431      14.296597      13.6088        16.498       
      2900   281.71436     -34290.897      2144.8561      3203.0426      14.266307      13.6088        16.498       
      3000   274.71631     -34305.058      13670.897      3196.242       14.236018      13.6088        16.498       
      3100   268.95545     -34305.863      6211.9276      3189.4415      14.205729      13.6088        16.498       
      3200   285.95428     -34295.72      -1047.5189      3182.641       14.175439      13.6088        16.498       
      3300   317.39923     -34307.217      11293.975      3175.8405      14.14515       13.6088        16.498       
      3400   298.4273      -34272.486     -2637.7501      3169.04        14.11486       13.6088        16.498       
      3500   307.93644     -34275.143     -1176.416       3162.2395      14.084571      13.6088        16.498       
      3600   300.41802     -34290.751      13669.484      3155.4389      14.054282      13.6088        16.498       
      3700   320.02911     -34312.082      13548.499      3148.6384      14.023992      13.6088        16.498       
      3800   304.72225     -34300.264      21005.145      3141.8379      13.993703      13.6088        16.498       
      3900   288.44284     -34276.934      11656.599      3135.0374      13.963413      13.6088        16.498       
      4000   334.375       -34283.517      18074.241      3128.2369      13.933124      13.6088        16.498       
      4100   329.17092     -34255.138      1911.5568      3121.4364      13.902835      13.6088        16.498       
      4200   303.24403     -34264.847      13777.956      3114.6359      13.872545      13.6088        16.498       
      4300   290.61365     -34272.084      7399.8738      3107.8353      13.842256      13.6088        16.498       
      4400   294.91882     -34288.464      14407.589      3101.0348      13.811966      13.6088        16.498       
      4500   276.43045     -34277.669      23371.093      3094.2343      13.781677      13.6088        16.498       
      4600   289.05287     -34279.5        10162.432      3087.4338      13.751388      13.6088        16.498       
      4700   282.65677     -34277.14       17177.542      3080.6333      13.721098      13.6088        16.498       
      4800   283.68628     -34278.353      5853.0457      3073.8328      13.690809      13.6088        16.498       
      4900   304.41086     -34315.83      -5617.298       3067.0323      13.660519      13.6088        16.498       
      5000   283.48576     -34300.221      27494.848      3060.2317      13.63023       13.6088        16.498       
Loop time of 236.573 on 16 procs for 5000 steps with 295 atoms

Performance: 0.913 ns/day, 26.286 hours/ns, 21.135 timesteps/s, 6.235 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 172.62     | 179.38     | 184.2      |  30.8 | 75.82
Bond    | 0.0016912  | 0.0019251  | 0.0021166  |   0.3 |  0.00
Neigh   | 13.939     | 14.288     | 14.564     |   5.2 |  6.04
Comm    | 16.379     | 21.2       | 27.992     |  89.6 |  8.96
Output  | 0.027463   | 0.032213   | 0.036866   |   1.9 |  0.01
Modify  | 20.482     | 20.735     | 21.077     |   4.2 |  8.76
Other   |            | 0.9347     |            |       |  0.40

Nlocal:         36.875 ave          41 max          28 min
Histogram: 1 0 0 1 0 0 1 1 1 3
Nghost:           3194 ave        3213 max        3182 min
Histogram: 2 0 2 1 0 0 2 0 0 1
Neighs:        24955.4 ave       27787 max       19100 min
Histogram: 1 0 1 0 0 0 1 1 1 3

Total # of neighbors = 199643
Ave neighs/atom = 676.75593
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.1447
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.51447 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.51447 xy delta -0.76974 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.51447 xy delta -0.76974 xz delta -0.06366 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.14073     -34284.044      6307.4024      3407.058       15.174989      13.6088        16.498       
       200   314.44205     -34288.936     -5485.8678      3413.8585      15.205279      13.6088        16.498       
       300   310.09468     -34288.931     -4184.6226      3420.659       15.235568      13.6088        16.498       
       400   280.83161     -34292.038     -13153.234      3427.4595      15.265858      13.6088        16.498       
       500   288.50375     -34302.024     -6613.8454      3434.2601      15.296147      13.6088        16.498       
       600   289.39005     -34290.668     -4574.6306      3441.0606      15.326436      13.6088        16.498       
       700   323.75047     -34304.703      1540.99        3447.8611      15.356726      13.6088        16.498       
       800   304.42843     -34281.22      -18715.094      3454.6616      15.387015      13.6088        16.498       
       900   291.92365     -34300.823     -25361.245      3461.4621      15.417305      13.6088        16.498       
      1000   286.46617     -34300.581     -15976.35       3468.2626      15.447594      13.6088        16.498       
      1100   283.45509     -34285.705     -6405.707       3475.0632      15.477883      13.6088        16.498       
      1200   320.05365     -34289.992     -18690.288      3481.8637      15.508173      13.6088        16.498       
      1300   304.79551     -34262.662      776.8492       3488.6642      15.538462      13.6088        16.498       
      1400   299.46745     -34267.437     -19227.068      3495.4647      15.568752      13.6088        16.498       
      1500   289.41426     -34293.309     -8486.845       3502.2652      15.599041      13.6088        16.498       
      1600   297.27635     -34297.775     -8838.9942      3509.0657      15.62933       13.6088        16.498       
      1700   299.08268     -34284.208     -22507.794      3515.8662      15.65962       13.6088        16.498       
      1800   300.84652     -34269.968     -6514.1504      3522.6668      15.689909      13.6088        16.498       
      1900   305.78835     -34252.958     -13242.005      3529.4673      15.720199      13.6088        16.498       
      2000   332.77219     -34266.206     -3860.0189      3536.2678      15.750488      13.6088        16.498       
      2100   306.11303     -34273.323     -6754.1698      3543.0683      15.780777      13.6088        16.498       
      2200   283.55387     -34260.839     -11158.888      3549.8688      15.811067      13.6088        16.498       
      2300   296.83316     -34258.444     -18577.626      3556.6693      15.841356      13.6088        16.498       
      2400   297.07595     -34233.245     -13672.827      3563.4698      15.871646      13.6088        16.498       
      2500   311.1457      -34244.906     -8949.6808      3570.2704      15.901935      13.6088        16.498       
      2600   299.33901     -34267.356     -14616.199      3577.0709      15.932224      13.6088        16.498       
      2700   276.59493     -34251.337     -10152.776      3583.8714      15.962514      13.6088        16.498       
      2800   299.41557     -34257.654     -5115.6017      3590.6719      15.992803      13.6088        16.498       
      2900   314.53399     -34253.848     -10728.912      3597.4724      16.023093      13.6088        16.498       
      3000   295.02344     -34243.858     -13196.513      3604.2729      16.053382      13.6088        16.498       
      3100   282.58665     -34256.843     -11475.979      3611.0735      16.083671      13.6088        16.498       
      3200   291.41197     -34262.299     -14155.823      3617.874       16.113961      13.6088        16.498       
      3300   304.94071     -34255.107     -12544.629      3624.6745      16.14425       13.6088        16.498       
      3400   319.13889     -34256.149     -18704.066      3631.475       16.17454       13.6088        16.498       
      3500   316.21682     -34262.368     -12493.77       3638.2755      16.204829      13.6088        16.498       
      3600   279.44792     -34247.821     -11187.191      3645.076       16.235118      13.6088        16.498       
      3700   290.08237     -34257.016     -13408.032      3651.8765      16.265408      13.6088        16.498       
      3800   308.19511     -34253.435     -22447.421      3658.6771      16.295697      13.6088        16.498       
      3900   308.96659     -34235.863     -4411.8453      3665.4776      16.325987      13.6088        16.498       
      4000   303.40484     -34231.016     -24933.269      3672.2781      16.356276      13.6088        16.498       
      4100   293.8758      -34248.344     -18650.163      3679.0786      16.386565      13.6088        16.498       
      4200   276.28128     -34233.532     -1283.8593      3685.8791      16.416855      13.6088        16.498       
      4300   291.91651     -34224.685     -23975.155      3692.6796      16.447144      13.6088        16.498       
      4400   329.66322     -34235.668     -16772.59       3699.4801      16.477434      13.6088        16.498       
      4500   315.57928     -34236.989     -23262.741      3706.2807      16.507723      13.6088        16.498       
      4600   310.72984     -34244.373     -11400.248      3713.0812      16.538012      13.6088        16.498       
      4700   286.50127     -34228.218     -5127.1731      3719.8817      16.568302      13.6088        16.498       
      4800   312.64076     -34238.163     -4298.4871      3726.6822      16.598591      13.6088        16.498       
      4900   313.86358     -34205.131     -17914.913      3733.4827      16.628881      13.6088        16.498       
      5000   320.83336     -34203.047     -13013.797      3740.2832      16.65917       13.6088        16.498       
Loop time of 206.909 on 16 procs for 5000 steps with 295 atoms

Performance: 1.044 ns/day, 22.990 hours/ns, 24.165 timesteps/s, 7.129 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 150.66     | 155.44     | 161.68     |  26.9 | 75.12
Bond    | 0.0017289  | 0.001927   | 0.0022354  |   0.4 |  0.00
Neigh   | 11.41      | 11.61      | 11.761     |   3.9 |  5.61
Comm    | 13.952     | 19.998     | 24.744     |  74.4 |  9.67
Output  | 0.031942   | 0.046816   | 0.06198    |   5.0 |  0.02
Modify  | 18.596     | 18.869     | 19.047     |   3.6 |  9.12
Other   |            | 0.9437     |            |       |  0.46

Nlocal:         36.875 ave          41 max          32 min
Histogram: 1 1 0 1 0 1 1 1 1 1
Nghost:        2791.75 ave        2845 max        2741 min
Histogram: 1 2 0 1 0 1 0 1 1 1
Neighs:        20393.5 ave       22504 max       17788 min
Histogram: 1 1 0 1 0 1 0 1 1 2

Total # of neighbors = 163148
Ave neighs/atom = 553.04407
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.6088
variable dlen equal ly-${len0}
variable dlen equal ly-13.6088
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.6088
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.76974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.06366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.05805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.36088 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.36088 yz delta -0.05805 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.85517     -34284.427      6454.0196      3393.457       15.1447        13.581582      16.498       
       200   314.56356     -34291.211     -5976.7427      3386.6565      15.1447        13.554365      16.498       
       300   310.08182     -34290.932     -723.82209      3379.8559      15.1447        13.527147      16.498       
       400   278.95738     -34291.317     -13765.863      3373.0554      15.1447        13.49993       16.498       
       500   299.40811     -34312.467     -5873.8617      3366.2549      15.1447        13.472712      16.498       
       600   297.4316      -34300.623     -7234.0135      3359.4544      15.1447        13.445494      16.498       
       700   298.00275     -34289.737     -2114.752       3352.6539      15.1447        13.418277      16.498       
       800   316.48033     -34299.909     -5418.8884      3345.8534      15.1447        13.391059      16.498       
       900   291.1041      -34296.107     -1396.6105      3339.0529      15.1447        13.363842      16.498       
      1000   282.85307     -34305.92      -2989.8299      3332.2523      15.1447        13.336624      16.498       
      1100   283.97631     -34304.235     -9876.9695      3325.4518      15.1447        13.309406      16.498       
      1200   313.22811     -34317.782      5534.5295      3318.6513      15.1447        13.282189      16.498       
      1300   315.10071     -34298.673      14238.151      3311.8508      15.1447        13.254971      16.498       
      1400   298.08563     -34266.573     -17567.524      3305.0503      15.1447        13.227754      16.498       
      1500   298.30889     -34290.106      13731.232      3298.2498      15.1447        13.200536      16.498       
      1600   286.81537     -34295.406      6960.5922      3291.4492      15.1447        13.173318      16.498       
      1700   295.71467     -34304.04      -3227.3525      3284.6487      15.1447        13.146101      16.498       
      1800   313.03558     -34318.55       903.11443      3277.8482      15.1447        13.118883      16.498       
      1900   285.54349     -34315.811      1628.4288      3271.0477      15.1447        13.091666      16.498       
      2000   307.47169     -34332.542      6519.5153      3264.2472      15.1447        13.064448      16.498       
      2100   302.72566     -34316.943     -842.02796      3257.4467      15.1447        13.03723       16.498       
      2200   296.2883      -34308.276     -5235.7489      3250.6462      15.1447        13.010013      16.498       
      2300   317.37683     -34319.872      766.78484      3243.8456      15.1447        12.982795      16.498       
      2400   337.03242     -34325.537      3837.5173      3237.0451      15.1447        12.955578      16.498       
      2500   293.29691     -34306.993      12428.596      3230.2446      15.1447        12.92836       16.498       
      2600   299.447       -34329.798     -2340.8383      3223.4441      15.1447        12.901142      16.498       
      2700   286.48342     -34323.423      3916.9174      3216.6436      15.1447        12.873925      16.498       
      2800   282.63113     -34329.227      2171.45        3209.8431      15.1447        12.846707      16.498       
      2900   297.31803     -34325.429      19047.517      3203.0426      15.1447        12.81949       16.498       
      3000   317.04198     -34302.196      16205.78       3196.242       15.1447        12.792272      16.498       
      3100   306.62339     -34283.264      5015.3087      3189.4415      15.1447        12.765054      16.498       
      3200   295.59363     -34286.603      9391.784       3182.641       15.1447        12.737837      16.498       
      3300   320.31791     -34321.365      5780.7925      3175.8405      15.1447        12.710619      16.498       
      3400   301.627       -34315.129     -9247.7934      3169.04        15.1447        12.683402      16.498       
      3500   288.9953      -34320.048      17651.059      3162.2395      15.1447        12.656184      16.498       
      3600   264.46376     -34295.823      6306.6669      3155.4389      15.1447        12.628966      16.498       
      3700   306.61731     -34323.504      2080.9098      3148.6384      15.1447        12.601749      16.498       
      3800   309.73889     -34291.618     -6284.2394      3141.8379      15.1447        12.574531      16.498       
      3900   322.10982     -34294.153     -3383.1252      3135.0374      15.1447        12.547314      16.498       
      4000   326.47969     -34324.161      9298.7199      3128.2369      15.1447        12.520096      16.498       
      4100   303.40595     -34315.422      1687.1099      3121.4364      15.1447        12.492878      16.498       
      4200   277.79004     -34298.05       13078.408      3114.6359      15.1447        12.465661      16.498       
      4300   292.88044     -34299.967      2241.8601      3107.8353      15.1447        12.438443      16.498       
      4400   319.41285     -34309.186      1542.8213      3101.0348      15.1447        12.411226      16.498       
      4500   330.41269     -34318.166      21575.225      3094.2343      15.1447        12.384008      16.498       
      4600   298.83454     -34319.934      7655.3287      3087.4338      15.1447        12.35679       16.498       
      4700   306.36408     -34334.05       17212.989      3080.6333      15.1447        12.329573      16.498       
      4800   275.56288     -34318.182      13580.267      3073.8328      15.1447        12.302355      16.498       
      4900   280.86665     -34320.261      14096.197      3067.0323      15.1447        12.275138      16.498       
      5000   297.54703     -34322.715      4581.0136      3060.2317      15.1447        12.24792       16.498       
Loop time of 239.257 on 16 procs for 5000 steps with 295 atoms

Performance: 0.903 ns/day, 26.584 hours/ns, 20.898 timesteps/s, 6.165 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 174.95     | 180.84     | 186.91     |  33.6 | 75.58
Bond    | 0.0017182  | 0.0019111  | 0.0020924  |   0.3 |  0.00
Neigh   | 14.424     | 14.735     | 14.887     |   3.7 |  6.16
Comm    | 16.056     | 22.098     | 27.853     |  95.5 |  9.24
Output  | 0.030111   | 0.03519    | 0.040227   |   1.9 |  0.01
Modify  | 20.421     | 20.563     | 20.778     |   2.6 |  8.59
Other   |            | 0.9891     |            |       |  0.41

Nlocal:         36.875 ave          42 max          31 min
Histogram: 1 0 0 1 1 2 1 1 0 1
Nghost:        3323.38 ave        3369 max        3274 min
Histogram: 2 0 1 0 1 0 0 2 0 2
Neighs:        24970.4 ave       28402 max       20985 min
Histogram: 1 0 0 1 1 2 1 1 0 1

Total # of neighbors = 199763
Ave neighs/atom = 677.16271
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.6088
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.36088 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.36088 yz delta 0.05805 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.42442     -34284.2        6283.1667      3407.058       15.1447        13.636018      16.498       
       200   312.12794     -34288.609     -594.94287      3413.8585      15.1447        13.663235      16.498       
       300   300.96482     -34280.328     -9578.9805      3420.659       15.1447        13.690453      16.498       
       400   279.7921      -34284.236     -17614.598      3427.4595      15.1447        13.71767       16.498       
       500   296.72706     -34305.85      -2484.979       3434.2601      15.1447        13.744888      16.498       
       600   280.66223     -34285.041     -2985.967       3441.0606      15.1447        13.772106      16.498       
       700   312.70828     -34297.022     -126.15245      3447.8611      15.1447        13.799323      16.498       
       800   308.90206     -34271.695     -20500.834      3454.6616      15.1447        13.826541      16.498       
       900   323.68558     -34252.85      -18942.303      3461.4621      15.1447        13.853758      16.498       
      1000   302.53976     -34244.542     -13076.094      3468.2626      15.1447        13.880976      16.498       
      1100   299.96458     -34267.619     -2677.9942      3475.0632      15.1447        13.908194      16.498       
      1200   305.87459     -34280.164     -9697.365       3481.8637      15.1447        13.935411      16.498       
      1300   308.24277     -34292.614     -12301.23       3488.6642      15.1447        13.962629      16.498       
      1400   300.34567     -34300.257     -7003.2343      3495.4647      15.1447        13.989846      16.498       
      1500   285.86759     -34288.632     -3764.1917      3502.2652      15.1447        14.017064      16.498       
      1600   324.45286     -34294.058     -24842.008      3509.0657      15.1447        14.044282      16.498       
      1700   316.84931     -34258.132     -16349.831      3515.8662      15.1447        14.071499      16.498       
      1800   295.95269     -34248.038     -3393.5119      3522.6668      15.1447        14.098717      16.498       
      1900   299.86476     -34267.73      -23014.5        3529.4673      15.1447        14.125934      16.498       
      2000   311.54155     -34278.264     -19677.458      3536.2678      15.1447        14.153152      16.498       
      2100   311.29219     -34278.191     -2820.7157      3543.0683      15.1447        14.18037       16.498       
      2200   298.239       -34269.785     -19879.6        3549.8688      15.1447        14.207587      16.498       
      2300   288.27765     -34286.832     -10591.507      3556.6693      15.1447        14.234805      16.498       
      2400   285.4275      -34280.981     -1936.1585      3563.4698      15.1447        14.262022      16.498       
      2500   276.00202     -34253.555     -25964.511      3570.2704      15.1447        14.28924       16.498       
      2600   280.47657     -34234.397     -10964.619      3577.0709      15.1447        14.316458      16.498       
      2700   293.60525     -34233.258     -10015.121      3583.8714      15.1447        14.343675      16.498       
      2800   327.60217     -34254.539     -10651.561      3590.6719      15.1447        14.370893      16.498       
      2900   281.42536     -34238.579     -20579.778      3597.4724      15.1447        14.39811       16.498       
      3000   265.733       -34237.948     -10506.349      3604.2729      15.1447        14.425328      16.498       
      3100   303.51503     -34262.231     -8595.3485      3611.0735      15.1447        14.452546      16.498       
      3200   288.23645     -34236.999     -11910.242      3617.874       15.1447        14.479763      16.498       
      3300   321.24685     -34229.997     -9469.1009      3624.6745      15.1447        14.506981      16.498       
      3400   324.91395     -34222.828     -9313.6395      3631.475       15.1447        14.534198      16.498       
      3500   309.98732     -34222.873     -17537.398      3638.2755      15.1447        14.561416      16.498       
      3600   287.02662     -34206.472     -13774.174      3645.076       15.1447        14.588634      16.498       
      3700   307.94942     -34219.077     -13898.048      3651.8765      15.1447        14.615851      16.498       
      3800   312.8113      -34228.387     -16686.127      3658.6771      15.1447        14.643069      16.498       
      3900   296.79092     -34232.658     -23791.253      3665.4776      15.1447        14.670286      16.498       
      4000   302.0101      -34247.465     -12956.629      3672.2781      15.1447        14.697504      16.498       
      4100   304.98065     -34255.237     -14126.34       3679.0786      15.1447        14.724722      16.498       
      4200   273.53494     -34221.182     -12155.525      3685.8791      15.1447        14.751939      16.498       
      4300   302.43621     -34234.264     -26591.393      3692.6796      15.1447        14.779157      16.498       
      4400   287.53649     -34210.093     -21806.559      3699.4801      15.1447        14.806374      16.498       
      4500   277.02004     -34214.923     -14237.728      3706.2807      15.1447        14.833592      16.498       
      4600   288.61646     -34238.373     -234.06605      3713.0812      15.1447        14.86081       16.498       
      4700   280.43841     -34226.618     -7225.7523      3719.8817      15.1447        14.888027      16.498       
      4800   314.17473     -34226.961     -7484.4901      3726.6822      15.1447        14.915245      16.498       
      4900   320.54772     -34209.799     -11016.09       3733.4827      15.1447        14.942462      16.498       
      5000   297.02337     -34186.222     -21651.484      3740.2832      15.1447        14.96968       16.498       
Loop time of 205.466 on 16 procs for 5000 steps with 295 atoms

Performance: 1.051 ns/day, 22.830 hours/ns, 24.335 timesteps/s, 7.179 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 151.12     | 154.49     | 158.66     |  17.4 | 75.19
Bond    | 0.0016646  | 0.0018908  | 0.0021688  |   0.4 |  0.00
Neigh   | 12.472     | 12.699     | 12.937     |   5.1 |  6.18
Comm    | 14.347     | 18.484     | 21.71      |  49.4 |  9.00
Output  | 0.028248   | 0.047132   | 0.064888   |   6.0 |  0.02
Modify  | 18.557     | 18.871     | 19.054     |   3.9 |  9.18
Other   |            | 0.8766     |            |       |  0.43

Nlocal:         36.875 ave          42 max          32 min
Histogram: 2 1 0 0 1 0 0 1 1 2
Nghost:        2726.25 ave        2770 max        2677 min
Histogram: 1 0 0 2 1 1 0 1 1 1
Neighs:        20382.6 ave       23074 max       17746 min
Histogram: 2 1 0 0 1 0 0 1 2 1

Total # of neighbors = 163061
Ave neighs/atom = 552.74915
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.498
variable dlen equal lz-${len0}
variable dlen equal lz-16.498
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.498
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.76974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.06366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.05805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.6498 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.68364     -34284.24       6374.6174      3393.457       15.1447        13.6088        16.465004    
       200   314.01692     -34288.594     -1022.3685      3386.6565      15.1447        13.6088        16.432008    
       300   309.27359     -34287.116     -2852.6569      3379.8559      15.1447        13.6088        16.399012    
       400   287.71982     -34292.002      1319.9505      3373.0554      15.1447        13.6088        16.366016    
       500   296.44893     -34295.188     -7708.9452      3366.2549      15.1447        13.6088        16.33302     
       600   306.76548     -34306.8       -11562.729      3359.4544      15.1447        13.6088        16.300024    
       700   308.31992     -34297.916     -540.52733      3352.6539      15.1447        13.6088        16.267028    
       800   295.37247     -34282.809     -5931.5202      3345.8534      15.1447        13.6088        16.234032    
       900   293.22007     -34294.9       -295.482        3339.0529      15.1447        13.6088        16.201036    
      1000   294.55106     -34309.317     -5774.3387      3332.2523      15.1447        13.6088        16.16804     
      1100   303.79736     -34317.133     -3144.1244      3325.4518      15.1447        13.6088        16.135044    
      1200   291.83139     -34304.03      -8947.4945      3318.6513      15.1447        13.6088        16.102048    
      1300   303.62063     -34278.137     -4777.7772      3311.8508      15.1447        13.6088        16.069052    
      1400   313.4188      -34273.701      6137.6647      3305.0503      15.1447        13.6088        16.036056    
      1500   303.25727     -34285.014     -5451.0702      3298.2498      15.1447        13.6088        16.00306     
      1600   300.49446     -34290.966     -4776.8574      3291.4492      15.1447        13.6088        15.970064    
      1700   318.4472      -34312.046     -357.47633      3284.6487      15.1447        13.6088        15.937068    
      1800   289.18985     -34297.549     -62.745533      3277.8482      15.1447        13.6088        15.904072    
      1900   305.8618      -34300.78      -5968.1003      3271.0477      15.1447        13.6088        15.871076    
      2000   301.29724     -34261.228      10700.615      3264.2472      15.1447        13.6088        15.83808     
      2100   326.95161     -34267.663      3592.773       3257.4467      15.1447        13.6088        15.805084    
      2200   329.61743     -34290.395      554.67233      3250.6462      15.1447        13.6088        15.772088    
      2300   317.33269     -34292.338      6278.1248      3243.8456      15.1447        13.6088        15.739092    
      2400   283.17787     -34276.003      11513.867      3237.0451      15.1447        13.6088        15.706096    
      2500   266.77484     -34270.45      -473.2744       3230.2446      15.1447        13.6088        15.6731      
      2600   294.98051     -34286.378      8185.4496      3223.4441      15.1447        13.6088        15.640104    
      2700   292.70216     -34270.323      9654.4055      3216.6436      15.1447        13.6088        15.607108    
      2800   312.48664     -34262.784      17974.935      3209.8431      15.1447        13.6088        15.574112    
      2900   309.02254     -34261.933      4168.0333      3203.0426      15.1447        13.6088        15.541116    
      3000   320.93179     -34304.352      3666.5876      3196.242       15.1447        13.6088        15.50812     
      3100   281.19657     -34277.59       6872.2775      3189.4415      15.1447        13.6088        15.475124    
      3200   290.16513     -34270.868      528.1829       3182.641       15.1447        13.6088        15.442128    
      3300   307.21448     -34270.118      12791.648      3175.8405      15.1447        13.6088        15.409132    
      3400   301.80484     -34269.937      15784.855      3169.04        15.1447        13.6088        15.376136    
      3500   309.05788     -34300.925      12603.63       3162.2395      15.1447        13.6088        15.34314     
      3600   299.90844     -34292.434      13294.929      3155.4389      15.1447        13.6088        15.310144    
      3700   315.94185     -34288.417      13825.663      3148.6384      15.1447        13.6088        15.277148    
      3800   336.77164     -34283.826      22256.513      3141.8379      15.1447        13.6088        15.244152    
      3900   307.26605     -34239.359      23363.801      3135.0374      15.1447        13.6088        15.211156    
      4000   310.55535     -34262.217      9794.3111      3128.2369      15.1447        13.6088        15.17816     
      4100   299.69469     -34269.987      28318.342      3121.4364      15.1447        13.6088        15.145164    
      4200   311.13163     -34284.686      11838.772      3114.6359      15.1447        13.6088        15.112168    
      4300   285.72529     -34260.71       18698.914      3107.8353      15.1447        13.6088        15.079172    
      4400   265.90115     -34244.381      23089.296      3101.0348      15.1447        13.6088        15.046176    
      4500   275.23357     -34260.975      22111.642      3094.2343      15.1447        13.6088        15.01318     
      4600   278.91894     -34261.855      22045.538      3087.4338      15.1447        13.6088        14.980184    
      4700   287.2588      -34245.571      12227.683      3080.6333      15.1447        13.6088        14.947188    
      4800   324.05757     -34245.424      3370.9124      3073.8328      15.1447        13.6088        14.914192    
      4900   308.68024     -34234.283      16869.273      3067.0323      15.1447        13.6088        14.881196    
      5000   310.1154      -34249.752      4547.7778      3060.2317      15.1447        13.6088        14.8482      
Loop time of 236.015 on 16 procs for 5000 steps with 295 atoms

Performance: 0.915 ns/day, 26.224 hours/ns, 21.185 timesteps/s, 6.250 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 175.6      | 179.65     | 182.73     |  17.6 | 76.12
Bond    | 0.0016701  | 0.0019144  | 0.0021084  |   0.3 |  0.00
Neigh   | 14.21      | 14.354     | 14.628     |   3.3 |  6.08
Comm    | 17.459     | 20.739     | 24.649     |  52.1 |  8.79
Output  | 0.027201   | 0.030964   | 0.035103   |   1.7 |  0.01
Modify  | 19.849     | 20.244     | 20.526     |   4.4 |  8.58
Other   |            | 0.9977     |            |       |  0.42

Nlocal:         36.875 ave          40 max          33 min
Histogram: 1 0 1 0 3 0 0 0 1 2
Nghost:           3231 ave        3269 max        3190 min
Histogram: 2 0 0 1 0 1 2 0 1 1
Neighs:        24999.6 ave       27101 max       22424 min
Histogram: 1 0 0 1 3 0 0 0 1 2

Total # of neighbors = 199997
Ave neighs/atom = 677.95593
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.498
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.6498 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.58452     -34284.362      6307.6189      3407.058       15.1447        13.6088        16.530996    
       200   314.29242     -34290.583     -8058.5298      3413.8585      15.1447        13.6088        16.563992    
       300   303.7755      -34283.879     -1349.3827      3420.659       15.1447        13.6088        16.596988    
       400   277.02095     -34287.157     -12465.478      3427.4595      15.1447        13.6088        16.629984    
       500   309.46293     -34317.862     -22071.03       3434.2601      15.1447        13.6088        16.66298     
       600   300.42506     -34298.047     -10095.333      3441.0606      15.1447        13.6088        16.695976    
       700   321.67975     -34299.275      1642.8485      3447.8611      15.1447        13.6088        16.728972    
       800   290.35899     -34271.028     -9450.8101      3454.6616      15.1447        13.6088        16.761968    
       900   304.30132     -34303.499     -3052.3771      3461.4621      15.1447        13.6088        16.794964    
      1000   279.71743     -34291.13      -5034.435       3468.2626      15.1447        13.6088        16.82796     
      1100   292.80445     -34291.299     -25714.636      3475.0632      15.1447        13.6088        16.860956    
      1200   298.38463     -34267.209     -13923.846      3481.8637      15.1447        13.6088        16.893952    
      1300   326.23448     -34261.1       -15966.974      3488.6642      15.1447        13.6088        16.926948    
      1400   293.76846     -34260.757     -20307.022      3495.4647      15.1447        13.6088        16.959944    
      1500   299.9207      -34283.967     -11404.688      3502.2652      15.1447        13.6088        16.99294     
      1600   288.02896     -34285.138     -3278.8187      3509.0657      15.1447        13.6088        17.025936    
      1700   290.01946     -34295.143     -2082.2035      3515.8662      15.1447        13.6088        17.058932    
      1800   290.23233     -34293.023     -6981.9604      3522.6668      15.1447        13.6088        17.091928    
      1900   288.39927     -34288.893     -24424.971      3529.4673      15.1447        13.6088        17.124924    
      2000   304.46583     -34290.752     -9907.6629      3536.2678      15.1447        13.6088        17.15792     
      2100   293.66817     -34268.679     -14352.842      3543.0683      15.1447        13.6088        17.190916    
      2200   311.65612     -34283.618     -17654.238      3549.8688      15.1447        13.6088        17.223912    
      2300   298.88692     -34292.062     -11798.204      3556.6693      15.1447        13.6088        17.256908    
      2400   272.6745      -34279.814     -19285.063      3563.4698      15.1447        13.6088        17.289904    
      2500   305.82244     -34302.172     -21723.98       3570.2704      15.1447        13.6088        17.3229      
      2600   307.87826     -34296.3       -15440.967      3577.0709      15.1447        13.6088        17.355896    
      2700   294.54327     -34301.515     -14590.054      3583.8714      15.1447        13.6088        17.388892    
      2800   299.42605     -34316.482     -17410.534      3590.6719      15.1447        13.6088        17.421888    
      2900   294.25853     -34294.895     -5643.0211      3597.4724      15.1447        13.6088        17.454884    
      3000   306.63006     -34273.528     -8998.5692      3604.2729      15.1447        13.6088        17.48788     
      3100   304.53116     -34263.416     -18269.666      3611.0735      15.1447        13.6088        17.520876    
      3200   299.04205     -34261.783     -20667.622      3617.874       15.1447        13.6088        17.553872    
      3300   294.64239     -34263.935     -10818.876      3624.6745      15.1447        13.6088        17.586868    
      3400   288.50104     -34274.098     -15807.843      3631.475       15.1447        13.6088        17.619864    
      3500   306.36236     -34284.326     -2970.3463      3638.2755      15.1447        13.6088        17.65286     
      3600   295.53311     -34276.457     -26308.641      3645.076       15.1447        13.6088        17.685856    
      3700   297.94481     -34271.234     -24155.667      3651.8765      15.1447        13.6088        17.718852    
      3800   278.03797     -34245.637     -14205.377      3658.6771      15.1447        13.6088        17.751848    
      3900   309.18408     -34251.456     -18224.542      3665.4776      15.1447        13.6088        17.784844    
      4000   302.65242     -34249.827     -9920.3131      3672.2781      15.1447        13.6088        17.81784     
      4100   289.44867     -34254.011     -27110.88       3679.0786      15.1447        13.6088        17.850836    
      4200   294.71532     -34265.034     -10853.365      3685.8791      15.1447        13.6088        17.883832    
      4300   299.06079     -34265.204     -20831.057      3692.6796      15.1447        13.6088        17.916828    
      4400   300.64092     -34251.325     -12954.813      3699.4801      15.1447        13.6088        17.949824    
      4500   322.75611     -34240.79      -18870.158      3706.2807      15.1447        13.6088        17.98282     
      4600   306.39312     -34205.221     -25605.238      3713.0812      15.1447        13.6088        18.015816    
      4700   320.80374     -34230.694     -18110.078      3719.8817      15.1447        13.6088        18.048812    
      4800   306.31343     -34241.547     -21927.108      3726.6822      15.1447        13.6088        18.081808    
      4900   276.72801     -34217.08      -8542.6142      3733.4827      15.1447        13.6088        18.114804    
      5000   301.20257     -34244.661     -1746.8895      3740.2832      15.1447        13.6088        18.1478      
Loop time of 209.834 on 16 procs for 5000 steps with 295 atoms

Performance: 1.029 ns/day, 23.315 hours/ns, 23.828 timesteps/s, 7.029 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 148.72     | 156.45     | 162.88     |  33.0 | 74.56
Bond    | 0.0016891  | 0.0018499  | 0.002009   |   0.2 |  0.00
Neigh   | 12.723     | 12.875     | 13.154     |   3.8 |  6.14
Comm    | 13.556     | 19.961     | 27.834     |  93.0 |  9.51
Output  | 0.027642   | 0.032021   | 0.036314   |   1.8 |  0.02
Modify  | 19.212     | 19.592     | 19.743     |   3.8 |  9.34
Other   |            | 0.921      |            |       |  0.44

Nlocal:         36.875 ave          41 max          30 min
Histogram: 1 0 1 0 0 1 0 1 3 1
Nghost:        2791.62 ave        2841 max        2743 min
Histogram: 1 1 0 1 1 2 0 0 1 1
Neighs:          20366 ave       22405 max       16759 min
Histogram: 1 0 1 0 0 1 0 1 3 1

Total # of neighbors = 162928
Ave neighs/atom = 552.29831
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.1447
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.5805)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.1447
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.76974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.06366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.05805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.51447 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.61096     -34284.277      6367.6052      3400.2575      15.1447        13.6088        16.498       
       200   313.72572     -34292.996     -391.86726      3400.2575      15.1447        13.6088        16.498       
       300   314.14357     -34294.115     -957.0806       3400.2575      15.1447        13.6088        16.498       
       400   273.73711     -34286.726     -3413.1052      3400.2575      15.1447        13.6088        16.498       
       500   275.91902     -34303.675     -10384.775      3400.2575      15.1447        13.6088        16.498       
       600   280.68945     -34297.152     -12654.26       3400.2575      15.1447        13.6088        16.498       
       700   319.46962     -34313.763      2056.6376      3400.2575      15.1447        13.6088        16.498       
       800   297.82594     -34293.884      1553.9126      3400.2575      15.1447        13.6088        16.498       
       900   294.58606     -34295.11      -7944.7268      3400.2575      15.1447        13.6088        16.498       
      1000   297.25102     -34302.213      2588.2462      3400.2575      15.1447        13.6088        16.498       
      1100   279.25378     -34296.658     -11556.308      3400.2575      15.1447        13.6088        16.498       
      1200   309.48022     -34309.498     -11135.004      3400.2575      15.1447        13.6088        16.498       
      1300   301.49467     -34285.315     -11511.887      3400.2575      15.1447        13.6088        16.498       
      1400   323.46344     -34289.555      1464.3506      3400.2575      15.1447        13.6088        16.498       
      1500   339.98257     -34289.363     -2445.5988      3400.2575      15.1447        13.6088        16.498       
      1600   312.07646     -34297.489     -9531.651       3400.2575      15.1447        13.6088        16.498       
      1700   282.11653     -34290.167     -8287.1438      3400.2575      15.1447        13.6088        16.498       
      1800   310.95583     -34307.158     -13926.694      3400.2575      15.1447        13.6088        16.498       
      1900   333.34035     -34319.544     -7416.2931      3400.2575      15.1447        13.6088        16.498       
      2000   299.81799     -34303.838      1172.0504      3400.2575      15.1447        13.6088        16.498       
      2100   273.96354     -34298.602     -8982.3386      3400.2575      15.1447        13.6088        16.498       
      2200   263.41333     -34291.105     -11005.758      3400.2575      15.1447        13.6088        16.498       
      2300   307.01609     -34292.973     -6553.6932      3400.2575      15.1447        13.6088        16.498       
      2400   306.27711     -34276.828     -1600.8005      3400.2575      15.1447        13.6088        16.498       
      2500   311.36437     -34293.94       6627.8784      3400.2575      15.1447        13.6088        16.498       
      2600   269.76995     -34280.141     -21902.407      3400.2575      15.1447        13.6088        16.498       
      2700   317.44903     -34318.124     -4504.3639      3400.2575      15.1447        13.6088        16.498       
      2800   299.20233     -34298.957      451.60888      3400.2575      15.1447        13.6088        16.498       
      2900   304.71265     -34293.058      1313.8038      3400.2575      15.1447        13.6088        16.498       
      3000   351.45794     -34288.223     -6368.8276      3400.2575      15.1447        13.6088        16.498       
      3100   336.43034     -34275.433      16511          3400.2575      15.1447        13.6088        16.498       
      3200   314.82033     -34284.897     -11289.472      3400.2575      15.1447        13.6088        16.498       
      3300   292.8862      -34289.452     -4185.2853      3400.2575      15.1447        13.6088        16.498       
      3400   295.44463     -34306.449     -5934.6024      3400.2575      15.1447        13.6088        16.498       
      3500   288.08831     -34302.817     -2182.3553      3400.2575      15.1447        13.6088        16.498       
      3600   311.46156     -34302.474     -13703.545      3400.2575      15.1447        13.6088        16.498       
      3700   311.58741     -34276.453     -4346.3104      3400.2575      15.1447        13.6088        16.498       
      3800   310.2606      -34269.552     -1210.7711      3400.2575      15.1447        13.6088        16.498       
      3900   310.80881     -34281.412     -15315.602      3400.2575      15.1447        13.6088        16.498       
      4000   276.57811     -34264.221     -309.03785      3400.2575      15.1447        13.6088        16.498       
      4100   294.5149      -34292.037     -7223.8869      3400.2575      15.1447        13.6088        16.498       
      4200   297.27402     -34302.09      -7353.3675      3400.2575      15.1447        13.6088        16.498       
      4300   309.39237     -34309.592      1538.8546      3400.2575      15.1447        13.6088        16.498       
      4400   271.66308     -34281.473     -10107.286      3400.2575      15.1447        13.6088        16.498       
      4500   294.00754     -34301.435      2937.9228      3400.2575      15.1447        13.6088        16.498       
      4600   296.54628     -34291.063     -7703.8854      3400.2575      15.1447        13.6088        16.498       
      4700   318.89504     -34288.603      4280.982       3400.2575      15.1447        13.6088        16.498       
      4800   306.98388     -34279.412     -1028.9027      3400.2575      15.1447        13.6088        16.498       
      4900   295.08035     -34298.891      1934.4683      3400.2575      15.1447        13.6088        16.498       
      5000   275.01324     -34295.502      252.52564      3400.2575      15.1447        13.6088        16.498       
Loop time of 223.266 on 16 procs for 5000 steps with 295 atoms

Performance: 0.967 ns/day, 24.807 hours/ns, 22.395 timesteps/s, 6.606 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 156.99     | 167.66     | 174.67     |  40.4 | 75.09
Bond    | 0.0017118  | 0.0019024  | 0.0020788  |   0.3 |  0.00
Neigh   | 13.17      | 13.617     | 13.997     |   7.1 |  6.10
Comm    | 14.156     | 21.153     | 31.857     | 113.5 |  9.47
Output  | 0.031597   | 0.035377   | 0.040075   |   1.5 |  0.02
Modify  | 19.422     | 19.804     | 20.264     |   5.7 |  8.87
Other   |            | 0.9983     |            |       |  0.45

Nlocal:         36.875 ave          44 max          32 min
Histogram: 2 2 0 0 0 2 0 0 1 1
Nghost:        3004.88 ave        3017 max        2982 min
Histogram: 1 0 0 1 0 1 0 1 2 2
Neighs:        22449.6 ave       26533 max       19647 min
Histogram: 2 2 0 0 0 2 0 0 1 1

Total # of neighbors = 179597
Ave neighs/atom = 608.80339
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.006 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.1447
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.51447 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.64535     -34284.318      6351.1205      3400.2575      15.1447        13.6088        16.498       
       200   313.22926     -34291.158     -2948.1787      3400.2575      15.1447        13.6088        16.498       
       300   300.76319     -34280.786     -5597.7746      3400.2575      15.1447        13.6088        16.498       
       400   279.44415     -34294.034     -16910.979      3400.2575      15.1447        13.6088        16.498       
       500   278.2982      -34298.664      3474.3441      3400.2575      15.1447        13.6088        16.498       
       600   287.53686     -34299.433     -11868.87       3400.2575      15.1447        13.6088        16.498       
       700   290.43631     -34290.24      -15365.195      3400.2575      15.1447        13.6088        16.498       
       800   311.03307     -34299.613     -14716.912      3400.2575      15.1447        13.6088        16.498       
       900   293.98926     -34284.233     -6622.072       3400.2575      15.1447        13.6088        16.498       
      1000   282.28838     -34280.426     -8054.3818      3400.2575      15.1447        13.6088        16.498       
      1100   298.23773     -34313.577      11495.518      3400.2575      15.1447        13.6088        16.498       
      1200   283.75402     -34311.532     -4223.9437      3400.2575      15.1447        13.6088        16.498       
      1300   310.73869     -34319.524     -8673.7196      3400.2575      15.1447        13.6088        16.498       
      1400   308.43847     -34291.588     -2880.7913      3400.2575      15.1447        13.6088        16.498       
      1500   324.67465     -34299.09      -8763.4612      3400.2575      15.1447        13.6088        16.498       
      1600   320.73676     -34302.755      2028.371       3400.2575      15.1447        13.6088        16.498       
      1700   287.42958     -34308.076     -17489.178      3400.2575      15.1447        13.6088        16.498       
      1800   299.40872     -34319.25      -4707.8461      3400.2575      15.1447        13.6088        16.498       
      1900   304.47966     -34314.355     -3684.8133      3400.2575      15.1447        13.6088        16.498       
      2000   297.08362     -34291.709     -14826.963      3400.2575      15.1447        13.6088        16.498       
      2100   317.4796      -34286.515      1191.3796      3400.2575      15.1447        13.6088        16.498       
      2200   331.77535     -34282.346     -3571.9679      3400.2575      15.1447        13.6088        16.498       
      2300   309.04945     -34298.979     -7207.8988      3400.2575      15.1447        13.6088        16.498       
      2400   300.31898     -34304.484     -12020.394      3400.2575      15.1447        13.6088        16.498       
      2500   281.84866     -34288.759     -11842.649      3400.2575      15.1447        13.6088        16.498       
      2600   311.24505     -34300.386     -5656.1995      3400.2575      15.1447        13.6088        16.498       
      2700   287.70064     -34260.119     -7384.8242      3400.2575      15.1447        13.6088        16.498       
      2800   305.44119     -34275.647      1038.9018      3400.2575      15.1447        13.6088        16.498       
      2900   295.35179     -34294.793     -7981.028       3400.2575      15.1447        13.6088        16.498       
      3000   279.80816     -34287.679     -16335.969      3400.2575      15.1447        13.6088        16.498       
      3100   286.40696     -34278.745     -3128.3768      3400.2575      15.1447        13.6088        16.498       
      3200   323.14745     -34300.073     -2194.7312      3400.2575      15.1447        13.6088        16.498       
      3300   288.48837     -34274.789     -6551.3807      3400.2575      15.1447        13.6088        16.498       
      3400   288.56944     -34304.213     -2472.0142      3400.2575      15.1447        13.6088        16.498       
      3500   278.19656     -34300.79       5007.9323      3400.2575      15.1447        13.6088        16.498       
      3600   286.42179     -34292.526      4343.4412      3400.2575      15.1447        13.6088        16.498       
      3700   305.47779     -34293.014     -16985.085      3400.2575      15.1447        13.6088        16.498       
      3800   330.55956     -34304.429     -8989.1331      3400.2575      15.1447        13.6088        16.498       
      3900   339.89348     -34312.165      13205.41       3400.2575      15.1447        13.6088        16.498       
      4000   300.37217     -34301.708      783.8234       3400.2575      15.1447        13.6088        16.498       
      4100   282.66849     -34297.359      7445.3263      3400.2575      15.1447        13.6088        16.498       
      4200   289.36283     -34304.492     -5517.8648      3400.2575      15.1447        13.6088        16.498       
      4300   304.65043     -34293.75       17242.77       3400.2575      15.1447        13.6088        16.498       
      4400   312.70474     -34279.695      10363.852      3400.2575      15.1447        13.6088        16.498       
      4500   313.5719      -34301.406      2070.4986      3400.2575      15.1447        13.6088        16.498       
      4600   284.37141     -34300.251     -8916.4623      3400.2575      15.1447        13.6088        16.498       
      4700   269.39391     -34276.949      8679.2973      3400.2575      15.1447        13.6088        16.498       
      4800   309.37548     -34289.663     -15615.553      3400.2575      15.1447        13.6088        16.498       
      4900   308.86803     -34282.103     -12723.649      3400.2575      15.1447        13.6088        16.498       
      5000   298.28079     -34293.589     -14814.474      3400.2575      15.1447        13.6088        16.498       
Loop time of 219.723 on 16 procs for 5000 steps with 295 atoms

Performance: 0.983 ns/day, 24.414 hours/ns, 22.756 timesteps/s, 6.713 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 161.14     | 165.73     | 169.48     |  22.2 | 75.43
Bond    | 0.0017094  | 0.0019081  | 0.0022441  |   0.5 |  0.00
Neigh   | 13.79      | 13.914     | 14.127     |   3.0 |  6.33
Comm    | 15.64      | 19.289     | 23.771     |  63.1 |  8.78
Output  | 0.029374   | 0.049434   | 0.072211   |   7.0 |  0.02
Modify  | 19.444     | 19.708     | 19.948     |   3.7 |  8.97
Other   |            | 1.034      |            |       |  0.47

Nlocal:         36.875 ave          44 max          27 min
Histogram: 1 0 0 2 0 1 0 1 2 1
Nghost:        2989.88 ave        3038 max        2947 min
Histogram: 1 1 0 2 0 1 2 0 0 1
Neighs:        22423.6 ave       26514 max       16652 min
Histogram: 1 0 0 2 0 1 0 1 2 1

Total # of neighbors = 179389
Ave neighs/atom = 608.09831
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.6088
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.6366)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.6088
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.76974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.06366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.05805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.36088 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.72039     -34284.284      6342.7737      3400.2575      15.1447        13.6088        16.498       
       200   311.10915     -34289.459     -4468.2761      3400.2575      15.1447        13.6088        16.498       
       300   306.13432     -34284.815     -9646.0843      3400.2575      15.1447        13.6088        16.498       
       400   280.97187     -34292.664     -14125.04       3400.2575      15.1447        13.6088        16.498       
       500   294.02179     -34312.709     -19869.196      3400.2575      15.1447        13.6088        16.498       
       600   291.66169     -34302.5       -17773.621      3400.2575      15.1447        13.6088        16.498       
       700   296.72657     -34286.58      -6275.0131      3400.2575      15.1447        13.6088        16.498       
       800   309.6459      -34291.871     -13326.936      3400.2575      15.1447        13.6088        16.498       
       900   296.30531     -34281.204     -8501.9598      3400.2575      15.1447        13.6088        16.498       
      1000   294.68216     -34281.006     -1396.1014      3400.2575      15.1447        13.6088        16.498       
      1100   300.94499     -34284.158     -11106.317      3400.2575      15.1447        13.6088        16.498       
      1200   298.20492     -34288.986      9127.9397      3400.2575      15.1447        13.6088        16.498       
      1300   301.50333     -34298.204     -7162.0311      3400.2575      15.1447        13.6088        16.498       
      1400   290.44297     -34287.44      -7329.5428      3400.2575      15.1447        13.6088        16.498       
      1500   304.32914     -34283.544     -8851.7224      3400.2575      15.1447        13.6088        16.498       
      1600   325.73919     -34281.047     -1060.9426      3400.2575      15.1447        13.6088        16.498       
      1700   306.40671     -34266.187     -1121.7033      3400.2575      15.1447        13.6088        16.498       
      1800   293.62926     -34289.06      -1945.8183      3400.2575      15.1447        13.6088        16.498       
      1900   284.88885     -34288.365     -19014.956      3400.2575      15.1447        13.6088        16.498       
      2000   295.2722      -34280.488     -8870.6472      3400.2575      15.1447        13.6088        16.498       
      2100   311.40648     -34275.694     -5197.6278      3400.2575      15.1447        13.6088        16.498       
      2200   306.08884     -34264.001     -15671.439      3400.2575      15.1447        13.6088        16.498       
      2300   309.40411     -34298.892     -14080.952      3400.2575      15.1447        13.6088        16.498       
      2400   281.26443     -34287.717      2652.2988      3400.2575      15.1447        13.6088        16.498       
      2500   271.7008      -34268.364      1408.9576      3400.2575      15.1447        13.6088        16.498       
      2600   313.86486     -34278.718     -16066.63       3400.2575      15.1447        13.6088        16.498       
      2700   309.75194     -34268.645      3257.3318      3400.2575      15.1447        13.6088        16.498       
      2800   302.76017     -34265.769     -11716.002      3400.2575      15.1447        13.6088        16.498       
      2900   293.89861     -34266.19      -6626.0084      3400.2575      15.1447        13.6088        16.498       
      3000   280.92498     -34261.775     -10035.593      3400.2575      15.1447        13.6088        16.498       
      3100   303.54142     -34271.966     -7147.4151      3400.2575      15.1447        13.6088        16.498       
      3200   314.0358      -34279.096     -4219.1538      3400.2575      15.1447        13.6088        16.498       
      3300   281.17347     -34272.187     -513.99357      3400.2575      15.1447        13.6088        16.498       
      3400   280.41319     -34287.217     -3.3877263      3400.2575      15.1447        13.6088        16.498       
      3500   281.46541     -34264.814     -8663.3392      3400.2575      15.1447        13.6088        16.498       
      3600   301.44083     -34257.211     -16982.981      3400.2575      15.1447        13.6088        16.498       
      3700   301.71315     -34251.018     -4096.0138      3400.2575      15.1447        13.6088        16.498       
      3800   304.00779     -34259.126      2034.9362      3400.2575      15.1447        13.6088        16.498       
      3900   292.07146     -34254.506     -1276.97        3400.2575      15.1447        13.6088        16.498       
      4000   286.58011     -34275.16      -8649.6425      3400.2575      15.1447        13.6088        16.498       
      4100   277.19281     -34274.838     -4191.6609      3400.2575      15.1447        13.6088        16.498       
      4200   290.95701     -34269.728      1863.6365      3400.2575      15.1447        13.6088        16.498       
      4300   294.47102     -34254.782     -10058.748      3400.2575      15.1447        13.6088        16.498       
      4400   310.57966     -34266.557     -21786.34       3400.2575      15.1447        13.6088        16.498       
      4500   327.30099     -34280.594     -10414.242      3400.2575      15.1447        13.6088        16.498       
      4600   288.06658     -34249.172     -1205.8998      3400.2575      15.1447        13.6088        16.498       
      4700   287.44499     -34244.055     -7789.5016      3400.2575      15.1447        13.6088        16.498       
      4800   302.35493     -34243.221     -7605.8142      3400.2575      15.1447        13.6088        16.498       
      4900   335.38824     -34260.514     -2081.902       3400.2575      15.1447        13.6088        16.498       
      5000   300.61917     -34247.839     -10545.601      3400.2575      15.1447        13.6088        16.498       
Loop time of 220.478 on 16 procs for 5000 steps with 295 atoms

Performance: 0.980 ns/day, 24.498 hours/ns, 22.678 timesteps/s, 6.690 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.39     | 166.74     | 172.36     |  30.1 | 75.62
Bond    | 0.0017003  | 0.0019245  | 0.0021468  |   0.3 |  0.00
Neigh   | 12.396     | 12.665     | 12.834     |   4.3 |  5.74
Comm    | 14.816     | 20.378     | 26.862     |  86.7 |  9.24
Output  | 0.031029   | 0.036569   | 0.041918   |   2.0 |  0.02
Modify  | 19.488     | 19.734     | 19.965     |   3.9 |  8.95
Other   |            | 0.9259     |            |       |  0.42

Nlocal:         36.875 ave          41 max          32 min
Histogram: 1 1 0 1 0 2 0 1 0 2
Nghost:        2961.75 ave        2996 max        2923 min
Histogram: 1 1 1 1 0 0 0 0 2 2
Neighs:        22434.5 ave       24897 max       19596 min
Histogram: 1 1 0 1 0 2 0 1 0 2

Total # of neighbors = 179476
Ave neighs/atom = 608.39322
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.6088
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.36088 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.5459      -34284.319      6339.0195      3400.2575      15.1447        13.6088        16.498       
       200   312.90751     -34292.273     -2084.3736      3400.2575      15.1447        13.6088        16.498       
       300   307.74485     -34288.853     -8861.6793      3400.2575      15.1447        13.6088        16.498       
       400   280.64519     -34295.055     -9657.9009      3400.2575      15.1447        13.6088        16.498       
       500   281.82982     -34305.833     -8845.4041      3400.2575      15.1447        13.6088        16.498       
       600   289.08366     -34305.496     -18458.137      3400.2575      15.1447        13.6088        16.498       
       700   302.75099     -34300.995      4697.8791      3400.2575      15.1447        13.6088        16.498       
       800   306.00489     -34302.793      11986.364      3400.2575      15.1447        13.6088        16.498       
       900   300.99628     -34301.605     -3409.0213      3400.2575      15.1447        13.6088        16.498       
      1000   293.6878      -34295.198      6512.613       3400.2575      15.1447        13.6088        16.498       
      1100   308.23552     -34308.872     -4102.4792      3400.2575      15.1447        13.6088        16.498       
      1200   302.03237     -34305.393     -725.28135      3400.2575      15.1447        13.6088        16.498       
      1300   310.81483     -34310.114     -2870.3418      3400.2575      15.1447        13.6088        16.498       
      1400   293.37015     -34284.421     -8788.5394      3400.2575      15.1447        13.6088        16.498       
      1500   316.43161     -34285.433      865.58281      3400.2575      15.1447        13.6088        16.498       
      1600   309.4431      -34283.286      1918.3832      3400.2575      15.1447        13.6088        16.498       
      1700   297.59706     -34307.874      2138.5944      3400.2575      15.1447        13.6088        16.498       
      1800   318.1638      -34335.052      1297.51        3400.2575      15.1447        13.6088        16.498       
      1900   291.35332     -34313.458     -796.24675      3400.2575      15.1447        13.6088        16.498       
      2000   305.68853     -34300.604      2222.8293      3400.2575      15.1447        13.6088        16.498       
      2100   331.95487     -34306.68      -20080.977      3400.2575      15.1447        13.6088        16.498       
      2200   302.478       -34284.431     -2855.3961      3400.2575      15.1447        13.6088        16.498       
      2300   304.69645     -34300.553     -258.23509      3400.2575      15.1447        13.6088        16.498       
      2400   313.56199     -34321.863     -9378.1455      3400.2575      15.1447        13.6088        16.498       
      2500   298.0063      -34321.335     -14931.633      3400.2575      15.1447        13.6088        16.498       
      2600   277.20313     -34310.672     -5003.9698      3400.2575      15.1447        13.6088        16.498       
      2700   293.64153     -34311.402      2434.2418      3400.2575      15.1447        13.6088        16.498       
      2800   311.71742     -34301.582     -12378.208      3400.2575      15.1447        13.6088        16.498       
      2900   300.0603      -34275.553     -9840.2984      3400.2575      15.1447        13.6088        16.498       
      3000   316.19763     -34303.822     -8116.7245      3400.2575      15.1447        13.6088        16.498       
      3100   295.85783     -34311.36      -654.44166      3400.2575      15.1447        13.6088        16.498       
      3200   297.23622     -34311.073     -13937.9        3400.2575      15.1447        13.6088        16.498       
      3300   295.12514     -34303.479     -16436.858      3400.2575      15.1447        13.6088        16.498       
      3400   314.47043     -34323.969     -6232.9011      3400.2575      15.1447        13.6088        16.498       
      3500   294.45633     -34315.901     -16626.87       3400.2575      15.1447        13.6088        16.498       
      3600   290.83187     -34316.924     -16067.971      3400.2575      15.1447        13.6088        16.498       
      3700   311.3971      -34320.071     -16226.134      3400.2575      15.1447        13.6088        16.498       
      3800   320.22655     -34306.854     -4055.3957      3400.2575      15.1447        13.6088        16.498       
      3900   305.45175     -34289.504     -5161.5632      3400.2575      15.1447        13.6088        16.498       
      4000   293.61033     -34306.753     -6897.8018      3400.2575      15.1447        13.6088        16.498       
      4100   296.27372     -34324.702     -9291.5761      3400.2575      15.1447        13.6088        16.498       
      4200   279.7718      -34304.514     -608.27335      3400.2575      15.1447        13.6088        16.498       
      4300   306.63069     -34310.499     -9128.7454      3400.2575      15.1447        13.6088        16.498       
      4400   324.72797     -34313.651      1429.478       3400.2575      15.1447        13.6088        16.498       
      4500   295.46181     -34300.749     -3048.7243      3400.2575      15.1447        13.6088        16.498       
      4600   272.20554     -34308.31      -13231.854      3400.2575      15.1447        13.6088        16.498       
      4700   292.97426     -34324.345      6078.8165      3400.2575      15.1447        13.6088        16.498       
      4800   301.00695     -34317.973      1613.3517      3400.2575      15.1447        13.6088        16.498       
      4900   329.67612     -34322.4        4608.4393      3400.2575      15.1447        13.6088        16.498       
      5000   324.05831     -34283.384     -4150.4643      3400.2575      15.1447        13.6088        16.498       
Loop time of 210.254 on 16 procs for 5000 steps with 295 atoms

Performance: 1.027 ns/day, 23.362 hours/ns, 23.781 timesteps/s, 7.015 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 149.17     | 159.15     | 163.93     |  42.7 | 75.70
Bond    | 0.0015392  | 0.0018093  | 0.0020996  |   0.4 |  0.00
Neigh   | 12.392     | 13.263     | 13.652     |  13.9 |  6.31
Comm    | 13.558     | 18.395     | 28.432     | 126.3 |  8.75
Output  | 0.023886   | 0.034216   | 0.042457   |   3.5 |  0.02
Modify  | 18.206     | 18.73      | 19.657     |  12.6 |  8.91
Other   |            | 0.6782     |            |       |  0.32

Nlocal:         36.875 ave          42 max          32 min
Histogram: 1 1 0 0 0 3 1 1 0 1
Nghost:        2958.88 ave        2986 max        2930 min
Histogram: 2 0 0 0 1 2 1 0 1 1
Neighs:        22468.6 ave       25348 max       19585 min
Histogram: 1 1 0 0 0 3 1 1 0 1

Total # of neighbors = 179749
Ave neighs/atom = 609.31864
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.498
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.6974)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.498
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.76974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.06366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.05805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.6498 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.56754     -34284.363      6230.2212      3400.2575      15.1447        13.6088        16.498       
       200   313.85917     -34290.785     -1322.8106      3400.2575      15.1447        13.6088        16.498       
       300   306.13048     -34286.577     -8617.8823      3400.2575      15.1447        13.6088        16.498       
       400   279.38863     -34293.79      -5763.3574      3400.2575      15.1447        13.6088        16.498       
       500   287.12048     -34308.133     -11072.247      3400.2575      15.1447        13.6088        16.498       
       600   291.97172     -34305.353     -7311.1631      3400.2575      15.1447        13.6088        16.498       
       700   294.7706      -34285.245      381.22154      3400.2575      15.1447        13.6088        16.498       
       800   303.09765     -34286.793     -26220.107      3400.2575      15.1447        13.6088        16.498       
       900   309.09511     -34296.913     -4078.7236      3400.2575      15.1447        13.6088        16.498       
      1000   293.7505      -34289.827     -14460.596      3400.2575      15.1447        13.6088        16.498       
      1100   303.92887     -34296.517     -5992.5366      3400.2575      15.1447        13.6088        16.498       
      1200   313.70475     -34304.732      2903.4219      3400.2575      15.1447        13.6088        16.498       
      1300   281.62787     -34308.677     -696.90257      3400.2575      15.1447        13.6088        16.498       
      1400   263.88719     -34292.972     -18954.027      3400.2575      15.1447        13.6088        16.498       
      1500   301.76898     -34302.966      1641.531       3400.2575      15.1447        13.6088        16.498       
      1600   311.17707     -34295.015      214.76584      3400.2575      15.1447        13.6088        16.498       
      1700   293.55292     -34280.929     -3173.6389      3400.2575      15.1447        13.6088        16.498       
      1800   305.63788     -34299.582     -13955.794      3400.2575      15.1447        13.6088        16.498       
      1900   287.86371     -34299.923     -5812.7801      3400.2575      15.1447        13.6088        16.498       
      2000   281.07954     -34317.914     -398.41935      3400.2575      15.1447        13.6088        16.498       
      2100   286.81238     -34315.785     -14022.173      3400.2575      15.1447        13.6088        16.498       
      2200   308.8613      -34302.74       4725.5019      3400.2575      15.1447        13.6088        16.498       
      2300   302.0348      -34284.147     -14594.923      3400.2575      15.1447        13.6088        16.498       
      2400   307.97603     -34281.631     -7413.962       3400.2575      15.1447        13.6088        16.498       
      2500   300.37563     -34289.268     -14903          3400.2575      15.1447        13.6088        16.498       
      2600   280.81826     -34293.05      -16976.416      3400.2575      15.1447        13.6088        16.498       
      2700   291.47364     -34301.969     -3424.1133      3400.2575      15.1447        13.6088        16.498       
      2800   292.8737      -34265.229     -6806.4189      3400.2575      15.1447        13.6088        16.498       
      2900   310.5493      -34265.043     -11745.605      3400.2575      15.1447        13.6088        16.498       
      3000   307.92423     -34278.894     -594.44939      3400.2575      15.1447        13.6088        16.498       
      3100   291.07647     -34275.311     -8587.9792      3400.2575      15.1447        13.6088        16.498       
      3200   283.84108     -34268.361     -8621.3         3400.2575      15.1447        13.6088        16.498       
      3300   307.27139     -34280.84      -9403.0339      3400.2575      15.1447        13.6088        16.498       
      3400   296.73136     -34288.23       1817.4711      3400.2575      15.1447        13.6088        16.498       
      3500   278.45655     -34294.261     -3687.7628      3400.2575      15.1447        13.6088        16.498       
      3600   304.51514     -34296.996     -5343.5334      3400.2575      15.1447        13.6088        16.498       
      3700   296.98463     -34266.982     -4537.5521      3400.2575      15.1447        13.6088        16.498       
      3800   292.50932     -34254.112     -10254.655      3400.2575      15.1447        13.6088        16.498       
      3900   308.13756     -34263.729     -16715.31       3400.2575      15.1447        13.6088        16.498       
      4000   300.194       -34259.05      -368.43175      3400.2575      15.1447        13.6088        16.498       
      4100   291.96066     -34263.23      -5448.481       3400.2575      15.1447        13.6088        16.498       
      4200   297.96862     -34270.999     -8901.9691      3400.2575      15.1447        13.6088        16.498       
      4300   299.66278     -34268.631     -6428.1157      3400.2575      15.1447        13.6088        16.498       
      4400   263.10137     -34251.865     -3520.6734      3400.2575      15.1447        13.6088        16.498       
      4500   271.21679     -34269.922      6023.6761      3400.2575      15.1447        13.6088        16.498       
      4600   278.54761     -34284.36      -14605.371      3400.2575      15.1447        13.6088        16.498       
      4700   289.57916     -34300.468     -9902.1593      3400.2575      15.1447        13.6088        16.498       
      4800   301.26337     -34285.82      -2977.4652      3400.2575      15.1447        13.6088        16.498       
      4900   301.96082     -34261.137     -10346.882      3400.2575      15.1447        13.6088        16.498       
      5000   297.74655     -34256.267     -4968.2957      3400.2575      15.1447        13.6088        16.498       
Loop time of 185.886 on 16 procs for 5000 steps with 295 atoms

Performance: 1.162 ns/day, 20.654 hours/ns, 26.898 timesteps/s, 7.935 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 108.81     | 134.8      | 155.02     | 125.5 | 72.52
Bond    | 0.0013035  | 0.0015121  | 0.0018492  |   0.4 |  0.00
Neigh   | 9.343      | 11.172     | 12.622     |  33.4 |  6.01
Comm    | 2.1816     | 22.409     | 48.414     | 307.8 | 12.06
Output  | 0.012652   | 0.014427   | 0.015926   |   1.0 |  0.01
Modify  | 15.938     | 17.386     | 19.199     |  26.6 |  9.35
Other   |            | 0.1026     |            |       |  0.06

Nlocal:         36.875 ave          41 max          34 min
Histogram: 1 1 2 0 2 0 0 1 0 1
Nghost:           3122 ave        3158 max        3083 min
Histogram: 1 0 1 0 2 1 1 0 1 1
Neighs:        22504.2 ave       24891 max       20906 min
Histogram: 1 1 2 0 2 0 0 1 0 1

Total # of neighbors = 180034
Ave neighs/atom = 610.28475
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.498
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.6498 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.5 | 117.4 | 119.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   290.02496     -34300.166      592.38462      3400.2575      15.1447        13.6088        16.498       
       100   281.77738     -34284.326      6369.9351      3400.2575      15.1447        13.6088        16.498       
       200   308.85755     -34289.393     -2629.0796      3400.2575      15.1447        13.6088        16.498       
       300   311.65047     -34292.376     -5299.0269      3400.2575      15.1447        13.6088        16.498       
       400   289.90748     -34297.339     -5608.3003      3400.2575      15.1447        13.6088        16.498       
       500   290.20693     -34316.813     -1483.1849      3400.2575      15.1447        13.6088        16.498       
       600   281.02101     -34301.599     -15405.455      3400.2575      15.1447        13.6088        16.498       
       700   289.90159     -34293.657     -27137.634      3400.2575      15.1447        13.6088        16.498       
       800   303.53433     -34297.677     -6974.9499      3400.2575      15.1447        13.6088        16.498       
       900   288.52031     -34288.791      5414.4013      3400.2575      15.1447        13.6088        16.498       
      1000   291.34103     -34284.706     -9042.1288      3400.2575      15.1447        13.6088        16.498       
      1100   298.80113     -34289.138     -15698.15       3400.2575      15.1447        13.6088        16.498       
      1200   309.47113     -34299.684      1714.7092      3400.2575      15.1447        13.6088        16.498       
      1300   308.2893      -34301.599     -6909.8423      3400.2575      15.1447        13.6088        16.498       
      1400   294.55621     -34298.015      7325.6181      3400.2575      15.1447        13.6088        16.498       
      1500   300.25251     -34308.03      -8372.5834      3400.2575      15.1447        13.6088        16.498       
      1600   284.78738     -34287.945     -4342.37        3400.2575      15.1447        13.6088        16.498       
      1700   297.57738     -34283.164     -5162.735       3400.2575      15.1447        13.6088        16.498       
      1800   309.93273     -34281.302     -10008.46       3400.2575      15.1447        13.6088        16.498       
      1900   312.78875     -34284.551     -6462.9788      3400.2575      15.1447        13.6088        16.498       
      2000   302.64542     -34310.76      -689.4426       3400.2575      15.1447        13.6088        16.498       
      2100   291.37394     -34309.831     -4342.6872      3400.2575      15.1447        13.6088        16.498       
      2200   292.32876     -34300.737     -3552.5091      3400.2575      15.1447        13.6088        16.498       
      2300   293.57123     -34281.722     -7043.1784      3400.2575      15.1447        13.6088        16.498       
      2400   296.10489     -34255.033     -3222.5479      3400.2575      15.1447        13.6088        16.498       
      2500   319.82195     -34277.791     -13882.691      3400.2575      15.1447        13.6088        16.498       
      2600   285.87364     -34288.252     -8226.5354      3400.2575      15.1447        13.6088        16.498       
      2700   284.53202     -34291.465     -3217.0558      3400.2575      15.1447        13.6088        16.498       
      2800   299.76182     -34292.131     -5911.845       3400.2575      15.1447        13.6088        16.498       
      2900   317.46334     -34291.66       1142.263       3400.2575      15.1447        13.6088        16.498       
      3000   294.92884     -34275.432     -11815.403      3400.2575      15.1447        13.6088        16.498       
      3100   285.17843     -34292.3       -11284.156      3400.2575      15.1447        13.6088        16.498       
      3200   290.13365     -34303.1       -3117.5768      3400.2575      15.1447        13.6088        16.498       
      3300   287.28433     -34295.103     -11195.106      3400.2575      15.1447        13.6088        16.498       
      3400   301.13911     -34286.72       6172.5471      3400.2575      15.1447        13.6088        16.498       
      3500   325.54491     -34263.454     -6427.7414      3400.2575      15.1447        13.6088        16.498       
      3600   310.32507     -34251.198      3504.5313      3400.2575      15.1447        13.6088        16.498       
      3700   317.56785     -34284.019     -5654.7376      3400.2575      15.1447        13.6088        16.498       
      3800   308.9313      -34290.509      10865.651      3400.2575      15.1447        13.6088        16.498       
      3900   301.36621     -34297.587     -4983.0964      3400.2575      15.1447        13.6088        16.498       
      4000   300.64565     -34306.133      4556.6011      3400.2575      15.1447        13.6088        16.498       
      4100   304.8376      -34315.643     -4572.6043      3400.2575      15.1447        13.6088        16.498       
      4200   270.49742     -34294.567     -7784.5025      3400.2575      15.1447        13.6088        16.498       
      4300   306.4813      -34314.787     -4582.5435      3400.2575      15.1447        13.6088        16.498       
      4400   322.40133     -34299.206      1588.7106      3400.2575      15.1447        13.6088        16.498       
      4500   287.80955     -34256.404      2069.7744      3400.2575      15.1447        13.6088        16.498       
      4600   301.86855     -34269.044     -3110.3535      3400.2575      15.1447        13.6088        16.498       
      4700   296.58001     -34293.771     -1267.789       3400.2575      15.1447        13.6088        16.498       
      4800   282.43698     -34293.685     -4844.3824      3400.2575      15.1447        13.6088        16.498       
      4900   304.26639     -34296.982     -11638.113      3400.2575      15.1447        13.6088        16.498       
      5000   301.94629     -34274.163      9419.0194      3400.2575      15.1447        13.6088        16.498       
Loop time of 131.545 on 16 procs for 5000 steps with 295 atoms

Performance: 1.642 ns/day, 14.616 hours/ns, 38.010 timesteps/s, 11.213 katom-step/s
99.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.435     | 103.43     | 107.29     |  30.3 | 78.62
Bond    | 0.0010506  | 0.0012767  | 0.0016628  |   0.5 |  0.00
Neigh   | 9.312      | 9.5892     | 9.8477     |   5.2 |  7.29
Comm    | 1.5376     | 5.4218     | 10.442     | 132.9 |  4.12
Output  | 0.010215   | 0.01172    | 0.012939   |   0.9 |  0.01
Modify  | 12.749     | 12.992     | 13.268     |   4.3 |  9.88
Other   |            | 0.1037     |            |       |  0.08

Nlocal:         36.875 ave          46 max          27 min
Histogram: 1 0 1 1 1 0 2 0 1 1
Nghost:        2873.25 ave        2916 max        2837 min
Histogram: 2 0 1 1 1 0 0 1 1 1
Neighs:        22372.4 ave       27598 max       16696 min
Histogram: 1 0 1 1 1 0 2 0 1 1

Total # of neighbors = 178979
Ave neighs/atom = 606.70847
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:45:58
