LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

variable FF string "CHONSi.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333-HD-100C-11-VASP

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333-HD-100C-11-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139.1 | 141.9 | 145.4 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -43876.171      0             -43876.171      75874.465    
        22   0             -44408.916      0             -44408.916      19998.011    
Loop time of 3.27289 on 16 procs for 22 steps with 366 atoms

97.6% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -43876.1708158574   -44408.915323308  -44408.9157752537
  Force two-norm initial, final = 945.09194 184.46932
  Force max component initial, final = 142.08591 79.596896
  Final line search alpha, max atom move = 0.001520452 0.12102326
  Iterations, force evaluations = 22 56

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.0081     | 2.5681     | 2.7047     |  13.4 | 78.47
Bond    | 3.033e-05  | 3.7814e-05 | 4.574e-05  |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.067728   | 0.20474    | 0.76504    |  47.5 |  6.26
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0.4962     | 0.4963     | 0.49645    |   0.0 | 15.16
Other   |            | 0.003708   |            |       |  0.11

Nlocal:          45.75 ave          53 max          35 min
Histogram: 1 0 1 0 1 1 0 1 1 2
Nghost:        3574.38 ave        3679 max        3484 min
Histogram: 2 0 1 1 0 1 1 0 1 1
Neighs:          32768 ave       37783 max       25274 min
Histogram: 1 0 1 0 1 1 0 1 1 2

Total # of neighbors = 262144
Ave neighs/atom = 716.24044
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-11-VASP_opt.data
System init for write_data ...
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.3 | 143.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -44408.916      24161.796      1.9939932      3583.6077    
       100   239.99788     -44304.349      7144.9693      1.9939932      3583.6077    
       200   278.48386     -44291.135      9918.9472      1.9939932      3583.6077    
       300   309.06144     -44277.319      14397.588      1.9939932      3583.6077    
       400   300.0386      -44242.516      28156.781      1.9939932      3583.6077    
       500   331.72985     -44282.138      33668.126      1.9939932      3583.6077    
       600   303.27479     -44304.889      14835.965      1.9939932      3583.6077    
       700   287.59839     -44326.974      18024.362      1.9939932      3583.6077    
       800   290.27538     -44352.157      2826.6659      1.9939932      3583.6077    
       900   277.47648     -44333.837      10664.07       1.9939932      3583.6077    
      1000   304.9407      -44333.607      10861.207      1.9939932      3583.6077    
      1100   332.60836     -44363.219      14533.434      1.9939932      3583.6077    
      1200   302.94616     -44358.915      15843.025      1.9939932      3583.6077    
      1300   293.47208     -44358.28       11123.08       1.9939932      3583.6077    
      1400   301.95241     -44363.488      12423.674      1.9939932      3583.6077    
      1500   328.36963     -44361.737      18003.246      1.9939932      3583.6077    
      1600   308.56512     -44323.911      23612.205      1.9939932      3583.6077    
      1700   301.80826     -44338.141      6087.0514      1.9939932      3583.6077    
      1800   277.53916     -44337.402      15855.187      1.9939932      3583.6077    
      1900   301.24952     -44366.467      4313.8173      1.9939932      3583.6077    
      2000   302.18656     -44360.979      15143.368      1.9939932      3583.6077    
      2100   322.96632     -44356.863      9873.9137      1.9939932      3583.6077    
      2200   319.93816     -44343.467      15896.514      1.9939932      3583.6077    
      2300   309.46757     -44376.38       14218.697      1.9939932      3583.6077    
      2400   302.38397     -44380.334      12613.307      1.9939932      3583.6077    
      2500   290.90313     -44369.545      22669.413      1.9939932      3583.6077    
      2600   296.16868     -44356.871      19050.797      1.9939932      3583.6077    
      2700   325.18685     -44364.141      11767.579      1.9939932      3583.6077    
      2800   320.07781     -44364.089      18634.265      1.9939932      3583.6077    
      2900   287.49565     -44365.563      14616.968      1.9939932      3583.6077    
      3000   304.16978     -44401.378      14819.854      1.9939932      3583.6077    
      3100   301.30772     -44387.338      13410.726      1.9939932      3583.6077    
      3200   284.89117     -44351.728      13647.81       1.9939932      3583.6077    
      3300   317.24375     -44363.738      7261.611       1.9939932      3583.6077    
      3400   313.84537     -44361.878      14257.515      1.9939932      3583.6077    
      3500   311.37011     -44378.848      13637.797      1.9939932      3583.6077    
      3600   307.76123     -44382.482      11679.804      1.9939932      3583.6077    
      3700   316.26214     -44394.779      19594.089      1.9939932      3583.6077    
      3800   295.0869      -44361.124      21875.613      1.9939932      3583.6077    
      3900   309.49148     -44349.805      15332.396      1.9939932      3583.6077    
      4000   324.96602     -44352.403      17814.982      1.9939932      3583.6077    
      4100   312.32143     -44367.172      30021.949      1.9939932      3583.6077    
      4200   289.22289     -44374.527      22327.527      1.9939932      3583.6077    
      4300   300.05317     -44385.273      13998.209      1.9939932      3583.6077    
      4400   282.94098     -44357.304      3284.0938      1.9939932      3583.6077    
      4500   307.81143     -44356.003      4141.4164      1.9939932      3583.6077    
      4600   303.88707     -44344.914      7961.2802      1.9939932      3583.6077    
      4700   308.91241     -44369.091      13206.077      1.9939932      3583.6077    
      4800   285.48229     -44374.271      14331.493      1.9939932      3583.6077    
      4900   309.38382     -44395.821      10299.923      1.9939932      3583.6077    
      5000   308.50984     -44382.009      21155.624      1.9939932      3583.6077    
Loop time of 307.685 on 16 procs for 5000 steps with 366 atoms

Performance: 0.702 ns/day, 34.187 hours/ns, 16.250 timesteps/s, 5.948 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 231.6      | 237.38     | 242.48     |  25.5 | 77.15
Bond    | 0.0015958  | 0.0018746  | 0.0022625  |   0.5 |  0.00
Neigh   | 17.936     | 18.811     | 19.429     |  11.1 |  6.11
Comm    | 21.417     | 26.409     | 32.155     |  75.7 |  8.58
Output  | 0.0030602  | 0.0037177  | 0.0081591  |   2.8 |  0.00
Modify  | 23.556     | 24.078     | 24.866     |   7.9 |  7.83
Other   |            | 1.005      |            |       |  0.33

Nlocal:          45.75 ave          57 max          35 min
Histogram: 1 0 2 1 0 1 1 1 0 1
Nghost:         3583.5 ave        3684 max        3486 min
Histogram: 1 1 1 0 1 1 0 1 1 1
Neighs:        32837.4 ave       40457 max       25361 min
Histogram: 1 0 2 1 0 0 2 1 0 1

Total # of neighbors = 262699
Ave neighs/atom = 717.75683
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-HD-100C-11-VASP_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.0372
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.535
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.6074

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.0807
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.1585
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.4931

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal lx-${len0}
variable dlen equal lx-15.0372
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.006 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.0372
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.50372 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.50372 xy delta 0.74931 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.50372 xy delta 0.74931 xz delta 0.01585 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.70538     -44350.454      2997.7893      3576.4405      15.007126      13.535         17.6074      
       200   302.50646     -44364.637      16381.276      3569.2733      14.977051      13.535         17.6074      
       300   300.98206     -44392.435      11457.66       3562.1061      14.946977      13.535         17.6074      
       400   287.68302     -44384.861      19186.864      3554.9389      14.916902      13.535         17.6074      
       500   290.70252     -44377.329      18807.6        3547.7717      14.886828      13.535         17.6074      
       600   268.26706     -44370.158      13763.29       3540.6045      14.856754      13.535         17.6074      
       700   288.80144     -44406.951      17901.228      3533.4372      14.826679      13.535         17.6074      
       800   306.70625     -44401.201      19318.34       3526.27        14.796605      13.535         17.6074      
       900   311.81401     -44389.581      7954.2299      3519.1028      14.76653       13.535         17.6074      
      1000   320.71138     -44374.41       21467.686      3511.9356      14.736456      13.535         17.6074      
      1100   332.52544     -44348.229      33450.454      3504.7684      14.706382      13.535         17.6074      
      1200   321.57041     -44350.962      25559.767      3497.6012      14.676307      13.535         17.6074      
      1300   311.99238     -44362.195      24583.462      3490.4339      14.646233      13.535         17.6074      
      1400   294.54351     -44358.202      16907.165      3483.2667      14.616158      13.535         17.6074      
      1500   295.81464     -44364.952      11381.057      3476.0995      14.586084      13.535         17.6074      
      1600   278.60798     -44356.645      16809.114      3468.9323      14.55601       13.535         17.6074      
      1700   305.20272     -44382.241      33047.15       3461.7651      14.525935      13.535         17.6074      
      1800   290.6854      -44367.775      30283.503      3454.5979      14.495861      13.535         17.6074      
      1900   290.88289     -44354.331      30698.841      3447.4307      14.465786      13.535         17.6074      
      2000   302.66309     -44330.73       38175.266      3440.2634      14.435712      13.535         17.6074      
      2100   308.12457     -44316.566      40266.262      3433.0962      14.405638      13.535         17.6074      
      2200   304.35777     -44328.753      44221.869      3425.929       14.375563      13.535         17.6074      
      2300   303.65882     -44347.165      38816.296      3418.7618      14.345489      13.535         17.6074      
      2400   282.79186     -44321.356      40622.289      3411.5946      14.315414      13.535         17.6074      
      2500   306.66918     -44341.474      38238.805      3404.4274      14.28534       13.535         17.6074      
      2600   299.51935     -44320.085      49610.453      3397.2601      14.255266      13.535         17.6074      
      2700   304.00091     -44295.948      44916.133      3390.0929      14.225191      13.535         17.6074      
      2800   317.12881     -44291.216      47581.079      3382.9257      14.195117      13.535         17.6074      
      2900   301.07442     -44300.851      48797.315      3375.7585      14.165042      13.535         17.6074      
      3000   307.16466     -44315.71       54234.96       3368.5913      14.134968      13.535         17.6074      
      3100   300.6719      -44299.103      63418.2        3361.4241      14.104894      13.535         17.6074      
      3200   298.99423     -44296.379      58606.931      3354.2569      14.074819      13.535         17.6074      
      3300   292.8393      -44302.133      41401.679      3347.0896      14.044745      13.535         17.6074      
      3400   277.32391     -44290.189      51445.884      3339.9224      14.01467       13.535         17.6074      
      3500   287.80793     -44271.789      59665.694      3332.7552      13.984596      13.535         17.6074      
      3600   326.29597     -44268.521      41934.815      3325.588       13.954522      13.535         17.6074      
      3700   347.16047     -44231.525      55895.621      3318.4208      13.924447      13.535         17.6074      
      3800   317.7223      -44209.057      47597.59       3311.2536      13.894373      13.535         17.6074      
      3900   331.07908     -44236.783      60590.911      3304.0863      13.864298      13.535         17.6074      
      4000   291.67128     -44217.546      63494.337      3296.9191      13.834224      13.535         17.6074      
      4100   286.17849     -44220.482      72706.074      3289.7519      13.80415       13.535         17.6074      
      4200   321.89425     -44247.02       78748.969      3282.5847      13.774075      13.535         17.6074      
      4300   299.98209     -44213.891      64945.756      3275.4175      13.744001      13.535         17.6074      
      4400   306.52327     -44222.734      55906.536      3268.2503      13.713926      13.535         17.6074      
      4500   312.45093     -44218.003      89790.876      3261.083       13.683852      13.535         17.6074      
      4600   281.0322      -44178.675      71049.145      3253.9158      13.653778      13.535         17.6074      
      4700   301.72444     -44188.355      79711.539      3246.7486      13.623703      13.535         17.6074      
      4800   312.34214     -44168.846      67038.395      3239.5814      13.593629      13.535         17.6074      
      4900   301.85186     -44125.309      92862.256      3232.4142      13.563554      13.535         17.6074      
      5000   308.6088      -44125.796      65643.896      3225.247       13.53348       13.535         17.6074      
Loop time of 332.511 on 16 procs for 5000 steps with 366 atoms

Performance: 0.650 ns/day, 36.946 hours/ns, 15.037 timesteps/s, 5.504 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 251.62     | 258.64     | 265.88     |  31.2 | 77.78
Bond    | 0.0017174  | 0.0018963  | 0.0021807  |   0.4 |  0.00
Neigh   | 18.879     | 19.691     | 20.419     |  11.8 |  5.92
Comm    | 19.604     | 26.791     | 33.77      |  95.9 |  8.06
Output  | 0.030258   | 0.035527   | 0.04199    |   2.0 |  0.01
Modify  | 25.753     | 26.44      | 27.182     |   8.5 |  7.95
Other   |            | 0.9105     |            |       |  0.27

Nlocal:          45.75 ave          58 max          35 min
Histogram: 2 0 1 0 1 2 0 0 1 1
Nghost:        3800.75 ave        3937 max        3670 min
Histogram: 2 0 1 0 1 1 1 0 1 1
Neighs:        36433.9 ave       45833 max       27894 min
Histogram: 2 0 1 0 1 1 1 0 1 1

Total # of neighbors = 291471
Ave neighs/atom = 796.36885
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.50372 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.50372 xy delta -0.74931 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.50372 xy delta -0.74931 xz delta -0.01585 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.59956     -44350.845      2929.1665      3590.775       15.067274      13.535         17.6074      
       200   303.95136     -44365.255      12508.17       3597.9422      15.097349      13.535         17.6074      
       300   295.02474     -44384.508      12081.062      3605.1094      15.127423      13.535         17.6074      
       400   300.0284      -44396.224      8723.3037      3612.2766      15.157498      13.535         17.6074      
       500   303.53239     -44401.343      15006.385      3619.4438      15.187572      13.535         17.6074      
       600   288.52184     -44393.449      1313.6099      3626.611       15.217646      13.535         17.6074      
       700   291.92447     -44394.088      9618.6642      3633.7783      15.247721      13.535         17.6074      
       800   293.25473     -44368.135      10547.107      3640.9455      15.277795      13.535         17.6074      
       900   320.74916     -44386.115     -2533.3599      3648.1127      15.30787       13.535         17.6074      
      1000   311.02018     -44383.887      5110.2533      3655.2799      15.337944      13.535         17.6074      
      1100   284.09252     -44381.041     -3187.3445      3662.4471      15.368018      13.535         17.6074      
      1200   299.82613     -44392.685      1112.1004      3669.6143      15.398093      13.535         17.6074      
      1300   298.99702     -44371.372      7358.6376      3676.7815      15.428167      13.535         17.6074      
      1400   308.66269     -44372.332      7351.9331      3683.9488      15.458242      13.535         17.6074      
      1500   280.66934     -44365.184     -4686.2921      3691.116       15.488316      13.535         17.6074      
      1600   279.86118     -44386.823     -3473.5435      3698.2832      15.51839       13.535         17.6074      
      1700   288.8957      -44386.067      5911.1898      3705.4504      15.548465      13.535         17.6074      
      1800   306.51273     -44375.987     -3848.6189      3712.6176      15.578539      13.535         17.6074      
      1900   303.57499     -44361.095      1330.1579      3719.7848      15.608614      13.535         17.6074      
      2000   303.8042      -44365.174     -10902.417      3726.9521      15.638688      13.535         17.6074      
      2100   309.499       -44376.906     -11482.18       3734.1193      15.668762      13.535         17.6074      
      2200   296.10965     -44372.146     -5492.0799      3741.2865      15.698837      13.535         17.6074      
      2300   283.67491     -44359.663     -7331.4563      3748.4537      15.728911      13.535         17.6074      
      2400   303.27545     -44374.922     -13324.767      3755.6209      15.758986      13.535         17.6074      
      2500   297.65331     -44372.823     -8273.033       3762.7881      15.78906       13.535         17.6074      
      2600   292.93982     -44377.253     -12993.998      3769.9553      15.819134      13.535         17.6074      
      2700   297.91483     -44380.211     -10405.302      3777.1226      15.849209      13.535         17.6074      
      2800   297.3489      -44367.397     -6443.7614      3784.2898      15.879283      13.535         17.6074      
      2900   304.12889     -44343.071     -23076.004      3791.457       15.909358      13.535         17.6074      
      3000   322.34512     -44349.481     -16767.291      3798.6242      15.939432      13.535         17.6074      
      3100   292.48149     -44342.645     -18541.696      3805.7914      15.969506      13.535         17.6074      
      3200   292.21957     -44349.828     -16886.018      3812.9586      15.999581      13.535         17.6074      
      3300   301.64259     -44356.91      -17037.106      3820.1259      16.029655      13.535         17.6074      
      3400   296.80281     -44344.09      -18836.254      3827.2931      16.05973       13.535         17.6074      
      3500   301.33881     -44352.941     -14002.084      3834.4603      16.089804      13.535         17.6074      
      3600   285.34655     -44350.518     -11357.669      3841.6275      16.119878      13.535         17.6074      
      3700   277.81218     -44340.473     -15777.514      3848.7947      16.149953      13.535         17.6074      
      3800   311.56822     -44338.427     -15358.346      3855.9619      16.180027      13.535         17.6074      
      3900   306.29968     -44316.531     -26200.014      3863.1292      16.210102      13.535         17.6074      
      4000   311.88948     -44326.948     -18365.232      3870.2964      16.240176      13.535         17.6074      
      4100   298.00352     -44320.481     -25781.389      3877.4636      16.27025       13.535         17.6074      
      4200   283.94443     -44307.715     -14121.839      3884.6308      16.300325      13.535         17.6074      
      4300   295.28872     -44317.017     -21986.741      3891.798       16.330399      13.535         17.6074      
      4400   290.31492     -44297.544     -26407.855      3898.9652      16.360474      13.535         17.6074      
      4500   305.64407     -44282.524     -36834.062      3906.1324      16.390548      13.535         17.6074      
      4600   306.6646      -44282.178     -26178.115      3913.2997      16.420622      13.535         17.6074      
      4700   284.52661     -44283.191     -32333.076      3920.4669      16.450697      13.535         17.6074      
      4800   294.51266     -44286.625     -36796.705      3927.6341      16.480771      13.535         17.6074      
      4900   299.83369     -44283.222     -30111.106      3934.8013      16.510846      13.535         17.6074      
      5000   291.84771     -44285.86      -26583.798      3941.9685      16.54092       13.535         17.6074      
Loop time of 288.813 on 16 procs for 5000 steps with 366 atoms

Performance: 0.748 ns/day, 32.090 hours/ns, 17.312 timesteps/s, 6.336 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 217.95     | 222.68     | 228.28     |  26.5 | 77.10
Bond    | 0.0016974  | 0.0018955  | 0.0022454  |   0.4 |  0.00
Neigh   | 16.443     | 17.023     | 17.695     |   9.3 |  5.89
Comm    | 18.663     | 24.142     | 28.969     |  79.8 |  8.36
Output  | 0.030368   | 0.035902   | 0.043261   |   2.0 |  0.01
Modify  | 23.297     | 23.947     | 24.526     |   7.2 |  8.29
Other   |            | 0.987      |            |       |  0.34

Nlocal:          45.75 ave          53 max          35 min
Histogram: 1 0 1 0 0 2 0 2 0 2
Nghost:         3380.5 ave        3481 max        3280 min
Histogram: 1 0 1 2 0 1 0 2 0 1
Neighs:        29771.9 ave       34154 max       22954 min
Histogram: 1 0 1 0 1 1 0 0 2 2

Total # of neighbors = 238175
Ave neighs/atom = 650.75137
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal ly-${len0}
variable dlen equal ly-13.535
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.535
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.3535 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.3535 yz delta -0.00807 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.64017     -44350.713      2964.522       3576.4405      15.0372        13.50793       17.6074      
       200   306.63008     -44369.481      18811.855      3569.2733      15.0372        13.48086       17.6074      
       300   304.29391     -44388.968      18348.321      3562.1061      15.0372        13.45379       17.6074      
       400   295.39374     -44388.264      11389.606      3554.9389      15.0372        13.42672       17.6074      
       500   295.39328     -44388.984      22243.285      3547.7717      15.0372        13.39965       17.6074      
       600   280.99942     -44384.332      24823.131      3540.6045      15.0372        13.37258       17.6074      
       700   274.21248     -44389.601      7239.4561      3533.4372      15.0372        13.34551       17.6074      
       800   304.99385     -44414.991      20721.117      3526.27        15.0372        13.31844       17.6074      
       900   308.961       -44382.192      10430.923      3519.1028      15.0372        13.29137       17.6074      
      1000   301.28891     -44357.99       22150.082      3511.9356      15.0372        13.2643        17.6074      
      1100   307.96846     -44367.287      31848.157      3504.7684      15.0372        13.23723       17.6074      
      1200   288.39377     -44374.399      22652.119      3497.6012      15.0372        13.21016       17.6074      
      1300   271.67825     -44367.192      27431.338      3490.4339      15.0372        13.18309       17.6074      
      1400   290.50007     -44374.906      17677.626      3483.2667      15.0372        13.15602       17.6074      
      1500   287.75004     -44353.627      39822.645      3476.0995      15.0372        13.12895       17.6074      
      1600   303.8986      -44354.987      22417.512      3468.9323      15.0372        13.10188       17.6074      
      1700   319.40259     -44351.054      33693.446      3461.7651      15.0372        13.07481       17.6074      
      1800   311.44426     -44347.124      29106.24       3454.5979      15.0372        13.04774       17.6074      
      1900   309.05717     -44364.15       35480.895      3447.4307      15.0372        13.02067       17.6074      
      2000   292.37918     -44356.643      35228.014      3440.2634      15.0372        12.9936        17.6074      
      2100   289.55775     -44357.148      27568.556      3433.0962      15.0372        12.96653       17.6074      
      2200   296.83963     -44355.827      32295.542      3425.929       15.0372        12.93946       17.6074      
      2300   311.78986     -44345.767      35523.27       3418.7618      15.0372        12.91239       17.6074      
      2400   306.53871     -44316.698      41295.107      3411.5946      15.0372        12.88532       17.6074      
      2500   303.17077     -44334.707      52633.334      3404.4274      15.0372        12.85825       17.6074      
      2600   281.50449     -44326.683      31551.599      3397.2601      15.0372        12.83118       17.6074      
      2700   287.19304     -44325.647      33168.471      3390.0929      15.0372        12.80411       17.6074      
      2800   306.7782      -44333.516      32108.678      3382.9257      15.0372        12.77704       17.6074      
      2900   291.86086     -44286.367      33146.758      3375.7585      15.0372        12.74997       17.6074      
      3000   328.89069     -44299.159      31282.723      3368.5913      15.0372        12.7229        17.6074      
      3100   310.27934     -44285.519      52005.177      3361.4241      15.0372        12.69583       17.6074      
      3200   306.65125     -44302.545      50383.363      3354.2569      15.0372        12.66876       17.6074      
      3300   287.44144     -44283.229      49508.235      3347.0896      15.0372        12.64169       17.6074      
      3400   314.69462     -44300.114      55490.861      3339.9224      15.0372        12.61462       17.6074      
      3500   296.15224     -44279.038      51917.105      3332.7552      15.0372        12.58755       17.6074      
      3600   292.35145     -44300.308      43594.471      3325.588       15.0372        12.56048       17.6074      
      3700   306.83014     -44302.912      58840.193      3318.4208      15.0372        12.53341       17.6074      
      3800   308.95144     -44295.381      47398.238      3311.2536      15.0372        12.50634       17.6074      
      3900   278.2305      -44279.054      53367.832      3304.0863      15.0372        12.47927       17.6074      
      4000   288.629       -44297.142      55014.903      3296.9191      15.0372        12.4522        17.6074      
      4100   299.21661     -44297.541      45184.084      3289.7519      15.0372        12.42513       17.6074      
      4200   294.07851     -44271.508      46173.317      3282.5847      15.0372        12.39806       17.6074      
      4300   311.79283     -44272.599      67960.847      3275.4175      15.0372        12.37099       17.6074      
      4400   305.91545     -44255.011      66426.626      3268.2503      15.0372        12.34392       17.6074      
      4500   315.02674     -44270.39       49564.833      3261.083       15.0372        12.31685       17.6074      
      4600   282.00935     -44263.972      51333.807      3253.9158      15.0372        12.28978       17.6074      
      4700   287.16938     -44254.107      54422.95       3246.7486      15.0372        12.26271       17.6074      
      4800   296.23472     -44226.713      55027.997      3239.5814      15.0372        12.23564       17.6074      
      4900   312.47861     -44223.206      75659.194      3232.4142      15.0372        12.20857       17.6074      
      5000   320.78005     -44223.547      75137.599      3225.247       15.0372        12.1815        17.6074      
Loop time of 337.467 on 16 procs for 5000 steps with 366 atoms

Performance: 0.640 ns/day, 37.496 hours/ns, 14.816 timesteps/s, 5.423 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 256.6      | 261.92     | 267.88     |  26.3 | 77.61
Bond    | 0.0017906  | 0.0019662  | 0.0021921  |   0.3 |  0.00
Neigh   | 19.596     | 20.3       | 21.131     |  10.7 |  6.02
Comm    | 21.509     | 27.47      | 32.767     |  80.9 |  8.14
Output  | 0.032014   | 0.037737   | 0.044359   |   2.0 |  0.01
Modify  | 26.04      | 26.864     | 27.465     |   8.7 |  7.96
Other   |            | 0.873      |            |       |  0.26

Nlocal:          45.75 ave          62 max          36 min
Histogram: 3 0 0 2 0 1 1 0 0 1
Nghost:         3974.5 ave        4116 max        3849 min
Histogram: 2 0 0 1 1 2 0 0 1 1
Neighs:          36427 ave       48569 max       28927 min
Histogram: 3 0 1 0 1 1 1 0 0 1

Total # of neighbors = 291416
Ave neighs/atom = 796.21858
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.3535 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.3535 yz delta 0.00807 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.67959     -44350.713      2957.2765      3590.775       15.0372        13.56207       17.6074      
       200   307.39298     -44370.153      14020.682      3597.9422      15.0372        13.58914       17.6074      
       300   290.54863     -44388.088      9857.3458      3605.1094      15.0372        13.61621       17.6074      
       400   299.93716     -44397.969      14668.127      3612.2766      15.0372        13.64328       17.6074      
       500   298.91041     -44393.305      20230.258      3619.4438      15.0372        13.67035       17.6074      
       600   287.76475     -44383.334      7756.8116      3626.611       15.0372        13.69742       17.6074      
       700   299.56746     -44388.849      5748.5063      3633.7783      15.0372        13.72449       17.6074      
       800   331.25484     -44400.488      5035.6829      3640.9455      15.0372        13.75156       17.6074      
       900   305.13033     -44371.091      408.88433      3648.1127      15.0372        13.77863       17.6074      
      1000   296.22376     -44386.125      3367.4811      3655.2799      15.0372        13.8057        17.6074      
      1100   311.13186     -44408.857     -1101.979       3662.4471      15.0372        13.83277       17.6074      
      1200   305.15613     -44393.158      4794.2622      3669.6143      15.0372        13.85984       17.6074      
      1300   289.23052     -44370.133     -5161.6768      3676.7815      15.0372        13.88691       17.6074      
      1400   313.19037     -44388.693      2558.9455      3683.9488      15.0372        13.91398       17.6074      
      1500   317.99062     -44380.385      10851.076      3691.116       15.0372        13.94105       17.6074      
      1600   297.65171     -44366.025     -3852.7328      3698.2832      15.0372        13.96812       17.6074      
      1700   302.43903     -44389.959     -5387.4882      3705.4504      15.0372        13.99519       17.6074      
      1800   294.31935     -44379.021     -2590.8668      3712.6176      15.0372        14.02226       17.6074      
      1900   309.08029     -44363.589      64.420021      3719.7848      15.0372        14.04933       17.6074      
      2000   320.13406     -44355.666     -3150.034       3726.9521      15.0372        14.0764        17.6074      
      2100   306.00886     -44349.686     -9821.2756      3734.1193      15.0372        14.10347       17.6074      
      2200   303.14508     -44357.409     -3312.9601      3741.2865      15.0372        14.13054       17.6074      
      2300   304.87006     -44367.819     -1520.9975      3748.4537      15.0372        14.15761       17.6074      
      2400   296.98468     -44365.04      -1741.3248      3755.6209      15.0372        14.18468       17.6074      
      2500   288.54729     -44372.242     -21974.644      3762.7881      15.0372        14.21175       17.6074      
      2600   271.24345     -44371.511     -19382.926      3769.9553      15.0372        14.23882       17.6074      
      2700   279.73458     -44354.311     -5491.955       3777.1226      15.0372        14.26589       17.6074      
      2800   308.60882     -44356.326     -15758.029      3784.2898      15.0372        14.29296       17.6074      
      2900   294.96176     -44330.292     -16602.003      3791.457       15.0372        14.32003       17.6074      
      3000   313.98309     -44342.026     -5638.9387      3798.6242      15.0372        14.3471        17.6074      
      3100   299.59778     -44338.191     -15412.496      3805.7914      15.0372        14.37417       17.6074      
      3200   299.03584     -44357.133     -9958.6067      3812.9586      15.0372        14.40124       17.6074      
      3300   279.45683     -44330.302     -17623.697      3820.1259      15.0372        14.42831       17.6074      
      3400   307.50975     -44330.937     -26503.051      3827.2931      15.0372        14.45538       17.6074      
      3500   313.73427     -44292.53      -13627.304      3834.4603      15.0372        14.48245       17.6074      
      3600   314.53401     -44291.129     -19863.65       3841.6275      15.0372        14.50952       17.6074      
      3700   303.04255     -44295.451     -12738.767      3848.7947      15.0372        14.53659       17.6074      
      3800   301.51925     -44308.344     -16366.407      3855.9619      15.0372        14.56366       17.6074      
      3900   272.35694     -44285.294     -17206.587      3863.1292      15.0372        14.59073       17.6074      
      4000   290.43864     -44303.437     -19950.909      3870.2964      15.0372        14.6178        17.6074      
      4100   297.28361     -44268.923     -24093.543      3877.4636      15.0372        14.64487       17.6074      
      4200   328.08088     -44269.953     -20246.742      3884.6308      15.0372        14.67194       17.6074      
      4300   331.09872     -44282.023     -7742.2704      3891.798       15.0372        14.69901       17.6074      
      4400   304.9604      -44275.741     -17703.904      3898.9652      15.0372        14.72608       17.6074      
      4500   314.91047     -44287.761     -17591.948      3906.1324      15.0372        14.75315       17.6074      
      4600   301.01257     -44271.961     -23258.813      3913.2997      15.0372        14.78022       17.6074      
      4700   299.37885     -44275.475     -21729.875      3920.4669      15.0372        14.80729       17.6074      
      4800   287.67674     -44278.109     -22141.329      3927.6341      15.0372        14.83436       17.6074      
      4900   279.16818     -44280.142     -13846.779      3934.8013      15.0372        14.86143       17.6074      
      5000   294.86904     -44272.71      -14642.06       3941.9685      15.0372        14.8885        17.6074      
Loop time of 285.77 on 16 procs for 5000 steps with 366 atoms

Performance: 0.756 ns/day, 31.752 hours/ns, 17.497 timesteps/s, 6.404 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 213.53     | 218.05     | 225.07     |  31.5 | 76.30
Bond    | 0.0017305  | 0.0019051  | 0.0022503  |   0.3 |  0.00
Neigh   | 17.146     | 17.665     | 18.274     |  10.2 |  6.18
Comm    | 18.239     | 25.162     | 29.694     |  91.8 |  8.81
Output  | 0.028844   | 0.034709   | 0.041363   |   2.0 |  0.01
Modify  | 23.329     | 23.863     | 24.286     |   6.8 |  8.35
Other   |            | 0.9921     |            |       |  0.35

Nlocal:          45.75 ave          52 max          33 min
Histogram: 1 0 0 0 0 1 1 3 0 2
Nghost:        3265.75 ave        3333 max        3187 min
Histogram: 1 2 0 1 0 0 0 0 2 2
Neighs:          29703 ave       33792 max       21581 min
Histogram: 1 0 0 0 0 1 1 3 0 2

Total # of neighbors = 237624
Ave neighs/atom = 649.2459
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal lz-${len0}
variable dlen equal lz-17.6074
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.6074
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.76074 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.7877      -44350.669      2980.8169      3576.4405      15.0372        13.535         17.572185    
       200   302.68308     -44362.783      14262.257      3569.2733      15.0372        13.535         17.53697     
       300   301.4333      -44390.928      15925.735      3562.1061      15.0372        13.535         17.501756    
       400   298.32515     -44387.692      22267.137      3554.9389      15.0372        13.535         17.466541    
       500   296.14735     -44387.533      16337.321      3547.7717      15.0372        13.535         17.431326    
       600   272.44109     -44376.642      17865.071      3540.6045      15.0372        13.535         17.396111    
       700   272.35721     -44380.178      11196.815      3533.4372      15.0372        13.535         17.360896    
       800   304.00964     -44381.064      15426.805      3526.27        15.0372        13.535         17.325682    
       900   327.10082     -44371.2        10531.509      3519.1028      15.0372        13.535         17.290467    
      1000   311.91245     -44360.527      19568.574      3511.9356      15.0372        13.535         17.255252    
      1100   313.74287     -44377.75       26790.563      3504.7684      15.0372        13.535         17.220037    
      1200   312.29691     -44377.275      28887.504      3497.6012      15.0372        13.535         17.184822    
      1300   304.83765     -44378.206      15147.997      3490.4339      15.0372        13.535         17.149608    
      1400   302.09725     -44381.838      20285.394      3483.2667      15.0372        13.535         17.114393    
      1500   298.09799     -44368.229      31155.35       3476.0995      15.0372        13.535         17.079178    
      1600   298.41083     -44348.782      28203.184      3468.9323      15.0372        13.535         17.043963    
      1700   319.61895     -44360.794      29297.026      3461.7651      15.0372        13.535         17.008748    
      1800   292.15338     -44341.906      39196.753      3454.5979      15.0372        13.535         16.973534    
      1900   299.96318     -44365.382      31887.33       3447.4307      15.0372        13.535         16.938319    
      2000   295.83876     -44359.441      11656.921      3440.2634      15.0372        13.535         16.903104    
      2100   300.48526     -44351.555      36777.859      3433.0962      15.0372        13.535         16.867889    
      2200   305.91438     -44333.467      27204.467      3425.929       15.0372        13.535         16.832674    
      2300   304.00598     -44307.737      36919.587      3418.7618      15.0372        13.535         16.79746     
      2400   297.86699     -44302.977      43355.114      3411.5946      15.0372        13.535         16.762245    
      2500   306.76094     -44336.428      44684.754      3404.4274      15.0372        13.535         16.72703     
      2600   278.92176     -44303.821      43416.169      3397.2601      15.0372        13.535         16.691815    
      2700   305.50807     -44324.286      38516.559      3390.0929      15.0372        13.535         16.6566      
      2800   300.36829     -44316.975      42453.392      3382.9257      15.0372        13.535         16.621386    
      2900   297.51996     -44327.936      39266.578      3375.7585      15.0372        13.535         16.586171    
      3000   292.84256     -44309.938      51898.792      3368.5913      15.0372        13.535         16.550956    
      3100   306.73994     -44308.565      40977.085      3361.4241      15.0372        13.535         16.515741    
      3200   307.43401     -44289.532      41557.333      3354.2569      15.0372        13.535         16.480526    
      3300   291.6552      -44287.912      46272.252      3347.0896      15.0372        13.535         16.445312    
      3400   267.42739     -44266.894      54474.161      3339.9224      15.0372        13.535         16.410097    
      3500   306.94146     -44279.578      37126.586      3332.7552      15.0372        13.535         16.374882    
      3600   326.40917     -44273.5        57356.833      3325.588       15.0372        13.535         16.339667    
      3700   314.72285     -44271.971      52623.156      3318.4208      15.0372        13.535         16.304452    
      3800   300.86654     -44270.965      53585.088      3311.2536      15.0372        13.535         16.269238    
      3900   308.35174     -44274.172      54790.512      3304.0863      15.0372        13.535         16.234023    
      4000   319.94423     -44284.096      51969.156      3296.9191      15.0372        13.535         16.198808    
      4100   277.72811     -44240.009      51439.898      3289.7519      15.0372        13.535         16.163593    
      4200   280.67297     -44248.046      61202.27       3282.5847      15.0372        13.535         16.128378    
      4300   287.38921     -44254.918      66541.572      3275.4175      15.0372        13.535         16.093164    
      4400   287.302       -44250.913      63544.954      3268.2503      15.0372        13.535         16.057949    
      4500   286.84683     -44248.155      62391.312      3261.083       15.0372        13.535         16.022734    
      4600   283.14915     -44221.383      66273.384      3253.9158      15.0372        13.535         15.987519    
      4700   323.37851     -44209.291      57746.239      3246.7486      15.0372        13.535         15.952304    
      4800   309.18292     -44186.79       70392.403      3239.5814      15.0372        13.535         15.91709     
      4900   281.41003     -44163.198      75777.831      3232.4142      15.0372        13.535         15.881875    
      5000   292.32783     -44162.633      60553.294      3225.247       15.0372        13.535         15.84666     
Loop time of 333.194 on 16 procs for 5000 steps with 366 atoms

Performance: 0.648 ns/day, 37.022 hours/ns, 15.006 timesteps/s, 5.492 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 254.94     | 259.29     | 264.34     |  22.0 | 77.82
Bond    | 0.001691   | 0.0019262  | 0.0022731  |   0.5 |  0.00
Neigh   | 19.17      | 19.894     | 20.611     |   9.7 |  5.97
Comm    | 20.7       | 25.759     | 30.152     |  69.2 |  7.73
Output  | 0.029293   | 0.034845   | 0.041148   |   2.1 |  0.01
Modify  | 26.547     | 27.256     | 27.918     |   7.3 |  8.18
Other   |            | 0.9548     |            |       |  0.29

Nlocal:          45.75 ave          59 max          32 min
Histogram: 1 0 1 1 1 0 2 1 0 1
Nghost:         3853.5 ave        3919 max        3794 min
Histogram: 2 0 0 1 1 2 0 0 1 1
Neighs:        36415.8 ave       46025 max       25972 min
Histogram: 1 0 1 1 1 0 2 1 0 1

Total # of neighbors = 291326
Ave neighs/atom = 795.97268
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.76074 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.55724     -44350.746      2946.7045      3590.775       15.0372        13.535         17.642615    
       200   303.25701     -44364.717      17741.103      3597.9422      15.0372        13.535         17.67783     
       300   290.19975     -44379.985      4206.5282      3605.1094      15.0372        13.535         17.713044    
       400   284.9204      -44375.845      7927.3705      3612.2766      15.0372        13.535         17.748259    
       500   286.31532     -44378.303      11914.494      3619.4438      15.0372        13.535         17.783474    
       600   274.80973     -44387.895      12437.698      3626.611       15.0372        13.535         17.818689    
       700   268.15254     -44402.96      -9884.6651      3633.7783      15.0372        13.535         17.853904    
       800   295.9499      -44405.38      -1753.6421      3640.9455      15.0372        13.535         17.889118    
       900   307.21695     -44373.601      5028.1464      3648.1127      15.0372        13.535         17.924333    
      1000   305.75871     -44371.455     -10967.754      3655.2799      15.0372        13.535         17.959548    
      1100   310.03379     -44383.948      6927.5292      3662.4471      15.0372        13.535         17.994763    
      1200   304.23307     -44393.261      14484.602      3669.6143      15.0372        13.535         18.029978    
      1300   311.12811     -44405.57       6796.3768      3676.7815      15.0372        13.535         18.065192    
      1400   282.93627     -44389.014      3610.9225      3683.9488      15.0372        13.535         18.100407    
      1500   282.49925     -44412.581     -4182.7116      3691.116       15.0372        13.535         18.135622    
      1600   265.74735     -44389.071     -6516.3354      3698.2832      15.0372        13.535         18.170837    
      1700   294.0129      -44375.668     -11487.334      3705.4504      15.0372        13.535         18.206052    
      1800   280.64599     -44346.272     -2837.8068      3712.6176      15.0372        13.535         18.241266    
      1900   304.58818     -44366.219     -13682.716      3719.7848      15.0372        13.535         18.276481    
      2000   295.70309     -44364.771     -11530.424      3726.9521      15.0372        13.535         18.311696    
      2100   285.17692     -44371.028     -2129.863       3734.1193      15.0372        13.535         18.346911    
      2200   291.32362     -44378.281     -19985.76       3741.2865      15.0372        13.535         18.382126    
      2300   304.14097     -44360.917     -9471.9375      3748.4537      15.0372        13.535         18.41734     
      2400   322.80396     -44340.761     -13631.043      3755.6209      15.0372        13.535         18.452555    
      2500   307.58376     -44333.06      -2370.5155      3762.7881      15.0372        13.535         18.48777     
      2600   290.8852      -44338.671     -10608.171      3769.9553      15.0372        13.535         18.522985    
      2700   297.78047     -44350.79      -6847.4494      3777.1226      15.0372        13.535         18.5582      
      2800   297.09122     -44344.47      -11609.735      3784.2898      15.0372        13.535         18.593414    
      2900   299.34675     -44347.247     -14243.43       3791.457       15.0372        13.535         18.628629    
      3000   297.77868     -44349.527     -15105.428      3798.6242      15.0372        13.535         18.663844    
      3100   287.80913     -44338.121     -16061.102      3805.7914      15.0372        13.535         18.699059    
      3200   298.91985     -44316.757     -14374.576      3812.9586      15.0372        13.535         18.734274    
      3300   305.58672     -44288.51      -22381.675      3820.1259      15.0372        13.535         18.769488    
      3400   338.63574     -44320.148     -24914.618      3827.2931      15.0372        13.535         18.804703    
      3500   312.3794      -44313.732     -13461.218      3834.4603      15.0372        13.535         18.839918    
      3600   298.35463     -44300.895     -26019.564      3841.6275      15.0372        13.535         18.875133    
      3700   300.17977     -44310.111     -18823.705      3848.7947      15.0372        13.535         18.910348    
      3800   300.15289     -44315.353     -27963.06       3855.9619      15.0372        13.535         18.945562    
      3900   316.48953     -44329.879     -26473.113      3863.1292      15.0372        13.535         18.980777    
      4000   268.109       -44289.246     -18725.961      3870.2964      15.0372        13.535         19.015992    
      4100   294.13242     -44317.222     -25567.413      3877.4636      15.0372        13.535         19.051207    
      4200   296.03913     -44293.211     -25427.666      3884.6308      15.0372        13.535         19.086422    
      4300   304.68306     -44267.129     -20287.3        3891.798       15.0372        13.535         19.121636    
      4400   318.37182     -44263.7       -19804.85       3898.9652      15.0372        13.535         19.156851    
      4500   307.38157     -44240.629     -16502.309      3906.1324      15.0372        13.535         19.192066    
      4600   296.70076     -44250.401     -18532.173      3913.2997      15.0372        13.535         19.227281    
      4700   287.82093     -44253.709     -20466.697      3920.4669      15.0372        13.535         19.262496    
      4800   285.1735      -44243.003     -30511.514      3927.6341      15.0372        13.535         19.29771     
      4900   297.74183     -44227.18      -14965.132      3934.8013      15.0372        13.535         19.332925    
      5000   328.00798     -44235.183     -23354.49       3941.9685      15.0372        13.535         19.36814     
Loop time of 287.456 on 16 procs for 5000 steps with 366 atoms

Performance: 0.751 ns/day, 31.940 hours/ns, 17.394 timesteps/s, 6.366 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 213.24     | 221.05     | 230.73     |  42.6 | 76.90
Bond    | 0.0016835  | 0.001943   | 0.0022329  |   0.4 |  0.00
Neigh   | 15.608     | 16.155     | 16.832     |  11.3 |  5.62
Comm    | 15.802     | 25.52      | 33.293     | 125.9 |  8.88
Output  | 0.031572   | 0.037974   | 0.045286   |   2.3 |  0.01
Modify  | 23.161     | 23.731     | 24.242     |   7.8 |  8.26
Other   |            | 0.955      |            |       |  0.33

Nlocal:          45.75 ave          51 max          39 min
Histogram: 1 1 1 1 0 0 0 1 0 3
Nghost:        3354.12 ave        3460 max        3261 min
Histogram: 2 0 0 1 1 1 1 0 1 1
Neighs:          29741 ave       33339 max       25355 min
Histogram: 1 0 2 1 0 0 0 1 0 3

Total # of neighbors = 237928
Ave neighs/atom = 650.0765
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.0807)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.0372
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.50372 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.51228     -44350.668      2964.8231      3583.6077      15.0372        13.535         17.6074      
       200   303.59608     -44366.139      14641.454      3583.6077      15.0372        13.535         17.6074      
       300   287.94523     -44379.572      10996.195      3583.6077      15.0372        13.535         17.6074      
       400   295.59029     -44392.338      8797.6937      3583.6077      15.0372        13.535         17.6074      
       500   296.62182     -44388.958      17910.612      3583.6077      15.0372        13.535         17.6074      
       600   274.8137      -44387.616      9041.6772      3583.6077      15.0372        13.535         17.6074      
       700   263.60699     -44386.347      10658.622      3583.6077      15.0372        13.535         17.6074      
       800   305.72448     -44394.137      15294.074      3583.6077      15.0372        13.535         17.6074      
       900   302.19992     -44377.253      12467.472      3583.6077      15.0372        13.535         17.6074      
      1000   284.73158     -44365.123      3604.0115      3583.6077      15.0372        13.535         17.6074      
      1100   289.34613     -44367.492      17661.191      3583.6077      15.0372        13.535         17.6074      
      1200   305.19167     -44375.144      2783.0508      3583.6077      15.0372        13.535         17.6074      
      1300   309.05656     -44373.191      3475.2804      3583.6077      15.0372        13.535         17.6074      
      1400   330.23814     -44406.742      9223.4653      3583.6077      15.0372        13.535         17.6074      
      1500   292.38718     -44390.998      1515.8037      3583.6077      15.0372        13.535         17.6074      
      1600   284.41748     -44389.367      15565.316      3583.6077      15.0372        13.535         17.6074      
      1700   307.20043     -44394.408      14794.201      3583.6077      15.0372        13.535         17.6074      
      1800   319.92078     -44376.053      29240.995      3583.6077      15.0372        13.535         17.6074      
      1900   326.34193     -44360.918      15114.826      3583.6077      15.0372        13.535         17.6074      
      2000   317.41481     -44378.637      6853.1884      3583.6077      15.0372        13.535         17.6074      
      2100   309.72778     -44382.018      12365.232      3583.6077      15.0372        13.535         17.6074      
      2200   293.13936     -44385.949      18015.409      3583.6077      15.0372        13.535         17.6074      
      2300   300.69295     -44411.128      11871.749      3583.6077      15.0372        13.535         17.6074      
      2400   292.85455     -44402.39       8982.1719      3583.6077      15.0372        13.535         17.6074      
      2500   314.36456     -44394.033      1309.3482      3583.6077      15.0372        13.535         17.6074      
      2600   308.70105     -44371.575      7735.2376      3583.6077      15.0372        13.535         17.6074      
      2700   307.3346      -44379.774      13092.938      3583.6077      15.0372        13.535         17.6074      
      2800   304.1649      -44396.381      11153.788      3583.6077      15.0372        13.535         17.6074      
      2900   288.2902      -44387.025     -495.89768      3583.6077      15.0372        13.535         17.6074      
      3000   306.48247     -44394.701      15785.102      3583.6077      15.0372        13.535         17.6074      
      3100   328.95265     -44384.668      13036.558      3583.6077      15.0372        13.535         17.6074      
      3200   318.34598     -44352.374      15591.533      3583.6077      15.0372        13.535         17.6074      
      3300   310.73748     -44363.589      11863.879      3583.6077      15.0372        13.535         17.6074      
      3400   312.00235     -44378.105      16957.355      3583.6077      15.0372        13.535         17.6074      
      3500   291.58126     -44364.377      19460.37       3583.6077      15.0372        13.535         17.6074      
      3600   292.80405     -44372.856      8917.2206      3583.6077      15.0372        13.535         17.6074      
      3700   295.01936     -44387.942      5671.5488      3583.6077      15.0372        13.535         17.6074      
      3800   283.49415     -44396.117      12960.476      3583.6077      15.0372        13.535         17.6074      
      3900   296.8341      -44410.681      9137.2077      3583.6077      15.0372        13.535         17.6074      
      4000   309.53304     -44380.622      1748.1025      3583.6077      15.0372        13.535         17.6074      
      4100   281.07801     -44340.353      23249.894      3583.6077      15.0372        13.535         17.6074      
      4200   313.32646     -44369.249      9257.0132      3583.6077      15.0372        13.535         17.6074      
      4300   299.48124     -44365.104      10659.095      3583.6077      15.0372        13.535         17.6074      
      4400   295.30809     -44380.654      24831.627      3583.6077      15.0372        13.535         17.6074      
      4500   280.73951     -44380.44       14813.566      3583.6077      15.0372        13.535         17.6074      
      4600   303.88492     -44396.426      19915.463      3583.6077      15.0372        13.535         17.6074      
      4700   302.43985     -44347.031      19359.838      3583.6077      15.0372        13.535         17.6074      
      4800   318.57057     -44352.007      2808.3262      3583.6077      15.0372        13.535         17.6074      
      4900   305.80927     -44351.768      18131.776      3583.6077      15.0372        13.535         17.6074      
      5000   310.1367      -44379.922      9535.1947      3583.6077      15.0372        13.535         17.6074      
Loop time of 297.492 on 16 procs for 5000 steps with 366 atoms

Performance: 0.726 ns/day, 33.055 hours/ns, 16.807 timesteps/s, 6.151 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 205.85     | 223.61     | 238.72     |  75.0 | 75.17
Bond    | 0.0016299  | 0.0018207  | 0.0020056  |   0.4 |  0.00
Neigh   | 17.364     | 18.425     | 19.669     |  18.6 |  6.19
Comm    | 14.876     | 29.897     | 47.616     | 204.7 | 10.05
Output  | 0.026331   | 0.031671   | 0.037678   |   2.1 |  0.01
Modify  | 23.659     | 24.831     | 25.847     |  16.5 |  8.35
Other   |            | 0.6947     |            |       |  0.23

Nlocal:          45.75 ave          58 max          35 min
Histogram: 2 0 0 1 2 0 1 0 1 1
Nghost:        3591.62 ave        3724 max        3460 min
Histogram: 1 0 2 0 1 1 1 0 1 1
Neighs:        32821.6 ave       40989 max       25507 min
Histogram: 2 0 0 1 2 0 1 0 1 1

Total # of neighbors = 262573
Ave neighs/atom = 717.41257
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.50372 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.81136     -44350.75       2957.8743      3583.6077      15.0372        13.535         17.6074      
       200   304.31413     -44366.703      15110.626      3583.6077      15.0372        13.535         17.6074      
       300   290.08995     -44382.098      9663.4251      3583.6077      15.0372        13.535         17.6074      
       400   293.99428     -44392.379      13427.229      3583.6077      15.0372        13.535         17.6074      
       500   283.07052     -44379.834      9918.0338      3583.6077      15.0372        13.535         17.6074      
       600   280.15003     -44367.942      12042.974      3583.6077      15.0372        13.535         17.6074      
       700   288.70709     -44346.197      7306.597       3583.6077      15.0372        13.535         17.6074      
       800   318.71588     -44367.425      15609.75       3583.6077      15.0372        13.535         17.6074      
       900   323.11591     -44393.893      12599.567      3583.6077      15.0372        13.535         17.6074      
      1000   290.31495     -44376.268      6024.2157      3583.6077      15.0372        13.535         17.6074      
      1100   301.75485     -44383.805      12867.206      3583.6077      15.0372        13.535         17.6074      
      1200   306.8378      -44398.781      15285.287      3583.6077      15.0372        13.535         17.6074      
      1300   277.98727     -44391.152      9362.8284      3583.6077      15.0372        13.535         17.6074      
      1400   293.3385      -44412.09       10976.097      3583.6077      15.0372        13.535         17.6074      
      1500   281.77846     -44350.318     -244.73329      3583.6077      15.0372        13.535         17.6074      
      1600   301.82636     -44360.342      1458.5718      3583.6077      15.0372        13.535         17.6074      
      1700   310.74609     -44367.713      5466.9449      3583.6077      15.0372        13.535         17.6074      
      1800   309.48328     -44386.368      12041.894      3583.6077      15.0372        13.535         17.6074      
      1900   303.79542     -44391.189      7168.9199      3583.6077      15.0372        13.535         17.6074      
      2000   308.13823     -44394.628      6417.1585      3583.6077      15.0372        13.535         17.6074      
      2100   278.78661     -44378.048      7468.9438      3583.6077      15.0372        13.535         17.6074      
      2200   265.62295     -44379.24       7954.926       3583.6077      15.0372        13.535         17.6074      
      2300   291.59083     -44382.604      10901.622      3583.6077      15.0372        13.535         17.6074      
      2400   294.77492     -44357.3        9191.1549      3583.6077      15.0372        13.535         17.6074      
      2500   304.08062     -44355.84       6089.0307      3583.6077      15.0372        13.535         17.6074      
      2600   307.11733     -44361.127      10503.813      3583.6077      15.0372        13.535         17.6074      
      2700   298.73137     -44385.943      22719.466      3583.6077      15.0372        13.535         17.6074      
      2800   276.79595     -44368.083      10080.369      3583.6077      15.0372        13.535         17.6074      
      2900   292.49642     -44366.979      11430.382      3583.6077      15.0372        13.535         17.6074      
      3000   306.24268     -44364.514      7561.3294      3583.6077      15.0372        13.535         17.6074      
      3100   302.16732     -44359.09       11010.024      3583.6077      15.0372        13.535         17.6074      
      3200   290.9681      -44351.788      7092.4113      3583.6077      15.0372        13.535         17.6074      
      3300   271.50035     -44356.557      9958.7544      3583.6077      15.0372        13.535         17.6074      
      3400   273.29648     -44377.097      12417.612      3583.6077      15.0372        13.535         17.6074      
      3500   284.93936     -44365.274      13234.927      3583.6077      15.0372        13.535         17.6074      
      3600   308.54727     -44360.31       7216.8977      3583.6077      15.0372        13.535         17.6074      
      3700   297.81794     -44342.667      3116.1442      3583.6077      15.0372        13.535         17.6074      
      3800   311.93989     -44353.44       10806.441      3583.6077      15.0372        13.535         17.6074      
      3900   297.6519      -44346.559      15392.44       3583.6077      15.0372        13.535         17.6074      
      4000   286.92104     -44373.19      -2489.3682      3583.6077      15.0372        13.535         17.6074      
      4100   280.45285     -44359.321      5952.0902      3583.6077      15.0372        13.535         17.6074      
      4200   309.02139     -44364.985      13001.805      3583.6077      15.0372        13.535         17.6074      
      4300   311.59822     -44348.777      4330.9449      3583.6077      15.0372        13.535         17.6074      
      4400   319.2586      -44347.916      802.38947      3583.6077      15.0372        13.535         17.6074      
      4500   299.9499      -44330.535      11536.694      3583.6077      15.0372        13.535         17.6074      
      4600   291.16422     -44328.229      11935.581      3583.6077      15.0372        13.535         17.6074      
      4700   303.85818     -44344.641      15531.955      3583.6077      15.0372        13.535         17.6074      
      4800   312.2774      -44352.64       4702.476       3583.6077      15.0372        13.535         17.6074      
      4900   295.89758     -44362.022      12088.476      3583.6077      15.0372        13.535         17.6074      
      5000   284.07136     -44360.691      13578.701      3583.6077      15.0372        13.535         17.6074      
Loop time of 230.186 on 16 procs for 5000 steps with 366 atoms

Performance: 0.938 ns/day, 25.576 hours/ns, 21.722 timesteps/s, 7.950 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 156.17     | 170.25     | 193.32     |  91.8 | 73.96
Bond    | 0.0010753  | 0.0014021  | 0.0016886  |   0.5 |  0.00
Neigh   | 14.244     | 15.287     | 17.247     |  23.8 |  6.64
Comm    | 1.3842     | 24.491     | 38.626     | 242.1 | 10.64
Output  | 0.012732   | 0.014396   | 0.015692   |   0.8 |  0.01
Modify  | 18.095     | 20.022     | 21.026     |  20.7 |  8.70
Other   |            | 0.1152     |            |       |  0.05

Nlocal:          45.75 ave          57 max          31 min
Histogram: 1 0 0 1 2 0 1 1 1 1
Nghost:        3612.75 ave        3696 max        3545 min
Histogram: 2 2 0 0 0 0 1 1 1 1
Neighs:        32790.9 ave       40433 max       22456 min
Histogram: 1 0 0 1 2 0 1 1 0 2

Total # of neighbors = 262327
Ave neighs/atom = 716.74044
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.1585)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.535
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.3535 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.688       -44350.703      2974.7555      3583.6077      15.0372        13.535         17.6074      
       200   302.563       -44365.723      20404.236      3583.6077      15.0372        13.535         17.6074      
       300   293.29747     -44384.835      10951.746      3583.6077      15.0372        13.535         17.6074      
       400   294.0028      -44392.88       11797.28       3583.6077      15.0372        13.535         17.6074      
       500   290.53219     -44393.358      9388.8273      3583.6077      15.0372        13.535         17.6074      
       600   295.45638     -44403.588      16575.562      3583.6077      15.0372        13.535         17.6074      
       700   297.24581     -44407.58      -1572.3027      3583.6077      15.0372        13.535         17.6074      
       800   315.81661     -44402.434      23209.312      3583.6077      15.0372        13.535         17.6074      
       900   310.12283     -44382.446      10560.546      3583.6077      15.0372        13.535         17.6074      
      1000   298.75031     -44361.815      7417.0425      3583.6077      15.0372        13.535         17.6074      
      1100   309.66516     -44375.625      18252.486      3583.6077      15.0372        13.535         17.6074      
      1200   315.12774     -44408.072      15973.561      3583.6077      15.0372        13.535         17.6074      
      1300   288.74755     -44397.699      14104.472      3583.6077      15.0372        13.535         17.6074      
      1400   278.75395     -44375.008      13314.133      3583.6077      15.0372        13.535         17.6074      
      1500   305.67274     -44373.557      18540.071      3583.6077      15.0372        13.535         17.6074      
      1600   307.55592     -44363.114      8010.7182      3583.6077      15.0372        13.535         17.6074      
      1700   326.08272     -44392.521      19523.05       3583.6077      15.0372        13.535         17.6074      
      1800   306.64656     -44373.208      19122.772      3583.6077      15.0372        13.535         17.6074      
      1900   313.30408     -44395.992      12257.74       3583.6077      15.0372        13.535         17.6074      
      2000   297.95652     -44392.899      2930.7345      3583.6077      15.0372        13.535         17.6074      
      2100   290.2763      -44388.503      51.929642      3583.6077      15.0372        13.535         17.6074      
      2200   319.09874     -44409.04       12480.948      3583.6077      15.0372        13.535         17.6074      
      2300   303.72209     -44361.12       9717.8716      3583.6077      15.0372        13.535         17.6074      
      2400   316.81072     -44368.194     -6045.009       3583.6077      15.0372        13.535         17.6074      
      2500   309.44106     -44382.78       6730.7836      3583.6077      15.0372        13.535         17.6074      
      2600   285.00965     -44389.64       4257.5078      3583.6077      15.0372        13.535         17.6074      
      2700   285.95727     -44390.17       17994.213      3583.6077      15.0372        13.535         17.6074      
      2800   309.83845     -44404.667      5581.4106      3583.6077      15.0372        13.535         17.6074      
      2900   280.91946     -44376.615      4599.2124      3583.6077      15.0372        13.535         17.6074      
      3000   288.14778     -44392.381      7076.9547      3583.6077      15.0372        13.535         17.6074      
      3100   287.02489     -44390.06       8170.3167      3583.6077      15.0372        13.535         17.6074      
      3200   301.69693     -44386.632      16327.108      3583.6077      15.0372        13.535         17.6074      
      3300   312.41216     -44374.207      19396.246      3583.6077      15.0372        13.535         17.6074      
      3400   302.67786     -44346.924      5868.1583      3583.6077      15.0372        13.535         17.6074      
      3500   305.32601     -44359.297      16820.717      3583.6077      15.0372        13.535         17.6074      
      3600   273.50329     -44360.713      3568.1285      3583.6077      15.0372        13.535         17.6074      
      3700   289.62306     -44375.514     -5891.9448      3583.6077      15.0372        13.535         17.6074      
      3800   296.12847     -44380.892      19212.814      3583.6077      15.0372        13.535         17.6074      
      3900   299.9188      -44378.478      16501.559      3583.6077      15.0372        13.535         17.6074      
      4000   301.31454     -44358.833      1076.8021      3583.6077      15.0372        13.535         17.6074      
      4100   307.32478     -44340.467      6271.2385      3583.6077      15.0372        13.535         17.6074      
      4200   302.52592     -44339.86       11899.057      3583.6077      15.0372        13.535         17.6074      
      4300   318.12351     -44382.37       4916.0216      3583.6077      15.0372        13.535         17.6074      
      4400   289.35216     -44361.485      21184.523      3583.6077      15.0372        13.535         17.6074      
      4500   297.96826     -44379.23       10434.455      3583.6077      15.0372        13.535         17.6074      
      4600   294.39348     -44372.387      14084.571      3583.6077      15.0372        13.535         17.6074      
      4700   306.51003     -44365.348      4638.7568      3583.6077      15.0372        13.535         17.6074      
      4800   288.72707     -44322.031      15877.9        3583.6077      15.0372        13.535         17.6074      
      4900   315.27443     -44356.348     -1385.4805      3583.6077      15.0372        13.535         17.6074      
      5000   287.72943     -44358.691      10470.613      3583.6077      15.0372        13.535         17.6074      
Loop time of 178.905 on 16 procs for 5000 steps with 366 atoms

Performance: 1.207 ns/day, 19.878 hours/ns, 27.948 timesteps/s, 10.229 katom-step/s
99.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 139.09     | 143.33     | 147.4      |  23.3 | 80.11
Bond    | 0.00092589 | 0.0012137  | 0.001523   |   0.6 |  0.00
Neigh   | 13.334     | 13.928     | 14.505     |   9.5 |  7.79
Comm    | 1.2896     | 5.3875     | 9.6551     | 121.2 |  3.01
Output  | 0.010514   | 0.012009   | 0.013394   |   0.9 |  0.01
Modify  | 15.575     | 16.127     | 16.698     |   8.3 |  9.01
Other   |            | 0.1208     |            |       |  0.07

Nlocal:          45.75 ave          54 max          36 min
Histogram: 2 0 1 0 0 0 2 1 0 2
Nghost:        3581.25 ave        3699 max        3459 min
Histogram: 1 0 2 0 1 1 0 2 0 1
Neighs:        32785.2 ave       38649 max       25844 min
Histogram: 2 0 1 0 0 1 1 1 0 2

Total # of neighbors = 262282
Ave neighs/atom = 716.61749
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.3535 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.6383      -44350.704      2950.5864      3583.6077      15.0372        13.535         17.6074      
       200   306.08753     -44368.262      16949.422      3583.6077      15.0372        13.535         17.6074      
       300   289.77355     -44381.458      12451.003      3583.6077      15.0372        13.535         17.6074      
       400   289.91632     -44388.316      8272.1698      3583.6077      15.0372        13.535         17.6074      
       500   298.16354     -44396.113      18091.089      3583.6077      15.0372        13.535         17.6074      
       600   282.56255     -44389.697      9257.9085      3583.6077      15.0372        13.535         17.6074      
       700   277.24051     -44398.794      10831.288      3583.6077      15.0372        13.535         17.6074      
       800   290.79795     -44388.62       10551.899      3583.6077      15.0372        13.535         17.6074      
       900   318.74018     -44388.358      13284.263      3583.6077      15.0372        13.535         17.6074      
      1000   316.70994     -44382.577      16578.249      3583.6077      15.0372        13.535         17.6074      
      1100   319.03629     -44391.627      13584.389      3583.6077      15.0372        13.535         17.6074      
      1200   299.0752      -44367.429      23539.441      3583.6077      15.0372        13.535         17.6074      
      1300   300.38292     -44389.989      10773.277      3583.6077      15.0372        13.535         17.6074      
      1400   286.8025      -44402.16       9747.8834      3583.6077      15.0372        13.535         17.6074      
      1500   284.89751     -44390.832      5761.1857      3583.6077      15.0372        13.535         17.6074      
      1600   298.93542     -44378.343      11213.353      3583.6077      15.0372        13.535         17.6074      
      1700   300.35229     -44360.991      23289.696      3583.6077      15.0372        13.535         17.6074      
      1800   292.55183     -44357.322      19691.21       3583.6077      15.0372        13.535         17.6074      
      1900   311.44938     -44386.143      15516.598      3583.6077      15.0372        13.535         17.6074      
      2000   309.62027     -44387.97       9574.8058      3583.6077      15.0372        13.535         17.6074      
      2100   314.0085      -44407.366      20189.881      3583.6077      15.0372        13.535         17.6074      
      2200   289.992       -44379.828      6150.3988      3583.6077      15.0372        13.535         17.6074      
      2300   304.95679     -44386.901      20592.417      3583.6077      15.0372        13.535         17.6074      
      2400   320.33735     -44383.495      17687.422      3583.6077      15.0372        13.535         17.6074      
      2500   313.86181     -44362.358      14127.624      3583.6077      15.0372        13.535         17.6074      
      2600   296.94362     -44368.013      20460.89       3583.6077      15.0372        13.535         17.6074      
      2700   301.95714     -44395.296      7887.6903      3583.6077      15.0372        13.535         17.6074      
      2800   280.95867     -44366.424      24100.318      3583.6077      15.0372        13.535         17.6074      
      2900   304.2844      -44374.875      13596.772      3583.6077      15.0372        13.535         17.6074      
      3000   325.32634     -44375.913      11487.029      3583.6077      15.0372        13.535         17.6074      
      3100   305.90515     -44375.513      18908.694      3583.6077      15.0372        13.535         17.6074      
      3200   304.28815     -44408.802      528.92211      3583.6077      15.0372        13.535         17.6074      
      3300   276.29708     -44373.923     -1340.9323      3583.6077      15.0372        13.535         17.6074      
      3400   308.02119     -44382.775      18498.048      3583.6077      15.0372        13.535         17.6074      
      3500   294.35272     -44349.244      9787.6602      3583.6077      15.0372        13.535         17.6074      
      3600   309.22104     -44349.229      10111.564      3583.6077      15.0372        13.535         17.6074      
      3700   293.47224     -44356.085      26671.256      3583.6077      15.0372        13.535         17.6074      
      3800   291.81172     -44378.038      15370.715      3583.6077      15.0372        13.535         17.6074      
      3900   294.15661     -44387.977      30694.593      3583.6077      15.0372        13.535         17.6074      
      4000   294.03649     -44377.049      19523.798      3583.6077      15.0372        13.535         17.6074      
      4100   314.4524      -44368.693      17458.916      3583.6077      15.0372        13.535         17.6074      
      4200   308.6166      -44342.825      18669.184      3583.6077      15.0372        13.535         17.6074      
      4300   284.98555     -44343.12       9212.7557      3583.6077      15.0372        13.535         17.6074      
      4400   308.16343     -44387.437      16289.204      3583.6077      15.0372        13.535         17.6074      
      4500   283.96213     -44361.237      14685.707      3583.6077      15.0372        13.535         17.6074      
      4600   318.42212     -44385.07       4755.6959      3583.6077      15.0372        13.535         17.6074      
      4700   312.01697     -44355.358      14109.102      3583.6077      15.0372        13.535         17.6074      
      4800   313.09445     -44328.343      8901.7064      3583.6077      15.0372        13.535         17.6074      
      4900   312.27507     -44341.26       10410.254      3583.6077      15.0372        13.535         17.6074      
      5000   311.87495     -44373.019      13405.682      3583.6077      15.0372        13.535         17.6074      
Loop time of 177.864 on 16 procs for 5000 steps with 366 atoms

Performance: 1.214 ns/day, 19.763 hours/ns, 28.111 timesteps/s, 10.289 katom-step/s
99.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 137.91     | 140.92     | 145.97     |  24.3 | 79.23
Bond    | 0.00089781 | 0.0011731  | 0.001446   |   0.5 |  0.00
Neigh   | 13.502     | 13.968     | 14.411     |   8.4 |  7.85
Comm    | 1.1963     | 6.2826     | 9.3087     | 116.2 |  3.53
Output  | 0.010584   | 0.012368   | 0.013797   |   0.9 |  0.01
Modify  | 16.135     | 16.561     | 16.999     |   7.2 |  9.31
Other   |            | 0.1225     |            |       |  0.07

Nlocal:          45.75 ave          54 max          32 min
Histogram: 1 0 0 0 0 3 1 1 0 2
Nghost:        3582.12 ave        3663 max        3498 min
Histogram: 2 0 0 1 1 0 2 0 0 2
Neighs:        32792.6 ave       38473 max       23233 min
Histogram: 1 0 0 0 1 2 1 1 0 2

Total # of neighbors = 262341
Ave neighs/atom = 716.77869
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.4931)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.6074
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.76074 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.6767      -44350.699      2962.9478      3583.6077      15.0372        13.535         17.6074      
       200   306.22004     -44367.166      17454.222      3583.6077      15.0372        13.535         17.6074      
       300   295.62406     -44383.836      11442.09       3583.6077      15.0372        13.535         17.6074      
       400   301.68305     -44393.057      7477.6708      3583.6077      15.0372        13.535         17.6074      
       500   296.84672     -44386.692      23505.501      3583.6077      15.0372        13.535         17.6074      
       600   287.0412      -44384.687      14489.977      3583.6077      15.0372        13.535         17.6074      
       700   286.49748     -44382.448      7526.9536      3583.6077      15.0372        13.535         17.6074      
       800   321.09731     -44396.453      12627.799      3583.6077      15.0372        13.535         17.6074      
       900   305.6844      -44364.434      3825.5882      3583.6077      15.0372        13.535         17.6074      
      1000   309.15658     -44381.791      5972.9752      3583.6077      15.0372        13.535         17.6074      
      1100   292.75343     -44390.426      7787.8221      3583.6077      15.0372        13.535         17.6074      
      1200   302.35497     -44401.555      9523.4156      3583.6077      15.0372        13.535         17.6074      
      1300   295.83026     -44378.845      2897.6555      3583.6077      15.0372        13.535         17.6074      
      1400   312.40584     -44381.874      10777.284      3583.6077      15.0372        13.535         17.6074      
      1500   315.78499     -44373.638      9969.1677      3583.6077      15.0372        13.535         17.6074      
      1600   301.22617     -44361.197      4142.7481      3583.6077      15.0372        13.535         17.6074      
      1700   309.77459     -44390.418      16685.625      3583.6077      15.0372        13.535         17.6074      
      1800   302.87734     -44396.977      9600.6503      3583.6077      15.0372        13.535         17.6074      
      1900   291.38951     -44378.169      15812.051      3583.6077      15.0372        13.535         17.6074      
      2000   298.9336      -44367.681      13867.279      3583.6077      15.0372        13.535         17.6074      
      2100   327.94566     -44361.808      21093.671      3583.6077      15.0372        13.535         17.6074      
      2200   317.10173     -44357.317      5414.2605      3583.6077      15.0372        13.535         17.6074      
      2300   301.53097     -44373.197      9598.4383      3583.6077      15.0372        13.535         17.6074      
      2400   293.70564     -44368.875      17213.629      3583.6077      15.0372        13.535         17.6074      
      2500   296.40392     -44371.857      5763.4839      3583.6077      15.0372        13.535         17.6074      
      2600   293.1601      -44376.307      6917.3535      3583.6077      15.0372        13.535         17.6074      
      2700   299.98719     -44398.111      5673.0787      3583.6077      15.0372        13.535         17.6074      
      2800   285.36502     -44393.799     -752.10032      3583.6077      15.0372        13.535         17.6074      
      2900   279.19815     -44391.601      8115.3111      3583.6077      15.0372        13.535         17.6074      
      3000   286.96742     -44381.233      9292.6725      3583.6077      15.0372        13.535         17.6074      
      3100   286.90935     -44351.165      9442.6248      3583.6077      15.0372        13.535         17.6074      
      3200   304.65611     -44338.379      3727.0338      3583.6077      15.0372        13.535         17.6074      
      3300   303.1899      -44345.529      5819.5826      3583.6077      15.0372        13.535         17.6074      
      3400   306.39036     -44371.387      3121.8778      3583.6077      15.0372        13.535         17.6074      
      3500   287.93142     -44347.487      7042.5072      3583.6077      15.0372        13.535         17.6074      
      3600   292.75514     -44355.976      12406.979      3583.6077      15.0372        13.535         17.6074      
      3700   287.20832     -44357.264      14958.464      3583.6077      15.0372        13.535         17.6074      
      3800   301.18749     -44369.507      7728.751       3583.6077      15.0372        13.535         17.6074      
      3900   286.29666     -44354.939      9805.0373      3583.6077      15.0372        13.535         17.6074      
      4000   283.44722     -44350.371      2232.6329      3583.6077      15.0372        13.535         17.6074      
      4100   285.4098      -44343.982     -226.65949      3583.6077      15.0372        13.535         17.6074      
      4200   306.3346      -44345.605      16815.978      3583.6077      15.0372        13.535         17.6074      
      4300   300.43243     -44315.209      7760.8863      3583.6077      15.0372        13.535         17.6074      
      4400   326.98926     -44327.686      857.75785      3583.6077      15.0372        13.535         17.6074      
      4500   306.52119     -44324.039      12265.554      3583.6077      15.0372        13.535         17.6074      
      4600   297.81319     -44339.555      11696.654      3583.6077      15.0372        13.535         17.6074      
      4700   288.55328     -44325.548      4947.8201      3583.6077      15.0372        13.535         17.6074      
      4800   296.70674     -44318.266      7533.2716      3583.6077      15.0372        13.535         17.6074      
      4900   300.78402     -44303.765      144.3851       3583.6077      15.0372        13.535         17.6074      
      5000   308.55285     -44305.205      7281.0248      3583.6077      15.0372        13.535         17.6074      
Loop time of 176.718 on 16 procs for 5000 steps with 366 atoms

Performance: 1.222 ns/day, 19.635 hours/ns, 28.294 timesteps/s, 10.355 katom-step/s
99.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 137.06     | 141        | 144.7      |  24.8 | 79.79
Bond    | 0.00085385 | 0.0011456  | 0.0014031  |   0.5 |  0.00
Neigh   | 13.339     | 13.828     | 14.329     |   8.4 |  7.82
Comm    | 1.9255     | 5.6518     | 9.6165     | 124.5 |  3.20
Output  | 0.010519   | 0.012136   | 0.013549   |   0.9 |  0.01
Modify  | 15.614     | 16.104     | 16.574     |   7.4 |  9.11
Other   |            | 0.125      |            |       |  0.07

Nlocal:          45.75 ave          55 max          35 min
Histogram: 2 0 0 0 1 0 1 3 0 1
Nghost:        3754.38 ave        3867 max        3645 min
Histogram: 1 0 1 2 0 0 2 1 0 1
Neighs:        32769.4 ave       39280 max       25079 min
Histogram: 2 0 0 0 1 0 2 2 0 1

Total # of neighbors = 262155
Ave neighs/atom = 716.27049
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.76074 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 140.6 | 143.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   308.50984     -44382.009      21155.696      3583.6077      15.0372        13.535         17.6074      
       100   291.64385     -44350.727      2958.8125      3583.6077      15.0372        13.535         17.6074      
       200   308.22825     -44372.55       16048.123      3583.6077      15.0372        13.535         17.6074      
       300   299.99507     -44393.43       9022.8632      3583.6077      15.0372        13.535         17.6074      
       400   287.895       -44390.32       22271.731      3583.6077      15.0372        13.535         17.6074      
       500   284.19493     -44383.949      8739.9856      3583.6077      15.0372        13.535         17.6074      
       600   300.85401     -44388.883      12446.379      3583.6077      15.0372        13.535         17.6074      
       700   301.47353     -44354.602      11552.464      3583.6077      15.0372        13.535         17.6074      
       800   306.66204     -44354.593      14998.232      3583.6077      15.0372        13.535         17.6074      
       900   318.49004     -44388.89       11858.506      3583.6077      15.0372        13.535         17.6074      
      1000   298.00344     -44384.845     -1686.0465      3583.6077      15.0372        13.535         17.6074      
      1100   297.83904     -44390.704      16318.184      3583.6077      15.0372        13.535         17.6074      
      1200   295.23855     -44384.864      15517.805      3583.6077      15.0372        13.535         17.6074      
      1300   300.40516     -44368.161      9706.9344      3583.6077      15.0372        13.535         17.6074      
      1400   328.16323     -44368.141      17896.201      3583.6077      15.0372        13.535         17.6074      
      1500   322.5403      -44366.371      13643.522      3583.6077      15.0372        13.535         17.6074      
      1600   292.74988     -44373.782      14862.587      3583.6077      15.0372        13.535         17.6074      
      1700   287.19827     -44370.504      5734.1299      3583.6077      15.0372        13.535         17.6074      
      1800   296.45399     -44385.348      9269.2364      3583.6077      15.0372        13.535         17.6074      
      1900   289.33296     -44380.293      8185.9558      3583.6077      15.0372        13.535         17.6074      
      2000   288.45422     -44388.871      11336.66       3583.6077      15.0372        13.535         17.6074      
      2100   292.67519     -44407.418      8153.6132      3583.6077      15.0372        13.535         17.6074      
      2200   293.64675     -44383.372      14192.844      3583.6077      15.0372        13.535         17.6074      
      2300   328.25649     -44380.989      17619.669      3583.6077      15.0372        13.535         17.6074      
      2400   309.55996     -44366.611      12889.869      3583.6077      15.0372        13.535         17.6074      
      2500   293.42034     -44362.639      2249.2248      3583.6077      15.0372        13.535         17.6074      
      2600   318.81806     -44407.476      10023.081      3583.6077      15.0372        13.535         17.6074      
      2700   271.41659     -44358.362      16137.157      3583.6077      15.0372        13.535         17.6074      
      2800   296.38939     -44367.755      22067.487      3583.6077      15.0372        13.535         17.6074      
      2900   307.47577     -44366.753      4038.8155      3583.6077      15.0372        13.535         17.6074      
      3000   292.5852      -44351.11       9037.3751      3583.6077      15.0372        13.535         17.6074      
      3100   267.03389     -44352.192      8461.4688      3583.6077      15.0372        13.535         17.6074      
      3200   273.73498     -44366.012      11530.304      3583.6077      15.0372        13.535         17.6074      
      3300   289.87361     -44361.495      18756.595      3583.6077      15.0372        13.535         17.6074      
      3400   302.13383     -44347.374      23170.748      3583.6077      15.0372        13.535         17.6074      
      3500   301.92253     -44323.801      15618.402      3583.6077      15.0372        13.535         17.6074      
      3600   300.57786     -44334.308      7458.8697      3583.6077      15.0372        13.535         17.6074      
      3700   274.39095     -44333.578      8110.9696      3583.6077      15.0372        13.535         17.6074      
      3800   322.78517     -44373.946      10432.905      3583.6077      15.0372        13.535         17.6074      
      3900   305.06525     -44338.814      6089.286       3583.6077      15.0372        13.535         17.6074      
      4000   296.18847     -44329.088      6076.4887      3583.6077      15.0372        13.535         17.6074      
      4100   277.65501     -44322.937      15028.473      3583.6077      15.0372        13.535         17.6074      
      4200   278.44925     -44322.156      2688.3097      3583.6077      15.0372        13.535         17.6074      
      4300   315.00809     -44325.328      6577.4718      3583.6077      15.0372        13.535         17.6074      
      4400   322.63702     -44309.342     -5675.8726      3583.6077      15.0372        13.535         17.6074      
      4500   322.88512     -44322.19       5342.8119      3583.6077      15.0372        13.535         17.6074      
      4600   296.82495     -44310.323     -968.51456      3583.6077      15.0372        13.535         17.6074      
      4700   296.57457     -44310.167      13359.235      3583.6077      15.0372        13.535         17.6074      
      4800   300.0148      -44312.575      4978.3632      3583.6077      15.0372        13.535         17.6074      
      4900   282.25305     -44300.181      1461.6208      3583.6077      15.0372        13.535         17.6074      
      5000   276.32352     -44307.394      4105.3406      3583.6077      15.0372        13.535         17.6074      
Loop time of 157.979 on 16 procs for 5000 steps with 366 atoms

Performance: 1.367 ns/day, 17.553 hours/ns, 31.650 timesteps/s, 11.584 katom-step/s
100.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 117.84     | 121.4      | 127.67     |  31.9 | 76.85
Bond    | 0.00076479 | 0.00099907 | 0.0012943  |   0.0 |  0.00
Neigh   | 12.539     | 12.993     | 13.425     |   8.4 |  8.22
Comm    | 1.216      | 7.4935     | 11.081     | 129.2 |  4.74
Output  | 0.011635   | 0.013184   | 0.014512   |   0.8 |  0.01
Modify  | 15.542     | 15.952     | 16.376     |   7.1 | 10.10
Other   |            | 0.1221     |            |       |  0.08

Nlocal:          45.75 ave          55 max          36 min
Histogram: 1 1 1 0 0 1 2 0 1 1
Nghost:        3443.25 ave        3517 max        3362 min
Histogram: 1 1 0 0 2 1 1 0 0 2
Neighs:        32803.4 ave       39169 max       26086 min
Histogram: 2 0 1 0 0 1 1 1 1 1

Total # of neighbors = 262427
Ave neighs/atom = 717.01366
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:56:37
