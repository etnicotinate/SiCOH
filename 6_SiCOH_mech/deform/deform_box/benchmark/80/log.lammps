LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 80*${nthermo}       # steps of equilibration run 10
variable nequil equal 80*100       
variable nrun equal 80*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 80*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-11-vasp
read_data       ${structure}.data
read_data       333-EXP-11-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.3254e-05 on 8 procs for 1 steps with 274 atoms

57.3% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 2.026e-06  | 2.026e-06  | 2.026e-06  |   0.0 |  3.80
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.679e-06  | 4.8275e-06 | 5.867e-06  |   0.0 |  9.07
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.64e-05   |            |       | 87.13

Nlocal:          34.25 ave          40 max          23 min
Histogram: 1 0 0 0 0 0 2 3 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-11-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 8000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -8.2 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.8 | 110.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -29524.072      53373.102      1.4594291      3472.1201    
       100   940.83325     -30895.433     -22221.566      1.4594291      3472.1201    
       200   655.32859     -31410.555     -8415.0945      1.4594291      3472.1201    
       300   492.44705     -31703.584     -1794.1004      1.4594291      3472.1201    
       400   382.80684     -31863.571     -399.08344      1.4594291      3472.1201    
       500   340.51122     -31988.881     -4396.9622      1.4594291      3472.1201    
       600   278.76054     -32030.093     -12030.124      1.4594291      3472.1201    
       700   252.54387     -32039.073     -16008.085      1.4594291      3472.1201    
       800   303.17696     -32059.227     -7196.0812      1.4594291      3472.1201    
       900   316.31868     -32035.623      1880.9547      1.4594291      3472.1201    
      1000   302.25251     -32011.681      399.58501      1.4594291      3472.1201    
      1100   315.72134     -32030.621     -1937.705       1.4594291      3472.1201    
      1200   304.92451     -32062.996     -4858.2292      1.4594291      3472.1201    
      1300   271.27974     -32068.968     -12188.651      1.4594291      3472.1201    
      1400   282.30555     -32083.975     -5263.1535      1.4594291      3472.1201    
      1500   284.15138     -32063.957     -2027.0405      1.4594291      3472.1201    
      1600   304.84901     -32054.903     -8468.5027      1.4594291      3472.1201    
      1700   320.05144     -32056.724     -12833.076      1.4594291      3472.1201    
      1800   304.8515      -32060.022     -6647.9777      1.4594291      3472.1201    
      1900   292.71773     -32083.757     -1193.4113      1.4594291      3472.1201    
      2000   272.13786     -32083.142      6047.8677      1.4594291      3472.1201    
      2100   289.96718     -32084.631      9390.5456      1.4594291      3472.1201    
      2200   287.75492     -32058.426     -9151.3398      1.4594291      3472.1201    
      2300   335.25197     -32079.165     -16200.698      1.4594291      3472.1201    
      2400   310.32653     -32067.983      2160.6232      1.4594291      3472.1201    
      2500   290.62987     -32076.478     -2874.5909      1.4594291      3472.1201    
      2600   291.63604     -32096.204      1291.0485      1.4594291      3472.1201    
      2700   278.45821     -32085.212      2152.4342      1.4594291      3472.1201    
      2800   295.16014     -32075.293      11384.18       1.4594291      3472.1201    
      2900   321.3704      -32074.659      4968.7777      1.4594291      3472.1201    
      3000   317.98161     -32069.827      4987.1493      1.4594291      3472.1201    
      3100   315.69129     -32093.196     -2919.9481      1.4594291      3472.1201    
      3200   272.69984     -32080.299     -10479.085      1.4594291      3472.1201    
      3300   295.4357      -32094.378     -2307.7923      1.4594291      3472.1201    
      3400   306.68136     -32082.661      166.83382      1.4594291      3472.1201    
      3500   303.62197     -32071.67      -7119.6858      1.4594291      3472.1201    
      3600   295.73041     -32073.133     -3795.8248      1.4594291      3472.1201    
      3700   277.22679     -32074.502     -11588.427      1.4594291      3472.1201    
      3800   297.79238     -32096.778     -7570.1459      1.4594291      3472.1201    
      3900   281.6086      -32077.626     -6662.3657      1.4594291      3472.1201    
      4000   300.60001     -32070.467      2359.5495      1.4594291      3472.1201    
      4100   294.06074     -32057.62       5645.1046      1.4594291      3472.1201    
      4200   301.27329     -32073.305     -18150.364      1.4594291      3472.1201    
      4300   303.9283      -32079.447      7855.4458      1.4594291      3472.1201    
      4400   305.65864     -32079.704      2286.7804      1.4594291      3472.1201    
      4500   322.922       -32092.465     -3549.397       1.4594291      3472.1201    
      4600   285.80906     -32064.212     -12844.728      1.4594291      3472.1201    
      4700   314.3524      -32094.977     -4345.0284      1.4594291      3472.1201    
      4800   296.7886      -32095.23      -3105.819       1.4594291      3472.1201    
      4900   274.49523     -32085.05       4288.4756      1.4594291      3472.1201    
      5000   303.35124     -32096.072      7339.555       1.4594291      3472.1201    
      5100   312.81138     -32085.288     -9208.7156      1.4594291      3472.1201    
      5200   315.87031     -32080.161      1911.4367      1.4594291      3472.1201    
      5300   294.51043     -32063.337     -7181.957       1.4594291      3472.1201    
      5400   302.37637     -32077.028     -5387.4033      1.4594291      3472.1201    
      5500   300.55289     -32083.698     -11712.412      1.4594291      3472.1201    
      5600   286.81598     -32082.197     -4124.5423      1.4594291      3472.1201    
      5700   287.94838     -32087.873     -17730.521      1.4594291      3472.1201    
      5800   288.56291     -32084.062     -6294.3873      1.4594291      3472.1201    
      5900   309.02052     -32089.82       5873.2398      1.4594291      3472.1201    
      6000   332.32223     -32090.501     -1939.7511      1.4594291      3472.1201    
      6100   282.03925     -32054.438     -17108.767      1.4594291      3472.1201    
      6200   302.85272     -32086.968     -10100.378      1.4594291      3472.1201    
      6300   285.77809     -32089.215     -4845.2139      1.4594291      3472.1201    
      6400   290.19453     -32093.381     -3191.1067      1.4594291      3472.1201    
      6500   301.88465     -32095.543     -25381.646      1.4594291      3472.1201    
      6600   286.51305     -32075.469     -2743.8843      1.4594291      3472.1201    
      6700   302.9048      -32069.597      933.3274       1.4594291      3472.1201    
      6800   319.28075     -32082.065     -6514.6725      1.4594291      3472.1201    
      6900   284.22641     -32076.56      -12313.662      1.4594291      3472.1201    
      7000   290.24417     -32099.671      5197.8377      1.4594291      3472.1201    
      7100   262.06924     -32083.029     -12354.398      1.4594291      3472.1201    
      7200   304.12919     -32097.111     -1664.7958      1.4594291      3472.1201    
      7300   299.75064     -32074.363     -8014.1875      1.4594291      3472.1201    
      7400   302.48509     -32076.98       916.15273      1.4594291      3472.1201    
      7500   299.55931     -32085.021     -8080.8124      1.4594291      3472.1201    
      7600   287.39311     -32080.02      -301.89487      1.4594291      3472.1201    
      7700   293.95066     -32087.398     -17628.339      1.4594291      3472.1201    
      7800   297.88062     -32085.589     -4914.549       1.4594291      3472.1201    
      7900   312.00991     -32065.687     -1879.2879      1.4594291      3472.1201    
      8000   308.54031     -32058.36      -6545.7789      1.4594291      3472.1201    
Loop time of 311.024 on 8 procs for 8000 steps with 274 atoms

Performance: 1.111 ns/day, 21.599 hours/ns, 25.722 timesteps/s, 7.048 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 226.62     | 252.93     | 261.71     |  67.9 | 81.32
Bond    | 0.021431   | 0.023806   | 0.025285   |   0.7 |  0.01
Neigh   | 16.701     | 17.808     | 18.586     |  12.1 |  5.73
Comm    | 4.2202     | 13.063     | 39.438     | 299.9 |  4.20
Output  | 0.004046   | 0.0044035  | 0.0066818  |   1.3 |  0.00
Modify  | 26.115     | 27.005     | 28.075     |  10.1 |  8.68
Other   |            | 0.1849     |            |       |  0.06

Nlocal:          34.25 ave          43 max          22 min
Histogram: 1 0 1 0 1 0 1 1 2 1
Nghost:        2818.25 ave        2831 max        2805 min
Histogram: 2 0 0 1 1 1 0 1 0 2
Neighs:          18927 ave       23502 max       12439 min
Histogram: 1 0 1 0 1 0 1 1 2 1

Total # of neighbors = 151416
Ave neighs/atom = 552.61314
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-11-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.8189
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.842
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.0755

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4312
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 1.195
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.3798

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal lx-${len0}
variable dlen equal lx-16.8189
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta -0.01195 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.60783     -32078.13      -2794.1617      1.4596115      3471.6861    
       200   297.24224     -32091.794     -4527.1011      1.459794       3471.2521    
       300   298.65145     -32097.944     -11942.862      1.4599766      3470.8181    
       400   285.42401     -32081.347     -10481.919      1.4601592      3470.3841    
       500   319.99441     -32083.538     -2677.1837      1.4603418      3469.9501    
       600   301.74422     -32053.045     -6566.8511      1.4605245      3469.516     
       700   325.20432     -32090.924      5535.9672      1.4607072      3469.082     
       800   327.58529     -32114.66       6191.1514      1.46089        3468.648     
       900   302.51624     -32101.109     -594.26852      1.4610728      3468.214     
      1000   289.46518     -32095.585     -12740.774      1.4612557      3467.78      
      1100   296.83401     -32090.656      2842.8064      1.4614386      3467.346     
      1200   330.6629      -32091.134     -3255.1149      1.4616215      3466.912     
      1300   295.35177     -32069.86      -8357.9289      1.4618045      3466.4779    
      1400   303.99154     -32094.656     -5479.297       1.4619876      3466.0439    
      1500   291.43459     -32090.375     -9683.7507      1.4621707      3465.6099    
      1600   302.89188     -32098.94      -11148.127      1.4623538      3465.1759    
      1700   283.08949     -32088.913     -4904.2712      1.462537       3464.7419    
      1800   279.09341     -32081.963     -1970.3523      1.4627202      3464.3079    
      1900   327.2284      -32089.662     -8028.5195      1.4629035      3463.8739    
      2000   317.26719     -32080.115     -1643.8375      1.4630868      3463.4398    
      2100   287.80941     -32079.278     -4314.6089      1.4632702      3463.0058    
      2200   312.54403     -32104.925     -5828.9024      1.4634536      3462.5718    
      2300   297.90004     -32084.165     -11090.538      1.4636371      3462.1378    
      2400   300.54746     -32085.378     -6629.8489      1.4638206      3461.7038    
      2500   310.66901     -32096.647      4378.7806      1.4640041      3461.2698    
      2600   287.9203      -32093.985     -39.872746      1.4641877      3460.8357    
      2700   298.15094     -32112.115     -311.82016      1.4643714      3460.4017    
      2800   293.49608     -32105.175     -2297.4557      1.464555       3459.9677    
      2900   287.41606     -32082.191      3699.7725      1.4647388      3459.5337    
      3000   320.46995     -32090.879      6143.2468      1.4649226      3459.0997    
      3100   310.47047     -32086.207     -1744.1419      1.4651064      3458.6657    
      3200   289.20143     -32102.102     -8176.4541      1.4652903      3458.2317    
      3300   289.30817     -32111.472     -12338.448      1.4654742      3457.7976    
      3400   291.88601     -32110.801     -5478.4788      1.4656581      3457.3636    
      3500   306.64786     -32111.905     -3486.0861      1.4658422      3456.9296    
      3600   311.04571     -32104.008     -6926.0174      1.4660262      3456.4956    
      3700   318.2575      -32100.063     -9039.2305      1.4662103      3456.0616    
      3800   305.70536     -32091.226     -13421.413      1.4663945      3455.6276    
      3900   289.61388     -32105.954     -16042.993      1.4665787      3455.1936    
      4000   288.4259      -32121.205     -14682.349      1.4667629      3454.7595    
      4100   288.9965      -32119.045     -7593.9797      1.4669472      3454.3255    
      4200   312.46134     -32136.652      6900.3953      1.4671315      3453.8915    
      4300   290.34462     -32120.627     -10327.734      1.4673159      3453.4575    
      4400   288.78658     -32125.145     -16272.006      1.4675003      3453.0235    
      4500   294.84773     -32134.824     -13429.168      1.4676848      3452.5895    
      4600   290.52257     -32128.082     -2190.5107      1.4678693      3452.1554    
      4700   316.40978     -32132.467     -10382.954      1.4680539      3451.7214    
      4800   320.90938     -32119.438     -1985.3075      1.4682385      3451.2874    
      4900   319.21823     -32132.657     -14965.224      1.4684232      3450.8534    
      5000   275.22351     -32129.652     -6971.6575      1.4686079      3450.4194    
      5100   287.97306     -32135.859     -602.38662      1.4687927      3449.9854    
      5200   294.18397     -32124.226     -4366.473       1.4689775      3449.5514    
      5300   295.54539     -32108.82      -9973.3988      1.4691623      3449.1173    
      5400   312.14723     -32115.989      5885.6048      1.4693472      3448.6833    
      5500   286.0723      -32119.483      1022.9956      1.4695321      3448.2493    
      5600   276.93408     -32130.196     -18771.595      1.4697171      3447.8153    
      5700   306.03071     -32139.988     -8162.4401      1.4699021      3447.3813    
      5800   317.38616     -32130.054     -11897.901      1.4700872      3446.9473    
      5900   312.67196     -32129.138     -5192.6857      1.4702724      3446.5133    
      6000   308.58734     -32136.755      642.20664      1.4704575      3446.0792    
      6100   309.098       -32144.044     -11234.413      1.4706427      3445.6452    
      6200   299.01032     -32134.446     -1513.2398      1.470828       3445.2112    
      6300   296.82531     -32126.232     -14401.571      1.4710133      3444.7772    
      6400   302.60231     -32126.445     -1362.2296      1.4711987      3444.3432    
      6500   292.85727     -32121.9       -15085.478      1.4713841      3443.9092    
      6600   289.75318     -32139.656      3419.6472      1.4715695      3443.4751    
      6700   275.02796     -32141.247     -5858.8119      1.471755       3443.0411    
      6800   281.49466     -32131.253      5407.085       1.4719406      3442.6071    
      6900   303.72632     -32121.752      352.21761      1.4721262      3442.1731    
      7000   303.38095     -32123.363     -9291.8134      1.4723118      3441.7391    
      7100   305.25539     -32136.579      4403.0992      1.4724975      3441.3051    
      7200   289.84992     -32140.847      1802.6192      1.4726832      3440.8711    
      7300   285.25088     -32142.568     -4130.9515      1.472869       3440.437     
      7400   287.9062      -32125.488     -11958.113      1.4730549      3440.003     
      7500   321.7819      -32131.066     -13522.008      1.4732407      3439.569     
      7600   302.81831     -32115.302      4932.6225      1.4734267      3439.135     
      7700   313.05144     -32137.025      383.29708      1.4736126      3438.701     
      7800   282.49545     -32138.295     -6615.0393      1.4737986      3438.267     
      7900   287.17774     -32144.941     -6695.8485      1.4739847      3437.833     
      8000   284.10841     -32135.749     -5940.5863      1.4741708      3437.3989    
Loop time of 312.14 on 8 procs for 8000 steps with 274 atoms

Performance: 1.107 ns/day, 21.676 hours/ns, 25.630 timesteps/s, 7.022 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 231.46     | 248.6      | 262.03     |  65.6 | 79.65
Bond    | 0.021792   | 0.024483   | 0.026181   |   0.8 |  0.01
Neigh   | 16.57      | 17.539     | 18.734     |  16.9 |  5.62
Comm    | 4.8084     | 18.29      | 35.501     | 242.1 |  5.86
Output  | 0.022573   | 0.02582    | 0.028599   |   1.3 |  0.01
Modify  | 26.145     | 27.461     | 28.511     |  14.1 |  8.80
Other   |            | 0.1949     |            |       |  0.06

Nlocal:          34.25 ave          42 max          28 min
Histogram: 2 0 1 0 1 1 1 1 0 1
Nghost:        2824.88 ave        2848 max        2798 min
Histogram: 1 0 2 0 1 0 0 2 0 2
Neighs:        19125.6 ave       23151 max       15782 min
Histogram: 2 0 1 0 1 1 1 1 0 1

Total # of neighbors = 153005
Ave neighs/atom = 558.41241
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta 0.01195 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.60668     -32078.152     -2793.346       1.4592467      3472.5542    
       200   297.44743     -32092.001     -3964.3186      1.4590643      3472.9882    
       300   295.49767     -32095.275     -11325.743      1.458882       3473.4222    
       400   278.92163     -32076.54      -9799.0763      1.4586997      3473.8562    
       500   315.19449     -32079.822      177.55235      1.4585175      3474.2902    
       600   315.08045     -32064.938     -9790.9435      1.4583353      3474.7242    
       700   333.23544     -32098.961     -4264.9724      1.4581532      3475.1582    
       800   305.93483     -32096.977     -19354.681      1.4579711      3475.5923    
       900   293.33304     -32094.759     -9750.9263      1.4577891      3476.0263    
      1000   310.74291     -32106.919     -12847.087      1.4576071      3476.4603    
      1100   304.19279     -32082.442     -15641.926      1.4574251      3476.8943    
      1200   317.21146     -32068.361     -10779.667      1.4572432      3477.3283    
      1300   322.45053     -32082.661     -1930.3567      1.4570614      3477.7623    
      1400   309.93243     -32088.377      3544.8403      1.4568796      3478.1963    
      1500   283.37828     -32068.985     -5373.567       1.4566978      3478.6304    
      1600   320.71648     -32102.325     -11073.243      1.4565161      3479.0644    
      1700   277.73927     -32085.047     -8309.2839      1.4563344      3479.4984    
      1800   285.85682     -32108.461     -7542.5759      1.4561528      3479.9324    
      1900   302.11009     -32105.914      4957.897       1.4559712      3480.3664    
      2000   313.18683     -32085.101     -2240.3593      1.4557896      3480.8004    
      2100   290.28248     -32071.533     -7738.6394      1.4556081      3481.2345    
      2200   278.72537     -32058.339      1830.2437      1.4554267      3481.6685    
      2300   341.74065     -32101.919     -2661.6308      1.4552453      3482.1025    
      2400   271.58883     -32077.04       7194.7666      1.4550639      3482.5365    
      2500   293.31229     -32101.132      2927.8313      1.4548826      3482.9705    
      2600   287.46098     -32091.957     -7964.3775      1.4547013      3483.4045    
      2700   313.62162     -32098.405      3494.7002      1.4545201      3483.8385    
      2800   315.48016     -32077.925     -6009.3503      1.4543389      3484.2726    
      2900   315.61526     -32078.088     -10248.426      1.4541578      3484.7066    
      3000   274.67165     -32074.273     -2177.0931      1.4539767      3485.1406    
      3100   306.69231     -32105.522     -865.08776      1.4537956      3485.5746    
      3200   288.58182     -32092.506     -7673.2747      1.4536146      3486.0086    
      3300   318.02434     -32107.425      765.62057      1.4534337      3486.4426    
      3400   322.55765     -32074.764     -6510.8987      1.4532528      3486.8766    
      3500   338.34324     -32089.913     -14550.297      1.4530719      3487.3107    
      3600   326.1207      -32107.746     -7059.8485      1.4528911      3487.7447    
      3700   306.01761     -32105.811     -5334.8802      1.4527103      3488.1787    
      3800   291.05949     -32109.399     -12832.579      1.4525296      3488.6127    
      3900   285.30798     -32109.207      10040.335      1.4523489      3489.0467    
      4000   312.98588     -32119.565     -1761.0005      1.4521683      3489.4807    
      4100   319.49006     -32093.5       -7245.5806      1.4519877      3489.9148    
      4200   307.10502     -32082.878     -6925.857       1.4518071      3490.3488    
      4300   295.44936     -32096.854     -8576.7259      1.4516266      3490.7828    
      4400   308.78451     -32125.72       7671.7951      1.4514461      3491.2168    
      4500   303.18513     -32128.169     -25011.063      1.4512657      3491.6508    
      4600   278.60434     -32099.029      2526.8131      1.4510854      3492.0848    
      4700   335.16958     -32123.642     -8870.2031      1.450905       3492.5188    
      4800   298.60675     -32103.782      1072.6985      1.4507247      3492.9529    
      4900   292.67339     -32127.962     -9751.0718      1.4505445      3493.3869    
      5000   278.38263     -32134.719     -4839.0986      1.4503643      3493.8209    
      5100   285.70862     -32123.393     -6109.317       1.4501842      3494.2549    
      5200   316.20475     -32114.189     -11349.55       1.4500041      3494.6889    
      5300   301.43669     -32101.507      3616.4607      1.449824       3495.1229    
      5400   287.95704     -32108.143     -8148.3129      1.449644       3495.5569    
      5500   280.80673     -32110.178     -14631.449      1.449464       3495.991     
      5600   302.29997     -32109.918     -11880.706      1.4492841      3496.425     
      5700   306.18729     -32093.705     -14058.233      1.4491042      3496.859     
      5800   303.61384     -32105.309     -561.0638       1.4489244      3497.293     
      5900   289.96004     -32101.033     -4867.801       1.4487446      3497.727     
      6000   293.39853     -32106.925     -14295.054      1.4485649      3498.161     
      6100   300.13299     -32109.001     -6817.6998      1.4483852      3498.5951    
      6200   305.03162     -32086.185     -5385.7127      1.4482055      3499.0291    
      6300   320.82746     -32088.076     -4572.3429      1.4480259      3499.4631    
      6400   313.71064     -32103.579     -8704.7695      1.4478463      3499.8971    
      6500   299.46187     -32107.754     -545.14114      1.4476668      3500.3311    
      6600   289.20938     -32106.292     -8825.0269      1.4474873      3500.7651    
      6700   286.09008     -32104.054     -4032.3855      1.4473079      3501.1991    
      6800   297.2588      -32105.329     -1581.176       1.4471285      3501.6332    
      6900   306.80123     -32074.332     -4078.2528      1.4469492      3502.0672    
      7000   331.80763     -32083.228     -7688.9539      1.4467699      3502.5012    
      7100   328.63364     -32104.905     -11199.904      1.4465906      3502.9352    
      7200   306.42424     -32108.504      5233.4242      1.4464114      3503.3692    
      7300   307.37251     -32126.761     -13857.72       1.4462322      3503.8032    
      7400   304.04543     -32126.3       -608.40151      1.4460531      3504.2372    
      7500   288.23804     -32102.646     -1065.6258      1.445874       3504.6713    
      7600   302.54281     -32082.127      2488.6693      1.445695       3505.1053    
      7700   309.91222     -32085.434      9829.5195      1.445516       3505.5393    
      7800   306.53037     -32098.413      1524.4311      1.4453371      3505.9733    
      7900   299.21815     -32109.704     -17529.441      1.4451582      3506.4073    
      8000   276.33958     -32098.515     -2984.4895      1.4449793      3506.8413    
Loop time of 309.218 on 8 procs for 8000 steps with 274 atoms

Performance: 1.118 ns/day, 21.473 hours/ns, 25.872 timesteps/s, 7.089 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 181.91     | 241.94     | 260.8      | 155.7 | 78.24
Bond    | 0.021208   | 0.023935   | 0.025709   |   1.1 |  0.01
Neigh   | 13.545     | 17.242     | 18.651     |  34.8 |  5.58
Comm    | 2.7277     | 21.586     | 81.633     | 521.8 |  6.98
Output  | 0.023613   | 0.027287   | 0.030417   |   1.5 |  0.01
Modify  | 26.776     | 28.21      | 31.911     |  27.2 |  9.12
Other   |            | 0.1929     |            |       |  0.06

Nlocal:          34.25 ave          43 max          25 min
Histogram: 3 0 0 0 0 0 1 2 0 2
Nghost:        2809.62 ave        2836 max        2787 min
Histogram: 2 0 1 1 0 1 0 2 0 1
Neighs:        18744.1 ave       23294 max       13899 min
Histogram: 3 0 0 0 0 0 1 2 0 2

Total # of neighbors = 149953
Ave neighs/atom = 547.27372
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal ly-${len0}
variable dlen equal ly-12.842
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta -0.004312 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.61566     -32078.134     -2791.8736      1.4596115      3471.6861    
       200   297.28096     -32091.83      -3926.6956      1.459794       3471.2521    
       300   295.7637      -32095.605     -11810.6        1.4599766      3470.8181    
       400   280.5797      -32078.209     -11193.338      1.4601592      3470.3841    
       500   306.32877     -32072.691     -32.148312      1.4603418      3469.9501    
       600   302.04343     -32052.413     -11266.436      1.4605245      3469.516     
       700   333.51205     -32096.628     -38.208159      1.4607072      3469.082     
       800   309.36362     -32098.332     -2972.898       1.46089        3468.648     
       900   293.51454     -32092.859      1005.9923      1.4610728      3468.214     
      1000   307.53424     -32108.647     -5290.5258      1.4612557      3467.78      
      1100   280.0266      -32083.846      747.63434      1.4614386      3467.346     
      1200   298.5877      -32073.753     -5173.974       1.4616215      3466.912     
      1300   294.82321     -32061.304     -5443.9667      1.4618045      3466.4779    
      1400   304.56299     -32076.59      -8677.3206      1.4619876      3466.0439    
      1500   288.48539     -32093.787     -11092.848      1.4621707      3465.6099    
      1600   279.19198     -32099.566     -14368.644      1.4623538      3465.1759    
      1700   294.785       -32102.723      859.00478      1.462537       3464.7419    
      1800   317.38207     -32103.165     -9248.1284      1.4627202      3464.3079    
      1900   298.05486     -32084.678     -10964.398      1.4629035      3463.8739    
      2000   316.07751     -32107.799      293.70988      1.4630868      3463.4398    
      2100   303.68337     -32105.442     -4148.1683      1.4632702      3463.0058    
      2200   313.93297     -32109.01      -1255.2706      1.4634536      3462.5718    
      2300   329.18192     -32099.929     -10860.2        1.4636371      3462.1378    
      2400   318.53699     -32064.56      -10938.353      1.4638206      3461.7038    
      2500   306.6661      -32073         -8417.5751      1.4640041      3461.2698    
      2600   314.48631     -32108.384      7908.263       1.4641877      3460.8357    
      2700   285.88849     -32092.854      8691.4405      1.4643714      3460.4017    
      2800   292.2259      -32099.854     -9683.3489      1.464555       3459.9677    
      2900   298.36985     -32100.468     -14563.659      1.4647388      3459.5337    
      3000   301.54944     -32097.908     -5746.6259      1.4649226      3459.0997    
      3100   329.06005     -32108.828     -22405.336      1.4651064      3458.6657    
      3200   309.37002     -32100.133      1782.4919      1.4652903      3458.2317    
      3300   290.55242     -32112.775     -2215.339       1.4654742      3457.7976    
      3400   316.46381     -32144.298     -13576.878      1.4656581      3457.3636    
      3500   290.55817     -32121.075     -6893.987       1.4658422      3456.9296    
      3600   300.30384     -32108.832      2899.4452      1.4660262      3456.4956    
      3700   331.23468     -32111.736      522.0311       1.4662103      3456.0616    
      3800   299.63408     -32100.393     -8750.1439      1.4663945      3455.6276    
      3900   319.68085     -32132.168     -2295.9998      1.4665787      3455.1936    
      4000   307.75775     -32131.754     -5881.226       1.4667629      3454.7595    
      4100   286.21855     -32122.899     -2112.5836      1.4669472      3454.3255    
      4200   291.20201     -32131.43      -5350.9454      1.4671315      3453.8915    
      4300   307.23595     -32126.672     -3091.4593      1.4673159      3453.4575    
      4400   309.95999     -32113.505      7395.4256      1.4675003      3453.0235    
      4500   326.64033     -32117.699     -1528.9731      1.4676848      3452.5895    
      4600   316.56436     -32130.336     -1194.5359      1.4678693      3452.1554    
      4700   297.19674     -32138.054     -82.270278      1.4680539      3451.7214    
      4800   278.54681     -32116.425      123.86438      1.4682385      3451.2874    
      4900   310.30463     -32122.914     -6636.6926      1.4684232      3450.8534    
      5000   293.40019     -32100.611     -2112.155       1.4686079      3450.4194    
      5100   300.54772     -32104.286     -2845.4371      1.4687927      3449.9854    
      5200   293.3025      -32101.122     -8483.1472      1.4689775      3449.5514    
      5300   296.50155     -32109.239     -2305.6533      1.4691623      3449.1173    
      5400   303.78109     -32127.777     -3044.3883      1.4693472      3448.6833    
      5500   296.83548     -32140.77      -7709.8171      1.4695321      3448.2493    
      5600   296.17204     -32142.814     -11725.91       1.4697171      3447.8153    
      5700   297.0947      -32130.759     -9077.6044      1.4699021      3447.3813    
      5800   314.1897      -32105.413     -5456.4948      1.4700872      3446.9473    
      5900   323.19697     -32111.959     -5594.2985      1.4702724      3446.5133    
      6000   303.38282     -32120.568     -9697.8178      1.4704575      3446.0792    
      6100   299.02523     -32137.301     -5420.9588      1.4706427      3445.6452    
      6200   307.83327     -32155.828      875.30356      1.470828       3445.2112    
      6300   302.51762     -32154.021     -8085.7876      1.4710133      3444.7772    
      6400   308.07885     -32140.012     -13388.806      1.4711987      3444.3432    
      6500   315.36661     -32122.038     -13598.43       1.4713841      3443.9092    
      6600   299.98921     -32117.883     -2297.162       1.4715695      3443.4751    
      6700   289.59468     -32129.592     -16963.159      1.471755       3443.0411    
      6800   289.92958     -32140.866     -4228.694       1.4719406      3442.6071    
      6900   301.16098     -32149          1102.8791      1.4721262      3442.1731    
      7000   304.57563     -32146.166     -16556.824      1.4723118      3441.7391    
      7100   311.2671      -32136.608     -24266.308      1.4724975      3441.3051    
      7200   301.44775     -32109.866     -3396.8985      1.4726832      3440.8711    
      7300   335.40554     -32128.362     -5183.6297      1.472869       3440.437     
      7400   310.70047     -32142.447     -11973.345      1.4730549      3440.003     
      7500   287.42483     -32140.074     -7819.4956      1.4732407      3439.569     
      7600   291.19422     -32143.717     -5707.7312      1.4734267      3439.135     
      7700   306.1865      -32138.072     -8830.4242      1.4736126      3438.701     
      7800   306.75432     -32127.627     -14110.206      1.4737986      3438.267     
      7900   316.16155     -32147.016     -15472.914      1.4739847      3437.833     
      8000   270.64442     -32137.695     -14819.435      1.4741708      3437.3989    
Loop time of 313.223 on 8 procs for 8000 steps with 274 atoms

Performance: 1.103 ns/day, 21.752 hours/ns, 25.541 timesteps/s, 6.998 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 214.27     | 245.96     | 263.75     |  97.4 | 78.53
Bond    | 0.021059   | 0.023795   | 0.025334   |   0.9 |  0.01
Neigh   | 14.843     | 17.355     | 18.154     |  25.3 |  5.54
Comm    | 3.9697     | 21.801     | 53.476     | 327.3 |  6.96
Output  | 0.0242     | 0.027529   | 0.03036    |   1.3 |  0.01
Modify  | 27.055     | 27.876     | 30.411     |  20.2 |  8.90
Other   |            | 0.1816     |            |       |  0.06

Nlocal:          34.25 ave          44 max          21 min
Histogram: 1 0 0 1 1 0 2 1 1 1
Nghost:         2832.5 ave        2855 max        2815 min
Histogram: 2 0 0 2 1 0 1 1 0 1
Neighs:        19140.8 ave       24259 max       11961 min
Histogram: 1 0 0 1 1 0 2 1 1 1

Total # of neighbors = 153126
Ave neighs/atom = 558.85401
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta 0.004312 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.59923     -32078.15      -2794.7234      1.4592467      3472.5542    
       200   297.24537     -32091.888     -4510.8515      1.4590643      3472.9882    
       300   297.7904      -32097.203     -11911.617      1.458882       3473.4222    
       400   285.33827     -32080.764     -10055.078      1.4586997      3473.8562    
       500   319.73509     -32083.84      -1991.1539      1.4585175      3474.2902    
       600   302.08096     -32052.85      -9978.3896      1.4583353      3474.7242    
       700   318.34532     -32085.18      -312.08207      1.4581532      3475.1582    
       800   314.08413     -32101.414     -6914.5104      1.4579711      3475.5923    
       900   288.87356     -32089.554     -15426.625      1.4577891      3476.0263    
      1000   300.65462     -32094.927     -8457.6579      1.4576071      3476.4603    
      1100   296.84548     -32068.525     -7229.2029      1.4574251      3476.8943    
      1200   326.86989     -32080.533     -331.57537      1.4572432      3477.3283    
      1300   302.35385     -32089.874     -6245.2179      1.4570614      3477.7623    
      1400   283.57233     -32086.214     -5867.6175      1.4568796      3478.1963    
      1500   312.66887     -32103.033     -9924.1523      1.4566978      3478.6304    
      1600   292.89427     -32084.39      -79.938422      1.4565161      3479.0644    
      1700   305.24506     -32099.072     -4483.742       1.4563344      3479.4984    
      1800   271.60344     -32082.708     -6440.729       1.4561528      3479.9324    
      1900   308.98147     -32103.159     -5330.038       1.4559712      3480.3664    
      2000   307.44844     -32074.964      1626.1264      1.4557896      3480.8004    
      2100   335.10995     -32091.638     -4502.6471      1.4556081      3481.2345    
      2200   292.75483     -32074.556      8291.9887      1.4554267      3481.6685    
      2300   306.57054     -32091.327     -607.22864      1.4552453      3482.1025    
      2400   307.7661      -32096.506     -4230.5253      1.4550639      3482.5365    
      2500   303.17851     -32098.252     -4127.6239      1.4548826      3482.9705    
      2600   297.27235     -32097.835     -9626.3243      1.4547013      3483.4045    
      2700   276.10788     -32086.013     -8782.648       1.4545201      3483.8385    
      2800   292.27797     -32092.685      11489.364      1.4543389      3484.2726    
      2900   309.46547     -32086.213     -1742.5543      1.4541578      3484.7066    
      3000   329.08685     -32097.321     -2216.9289      1.4539767      3485.1406    
      3100   272.94896     -32064.913      994.17201      1.4537956      3485.5746    
      3200   274.31351     -32089.403      3715.3784      1.4536146      3486.0086    
      3300   300.50362     -32115.339      3240.3202      1.4534337      3486.4426    
      3400   293.58813     -32088.885     -6350.6875      1.4532528      3486.8766    
      3500   325.19584     -32088.88      -2353.8851      1.4530719      3487.3107    
      3600   304.67315     -32075.171     -8076.7449      1.4528911      3487.7447    
      3700   287.26589     -32076.421     -9922.2817      1.4527103      3488.1787    
      3800   278.8069      -32081.098     -7423.7869      1.4525296      3488.6127    
      3900   273.78422     -32084.425     -4373.3498      1.4523489      3489.0467    
      4000   275.58366     -32076.909      2193.54        1.4521683      3489.4807    
      4100   315.69726     -32087.848     -4723.843       1.4519877      3489.9148    
      4200   308.3779      -32070.414     -9061.3973      1.4518071      3490.3488    
      4300   316.88148     -32082.005     -4260.7185      1.4516266      3490.7828    
      4400   288.81707     -32095.669     -8504.7651      1.4514461      3491.2168    
      4500   283.52376     -32096.356     -12655.791      1.4512657      3491.6508    
      4600   300.92091     -32100.695     -20564.177      1.4510854      3492.0848    
      4700   321.05274     -32104.132     -1182.8415      1.450905       3492.5188    
      4800   312.84506     -32070.935     -13993.638      1.4507247      3492.9529    
      4900   328.02        -32076.766     -4769.1868      1.4505445      3493.3869    
      5000   306.73417     -32095.329     -846.42924      1.4503643      3493.8209    
      5100   309.06088     -32110.636     -11333.23       1.4501842      3494.2549    
      5200   281.66511     -32091.884     -9736.827       1.4500041      3494.6889    
      5300   295.2146      -32093.74       1181.6388      1.449824       3495.1229    
      5400   303.45707     -32087.861     -912.28689      1.449644       3495.5569    
      5500   326.86482     -32089.133     -12628.561      1.449464       3495.991     
      5600   318.44031     -32085.181     -4650.536       1.4492841      3496.425     
      5700   298.10217     -32098.439     -16157.396      1.4491042      3496.859     
      5800   276.63898     -32096.361     -5423.5011      1.4489244      3497.293     
      5900   286.15742     -32099.79      -2713.048       1.4487446      3497.727     
      6000   314.32951     -32103.331     -5612.7747      1.4485649      3498.161     
      6100   289.07301     -32076.401     -5359.3444      1.4483852      3498.5951    
      6200   314.16697     -32097.507     -12642.185      1.4482055      3499.0291    
      6300   304.16481     -32095.754     -5633.1529      1.4480259      3499.4631    
      6400   306.55662     -32106.946     -12930.39       1.4478463      3499.8971    
      6500   278.18155     -32093.933      1324.0912      1.4476668      3500.3311    
      6600   251.70944     -32090.442     -227.59345      1.4474873      3500.7651    
      6700   295.73255     -32123.23      -12383.679      1.4473079      3501.1991    
      6800   294.04212     -32093.726     -15046.044      1.4471285      3501.6332    
      6900   302.61141     -32088.137     -13178.455      1.4469492      3502.0672    
      7000   308.54235     -32093.307     -14882.192      1.4467699      3502.5012    
      7100   292.74421     -32097.89      -3683.1316      1.4465906      3502.9352    
      7200   283.07509     -32115.738     -12268.233      1.4464114      3503.3692    
      7300   265.14592     -32110.848     -2333.9402      1.4462322      3503.8032    
      7400   300.73953     -32101.738     -13548.387      1.4460531      3504.2372    
      7500   301.61811     -32092.865      4029.3649      1.445874       3504.6713    
      7600   290.75676     -32084.384      1309.3963      1.445695       3505.1053    
      7700   309.94113     -32099.723      3156.2635      1.445516       3505.5393    
      7800   311.66668     -32107.077      4672.2165      1.4453371      3505.9733    
      7900   285.00192     -32102.123     -10008.77       1.4451582      3506.4073    
      8000   279.8809      -32108.814     -4936.6882      1.4449793      3506.8413    
Loop time of 310.23 on 8 procs for 8000 steps with 274 atoms

Performance: 1.114 ns/day, 21.544 hours/ns, 25.787 timesteps/s, 7.066 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 227.91     | 248.38     | 261.32     |  71.5 | 80.06
Bond    | 0.021108   | 0.023969   | 0.025998   |   0.9 |  0.01
Neigh   | 15.484     | 17.293     | 17.843     |  17.2 |  5.57
Comm    | 4.2977     | 17.287     | 37.729     | 271.6 |  5.57
Output  | 0.021695   | 0.024929   | 0.027627   |   1.3 |  0.01
Modify  | 26.448     | 27.036     | 28.876     |  14.0 |  8.71
Other   |            | 0.1882     |            |       |  0.06

Nlocal:          34.25 ave          42 max          15 min
Histogram: 1 0 0 0 1 1 0 0 1 4
Nghost:           2780 ave        2804 max        2762 min
Histogram: 1 2 1 1 0 1 0 0 1 1
Neighs:        18725.1 ave       22839 max        8446 min
Histogram: 1 0 0 0 1 1 0 0 1 4

Total # of neighbors = 149801
Ave neighs/atom = 546.71898
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal lz-${len0}
variable dlen equal lz-16.0755
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.160755 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.5915      -32078.12      -2783.7103      1.4596115      3471.6861    
       200   297.29663     -32091.994     -4736.4636      1.459794       3471.2521    
       300   298.01425     -32097.837     -11948.128      1.4599766      3470.8181    
       400   283.74179     -32080.251     -11151.519      1.4601592      3470.3841    
       500   318.7498      -32081.339      472.76558      1.4603418      3469.9501    
       600   308.24941     -32058.405     -6153.006       1.4605245      3469.516     
       700   313.9702      -32081.672      5569.7922      1.4607072      3469.082     
       800   308.75078     -32097.604     -1162.0762      1.46089        3468.648     
       900   283.66507     -32083.551     -7629.643       1.4610728      3468.214     
      1000   299.23551     -32097.04      -7226.5869      1.4612557      3467.78      
      1100   299.92196     -32090.972     -3058.9027      1.4614386      3467.346     
      1200   311.85477     -32078.717     -7744.0814      1.4616215      3466.912     
      1300   325.80949     -32087.268     -9345.3881      1.4618045      3466.4779    
      1400   304.0676      -32094.728     -1590.9718      1.4619876      3466.0439    
      1500   275.57933     -32088.283     -4167.0888      1.4621707      3465.6099    
      1600   325.93833     -32122.17      -6283.4326      1.4623538      3465.1759    
      1700   286.35518     -32090.452     -7342.6266      1.462537       3464.7419    
      1800   298.85407     -32090.099      1495.2969      1.4627202      3464.3079    
      1900   320.13177     -32075.058     -2023.8986      1.4629035      3463.8739    
      2000   299.33654     -32071.801     -6609.2875      1.4630868      3463.4398    
      2100   288.24705     -32078.883     -10254.713      1.4632702      3463.0058    
      2200   305.09241     -32102.763     -5902.7206      1.4634536      3462.5718    
      2300   295.06419     -32096.504      41.167817      1.4636371      3462.1378    
      2400   297.13277     -32091.475     -3467.1306      1.4638206      3461.7038    
      2500   289.6         -32064.529     -12831.75       1.4640041      3461.2698    
      2600   336.77932     -32087.77      -4418.9475      1.4641877      3460.8357    
      2700   319.77278     -32093.91      -2284.8792      1.4643714      3460.4017    
      2800   287.26207     -32089.207     -2609.3037      1.464555       3459.9677    
      2900   270.87949     -32076.433     -10269.229      1.4647388      3459.5337    
      3000   321.3103      -32099.95       752.71489      1.4649226      3459.0997    
      3100   310.35932     -32095.283     -3924.2706      1.4651064      3458.6657    
      3200   286.07979     -32080.69       20.173793      1.4652903      3458.2317    
      3300   315.63073     -32101.456     -10929.334      1.4654742      3457.7976    
      3400   290.29844     -32083.842     -3378.2846      1.4656581      3457.3636    
      3500   314.58999     -32104.536     -2973.2453      1.4658422      3456.9296    
      3600   303.65286     -32095.958     -906.35621      1.4660262      3456.4956    
      3700   284.36434     -32088.947     -9145.5148      1.4662103      3456.0616    
      3800   278.77829     -32095.448     -9704.1797      1.4663945      3455.6276    
      3900   296.34827     -32102.352     -11406.361      1.4665787      3455.1936    
      4000   308.92693     -32086.328     -6398.6518      1.4667629      3454.7595    
      4100   301.22997     -32067.952     -10725.401      1.4669472      3454.3255    
      4200   313.82506     -32082.491     -3063.7356      1.4671315      3453.8915    
      4300   303.81966     -32087.81       6922.7484      1.4673159      3453.4575    
      4400   278.68207     -32105.258     -8271.7794      1.4675003      3453.0235    
      4500   281.52637     -32103.972     -16518.959      1.4676848      3452.5895    
      4600   288.02474     -32090.213      3148.0561      1.4678693      3452.1554    
      4700   306.36113     -32088.33      -1235.9119      1.4680539      3451.7214    
      4800   299.90113     -32078.363     -2751.1885      1.4682385      3451.2874    
      4900   303.83147     -32095.984     -6426.3284      1.4684232      3450.8534    
      5000   279.91265     -32101.44      -11350.435      1.4686079      3450.4194    
      5100   305.96883     -32118.291     -1454.7075      1.4687927      3449.9854    
      5200   304.97037     -32105.658      1553.4112      1.4689775      3449.5514    
      5300   286.05795     -32080.478     -15268.815      1.4691623      3449.1173    
      5400   311.82677     -32091.542     -14616.991      1.4693472      3448.6833    
      5500   316.23693     -32092.883      6312.5041      1.4695321      3448.2493    
      5600   285.8899      -32095.327     -7405.2121      1.4697171      3447.8153    
      5700   271.62212     -32095.007     -18058.455      1.4699021      3447.3813    
      5800   292.79451     -32105.914      2797.7635      1.4700872      3446.9473    
      5900   304.51285     -32091.938     -245.15392      1.4702724      3446.5133    
      6000   318.51345     -32077.493      4213.9899      1.4704575      3446.0792    
      6100   304.59683     -32074.134     -1317.1584      1.4706427      3445.6452    
      6200   302.12678     -32084.592     -1614.8509      1.470828       3445.2112    
      6300   298.06156     -32096.184     -1064.1186      1.4710133      3444.7772    
      6400   292.13005     -32096.002     -11370.124      1.4711987      3444.3432    
      6500   302.37639     -32101.354     -3341.0802      1.4713841      3443.9092    
      6600   284.80067     -32091.745      8001.6015      1.4715695      3443.4751    
      6700   281.3755      -32098.021     -11361.949      1.471755       3443.0411    
      6800   288.09632     -32104.465     -8503.8613      1.4719406      3442.6071    
      6900   320.13943     -32127.74      -7033.5262      1.4721262      3442.1731    
      7000   303.72164     -32127.067     -11170.225      1.4723118      3441.7391    
      7100   310.51542     -32133.617      1825.9639      1.4724975      3441.3051    
      7200   283.54211     -32086.28      -4760.1298      1.4726832      3440.8711    
      7300   345.78921     -32113.434     -6608.1755      1.472869       3440.437     
      7400   297.18644     -32090.141     -7611.8221      1.4730549      3440.003     
      7500   287.72661     -32105.858     -5038.4944      1.4732407      3439.569     
      7600   281.80644     -32110.278     -4451.4093      1.4734267      3439.135     
      7700   286.88856     -32107.426     -4963.6392      1.4736126      3438.701     
      7800   305.52946     -32106.35      -2219.2118      1.4737986      3438.267     
      7900   312.69017     -32081.795     -6171.6179      1.4739847      3437.833     
      8000   301.07021     -32084.308      4194.1895      1.4741708      3437.3989    
Loop time of 310.415 on 8 procs for 8000 steps with 274 atoms

Performance: 1.113 ns/day, 21.557 hours/ns, 25.772 timesteps/s, 7.062 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 176.14     | 235.58     | 261.8      | 199.0 | 75.89
Bond    | 0.021034   | 0.023317   | 0.026024   |   1.1 |  0.01
Neigh   | 12.728     | 16.611     | 18.11      |  47.5 |  5.35
Comm    | 3.473      | 29.711     | 89.149     | 560.4 |  9.57
Output  | 0.023369   | 0.027022   | 0.030427   |   1.5 |  0.01
Modify  | 26.793     | 28.287     | 32.189     |  36.6 |  9.11
Other   |            | 0.177      |            |       |  0.06

Nlocal:          34.25 ave          40 max          26 min
Histogram: 1 1 1 0 0 1 0 0 1 3
Nghost:        2854.88 ave        2875 max        2836 min
Histogram: 2 1 0 1 0 0 1 1 1 1
Neighs:        19147.5 ave       22147 max       14820 min
Histogram: 1 2 0 0 0 1 0 0 1 3

Total # of neighbors = 153180
Ave neighs/atom = 559.05109
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.160755 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.64121     -32078.179     -3055.3684      1.4592467      3472.5542    
       200   296.97145     -32091.55      -3940.0124      1.4590643      3472.9882    
       300   295.06116     -32094.882     -11589.164      1.458882       3473.4222    
       400   279.97643     -32077.269     -10528.067      1.4586997      3473.8562    
       500   321.99131     -32085.228     -2488.5367      1.4585175      3474.2902    
       600   314.2651      -32063.994     -12035.16       1.4583353      3474.7242    
       700   329.50682     -32096.311      644.04053      1.4581532      3475.1582    
       800   313.68196     -32102.511     -10982.317      1.4579711      3475.5923    
       900   288.26361     -32089.779     -18200.07       1.4577891      3476.0263    
      1000   291.12843     -32093.49      -9601.1591      1.4576071      3476.4603    
      1100   310.39364     -32089.071      766.29155      1.4574251      3476.8943    
      1200   317.43558     -32076.133     -6489.8155      1.4572432      3477.3283    
      1300   308.29801     -32085.32       1046.9226      1.4570614      3477.7623    
      1400   304.3649      -32098.632     -12393.585      1.4568796      3478.1963    
      1500   300.13474     -32094.536     -9124.4723      1.4566978      3478.6304    
      1600   308.65151     -32098.674     -7929.2407      1.4565161      3479.0644    
      1700   307.78655     -32103.981     -12453.853      1.4563344      3479.4984    
      1800   272.27592     -32094.346      3142.5661      1.4561528      3479.9324    
      1900   282.2647      -32104.562     -5693.6794      1.4559712      3480.3664    
      2000   309.1748      -32095.904      3049.341       1.4557896      3480.8004    
      2100   301.85831     -32074.773      2459.9728      1.4556081      3481.2345    
      2200   296.34245     -32069.226     -1713.5921      1.4554267      3481.6685    
      2300   306.26141     -32079.849     -11411.004      1.4552453      3482.1025    
      2400   294.52582     -32094.696      3981.2761      1.4550639      3482.5365    
      2500   264.64889     -32085.519      5275.5464      1.4548826      3482.9705    
      2600   283.87562     -32094.701     -2437.9561      1.4547013      3483.4045    
      2700   304.21286     -32080.22      -14068.37       1.4545201      3483.8385    
      2800   320.40011     -32090.066      17063.785      1.4543389      3484.2726    
      2900   297.85209     -32084.678     -11167.134      1.4541578      3484.7066    
      3000   316.07517     -32106.345     -7411.3516      1.4539767      3485.1406    
      3100   279.50557     -32092.583      1406.0202      1.4537956      3485.5746    
      3200   277.15304     -32100.963      1971.9398      1.4536146      3486.0086    
      3300   291.61721     -32087.865     -8626.0821      1.4534337      3486.4426    
      3400   304.16627     -32078.02      -2951.1217      1.4532528      3486.8766    
      3500   308.35179     -32078.303     -3580.8418      1.4530719      3487.3107    
      3600   301.8243      -32082.677     -12255.928      1.4528911      3487.7447    
      3700   289.04744     -32097.846     -8186.8339      1.4527103      3488.1787    
      3800   289.27175     -32105.435      3947.5519      1.4525296      3488.6127    
      3900   295.38258     -32081.851     -13306.705      1.4523489      3489.0467    
      4000   315.58286     -32082.156     -16237.589      1.4521683      3489.4807    
      4100   303.64636     -32077.314     -482.63684      1.4519877      3489.9148    
      4200   298.714       -32084.81       3840.3244      1.4518071      3490.3488    
      4300   273.71773     -32074.101     -1731.2622      1.4516266      3490.7828    
      4400   316.20572     -32083.649      10568.921      1.4514461      3491.2168    
      4500   320.99395     -32075.489     -3319.8986      1.4512657      3491.6508    
      4600   325.67831     -32091.185     -5804.656       1.4510854      3492.0848    
      4700   297.87042     -32086.065      286.52668      1.450905       3492.5188    
      4800   296.10625     -32088.586     -15190.343      1.4507247      3492.9529    
      4900   295.44189     -32086.17      -4716.2227      1.4505445      3493.3869    
      5000   293.53884     -32076.131     -1714.6954      1.4503643      3493.8209    
      5100   321.6583      -32088.006     -11632.883      1.4501842      3494.2549    
      5200   309.95699     -32072.695      1053.1439      1.4500041      3494.6889    
      5300   331.85897     -32106.568     -7016.0567      1.449824       3495.1229    
      5400   298.55574     -32105.72      -1445.5246      1.449644       3495.5569    
      5500   301.44637     -32111.815      8238.7516      1.449464       3495.991     
      5600   297.58437     -32101.156      477.30047      1.4492841      3496.425     
      5700   304.83622     -32085.207     -4711.7972      1.4491042      3496.859     
      5800   353.67184     -32106.153     -8768.0673      1.4489244      3497.293     
      5900   311.15687     -32097.217     -4568.2404      1.4487446      3497.727     
      6000   309.71344     -32119.514     -3266.659       1.4485649      3498.161     
      6100   296.79172     -32112.439     -896.32796      1.4483852      3498.5951    
      6200   294.14739     -32098.742     -1120.0345      1.4482055      3499.0291    
      6300   312.8052      -32094.843     -4606.1376      1.4480259      3499.4631    
      6400   310.02273     -32097.56      -14706.708      1.4478463      3499.8971    
      6500   302.68332     -32126.629      973.39079      1.4476668      3500.3311    
      6600   286.67394     -32121.325     -10035.386      1.4474873      3500.7651    
      6700   307.56227     -32125.715     -3035.674       1.4473079      3501.1991    
      6800   308.71367     -32115.371      32.559286      1.4471285      3501.6332    
      6900   295.04025     -32105.232     -1806.4924      1.4469492      3502.0672    
      7000   292.28098     -32115.716      4849.4689      1.4467699      3502.5012    
      7100   266.44411     -32107.659     -3870.6556      1.4465906      3502.9352    
      7200   289.89588     -32112.733      564.05992      1.4464114      3503.3692    
      7300   304.79461     -32102.865      3135.9729      1.4462322      3503.8032    
      7400   298.39335     -32099.221      2818.8751      1.4460531      3504.2372    
      7500   303.59611     -32115.08      -6826.8596      1.445874       3504.6713    
      7600   294.21099     -32116.906     -1703.2477      1.445695       3505.1053    
      7700   282.40292     -32121.171     -15573.425      1.445516       3505.5393    
      7800   300.70883     -32149.147     -10399.009      1.4453371      3505.9733    
      7900   286.38348     -32127.349     -10886.905      1.4451582      3506.4073    
      8000   310.15509     -32122.252     -11717.941      1.4449793      3506.8413    
Loop time of 297.416 on 8 procs for 8000 steps with 274 atoms

Performance: 1.162 ns/day, 20.654 hours/ns, 26.898 timesteps/s, 7.370 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.17     | 219.79     | 249.17     | 196.3 | 73.90
Bond    | 0.020802   | 0.022445   | 0.025402   |   1.0 |  0.01
Neigh   | 12.584     | 16.086     | 17.725     |  44.0 |  5.41
Comm    | 3.5895     | 32.977     | 90.58      | 506.8 | 11.09
Output  | 0.021389   | 0.024348   | 0.02738    |   1.4 |  0.01
Modify  | 26.694     | 28.339     | 31.873     |  33.4 |  9.53
Other   |            | 0.1742     |            |       |  0.06

Nlocal:          34.25 ave          41 max          26 min
Histogram: 2 0 1 0 1 0 0 0 2 2
Nghost:           2778 ave        2819 max        2746 min
Histogram: 2 1 1 0 0 2 0 0 1 1
Neighs:        18768.2 ave       22383 max       14555 min
Histogram: 2 1 0 0 1 0 0 0 3 1

Total # of neighbors = 150146
Ave neighs/atom = 547.9781
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4312)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.168189 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.60012     -32078.143     -2790.1624      1.4594291      3472.1201    
       200   297.43799     -32091.956     -4661.6464      1.4594291      3472.1201    
       300   297.07299     -32096.854     -11117.58       1.4594291      3472.1201    
       400   284.52529     -32080.347     -10350.132      1.4594291      3472.1201    
       500   312.61837     -32077.148     -1584.3477      1.4594291      3472.1201    
       600   308.24744     -32057.084     -6988.7611      1.4594291      3472.1201    
       700   312.85128     -32079.929      9.3918952      1.4594291      3472.1201    
       800   303.1315      -32091.339     -7814.0623      1.4594291      3472.1201    
       900   294.16443     -32094.245     -7169.1169      1.4594291      3472.1201    
      1000   309.24784     -32112.852     -16375.856      1.4594291      3472.1201    
      1100   285.39704     -32089.737     -4303.9189      1.4594291      3472.1201    
      1200   323.36815     -32091.097     -4172.2962      1.4594291      3472.1201    
      1300   309.76212     -32079.186     -4971.1097      1.4594291      3472.1201    
      1400   302.02831     -32081.846     -8957.5839      1.4594291      3472.1201    
      1500   294.61854     -32107.761     -1923.2075      1.4594291      3472.1201    
      1600   282.54435     -32108.508     -1684.6192      1.4594291      3472.1201    
      1700   292.10613     -32101.96      -8613.9618      1.4594291      3472.1201    
      1800   306.14447     -32099.361     -8221.7142      1.4594291      3472.1201    
      1900   318.78463     -32102.506     -2340.1972      1.4594291      3472.1201    
      2000   302.08038     -32087.727     -8949.5448      1.4594291      3472.1201    
      2100   286.97186     -32076.67       617.92895      1.4594291      3472.1201    
      2200   322.61039     -32108.661     -12430.621      1.4594291      3472.1201    
      2300   305.21565     -32100.802     -7675.945       1.4594291      3472.1201    
      2400   293.10172     -32095.67      -7674.344       1.4594291      3472.1201    
      2500   321.6323      -32109.052     -2541.1677      1.4594291      3472.1201    
      2600   327.3762      -32098.635     -10495.501      1.4594291      3472.1201    
      2700   322.83677     -32097.498     -20591.52       1.4594291      3472.1201    
      2800   285.28665     -32091.678     -4175.2275      1.4594291      3472.1201    
      2900   324.32755     -32134.086     -7334.053       1.4594291      3472.1201    
      3000   312.09989     -32119.845     -23818.069      1.4594291      3472.1201    
      3100   329.36563     -32111.652     -10537.31       1.4594291      3472.1201    
      3200   336.26994     -32087.433      4189.026       1.4594291      3472.1201    
      3300   315.96689     -32085.74       2405.5109      1.4594291      3472.1201    
      3400   290.26281     -32085.121     -7199.7702      1.4594291      3472.1201    
      3500   310.00865     -32109.355     -11632.961      1.4594291      3472.1201    
      3600   294.85812     -32105.521     -6741.5397      1.4594291      3472.1201    
      3700   278.01712     -32101.994     -12781.219      1.4594291      3472.1201    
      3800   303.50795     -32124.361     -10888.326      1.4594291      3472.1201    
      3900   319.57963     -32122.78      -14664.993      1.4594291      3472.1201    
      4000   304.3905      -32096.235     -2034.1501      1.4594291      3472.1201    
      4100   290.84146     -32070.625     -19674.957      1.4594291      3472.1201    
      4200   316.26497     -32085.753     -5867.2013      1.4594291      3472.1201    
      4300   278.3884      -32074.765     -1435.5258      1.4594291      3472.1201    
      4400   289.65361     -32096.98      -11654.638      1.4594291      3472.1201    
      4500   305.61809     -32115.505     -10352.933      1.4594291      3472.1201    
      4600   291.88239     -32105.491     -4641.3679      1.4594291      3472.1201    
      4700   317.38133     -32101.866     -13583.811      1.4594291      3472.1201    
      4800   321.72873     -32094.323      4173.6172      1.4594291      3472.1201    
      4900   324.45037     -32103.504     -7029.9605      1.4594291      3472.1201    
      5000   288.29964     -32104.101     -589.69681      1.4594291      3472.1201    
      5100   289.15572     -32111.429     -9852.0405      1.4594291      3472.1201    
      5200   315.94875     -32124.178     -14218.119      1.4594291      3472.1201    
      5300   305.47009     -32105.281     -1966.5731      1.4594291      3472.1201    
      5400   308.36454     -32101.666     -5789.3392      1.4594291      3472.1201    
      5500   301.53547     -32097.405     -10193.706      1.4594291      3472.1201    
      5600   300.4624      -32097.412     -16151.18       1.4594291      3472.1201    
      5700   323.37315     -32114.311     -19056.709      1.4594291      3472.1201    
      5800   291.32432     -32099.775     -19964.358      1.4594291      3472.1201    
      5900   302.81142     -32133.713     -7804.9707      1.4594291      3472.1201    
      6000   302.02891     -32135.168      5681.8695      1.4594291      3472.1201    
      6100   295.39063     -32096.778     -13929.834      1.4594291      3472.1201    
      6200   310.41139     -32095.858     -15162.255      1.4594291      3472.1201    
      6300   310.43633     -32098.214     -18486.289      1.4594291      3472.1201    
      6400   282.33686     -32091.654     -3944.2495      1.4594291      3472.1201    
      6500   298.83671     -32116.877     -1973.82        1.4594291      3472.1201    
      6600   303.68014     -32130.452     -8356.4793      1.4594291      3472.1201    
      6700   282.02289     -32132.311     -1919.6619      1.4594291      3472.1201    
      6800   278.16882     -32131.852      1511.5377      1.4594291      3472.1201    
      6900   292.26231     -32113         -13933.1        1.4594291      3472.1201    
      7000   299.13779     -32104.297     -12980.48       1.4594291      3472.1201    
      7100   295.93234     -32102.359     -9801.9826      1.4594291      3472.1201    
      7200   295.31924     -32111.452     -10572.462      1.4594291      3472.1201    
      7300   274.64265     -32121.017     -3706.4684      1.4594291      3472.1201    
      7400   272.51914     -32117.7       -1959.9209      1.4594291      3472.1201    
      7500   297.95135     -32113.186     -831.21641      1.4594291      3472.1201    
      7600   313.712       -32122.881     -13019.944      1.4594291      3472.1201    
      7700   298.02361     -32112.417     -18359.241      1.4594291      3472.1201    
      7800   281.9685      -32107.301     -10338.878      1.4594291      3472.1201    
      7900   309.67981     -32124.019     -1172.5267      1.4594291      3472.1201    
      8000   322.78179     -32120.875      1162.2409      1.4594291      3472.1201    
Loop time of 289.119 on 8 procs for 8000 steps with 274 atoms

Performance: 1.195 ns/day, 20.078 hours/ns, 27.670 timesteps/s, 7.582 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 158.07     | 207.96     | 241.79     | 246.3 | 71.93
Bond    | 0.019647   | 0.021175   | 0.02371    |   0.8 |  0.01
Neigh   | 12.514     | 15.8       | 18.193     |  62.9 |  5.46
Comm    | 2.6724     | 36.516     | 86.41      | 587.6 | 12.63
Output  | 0.01971    | 0.022718   | 0.025678   |   1.3 |  0.01
Modify  | 26.232     | 28.627     | 31.932     |  47.2 |  9.90
Other   |            | 0.1684     |            |       |  0.06

Nlocal:          34.25 ave          41 max          24 min
Histogram: 1 1 0 1 0 0 0 1 2 2
Nghost:        2805.88 ave        2837 max        2777 min
Histogram: 1 1 0 1 0 2 1 1 0 1
Neighs:          18923 ave       22551 max       13530 min
Histogram: 1 1 0 1 0 0 0 1 2 2

Total # of neighbors = 151384
Ave neighs/atom = 552.49635
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.168189 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.58885     -32078.14      -3272.051       1.4594291      3472.1201    
       200   296.99011     -32091.724     -3939.3233      1.4594291      3472.1201    
       300   297.21586     -32096.576     -11709.702      1.4594291      3472.1201    
       400   281.58254     -32078.495     -10591.675      1.4594291      3472.1201    
       500   325.94455     -32088.613     -1850.8063      1.4594291      3472.1201    
       600   306.15526     -32056.848     -10702.972      1.4594291      3472.1201    
       700   326.76763     -32090.459     -6388.5808      1.4594291      3472.1201    
       800   307.01976     -32095.786      1179.095       1.4594291      3472.1201    
       900   281.21188     -32081.945     -7798.7678      1.4594291      3472.1201    
      1000   282.79348     -32083.844     -11373.238      1.4594291      3472.1201    
      1100   302.39246     -32089.686     -10271.438      1.4594291      3472.1201    
      1200   326.504       -32089.052     -3882.255       1.4594291      3472.1201    
      1300   307.40245     -32070.772     -2458.5797      1.4594291      3472.1201    
      1400   294.76531     -32083.649     -8095.6595      1.4594291      3472.1201    
      1500   300.96489     -32105.508     -10387.085      1.4594291      3472.1201    
      1600   303.0068      -32106.828     -15341.235      1.4594291      3472.1201    
      1700   313.64086     -32108.679     -1379.6248      1.4594291      3472.1201    
      1800   320.91464     -32086.35      -17771.793      1.4594291      3472.1201    
      1900   306.84376     -32066.888     -8920.9006      1.4594291      3472.1201    
      2000   294.69974     -32080.31      -449.00691      1.4594291      3472.1201    
      2100   301.10133     -32104.841     -13939.183      1.4594291      3472.1201    
      2200   283.24049     -32089.629     -3200.4607      1.4594291      3472.1201    
      2300   305.97979     -32094.078      5328.9958      1.4594291      3472.1201    
      2400   305.66804     -32085.551      1369.6718      1.4594291      3472.1201    
      2500   330.1365      -32107.284     -7929.6674      1.4594291      3472.1201    
      2600   276.8754      -32087.218     -2984.0591      1.4594291      3472.1201    
      2700   293.53354     -32115.609     -7510.6752      1.4594291      3472.1201    
      2800   304.984       -32121.788     -4231.6362      1.4594291      3472.1201    
      2900   306.59638     -32100.368     -9309.7467      1.4594291      3472.1201    
      3000   329.48712     -32100.234     -1180.8704      1.4594291      3472.1201    
      3100   306.48781     -32093.685     -17519.28       1.4594291      3472.1201    
      3200   289.9694      -32090.036      464.73886      1.4594291      3472.1201    
      3300   296.37619     -32101.305     -2305.8455      1.4594291      3472.1201    
      3400   295.49351     -32100.32      -4505.5774      1.4594291      3472.1201    
      3500   291.08545     -32093.513     -6697.5118      1.4594291      3472.1201    
      3600   280.91902     -32088.122     -6704.7576      1.4594291      3472.1201    
      3700   300.72807     -32110.392     -11796.417      1.4594291      3472.1201    
      3800   287.27235     -32116.186     -7875.9295      1.4594291      3472.1201    
      3900   272.68274     -32111.195      1081.5252      1.4594291      3472.1201    
      4000   313.69188     -32118.495     -15269.078      1.4594291      3472.1201    
      4100   316.76615     -32111.03       3009.3555      1.4594291      3472.1201    
      4200   315.832       -32122.841      4370.6307      1.4594291      3472.1201    
      4300   281.08868     -32108.109     -8660.7904      1.4594291      3472.1201    
      4400   291.27857     -32115.614     -3932.9398      1.4594291      3472.1201    
      4500   308.3311      -32122.09      -9629.1948      1.4594291      3472.1201    
      4600   294.05748     -32106.654     -16692.332      1.4594291      3472.1201    
      4700   313.54253     -32105.061     -10772.314      1.4594291      3472.1201    
      4800   313.45244     -32098.345     -10826.247      1.4594291      3472.1201    
      4900   319.55273     -32129.077      1796.5647      1.4594291      3472.1201    
      5000   293.13545     -32124.818     -9889.1966      1.4594291      3472.1201    
      5100   295.37748     -32126.046     -10797.153      1.4594291      3472.1201    
      5200   318.80079     -32134.139      16131.69       1.4594291      3472.1201    
      5300   311.6306      -32107.981      8061.3318      1.4594291      3472.1201    
      5400   351.92775     -32106.889     -17003.14       1.4594291      3472.1201    
      5500   332.99395     -32110.84      -21390.517      1.4594291      3472.1201    
      5600   318.14421     -32118.712      1197.3226      1.4594291      3472.1201    
      5700   305.51218     -32129.592      973.00914      1.4594291      3472.1201    
      5800   298.1264      -32134.297      4732.9015      1.4594291      3472.1201    
      5900   307.359       -32140.335     -3805.1397      1.4594291      3472.1201    
      6000   285.5677      -32121.606     -15614.214      1.4594291      3472.1201    
      6100   306.44906     -32117.402     -16108.134      1.4594291      3472.1201    
      6200   332.37937     -32125.826     -9657.1949      1.4594291      3472.1201    
      6300   310.9179      -32122.27      -6502.9461      1.4594291      3472.1201    
      6400   271.15099     -32115.887     -1369.4015      1.4594291      3472.1201    
      6500   291.67634     -32133.133     -2945.4617      1.4594291      3472.1201    
      6600   306.90135     -32134.734      3575.7472      1.4594291      3472.1201    
      6700   312.73519     -32124.181     -10006.992      1.4594291      3472.1201    
      6800   310.9654      -32106.801     -1634.5972      1.4594291      3472.1201    
      6900   322.06242     -32111.678     -14721.117      1.4594291      3472.1201    
      7000   317.21528     -32139.014     -3564.1917      1.4594291      3472.1201    
      7100   294.13343     -32139.255     -11385.553      1.4594291      3472.1201    
      7200   283.37463     -32132.154      11613.899      1.4594291      3472.1201    
      7300   302.80431     -32131.948     -13158.586      1.4594291      3472.1201    
      7400   305.283       -32111.617     -20252.521      1.4594291      3472.1201    
      7500   313.33948     -32106.748     -13869.606      1.4594291      3472.1201    
      7600   314.60886     -32117.683     -12417.01       1.4594291      3472.1201    
      7700   310.46554     -32147.524     -5884.0692      1.4594291      3472.1201    
      7800   314.25842     -32163.167     -12736.434      1.4594291      3472.1201    
      7900   290.92616     -32150.032     -13695.736      1.4594291      3472.1201    
      8000   296.60937     -32147.819     -7409.9607      1.4594291      3472.1201    
Loop time of 287.51 on 8 procs for 8000 steps with 274 atoms

Performance: 1.202 ns/day, 19.966 hours/ns, 27.825 timesteps/s, 7.624 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.13     | 210.22     | 240.63     | 214.2 | 73.12
Bond    | 0.019914   | 0.020776   | 0.022357   |   0.5 |  0.01
Neigh   | 12.642     | 16.092     | 17.812     |  54.4 |  5.60
Comm    | 2.5517     | 32.968     | 86.038     | 540.6 | 11.47
Output  | 0.020086   | 0.023045   | 0.026008   |   1.3 |  0.01
Modify  | 26.288     | 28.007     | 31.485     |  41.7 |  9.74
Other   |            | 0.1742     |            |       |  0.06

Nlocal:          34.25 ave          43 max          21 min
Histogram: 1 0 1 0 0 1 1 2 1 1
Nghost:        2830.62 ave        2856 max        2812 min
Histogram: 1 1 2 1 0 0 1 1 0 1
Neighs:          18928 ave       23615 max       11856 min
Histogram: 1 0 1 0 0 1 1 2 1 1

Total # of neighbors = 151424
Ave neighs/atom = 552.64234
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-1.195)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.12842 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.61045     -32078.133     -2791.3657      1.4594291      3472.1201    
       200   297.30454     -32091.828     -4269.2429      1.4594291      3472.1201    
       300   297.78105     -32097.301     -11640.46       1.4594291      3472.1201    
       400   281.46171     -32078.263     -11237.583      1.4594291      3472.1201    
       500   316.97478     -32081.883     -170.27521      1.4594291      3472.1201    
       600   317.12522     -32066.022     -8079.9445      1.4594291      3472.1201    
       700   320.71375     -32086.618     -5227.4684      1.4594291      3472.1201    
       800   296.00139     -32088.791     -7686.6071      1.4594291      3472.1201    
       900   293.86783     -32092.609     -5261.4168      1.4594291      3472.1201    
      1000   300.4155      -32102.711     -7428.3349      1.4594291      3472.1201    
      1100   292.48255     -32086.562     -5689.1708      1.4594291      3472.1201    
      1200   325.21629     -32084.631      6498.6244      1.4594291      3472.1201    
      1300   307.67916     -32075.583     -3679.2235      1.4594291      3472.1201    
      1400   308.95512     -32094.881     -1572.3672      1.4594291      3472.1201    
      1500   295.8931      -32098.004     -14034.267      1.4594291      3472.1201    
      1600   281.64265     -32084.33       59.543826      1.4594291      3472.1201    
      1700   298.1594      -32090.156     -2577.8637      1.4594291      3472.1201    
      1800   290.5612      -32073.064      6226.7152      1.4594291      3472.1201    
      1900   304.95801     -32057.793     -1025.2222      1.4594291      3472.1201    
      2000   303.77232     -32056.414     -1325.1882      1.4594291      3472.1201    
      2100   301.58428     -32086.771     -1625.3016      1.4594291      3472.1201    
      2200   289.84768     -32084.297     -5108.853       1.4594291      3472.1201    
      2300   308.60199     -32091.307     -4388.1393      1.4594291      3472.1201    
      2400   307.92061     -32098.315     -6630.0756      1.4594291      3472.1201    
      2500   288.91527     -32100.971     -1834.041       1.4594291      3472.1201    
      2600   294.31475     -32118.121     -14439.497      1.4594291      3472.1201    
      2700   284.27282     -32119.78      -11039.691      1.4594291      3472.1201    
      2800   278.63651     -32096.448     -3466.2317      1.4594291      3472.1201    
      2900   292.4231      -32082.6       -12931.985      1.4594291      3472.1201    
      3000   291.53678     -32074.528     -10971.827      1.4594291      3472.1201    
      3100   309.80826     -32092.389     -7025.1807      1.4594291      3472.1201    
      3200   285.49215     -32095.878     -6457.5976      1.4594291      3472.1201    
      3300   289.34306     -32112.211      9374.0365      1.4594291      3472.1201    
      3400   313.49384     -32122.269     -12198.031      1.4594291      3472.1201    
      3500   301.60629     -32076.033     -3539.7302      1.4594291      3472.1201    
      3600   326.6225      -32093.343     -5047.2792      1.4594291      3472.1201    
      3700   297.99413     -32087.648     -2150.3918      1.4594291      3472.1201    
      3800   308.58101     -32109.687     -1129.9563      1.4594291      3472.1201    
      3900   292.29351     -32103.586      1172.1575      1.4594291      3472.1201    
      4000   296.26719     -32127.174     -8493.0224      1.4594291      3472.1201    
      4100   271.7451      -32121.765     -2910.7145      1.4594291      3472.1201    
      4200   316.96313     -32136.391     -10658.697      1.4594291      3472.1201    
      4300   291.99839     -32094.94       7582.7926      1.4594291      3472.1201    
      4400   292.56928     -32087.699     -5013.221       1.4594291      3472.1201    
      4500   296.11243     -32087.094      2806.7467      1.4594291      3472.1201    
      4600   315.20471     -32089.25       2465.6256      1.4594291      3472.1201    
      4700   341.55908     -32109.839     -13151.006      1.4594291      3472.1201    
      4800   303.97793     -32105.794     -4903.0415      1.4594291      3472.1201    
      4900   287.96613     -32103.481     -1765.6929      1.4594291      3472.1201    
      5000   295.96518     -32101.607     -13786.161      1.4594291      3472.1201    
      5100   311.96674     -32089.314     -2433.0473      1.4594291      3472.1201    
      5200   322.82092     -32077.307      665.19417      1.4594291      3472.1201    
      5300   297.89773     -32075.545     -5965.7583      1.4594291      3472.1201    
      5400   304.37794     -32091.819     -19384.529      1.4594291      3472.1201    
      5500   295.50379     -32093.875     -8355.825       1.4594291      3472.1201    
      5600   287.24412     -32104.303      323.22451      1.4594291      3472.1201    
      5700   266.76364     -32096.048      1909.3714      1.4594291      3472.1201    
      5800   283.19296     -32091.878     -7347.6068      1.4594291      3472.1201    
      5900   307.34299     -32083.203     -18934.198      1.4594291      3472.1201    
      6000   289.2305      -32068.848     -5153.695       1.4594291      3472.1201    
      6100   284.09739     -32073.624     -7022.4865      1.4594291      3472.1201    
      6200   300.1643      -32106.746     -8033.6195      1.4594291      3472.1201    
      6300   286.81047     -32118.462      8632.5804      1.4594291      3472.1201    
      6400   287.31967     -32111.935      13033.638      1.4594291      3472.1201    
      6500   310.92148     -32115.451     -915.58483      1.4594291      3472.1201    
      6600   313.29747     -32110.343     -5742.9325      1.4594291      3472.1201    
      6700   306.8452      -32086.94      -7040.8451      1.4594291      3472.1201    
      6800   307.98977     -32077.686      3513.8184      1.4594291      3472.1201    
      6900   309.92945     -32096.199     -3224.1884      1.4594291      3472.1201    
      7000   302.67791     -32117.089      4952.1317      1.4594291      3472.1201    
      7100   290.30719     -32110.796     -10181.79       1.4594291      3472.1201    
      7200   305.49601     -32121.447     -4067.5715      1.4594291      3472.1201    
      7300   307.91074     -32116.885     -4271.4764      1.4594291      3472.1201    
      7400   299.54919     -32096.213     -585.13779      1.4594291      3472.1201    
      7500   308.74239     -32078.827     -8310.6095      1.4594291      3472.1201    
      7600   321.43949     -32088.016     -13472.59       1.4594291      3472.1201    
      7700   288.10186     -32097.156      426.56425      1.4594291      3472.1201    
      7800   297.40873     -32115.985     -13183.174      1.4594291      3472.1201    
      7900   285.18745     -32107.355     -1563.1349      1.4594291      3472.1201    
      8000   305.66987     -32107.315      1567.9985      1.4594291      3472.1201    
Loop time of 274.386 on 8 procs for 8000 steps with 274 atoms

Performance: 1.260 ns/day, 19.055 hours/ns, 29.156 timesteps/s, 7.989 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 153.38     | 195.63     | 217.5      | 152.6 | 71.30
Bond    | 0.020325   | 0.020977   | 0.02291    |   0.5 |  0.01
Neigh   | 12.613     | 15.307     | 17.506     |  41.4 |  5.58
Comm    | 14.581     | 36.407     | 78.64      | 353.6 | 13.27
Output  | 0.019089   | 0.021683   | 0.024366   |   1.2 |  0.01
Modify  | 24.593     | 26.83      | 29.571     |  31.7 |  9.78
Other   |            | 0.1658     |            |       |  0.06

Nlocal:          34.25 ave          43 max          25 min
Histogram: 2 0 1 0 0 1 1 1 1 1
Nghost:           2806 ave        2824 max        2779 min
Histogram: 1 0 0 2 1 0 0 1 1 2
Neighs:        18938.2 ave       23472 max       14068 min
Histogram: 2 0 1 0 0 1 1 1 0 2

Total # of neighbors = 151506
Ave neighs/atom = 552.94161
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.12842 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.62029     -32078.163     -3045.4798      1.4594291      3472.1201    
       200   297.08376     -32091.731     -4198.1048      1.4594291      3472.1201    
       300   297.03322     -32096.696     -11824.716      1.4594291      3472.1201    
       400   284.00328     -32080.464     -9296.9569      1.4594291      3472.1201    
       500   319.18673     -32083.241     -2369.841       1.4594291      3472.1201    
       600   304.74464     -32056.176     -15545.723      1.4594291      3472.1201    
       700   311.47281     -32081.254      3163.3673      1.4594291      3472.1201    
       800   310.13167     -32099.682     -1413.6542      1.4594291      3472.1201    
       900   285.67321     -32088.976     -2141.3148      1.4594291      3472.1201    
      1000   308.99657     -32108.205     -675.79759      1.4594291      3472.1201    
      1100   283.26874     -32080.362     -17591.456      1.4594291      3472.1201    
      1200   321.18866     -32085.756     -4133.1948      1.4594291      3472.1201    
      1300   317.32337     -32083.785     -5861.9121      1.4594291      3472.1201    
      1400   312.76466     -32103.437     -12744.671      1.4594291      3472.1201    
      1500   284.36583     -32102.108     -3295.673       1.4594291      3472.1201    
      1600   289.1628      -32103.091     -6051.3778      1.4594291      3472.1201    
      1700   320.15318     -32121.129     -6069.9685      1.4594291      3472.1201    
      1800   297.94725     -32090.548     -16740.109      1.4594291      3472.1201    
      1900   313.38206     -32089.43      -919.45765      1.4594291      3472.1201    
      2000   310.68806     -32088.436     -8945.4142      1.4594291      3472.1201    
      2100   298.84771     -32083.004     -4647.0474      1.4594291      3472.1201    
      2200   284.31281     -32075.294      6436.204       1.4594291      3472.1201    
      2300   307.17869     -32089.079     -2865.7531      1.4594291      3472.1201    
      2400   298.09603     -32059.781     -3766.6181      1.4594291      3472.1201    
      2500   317.39302     -32060.182     -4121.6591      1.4594291      3472.1201    
      2600   307.67242     -32077.395      2258.1642      1.4594291      3472.1201    
      2700   297.77876     -32087.971     -10016.762      1.4594291      3472.1201    
      2800   314.84835     -32108.032     -9730.2182      1.4594291      3472.1201    
      2900   273.28211     -32087.929     -2912.1609      1.4594291      3472.1201    
      3000   292.04792     -32113.419     -11973.178      1.4594291      3472.1201    
      3100   269.56511     -32117.163     -10692.782      1.4594291      3472.1201    
      3200   279.75592     -32130.635     -8888.4729      1.4594291      3472.1201    
      3300   285.50066     -32101.911      1573.2002      1.4594291      3472.1201    
      3400   298.57977     -32096.733     -19659.004      1.4594291      3472.1201    
      3500   292.96345     -32089.73      -4816.3928      1.4594291      3472.1201    
      3600   306.918       -32101.656     -16983.668      1.4594291      3472.1201    
      3700   296.29015     -32093.079     -5657.436       1.4594291      3472.1201    
      3800   299.05181     -32103.465     -3223.1584      1.4594291      3472.1201    
      3900   299.47696     -32116.679     -599.50244      1.4594291      3472.1201    
      4000   297.16404     -32121.254     -7370.4445      1.4594291      3472.1201    
      4100   302.114       -32108.199     -10225.862      1.4594291      3472.1201    
      4200   302.24267     -32082.532      5100.0012      1.4594291      3472.1201    
      4300   300.00259     -32080.624     -8454.3101      1.4594291      3472.1201    
      4400   299.98805     -32092.43       880.56621      1.4594291      3472.1201    
      4500   301.06746     -32109.144     -8177.4502      1.4594291      3472.1201    
      4600   312.93647     -32122.084     -5886.8646      1.4594291      3472.1201    
      4700   296.07103     -32105.708     -2500.7073      1.4594291      3472.1201    
      4800   305.75145     -32109.864      1302.1704      1.4594291      3472.1201    
      4900   295.42552     -32095.798     -2833.9061      1.4594291      3472.1201    
      5000   316.95708     -32104.73       1748.0663      1.4594291      3472.1201    
      5100   308.64481     -32102.665      2170.3278      1.4594291      3472.1201    
      5200   296.1907      -32111.429     -3749.4385      1.4594291      3472.1201    
      5300   281.45016     -32117.701     -7905.9247      1.4594291      3472.1201    
      5400   305.70281     -32135.836     -9344.6826      1.4594291      3472.1201    
      5500   289.8499      -32092.145      313.03315      1.4594291      3472.1201    
      5600   314.42959     -32092.09      -3444.58        1.4594291      3472.1201    
      5700   321.66183     -32106.764      1758.0363      1.4594291      3472.1201    
      5800   299.68071     -32110.081      698.30204      1.4594291      3472.1201    
      5900   291.91314     -32116.895     -2989.263       1.4594291      3472.1201    
      6000   294.61665     -32111.712      3158.103       1.4594291      3472.1201    
      6100   303.82609     -32098.869     -5814.8562      1.4594291      3472.1201    
      6200   314.35381     -32090.367     -7704.1432      1.4594291      3472.1201    
      6300   317.25865     -32082.158      1705.5417      1.4594291      3472.1201    
      6400   322.21752     -32087.15      -1520.6195      1.4594291      3472.1201    
      6500   300.47314     -32096.294     -2931.6157      1.4594291      3472.1201    
      6600   289.12807     -32104.872     -12800.82       1.4594291      3472.1201    
      6700   267.74886     -32098.76      -7017.5421      1.4594291      3472.1201    
      6800   276.72876     -32096.62       8316.6179      1.4594291      3472.1201    
      6900   305.96474     -32095.335     -3531.6484      1.4594291      3472.1201    
      7000   293.30728     -32085.875     -740.71234      1.4594291      3472.1201    
      7100   305.25456     -32108.449     -12053.772      1.4594291      3472.1201    
      7200   295.06354     -32113.296      37.646161      1.4594291      3472.1201    
      7300   300.29288     -32120.872     -5919.1971      1.4594291      3472.1201    
      7400   302.24175     -32117.396     -6670.2551      1.4594291      3472.1201    
      7500   306.28335     -32114.964     -12220.995      1.4594291      3472.1201    
      7600   301.69667     -32114.484     -11691.314      1.4594291      3472.1201    
      7700   278.7743      -32110.167     -1106.8406      1.4594291      3472.1201    
      7800   266.89251     -32106.825      8859.7791      1.4594291      3472.1201    
      7900   305.39046     -32119.604     -8018.4274      1.4594291      3472.1201    
      8000   335.81839     -32128.08       16126.044      1.4594291      3472.1201    
Loop time of 249.472 on 8 procs for 8000 steps with 274 atoms

Performance: 1.385 ns/day, 17.324 hours/ns, 32.068 timesteps/s, 8.787 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 146.36     | 160.52     | 210.25     | 151.9 | 64.35
Bond    | 0.018549   | 0.021224   | 0.02417    |   1.2 |  0.01
Neigh   | 12.513     | 13.227     | 17.626     |  45.7 |  5.30
Comm    | 1.8171     | 51.542     | 65.721     | 268.0 | 20.66
Output  | 0.017747   | 0.01985    | 0.021929   |   1.0 |  0.01
Modify  | 19.566     | 23.979     | 24.664     |  34.1 |  9.61
Other   |            | 0.1585     |            |       |  0.06

Nlocal:          34.25 ave          44 max          23 min
Histogram: 2 1 0 0 0 0 1 2 1 1
Nghost:        2826.62 ave        2851 max        2812 min
Histogram: 2 1 0 2 0 2 0 0 0 1
Neighs:        18932.2 ave       24188 max       12963 min
Histogram: 2 1 0 0 0 0 1 2 1 1

Total # of neighbors = 151458
Ave neighs/atom = 552.76642
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.3798)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.160755 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.61752     -32078.146     -2797.2106      1.4594291      3472.1201    
       200   296.9929      -32091.737     -4510.5067      1.4594291      3472.1201    
       300   297.76131     -32097.332     -11856.542      1.4594291      3472.1201    
       400   279.36464     -32076.495     -10959.238      1.4594291      3472.1201    
       500   309.73432     -32074.331     -2247.7527      1.4594291      3472.1201    
       600   302.90535     -32052.559     -13873.192      1.4594291      3472.1201    
       700   316.70577     -32081.645     -2007.7745      1.4594291      3472.1201    
       800   311.30354     -32097.262     -8374.8682      1.4594291      3472.1201    
       900   278.95942     -32081.226      3313.6695      1.4594291      3472.1201    
      1000   307.08572     -32108.254     -13525.076      1.4594291      3472.1201    
      1100   322.78231     -32106.547      1937.8481      1.4594291      3472.1201    
      1200   334.87405     -32089.043     -4074.1109      1.4594291      3472.1201    
      1300   304.75046     -32073.112      458.08739      1.4594291      3472.1201    
      1400   297.38862     -32093.479      808.20899      1.4594291      3472.1201    
      1500   279.82952     -32087.062     -15627.651      1.4594291      3472.1201    
      1600   288.98212     -32094.608      6273.5775      1.4594291      3472.1201    
      1700   295.02679     -32097.18      -646.57938      1.4594291      3472.1201    
      1800   290.66093     -32091.063     -6791.0429      1.4594291      3472.1201    
      1900   320.34614     -32098.6       -4305.7746      1.4594291      3472.1201    
      2000   303.13347     -32069.74       8334.1959      1.4594291      3472.1201    
      2100   308.72914     -32082.704     -3601.7198      1.4594291      3472.1201    
      2200   289.27184     -32094.955     -3460.7024      1.4594291      3472.1201    
      2300   274.31601     -32083.775     -8577.9446      1.4594291      3472.1201    
      2400   278.48522     -32074.766     -11666.075      1.4594291      3472.1201    
      2500   302.35393     -32084.095     -1763.0716      1.4594291      3472.1201    
      2600   321.59275     -32097.651     -11435.067      1.4594291      3472.1201    
      2700   315.40687     -32098.517     -15437.385      1.4594291      3472.1201    
      2800   282.21427     -32082.765     -7526.9526      1.4594291      3472.1201    
      2900   285.22034     -32088.914     -20380.682      1.4594291      3472.1201    
      3000   286.52433     -32107.705     -7757.8658      1.4594291      3472.1201    
      3100   287.41971     -32110.798      1182.9826      1.4594291      3472.1201    
      3200   303.85191     -32105.02      -11877.345      1.4594291      3472.1201    
      3300   316.40895     -32094.819      9459.1537      1.4594291      3472.1201    
      3400   323.42177     -32098.744     -8054.1302      1.4594291      3472.1201    
      3500   304.9553      -32104.146     -5756.0372      1.4594291      3472.1201    
      3600   306.80843     -32111.163      3383.1645      1.4594291      3472.1201    
      3700   315.60022     -32117.508     -639.05868      1.4594291      3472.1201    
      3800   300.73486     -32102.036     -7913.3509      1.4594291      3472.1201    
      3900   266.97031     -32072.175     -7437.8242      1.4594291      3472.1201    
      4000   328.60159     -32103.001     -9937.341       1.4594291      3472.1201    
      4100   334.18516     -32098         -7619.9346      1.4594291      3472.1201    
      4200   288.07702     -32084.058     -6056.6779      1.4594291      3472.1201    
      4300   305.83295     -32115.828     -5912.5322      1.4594291      3472.1201    
      4400   262.15349     -32087.713      3198.642       1.4594291      3472.1201    
      4500   288.4148      -32097.897     -5574.2974      1.4594291      3472.1201    
      4600   290.04478     -32084.885     -18106.862      1.4594291      3472.1201    
      4700   302.95924     -32100.426     -2536.5149      1.4594291      3472.1201    
      4800   286.78911     -32123.587      2706.2381      1.4594291      3472.1201    
      4900   271.66718     -32108.892     -12316.58       1.4594291      3472.1201    
      5000   277.86154     -32094.462      5311.3157      1.4594291      3472.1201    
      5100   303.28993     -32097.557     -11625.596      1.4594291      3472.1201    
      5200   317.20026     -32107.749     -8782.7661      1.4594291      3472.1201    
      5300   281.2223      -32090.868     -3489.6689      1.4594291      3472.1201    
      5400   268.72286     -32116.922     -7046.8443      1.4594291      3472.1201    
      5500   272.0928      -32125.941     -2008.6849      1.4594291      3472.1201    
      5600   280.16685     -32111.15      -7682.5792      1.4594291      3472.1201    
      5700   303.39642     -32110.555     -7310.9748      1.4594291      3472.1201    
      5800   284.86339     -32083.735     -2155.4166      1.4594291      3472.1201    
      5900   308.90745     -32089.148      571.78095      1.4594291      3472.1201    
      6000   326.31434     -32108.691     -3239.6468      1.4594291      3472.1201    
      6100   286.98105     -32111.451     -5844.7819      1.4594291      3472.1201    
      6200   276.14909     -32109.696     -7436.4388      1.4594291      3472.1201    
      6300   300.90298     -32112.88       820.52116      1.4594291      3472.1201    
      6400   286.0508      -32085.803     -10576.995      1.4594291      3472.1201    
      6500   334.08994     -32123.075     -7311.0562      1.4594291      3472.1201    
      6600   304.40131     -32113.135     -5150.6387      1.4594291      3472.1201    
      6700   299.45117     -32116.25       2656.0982      1.4594291      3472.1201    
      6800   296.6446      -32116.256     -7879.4431      1.4594291      3472.1201    
      6900   294.13693     -32101.48      -7246.9501      1.4594291      3472.1201    
      7000   314.99994     -32091.781     -8093.6907      1.4594291      3472.1201    
      7100   290.2181      -32079.852     -6260.9334      1.4594291      3472.1201    
      7200   295.22275     -32102.433     -962.81632      1.4594291      3472.1201    
      7300   293.52987     -32113.701     -904.46326      1.4594291      3472.1201    
      7400   300.86921     -32121.641     -5887.9269      1.4594291      3472.1201    
      7500   285.05001     -32101.738      2212.4757      1.4594291      3472.1201    
      7600   311.03919     -32103.732     -3271.5946      1.4594291      3472.1201    
      7700   315.21769     -32100.175     -359.17841      1.4594291      3472.1201    
      7800   313.31076     -32116.76      -3302.7264      1.4594291      3472.1201    
      7900   272.08731     -32104.434     -10149.264      1.4594291      3472.1201    
      8000   291.74937     -32116.05      -9664.5823      1.4594291      3472.1201    
Loop time of 212.956 on 8 procs for 8000 steps with 274 atoms

Performance: 1.623 ns/day, 14.789 hours/ns, 37.566 timesteps/s, 10.293 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 141.27     | 152.58     | 170.6      |  69.9 | 71.65
Bond    | 0.01891    | 0.02069    | 0.022847   |   0.9 |  0.01
Neigh   | 12.564     | 12.927     | 14.725     |  19.0 |  6.07
Comm    | 8.2868     | 26.28      | 37.59      | 168.4 | 12.34
Output  | 0.016965   | 0.019178   | 0.021214   |   1.1 |  0.01
Modify  | 19.143     | 20.967     | 21.318     |  15.1 |  9.85
Other   |            | 0.1611     |            |       |  0.08

Nlocal:          34.25 ave          41 max          23 min
Histogram: 2 0 0 1 0 0 0 1 2 2
Nghost:         2808.5 ave        2833 max        2768 min
Histogram: 1 0 0 0 2 2 0 0 0 3
Neighs:        18950.5 ave       22601 max       12908 min
Histogram: 2 0 0 1 0 0 0 1 2 2

Total # of neighbors = 151604
Ave neighs/atom = 553.29927
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.160755 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 8000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.1 | 109.9 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   308.54031     -32058.36      -6545.7395      1.4594291      3472.1201    
       100   303.59747     -32078.139     -2789.3624      1.4594291      3472.1201    
       200   297.62774     -32092.04      -4675.6159      1.4594291      3472.1201    
       300   296.08953     -32096.055     -10881.925      1.4594291      3472.1201    
       400   284.66757     -32080.472     -11342.719      1.4594291      3472.1201    
       500   319.83547     -32081.987     -1030.1111      1.4594291      3472.1201    
       600   301.19531     -32052.31      -13694.333      1.4594291      3472.1201    
       700   318.19314     -32086.248      2832.656       1.4594291      3472.1201    
       800   319.84059     -32107.332     -1620.7234      1.4594291      3472.1201    
       900   300.73816     -32100.295      165.01027      1.4594291      3472.1201    
      1000   304.56482     -32107.09      -11199.718      1.4594291      3472.1201    
      1100   304.38073     -32099.73      -7835.6882      1.4594291      3472.1201    
      1200   316.99758     -32084.345     -13.334286      1.4594291      3472.1201    
      1300   311.66699     -32077.648     -9887.5833      1.4594291      3472.1201    
      1400   308.1317      -32093.236     -12759.506      1.4594291      3472.1201    
      1500   285.89604     -32104.491     -5433.208       1.4594291      3472.1201    
      1600   280.51037     -32100.03      -11840.387      1.4594291      3472.1201    
      1700   289.18852     -32098.263     -18157.035      1.4594291      3472.1201    
      1800   307.82517     -32093.509     -6532.9264      1.4594291      3472.1201    
      1900   300.88327     -32082.619     -22608.597      1.4594291      3472.1201    
      2000   316.75422     -32106.408     -5116.9396      1.4594291      3472.1201    
      2100   280.41213     -32090.788     -7921.5683      1.4594291      3472.1201    
      2200   281.99818     -32103.45      -2472.1112      1.4594291      3472.1201    
      2300   312.117       -32109.346     -3303.5922      1.4594291      3472.1201    
      2400   327.64577     -32093.938     -10835.647      1.4594291      3472.1201    
      2500   322.88119     -32096.064     -1124.4468      1.4594291      3472.1201    
      2600   305.22872     -32096.879     -11458.909      1.4594291      3472.1201    
      2700   289.91146     -32104.442     -8747.4979      1.4594291      3472.1201    
      2800   260.90094     -32096.477     -2728.5269      1.4594291      3472.1201    
      2900   301.83026     -32119.069     -6355.2292      1.4594291      3472.1201    
      3000   294.93352     -32088.325     -6110.1048      1.4594291      3472.1201    
      3100   300.07253     -32082.265     -10681.989      1.4594291      3472.1201    
      3200   294.03008     -32073.32      -7274.0624      1.4594291      3472.1201    
      3300   303.84339     -32083.943      1762.261       1.4594291      3472.1201    
      3400   308.62398     -32106          265.20505      1.4594291      3472.1201    
      3500   265.20747     -32091.94       4254.4054      1.4594291      3472.1201    
      3600   286.69688     -32102.323     -6303.6569      1.4594291      3472.1201    
      3700   309.80623     -32099.066     -14535.016      1.4594291      3472.1201    
      3800   312.40842     -32096.848     -12964.673      1.4594291      3472.1201    
      3900   299.36446     -32088.326     -6415.7529      1.4594291      3472.1201    
      4000   318.56303     -32111.264     -5483.844       1.4594291      3472.1201    
      4100   291.23914     -32106.661     -12667.315      1.4594291      3472.1201    
      4200   291.56822     -32122.631     -7672.0378      1.4594291      3472.1201    
      4300   290.93189     -32116.293      2263.0109      1.4594291      3472.1201    
      4400   312.0666      -32105.09      -12181.157      1.4594291      3472.1201    
      4500   294.09013     -32081.67       2545.802       1.4594291      3472.1201    
      4600   305.97567     -32098.222     -14691.39       1.4594291      3472.1201    
      4700   281.88739     -32105.009     -14883.232      1.4594291      3472.1201    
      4800   284.52059     -32108.769      6202.0144      1.4594291      3472.1201    
      4900   301.93136     -32087.139      3346.9361      1.4594291      3472.1201    
      5000   326.42671     -32095.951     -7391.3556      1.4594291      3472.1201    
      5100   301.93329     -32085.989     -2597.2959      1.4594291      3472.1201    
      5200   297.59495     -32108.019     -9336.3895      1.4594291      3472.1201    
      5300   294.81419     -32113.252     -5675.8652      1.4594291      3472.1201    
      5400   289.65742     -32097.138     -5681.8277      1.4594291      3472.1201    
      5500   303.36881     -32080.106     -1020.6983      1.4594291      3472.1201    
      5600   335.56906     -32104.048     -10014.801      1.4594291      3472.1201    
      5700   311.38666     -32098.849     -9399.8246      1.4594291      3472.1201    
      5800   290.3631      -32103.548      2105.0413      1.4594291      3472.1201    
      5900   286.01604     -32113.001     -4645.8985      1.4594291      3472.1201    
      6000   290.77662     -32110.6       -9950.4831      1.4594291      3472.1201    
      6100   299.54191     -32109.058      1089.3399      1.4594291      3472.1201    
      6200   290.88143     -32097.389      4686.782       1.4594291      3472.1201    
      6300   319.53462     -32113.618     -9557.4259      1.4594291      3472.1201    
      6400   298.63035     -32095.035     -6695.882       1.4594291      3472.1201    
      6500   304.04167     -32094.004     -7652.9563      1.4594291      3472.1201    
      6600   309.52559     -32097.88       3022.5288      1.4594291      3472.1201    
      6700   293.79714     -32103.032     -12358.216      1.4594291      3472.1201    
      6800   273.31303     -32106.581     -8944.1064      1.4594291      3472.1201    
      6900   296.01551     -32121.48      -7480.2876      1.4594291      3472.1201    
      7000   301.09335     -32099.791     -9556.124       1.4594291      3472.1201    
      7100   312.81386     -32096.853     -3407.8977      1.4594291      3472.1201    
      7200   316.23622     -32109.649     -8310.8387      1.4594291      3472.1201    
      7300   284.10259     -32095.912     -1001.3853      1.4594291      3472.1201    
      7400   334.68747     -32134.163      1363.8674      1.4594291      3472.1201    
      7500   291.56674     -32102.698     -11794.898      1.4594291      3472.1201    
      7600   270.71729     -32099.782     -5316.0949      1.4594291      3472.1201    
      7700   293.38694     -32111.556     -10394.059      1.4594291      3472.1201    
      7800   317.53636     -32109.058     -14947.693      1.4594291      3472.1201    
      7900   307.47383     -32098.532      2816.4879      1.4594291      3472.1201    
      8000   283.43992     -32101.516     -2043.1606      1.4594291      3472.1201    
Loop time of 188.088 on 8 procs for 8000 steps with 274 atoms

Performance: 1.837 ns/day, 13.062 hours/ns, 42.533 timesteps/s, 11.654 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 139.06     | 148.52     | 154.56     |  44.2 | 78.97
Bond    | 0.018578   | 0.020263   | 0.022902   |   1.1 |  0.01
Neigh   | 12.484     | 12.568     | 12.659     |   1.5 |  6.68
Comm    | 1.7108     | 7.7641     | 17.245     | 193.6 |  4.13
Output  | 0.015695   | 0.017917   | 0.019812   |   1.1 |  0.01
Modify  | 18.923     | 19.025     | 19.114     |   1.4 | 10.12
Other   |            | 0.1687     |            |       |  0.09

Nlocal:          34.25 ave          42 max          26 min
Histogram: 2 0 1 0 0 1 2 0 0 2
Nghost:           2793 ave        2822 max        2764 min
Histogram: 1 1 0 2 1 0 1 0 0 2
Neighs:        18917.9 ave       23011 max       14535 min
Histogram: 2 0 1 0 0 1 2 0 0 2

Total # of neighbors = 151343
Ave neighs/atom = 552.34672
Ave special neighs/atom = 0
Neighbor list builds = 800
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 1:01:06
