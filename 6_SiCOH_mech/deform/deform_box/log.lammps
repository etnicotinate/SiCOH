LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
# boundary        s s s
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 0.1
variable FF string "SiOCHN_2018.ff C H O Si"          # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff C H O Si
# pair_coeff * * CHOSiNa.ff C H O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff C H O Si
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# Read the initial sctructure
# box tilt large
variable structure string 0.lmpdata/333-EXP-27

read_data       ${structure}.data
read_data       0.lmpdata/333-EXP-27.data
Reading data file ...
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.009 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# # Energy minimization
# print "*****Minimization starts.*****"
# minimize 1.0e-6 1.0e-6 100 1000
# min_style cg
# # Save the optimized structure
# write_data ${structure}_opt.data
# velocity        all create ${temp} ${seed} dist gaussian

# # Equilibration
# include ff.mod.lmp
# if "$(is_defined(fix,avgp))" then "unfix avgp"
# if "$(is_defined(fix,avgl))" then "unfix avgl"
# thermo_style custom step temp pe press density vol
# run ${nequil}
# # Save the equilibrated structure
# write_data ${structure}_eq.data

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.1447
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.6088
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.498

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.5805
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.6366
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.6974

# Write restart
write_restart equil.res
System init for write_restart ...
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.1447
variable dlen equal lx-${len0}
variable dlen equal lx-15.1447
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.1447
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.076974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.006366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.005805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.151447 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.151447 xy delta 0.076974 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.151447 xy delta 0.076974 xz delta 0.006366 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform1.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.4315     -29110.231      19579.175      3399.5774    
       200   677.14061     -29513.688      8533.1412      3398.8974    
       300   477.31099     -29778.746      4124.9315      3398.2173    
       400   451.12894     -30055.216      2840.8967      3397.5373    
       500   316.99988     -30112.691     -3065.9449      3396.8572    
       600   334.00343     -30223.237     -3077.2441      3396.1772    
       700   276.5257      -30219.046     -5346.7576      3395.4971    
       800   276.62277     -30235.166      1344.5542      3394.8171    
       900   264.9494      -30211.667     -166.35513      3394.137     
      1000   297.34329     -30221.667     -4983.8965      3393.457     
      1100   337.46685     -30256.233     -8063.7614      3392.7769    
      1200   289.72413     -30227.873     -58.107677      3392.0969    
      1300   309.54438     -30260.356     -9471.9845      3391.4168    
      1400   315.45273     -30266.981     -11013.719      3390.7368    
      1500   257.62834     -30206.839     -5047.4248      3390.0567    
      1600   355.59324     -30271.886      6065.482       3389.3767    
      1700   318.81216     -30261.258      4212.5304      3388.6966    
      1800   316.67287     -30346.822      2404.4708      3388.0166    
      1900   282.89083     -30372.443     -3157.916       3387.3365    
      2000   298.36038     -30401.658      1887.7431      3386.6565    
      2100   277.16636     -30361.182     -9173.8536      3385.9764    
      2200   314.52307     -30362.851      3555.0371      3385.2964    
      2300   332.44313     -30388.925      9719.1905      3384.6163    
      2400   320.52887     -30440.398      8607.7357      3383.9363    
      2500   305.97101     -30478.25      -1119.2336      3383.2562    
      2600   249.51652     -30450.663     -4822.1266      3382.5761    
      2700   312.87058     -30493.434     -9254.5866      3381.8961    
      2800   334.45518     -30479.735      3271.1083      3381.216     
      2900   338.9028      -30451.777     -2861.6684      3380.536     
      3000   301.75183     -30429.36      -11599.635      3379.8559    
      3100   300.42775     -30461.136     -14699.819      3379.1759    
      3200   253.54165     -30451.933     -7289.8606      3378.4958    
      3300   276.80433     -30472.459     -1001.1247      3377.8158    
      3400   294.79625     -30457.392     -4033.7256      3377.1357    
      3500   325.18107     -30459.179      19762.889      3376.4557    
      3600   347.61487     -30495.188     -461.51516      3375.7756    
      3700   321.37142     -30502.709      6127.3907      3375.0956    
      3800   280.48471     -30476.68      -10319.016      3374.4155    
      3900   306.3833      -30489.112     -11755.355      3373.7355    
      4000   310.00392     -30479.052      8786.2566      3373.0554    
      4100   301.52566     -30464.834     -3487.8502      3372.3754    
      4200   300.12783     -30470.018     -6197.1426      3371.6953    
      4300   272.87941     -30464.431     -12484.998      3371.0153    
      4400   327.54478     -30525.711      3052.7702      3370.3352    
      4500   287.45806     -30537.29       2838.9564      3369.6552    
      4600   253.95201     -30560.815     -8179.8642      3368.9751    
      4700   333.88879     -30661.317      4922.2888      3368.2951    
      4800   270.00641     -30598.438     -5675.101       3367.615     
      4900   353.14879     -30635.176     -5948.7915      3366.935     
      5000   308.98349     -30565.422     -5885.2157      3366.2549    
Loop time of 95.2277 on 16 procs for 5000 steps with 295 atoms

Performance: 2.268 ns/day, 10.581 hours/ns, 52.506 timesteps/s, 15.489 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.718     | 75.645     | 79.402     |  35.1 | 79.44
Bond    | 0.0081023  | 0.0085578  | 0.0089682  |   0.3 |  0.01
Neigh   | 2.1473     | 2.2316     | 2.344      |   4.7 |  2.34
Comm    | 1.3525     | 5.1399     | 11.053     | 134.5 |  5.40
Output  | 0.010846   | 0.028748   | 0.062762   |  11.3 |  0.03
Modify  | 11.956     | 12.072     | 12.161     |   2.1 | 12.68
Other   |            | 0.1015     |            |       |  0.11

Nlocal:         36.875 ave          43 max          28 min
Histogram: 2 0 0 0 0 0 3 0 2 1
Nghost:           3012 ave        3072 max        2948 min
Histogram: 1 1 0 0 2 1 1 0 1 1
Neighs:        22643.9 ave       26233 max       17630 min
Histogram: 2 0 0 0 0 0 3 0 2 1

Total # of neighbors = 181151
Ave neighs/atom = 614.07119
Ave special neighs/atom = 0
Neighbor list builds = 112
Dangerous builds = 5
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.1447
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.151447 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.151447 xy delta -0.076974 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.151447 xy delta -0.076974 xz delta -0.006366 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform1.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1025.9112     -29109.797      19818.097      3400.9375    
       200   676.73789     -29513.348      10095.505      3401.6176    
       300   480.75205     -29781.915      5664.3931      3402.2976    
       400   409.599       -30000.114      9691.0024      3402.9777    
       500   326.55713     -30107.459     -2984.7476      3403.6577    
       600   289.271       -30178.61      -8562.1525      3404.3378    
       700   318.91528     -30256.519     -9652.5724      3405.0178    
       800   299.12709     -30257.648     -5161.7304      3405.6979    
       900   297.81416     -30248.684     -1373.4887      3406.378     
      1000   282.02621     -30225.958      2959.5345      3407.058     
      1100   322.03068     -30262.361     -3747.7747      3407.7381    
      1200   300.42704     -30257.322     -5125.8841      3408.4181    
      1300   323.04828     -30285.748     -9353.4976      3409.0982    
      1400   305.23074     -30276.797      128.05618      3409.7782    
      1500   281.10918     -30278.006     -4043.9707      3410.4583    
      1600   268.14381     -30287.937     -12712.667      3411.1383    
      1700   316.3122      -30328.989     -9219.8036      3411.8184    
      1800   308.70189     -30304.727     -11533.286      3412.4984    
      1900   332.99281     -30345.331      5273.0754      3413.1785    
      2000   305.43062     -30380.44      -5280.0389      3413.8585    
      2100   293.34506     -30425.49       1936.2852      3414.5386    
      2200   242.1987      -30389.366      5152.6997      3415.2186    
      2300   306.22577     -30407.541     -6081.6041      3415.8987    
      2400   326.53635     -30390.822      405.85156      3416.5787    
      2500   313.11192     -30376.511      4597.6893      3417.2588    
      2600   291.65562     -30387.47       946.60501      3417.9388    
      2700   303.37666     -30432.147      9383.5728      3418.6189    
      2800   260.59579     -30424.211     -16089.471      3419.2989    
      2900   297.54291     -30473.721     -7314.4225      3419.979     
      3000   273.47089     -30433.898     -1174.0276      3420.659     
      3100   311.61868     -30423.309      5881.3888      3421.3391    
      3200   338.07336     -30416.056      7660.1248      3422.0191    
      3300   327.48346     -30441.301      5701.6212      3422.6992    
      3400   293.91886     -30473.223      138.04941      3423.3792    
      3500   298.32343     -30521.24      -14164.615      3424.0593    
      3600   282.78323     -30516.375     -414.52561      3424.7393    
      3700   278.7802      -30484.764      7004.6366      3425.4194    
      3800   336.94119     -30497.749      8146.5781      3426.0994    
      3900   317.06692     -30477.297     -10468.621      3426.7795    
      4000   296.21029     -30513.991      3518.3412      3427.4595    
      4100   302.00426     -30569.543     -6099.7915      3428.1396    
      4200   309.41461     -30588.374     -4463.1334      3428.8197    
      4300   297.96703     -30567.013      4514.7531      3429.4997    
      4400   297.021       -30536.042     -8697.1005      3430.1798    
      4500   295.00989     -30516.628     -1670.1673      3430.8598    
      4600   328.20496     -30547.198     -2436.951       3431.5399    
      4700   298.80819     -30533.161     -99.820119      3432.2199    
      4800   284.10418     -30541.303      4966.7058      3432.9       
      4900   278.39512     -30550.204     -8258.4664      3433.58      
      5000   323.16222     -30581.382     -620.02024      3434.2601    
Loop time of 91.4889 on 16 procs for 5000 steps with 295 atoms

Performance: 2.361 ns/day, 10.165 hours/ns, 54.651 timesteps/s, 16.122 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.027     | 74.104     | 77.117     |  18.1 | 81.00
Bond    | 0.0081535  | 0.0086158  | 0.0093579  |   0.4 |  0.01
Neigh   | 2.0154     | 2.0668     | 2.14       |   3.0 |  2.26
Comm    | 0.81606    | 3.827      | 5.9029     |  79.5 |  4.18
Output  | 0.010909   | 0.026248   | 0.063809   |  12.5 |  0.03
Modify  | 11.244     | 11.316     | 11.373     |   1.3 | 12.37
Other   |            | 0.1398     |            |       |  0.15

Nlocal:         36.875 ave          42 max          32 min
Histogram: 1 0 0 3 0 0 1 2 0 1
Nghost:        2973.75 ave        3021 max        2923 min
Histogram: 2 0 1 1 0 0 0 1 2 1
Neighs:        22234.8 ave       25133 max       19438 min
Histogram: 1 0 2 1 0 0 1 2 0 1

Total # of neighbors = 177878
Ave neighs/atom = 602.97627
Ave special neighs/atom = 0
Neighbor list builds = 105
Dangerous builds = 5
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.6088
variable dlen equal ly-${len0}
variable dlen equal ly-13.6088
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.6088
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.076974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.006366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.005805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.136088 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.136088 yz delta -0.005805 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform2.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.5341     -29110.279      19630.3        3399.5774    
       200   673.13153     -29510.342      9642.7147      3398.8974    
       300   478.60781     -29780.845      4470.0615      3398.2173    
       400   438.90995     -30020.79       1765.2005      3397.5373    
       500   361.36034     -30140.261      310.18751      3396.8572    
       600   308.9933      -30192.161      1588.7317      3396.1772    
       700   278.52439     -30223.61      -4634.8647      3395.4971    
       800   253.89364     -30225.826      2328.9047      3394.8171    
       900   315.56161     -30279.563     -13827.421      3394.137     
      1000   347.71256     -30312.476     -10768.056      3393.457     
      1100   321.07787     -30316.819     -14833.452      3392.7769    
      1200   299.17475     -30333.571     -9028.5344      3392.0969    
      1300   252.95917     -30305.262     -5881.5741      3391.4168    
      1400   278.8369      -30316.776      2991.2842      3390.7368    
      1500   281.10479     -30287.172     -12335.929      3390.0567    
      1600   323.10004     -30321.638     -15298.289      3389.3767    
      1700   315.90154     -30349.509     -11092.05       3388.6966    
      1800   287.44447     -30385.209     -5969.4147      3388.0166    
      1900   293.82888     -30421.364      4603.4256      3387.3365    
      2000   263.05544     -30386.335     -5805.0244      3386.6565    
      2100   325.50136     -30417.867     -5023.4552      3385.9764    
      2200   306.9646      -30393.372     -3013.7331      3385.2964    
      2300   306.74019     -30399.194     -371.7699       3384.6163    
      2400   321.01325     -30438.234     -1334.3836      3383.9363    
      2500   300.58375     -30452.28       6115.6173      3383.2562    
      2600   285.24089     -30455.24      -4300.8588      3382.5761    
      2700   279.16055     -30444.161     -241.91554      3381.8961    
      2800   290.10159     -30444.387     -4133.6695      3381.216     
      2900   286.68478     -30431.126     -887.98485      3380.536     
      3000   319.6805      -30450.864     -3060.721       3379.8559    
      3100   295.58227     -30430.323     -661.62477      3379.1759    
      3200   294.36354     -30440.616      588.50043      3378.4958    
      3300   305.17225     -30449.704      674.55296      3377.8158    
      3400   297.66718     -30449.246      8996.297       3377.1357    
      3500   311.09067     -30465.182     -2090.1691      3376.4557    
      3600   305.07433     -30459.088      10228.514      3375.7756    
      3700   324.98236     -30471.534     -6947.79        3375.0956    
      3800   285.98384     -30444.934     -18668.459      3374.4155    
      3900   286.57345     -30453.277     -34.22335       3373.7355    
      4000   328.88963     -30499.937     -12658.636      3373.0554    
      4100   272.77219     -30450.052     -7656.7362      3372.3754    
      4200   311.06866     -30474.782     -7085.2124      3371.6953    
      4300   301.80031     -30451.165     -2012.0817      3371.0153    
      4400   339.96055     -30477.528      7164.8384      3370.3352    
      4500   318.14733     -30484.591     -7204.9632      3369.6552    
      4600   294.13169     -30495.368      7423.7257      3368.9751    
      4700   326.74779     -30569.718     -1006.372       3368.2951    
      4800   287.58669     -30581.326      2412.0824      3367.615     
      4900   291.27789     -30590.216     -1743.3514      3366.935     
      5000   284.82821     -30554.882     -13205.047      3366.2549    
Loop time of 94.7866 on 16 procs for 5000 steps with 295 atoms

Performance: 2.279 ns/day, 10.532 hours/ns, 52.750 timesteps/s, 15.561 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.328     | 75.294     | 79.519     |  32.8 | 79.44
Bond    | 0.0081391  | 0.0085929  | 0.0090922  |   0.3 |  0.01
Neigh   | 1.9779     | 2.0558     | 2.1586     |   4.3 |  2.17
Comm    | 0.87077    | 5.079      | 10.035     | 126.1 |  5.36
Output  | 0.010692   | 0.02614    | 0.061978   |  11.8 |  0.03
Modify  | 12.118     | 12.223     | 12.307     |   1.7 | 12.90
Other   |            | 0.1002     |            |       |  0.11

Nlocal:         36.875 ave          42 max          29 min
Histogram: 1 0 0 1 1 1 0 1 1 2
Nghost:        3034.62 ave        3072 max        2985 min
Histogram: 1 0 1 0 2 0 0 1 1 2
Neighs:        22651.6 ave       25689 max       18084 min
Histogram: 1 0 0 1 1 1 0 1 1 2

Total # of neighbors = 181213
Ave neighs/atom = 614.28136
Ave special neighs/atom = 0
Neighbor list builds = 103
Dangerous builds = 5
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.6088
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.136088 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.136088 yz delta 0.005805 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform2.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1025.7435     -29109.937      19670.899      3400.9375    
       200   675.32542     -29512.808      8969.3611      3401.6176    
       300   473.80778     -29774.881      4464.0405      3402.2976    
       400   404.42557     -29989.089      9086.8219      3402.9777    
       500   369.50279     -30142.081     -4166.42        3403.6577    
       600   293.5113      -30173.347     -4421.5239      3404.3378    
       700   285.87024     -30215.843     -1300.5127      3405.0178    
       800   272.39124     -30228.729     -4446.568       3405.6979    
       900   284.91299     -30256.323      1633.4631      3406.378     
      1000   327.179       -30325.421      2042.5924      3407.058     
      1100   323.72948     -30357.155     -13448.894      3407.7381    
      1200   269.30981     -30331.927     -12971.642      3408.4181    
      1300   271.14784     -30340.677     -13115.263      3409.0982    
      1400   281.34523     -30338.902     -265.05383      3409.7782    
      1500   329.95219     -30367.988     -4434.5087      3410.4583    
      1600   302.2946      -30346.01      -10810.888      3411.1383    
      1700   326.22109     -30383.001      558.11913      3411.8184    
      1800   300.93109     -30363.179     -3155.9595      3412.4984    
      1900   301.99975     -30360.485     -10300.49       3413.1785    
      2000   325.15451     -30381.912      464.63594      3413.8585    
      2100   282.13918     -30359.247     -4056.2303      3414.5386    
      2200   293.87167     -30384.902      8808.8295      3415.2186    
      2300   319.45854     -30408.907     -5205.1866      3415.8987    
      2400   309.10267     -30381.323      13562.42       3416.5787    
      2500   300.52717     -30361.216     -4189.8723      3417.2588    
      2600   303.15263     -30378.108      800.98752      3417.9388    
      2700   295.0352      -30385.689     -17513.797      3418.6189    
      2800   323.07076     -30420.123      7010.5186      3419.2989    
      2900   310.3199      -30421.282      9387.9323      3419.979     
      3000   305.6158      -30443.095      3767.2651      3420.659     
      3100   299.23652     -30455.229     -918.33466      3421.3391    
      3200   275.6341      -30420.253     -5117.3364      3422.0191    
      3300   324.07357     -30440.559     -8262.1045      3422.6992    
      3400   298.77644     -30427.93      -11548.2        3423.3792    
      3500   302.34828     -30456.5       -9295.2445      3424.0593    
      3600   313.10284     -30498.75      -3570.674       3424.7393    
      3700   269.08177     -30477.872     -2400.5903      3425.4194    
      3800   306.36171     -30502.369      996.2412       3426.0994    
      3900   302.34955     -30479.707     -2340.655       3426.7795    
      4000   294.95388     -30458.081      7274.4586      3427.4595    
      4100   317.21969     -30483.837     -1065.4554      3428.1396    
      4200   283.9716      -30468.924     -9706.4909      3428.8197    
      4300   314.2783      -30496.905      11331.471      3429.4997    
      4400   313.44185     -30500.657     -2988.5401      3430.1798    
      4500   285.23258     -30489.375     -10035.237      3430.8598    
      4600   282.78082     -30492.329      11541.973      3431.5399    
      4700   305.36751     -30523.979     -4669.6563      3432.2199    
      4800   283.48911     -30514.016      2124.3477      3432.9       
      4900   308.40723     -30542.723      1753.7536      3433.58      
      5000   284.55215     -30530.399     -9281.0155      3434.2601    
Loop time of 92.4777 on 16 procs for 5000 steps with 295 atoms

Performance: 2.336 ns/day, 10.275 hours/ns, 54.067 timesteps/s, 15.950 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.609     | 74.369     | 77.681     |  17.8 | 80.42
Bond    | 0.0082575  | 0.0087179  | 0.0093406  |   0.4 |  0.01
Neigh   | 2.2175     | 2.286      | 2.3662     |   3.1 |  2.47
Comm    | 0.89797    | 4.2103     | 5.9669     |  74.9 |  4.55
Output  | 0.0107     | 0.025967   | 0.063508   |  12.5 |  0.03
Modify  | 11.36      | 11.437     | 11.507     |   1.4 | 12.37
Other   |            | 0.141      |            |       |  0.15

Nlocal:         36.875 ave          42 max          29 min
Histogram: 1 0 0 0 1 0 4 0 1 1
Nghost:        2962.25 ave        3008 max        2917 min
Histogram: 1 1 1 0 0 2 0 1 1 1
Neighs:        22200.2 ave       25097 max       17603 min
Histogram: 1 0 0 0 1 1 2 1 1 1

Total # of neighbors = 177602
Ave neighs/atom = 602.04068
Ave special neighs/atom = 0
Neighbor list builds = 117
Dangerous builds = 5
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.498
variable dlen equal lz-${len0}
variable dlen equal lz-16.498
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.498
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.076974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.006366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.005805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.16498 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform3.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.0903     -29109.989      19649.309      3399.5774    
       200   672.5051      -29509.656      9941.299       3398.8974    
       300   475.85832     -29777.916      4302.6139      3398.2173    
       400   410.401       -29994.941      3491.1296      3397.5373    
       500   366.15627     -30145.899      235.01107      3396.8572    
       600   337.80922     -30223.038      3220.5175      3396.1772    
       700   307.36144     -30239.986     -5940.4776      3395.4971    
       800   281.33817     -30210.263      296.76485      3394.8171    
       900   319.07636     -30234.392      1213.5353      3394.137     
      1000   328.45635     -30280.82      -20500.686      3393.457     
      1100   298.03055     -30327.39      -8435.5484      3392.7769    
      1200   294.05492     -30385.844     -2174.3002      3392.0969    
      1300   261.63977     -30381.613     -5901.4494      3391.4168    
      1400   270.93863     -30375.23       5252.7525      3390.7368    
      1500   302.90902     -30375.685     -6538.9166      3390.0567    
      1600   315.49082     -30369.215     -6485.2688      3389.3767    
      1700   331.8424      -30394.08      -2167.2585      3388.6966    
      1800   276.41325     -30386.797     -1620.2755      3388.0166    
      1900   305.35645     -30448.576     -3725.2278      3387.3365    
      2000   270.4207      -30431.104     -8245.339       3386.6565    
      2100   296.87218     -30456.465      3020.6483      3385.9764    
      2200   302.1349      -30454.893      4749.7793      3385.2964    
      2300   301.36103     -30447.68      -2376.363       3384.6163    
      2400   316.39404     -30467.892     -5512.0405      3383.9363    
      2500   284.70286     -30442.519     -6526.1258      3383.2562    
      2600   303.34128     -30456.187     -17823.404      3382.5761    
      2700   285.49221     -30436.383     -6888.0233      3381.8961    
      2800   317.96572     -30464.504      970.90498      3381.216     
      2900   298.47287     -30446.606     -3536.7522      3380.536     
      3000   294.4723      -30449.662     -3596.9428      3379.8559    
      3100   326.02605     -30494.691     -14440.026      3379.1759    
      3200   281.51227     -30486.826      9673.2269      3378.4958    
      3300   284.47999     -30503.475     -14948.462      3377.8158    
      3400   281.29656     -30480.853      2500.1627      3377.1357    
      3500   342.43393     -30515.337      2344.9123      3376.4557    
      3600   316.31837     -30508.174     -3097.047       3375.7756    
      3700   301.51134     -30541.631      10060.774      3375.0956    
      3800   258.30526     -30552.141     -1056.536       3374.4155    
      3900   314.08883     -30607.533     -5286.5274      3373.7355    
      4000   292.22032     -30593.807     -3704.6588      3373.0554    
      4100   298.7305      -30615.922     -198.37928      3372.3754    
      4200   303.53279     -30625.422      1714.3817      3371.6953    
      4300   293.52857     -30614.311     -5388.0152      3371.0153    
      4400   280.07658     -30599.996     -14891.26       3370.3352    
      4500   291.00013     -30594.614      1355.804       3369.6552    
      4600   306.36849     -30597.598      1139.2891      3368.9751    
      4700   310.97565     -30601.312      1930.9263      3368.2951    
      4800   275.4146      -30584.778     -1571.4347      3367.615     
      4900   315.16361     -30635.287     -10687.051      3366.935     
      5000   303.08586     -30649.061     -5627.0417      3366.2549    
Loop time of 95.1581 on 16 procs for 5000 steps with 295 atoms

Performance: 2.270 ns/day, 10.573 hours/ns, 52.544 timesteps/s, 15.501 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.009     | 75.788     | 80.07      |  34.2 | 79.64
Bond    | 0.0083119  | 0.0087621  | 0.0091528  |   0.3 |  0.01
Neigh   | 2.1099     | 2.1913     | 2.2915     |   4.2 |  2.30
Comm    | 0.85146    | 5.1181     | 10.883     | 131.4 |  5.38
Output  | 0.010627   | 0.026197   | 0.061694   |  11.7 |  0.03
Modify  | 11.824     | 11.924     | 12.008     |   1.8 | 12.53
Other   |            | 0.1013     |            |       |  0.11

Nlocal:         36.875 ave          40 max          31 min
Histogram: 1 0 0 2 0 0 0 1 2 2
Nghost:         3024.5 ave        3071 max        2976 min
Histogram: 2 0 0 0 1 2 1 0 1 1
Neighs:        22662.6 ave       24525 max       19276 min
Histogram: 1 0 0 2 0 0 0 1 2 2

Total # of neighbors = 181301
Ave neighs/atom = 614.57966
Ave special neighs/atom = 0
Neighbor list builds = 110
Dangerous builds = 5
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.498
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.16498 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform3.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.1052     -29110.05       19638.207      3400.9375    
       200   673.68482     -29511.583      8848.2962      3401.6176    
       300   481.88137     -29782.79       5550.1965      3402.2976    
       400   399.09812     -29984.233      5190.5595      3402.9777    
       500   356.58883     -30130.656      369.75897      3403.6577    
       600   330.64743     -30209.177      4429.7134      3404.3378    
       700   259.50268     -30188.503     -9546.0674      3405.0178    
       800   251.57494     -30182.324      5449.3435      3405.6979    
       900   318.00089     -30210.212      5411.4855      3406.378     
      1000   302.05424     -30169.111     -6714.7003      3407.058     
      1100   353.08972     -30248.968     -10550.945      3407.7381    
      1200   284.93964     -30269.844     -7130.5492      3408.4181    
      1300   274.3017      -30315.75      -2575.6828      3409.0982    
      1400   304.3421      -30349.105      2664.1434      3409.7782    
      1500   308.07008     -30326.758     -5701.3355      3410.4583    
      1600   367.63389     -30344.097     -13355.942      3411.1383    
      1700   307.50075     -30299.155      5035.8818      3411.8184    
      1800   319.42493     -30380.691     -6642.4406      3412.4984    
      1900   269.42253     -30422.509     -4592.6218      3413.1785    
      2000   277.49465     -30478.089     -11062.219      3413.8585    
      2100   275.06072     -30485.454     -14165.689      3414.5386    
      2200   306.30774     -30485.894     -1951.1249      3415.2186    
      2300   309.73792     -30468.112      1898.5367      3415.8987    
      2400   299.78786     -30473.945     -10520.067      3416.5787    
      2500   318.45339     -30530.901     -1997.7932      3417.2588    
      2600   265.62832     -30516.315     -8270.6896      3417.9388    
      2700   285.17413     -30547.682     -6254.2889      3418.6189    
      2800   312.33442     -30562.557      4781.5514      3419.2989    
      2900   277.12284     -30503.789     -12193.604      3419.979     
      3000   322.7367      -30526.631      4008.4388      3420.659     
      3100   316.95082     -30529.259     -4685.9388      3421.3391    
      3200   274.35947     -30522.57       2613.6608      3422.0191    
      3300   296.62142     -30575.595     -9879.4624      3422.6992    
      3400   293.88107     -30605.535     -4726.0114      3423.3792    
      3500   311.72045     -30634.429     -4370.3742      3424.0593    
      3600   303.51176     -30615.685     -4748.0508      3424.7393    
      3700   319.21376     -30606.87       5847.414       3425.4194    
      3800   311.89007     -30588.237     -2285.7563      3426.0994    
      3900   278.92456     -30564.084     -5093.9611      3426.7795    
      4000   313.19233     -30611.619      6562.1677      3427.4595    
      4100   327.55063     -30643.944      56.197154      3428.1396    
      4200   310.65458     -30659.339     -13842.918      3428.8197    
      4300   319.40719     -30686.5       -15310.579      3429.4997    
      4400   292.87468     -30673.318     -7059.3736      3430.1798    
      4500   313.57907     -30688.806      2615.1644      3430.8598    
      4600   305.01093     -30672.134     -6692.4669      3431.5399    
      4700   321.49707     -30673.658     -135.61938      3432.2199    
      4800   303.84985     -30658.132     -11858.266      3432.9       
      4900   335.50796     -30695.847     -2638.7748      3433.58      
      5000   311.40185     -30696.998     -16680.44       3434.2601    
Loop time of 94.2449 on 16 procs for 5000 steps with 295 atoms

Performance: 2.292 ns/day, 10.472 hours/ns, 53.053 timesteps/s, 15.651 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.595     | 74.948     | 78.728     |  33.7 | 79.52
Bond    | 0.0082425  | 0.0087145  | 0.0093523  |   0.4 |  0.01
Neigh   | 1.997      | 2.0821     | 2.1802     |   4.4 |  2.21
Comm    | 1.2558     | 5.0274     | 10.367     | 130.0 |  5.33
Output  | 0.010458   | 0.027741   | 0.061823   |  11.3 |  0.03
Modify  | 11.961     | 12.051     | 12.134     |   1.7 | 12.79
Other   |            | 0.1004     |            |       |  0.11

Nlocal:         36.875 ave          45 max          21 min
Histogram: 1 0 0 0 0 2 0 2 2 1
Nghost:        3003.75 ave        3047 max        2942 min
Histogram: 1 0 0 1 1 0 2 1 0 2
Neighs:        22195.2 ave       26858 max       12998 min
Histogram: 1 0 0 0 0 2 0 1 3 1

Total # of neighbors = 177562
Ave neighs/atom = 601.90508
Ave special neighs/atom = 0
Neighbor list builds = 105
Dangerous builds = 5
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.1447
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.5805)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.1447
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.076974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.006366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.005805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.151447 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform4.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.1675     -29110.083      19634.618      3400.2575    
       200   674.66823     -29511.724      9599.775       3400.2575    
       300   473.87198     -29775.983      4082.1318      3400.2575    
       400   398.66311     -29982.973      5922.6691      3400.2575    
       500   351.13747     -30125.2        9173.0102      3400.2575    
       600   286.45076     -30167.838      1783.5127      3400.2575    
       700   311.55259     -30237.24      -6229.9067      3400.2575    
       800   278.1259      -30200.854      8154.6969      3400.2575    
       900   300.68393     -30206.171     -2069.0372      3400.2575    
      1000   345.45134     -30264.331     -9845.9864      3400.2575    
      1100   307.54157     -30268.656     -11181.208      3400.2575    
      1200   316.20296     -30289.926     -7760.0929      3400.2575    
      1300   326.39854     -30288.451      301.80023      3400.2575    
      1400   346.44591     -30329.975      1353.9443      3400.2575    
      1500   279.66677     -30336.939     -20133.317      3400.2575    
      1600   288.29415     -30395.1       -9137.2732      3400.2575    
      1700   268.20477     -30391.743     -81.755091      3400.2575    
      1800   304.91606     -30403.276      4328.6339      3400.2575    
      1900   328.81848     -30399.805     -8765.9915      3400.2575    
      2000   303.34593     -30383.514     -7620.3139      3400.2575    
      2100   317.64166     -30428.814     -1465.5449      3400.2575    
      2200   277.73927     -30412.324      3296.9763      3400.2575    
      2300   305.10504     -30441.502     -4144.4296      3400.2575    
      2400   279.73156     -30408.05      -7767.9842      3400.2575    
      2500   315.104       -30418.945     -5848.8585      3400.2575    
      2600   317.03593     -30405.466      55.35687       3400.2575    
      2700   297.56595     -30392.894      2899.0408      3400.2575    
      2800   331.6138      -30432.491     -20706.533      3400.2575    
      2900   287.17951     -30423.94      -14175.02       3400.2575    
      3000   279.12922     -30456.117     -7013.6195      3400.2575    
      3100   305.33006     -30489.772     -11399.575      3400.2575    
      3200   290.99571     -30464.31       1964.0049      3400.2575    
      3300   330.19899     -30496.816      9756.3534      3400.2575    
      3400   312.84411     -30500.188      2776.0586      3400.2575    
      3500   262.50193     -30487.878     -8445.3205      3400.2575    
      3600   285.54141     -30521.072     -8685.9229      3400.2575    
      3700   320.50139     -30524.57      -3429.2075      3400.2575    
      3800   328.31444     -30507.95       1494.3783      3400.2575    
      3900   325.40376     -30526.369      11748.522      3400.2575    
      4000   305.08622     -30543.891     -12485.448      3400.2575    
      4100   294.18428     -30558.393     -9005.759       3400.2575    
      4200   269.25421     -30537.112     -2791.7839      3400.2575    
      4300   291.17028     -30539.146      2469.4998      3400.2575    
      4400   324.73326     -30555.454     -4511.233       3400.2575    
      4500   314.88904     -30559.535     -10113.406      3400.2575    
      4600   295.27293     -30563.81      -14370.804      3400.2575    
      4700   320.52274     -30590.799     -20831.023      3400.2575    
      4800   296.095       -30575.852     -6814.3366      3400.2575    
      4900   305.94927     -30602.134      6009.0956      3400.2575    
      5000   282.92024     -30589.252     -7303.182       3400.2575    
Loop time of 94.2571 on 16 procs for 5000 steps with 295 atoms

Performance: 2.292 ns/day, 10.473 hours/ns, 53.046 timesteps/s, 15.649 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.779     | 75.061     | 78.817     |  32.3 | 79.63
Bond    | 0.008129   | 0.0086794  | 0.009358   |   0.4 |  0.01
Neigh   | 2.1799     | 2.262      | 2.3667     |   4.5 |  2.40
Comm    | 1.0545     | 4.7911     | 10.061     | 127.5 |  5.08
Output  | 0.010627   | 0.026448   | 0.061742   |  11.7 |  0.03
Modify  | 11.898     | 12.006     | 12.092     |   1.9 | 12.74
Other   |            | 0.1019     |            |       |  0.11

Nlocal:         36.875 ave          45 max          26 min
Histogram: 1 0 0 2 0 0 2 2 0 1
Nghost:        2990.88 ave        3063 max        2907 min
Histogram: 1 1 0 0 1 2 0 1 0 2
Neighs:        22433.8 ave       26882 max       16262 min
Histogram: 1 0 0 2 0 0 2 0 2 1

Total # of neighbors = 179470
Ave neighs/atom = 608.37288
Ave special neighs/atom = 0
Neighbor list builds = 114
Dangerous builds = 5
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.1447
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.151447 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform4.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.074      -29109.923      19656.987      3400.2575    
       200   673.39248     -29511.054      9312.2726      3400.2575    
       300   470.93675     -29773.073      4528.6785      3400.2575    
       400   401.00248     -29985.286      3833.2039      3400.2575    
       500   361.94416     -30133.756     -2021.3476      3400.2575    
       600   305.29944     -30179.365      4021.1583      3400.2575    
       700   288.42294     -30203.847     -7220.5415      3400.2575    
       800   244.09555     -30155.604     -2884.6611      3400.2575    
       900   322.10392     -30205.511     -1312.8202      3400.2575    
      1000   312.81834     -30219.049     -5658.9575      3400.2575    
      1100   286.02783     -30231.076     -13705.518      3400.2575    
      1200   286.92662     -30270.943     -8396.9741      3400.2575    
      1300   271.30453     -30285.293     -3489.3516      3400.2575    
      1400   294.39656     -30301.537      9514.6698      3400.2575    
      1500   308.64802     -30281.792     -5971.3615      3400.2575    
      1600   350.25078     -30296.335      4566.2124      3400.2575    
      1700   330.41549     -30305.885     -2270.0899      3400.2575    
      1800   290.62744     -30334.228     -13624.437      3400.2575    
      1900   294.96685     -30388.43      -2898.756       3400.2575    
      2000   283.42881     -30407.295     -4471.7548      3400.2575    
      2100   259.81457     -30379.144     -13653.931      3400.2575    
      2200   291.74034     -30376.193     -14723.697      3400.2575    
      2300   334.93038     -30392.606     -5220.5111      3400.2575    
      2400   304.52015     -30391.035     -5455.2669      3400.2575    
      2500   281.64672     -30407.777     -8262.1275      3400.2575    
      2600   284.05103     -30431.297     -10737.386      3400.2575    
      2700   295.45935     -30459.054     -7623.0255      3400.2575    
      2800   292.64775     -30472.132     -5296.5869      3400.2575    
      2900   335.779       -30569.069      10900.919      3400.2575    
      3000   238.39313     -30535.308     -5423.3649      3400.2575    
      3100   250.30688     -30553.034     -6367.2587      3400.2575    
      3200   248.81504     -30518.006     -9545.6175      3400.2575    
      3300   320.25017     -30535.018     -2073.5192      3400.2575    
      3400   362.08133     -30563.016     -6143.4368      3400.2575    
      3500   293.4945      -30538.256      894.55979      3400.2575    
      3600   267.6351      -30543.984     -4136.1312      3400.2575    
      3700   297.24266     -30578.877     -14451.631      3400.2575    
      3800   271.63586     -30547.873     -16058.62       3400.2575    
      3900   337.32395     -30593.928     -15301.957      3400.2575    
      4000   333.54231     -30578.971     -3630.4766      3400.2575    
      4100   269.74541     -30512.522     -6405.3262      3400.2575    
      4200   282.85216     -30529.103     -7155.1776      3400.2575    
      4300   309.48879     -30555.68      -9966.9779      3400.2575    
      4400   310.09131     -30563.525      1704.1939      3400.2575    
      4500   291.00754     -30559.339     -4638.2965      3400.2575    
      4600   241.76118     -30517.893      5831.9724      3400.2575    
      4700   283.68659     -30545.472     -6249.3161      3400.2575    
      4800   309.48038     -30556.662      910.36681      3400.2575    
      4900   342.35296     -30588.123      2223.7595      3400.2575    
      5000   349.29533     -30594.107      9531.2922      3400.2575    
Loop time of 93.0023 on 16 procs for 5000 steps with 295 atoms

Performance: 2.323 ns/day, 10.334 hours/ns, 53.762 timesteps/s, 15.860 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.093     | 74.853     | 77.727     |  16.9 | 80.49
Bond    | 0.0082943  | 0.0087632  | 0.0097457  |   0.5 |  0.01
Neigh   | 2.44       | 2.5148     | 2.6176     |   3.8 |  2.70
Comm    | 0.91909    | 3.7942     | 5.5492     |  74.9 |  4.08
Output  | 0.010643   | 0.025886   | 0.063234   |  12.5 |  0.03
Modify  | 11.564     | 11.663     | 11.735     |   1.7 | 12.54
Other   |            | 0.1426     |            |       |  0.15

Nlocal:         36.875 ave          43 max          31 min
Histogram: 2 0 0 0 2 1 0 1 1 1
Nghost:        3005.12 ave        3046 max        2962 min
Histogram: 2 0 0 0 1 3 0 0 0 2
Neighs:        22412.4 ave       25819 max       19010 min
Histogram: 2 0 0 0 2 1 0 1 1 1

Total # of neighbors = 179299
Ave neighs/atom = 607.79322
Ave special neighs/atom = 0
Neighbor list builds = 127
Dangerous builds = 5
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.6088
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.6366)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.6088
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.076974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.006366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.005805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.136088 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform5.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.1081     -29109.98       19659.562      3400.2575    
       200   673.86693     -29511.698      9426.5396      3400.2575    
       300   477.53962     -29779.159      4649.0854      3400.2575    
       400   398.56686     -29983.324      4180.0216      3400.2575    
       500   346.47671     -30119.804      871.55153      3400.2575    
       600   315.59846     -30190.286      3434.6524      3400.2575    
       700   298.28765     -30216.517      2070.6193      3400.2575    
       800   275.13711     -30193.073      3073.2376      3400.2575    
       900   282.06914     -30202.168     -4000.0522      3400.2575    
      1000   308.26584     -30258.633      1567.9695      3400.2575    
      1100   276.56569     -30260.472     -5611.8571      3400.2575    
      1200   296.00684     -30281.233     -8566.0381      3400.2575    
      1300   307.98827     -30267.893      2050.94        3400.2575    
      1400   335.36891     -30299.222     -817.99188      3400.2575    
      1500   305.19614     -30327.722      8016.4959      3400.2575    
      1600   265.64017     -30336.959     -2357.3834      3400.2575    
      1700   266.49002     -30350.333      2485.2767      3400.2575    
      1800   306.11091     -30385.401     -10222.779      3400.2575    
      1900   328.90066     -30422.872      1741.6058      3400.2575    
      2000   295.124       -30414.952     -17983.669      3400.2575    
      2100   284.99432     -30418.97      -5787.737       3400.2575    
      2200   285.3811      -30400.422     -3145.0412      3400.2575    
      2300   306.1438      -30391.496     -8125.1405      3400.2575    
      2400   334.02165     -30402.78      -6298.8865      3400.2575    
      2500   329.62573     -30437.659     -11574.323      3400.2575    
      2600   345.23015     -30580.766     -595.56876      3400.2575    
      2700   228.24864     -30557.164     -10251.49       3400.2575    
      2800   293.8608      -30634.225     -4545.3834      3400.2575    
      2900   257.74441     -30561.374     -7435.5236      3400.2575    
      3000   292.86269     -30536.871      5434.3483      3400.2575    
      3100   350.58059     -30558.517     -4895.3989      3400.2575    
      3200   343.73758     -30584.212      1719.7981      3400.2575    
      3300   276.0439      -30572.032      428.63113      3400.2575    
      3400   283.4186      -30605.871     -10885.055      3400.2575    
      3500   266.37371     -30584.33      -1167.1884      3400.2575    
      3600   318.9187      -30597.001     -11117.362      3400.2575    
      3700   280.94217     -30526.615     -8085.2991      3400.2575    
      3800   319.06661     -30550.12       3714.1514      3400.2575    
      3900   289.0975      -30550.546     -12241.598      3400.2575    
      4000   285.82997     -30587.835     -11531.587      3400.2575    
      4100   276.21944     -30591.693     -12046.413      3400.2575    
      4200   319.02807     -30615.367     -518.6101       3400.2575    
      4300   278.114       -30566.217     -4707.58        3400.2575    
      4400   278.24048     -30556.354     -6079.8113      3400.2575    
      4500   317.84923     -30592.213      8779.2456      3400.2575    
      4600   300.46435     -30587.495      7850.8647      3400.2575    
      4700   325.5631      -30629.957      356.47382      3400.2575    
      4800   294.63189     -30598.858     -7007.6134      3400.2575    
      4900   258.05006     -30563.826     -12230.502      3400.2575    
      5000   307.51814     -30603.11       4032.6554      3400.2575    
Loop time of 94.7605 on 16 procs for 5000 steps with 295 atoms

Performance: 2.279 ns/day, 10.529 hours/ns, 52.765 timesteps/s, 15.566 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.389     | 75.089     | 78.638     |  30.8 | 79.24
Bond    | 0.0081588  | 0.008677   | 0.0093227  |   0.4 |  0.01
Neigh   | 2.6477     | 2.7429     | 2.8769     |   4.7 |  2.89
Comm    | 1.2599     | 4.7958     | 9.4781     | 121.9 |  5.06
Output  | 0.010584   | 0.026253   | 0.061456   |  11.6 |  0.03
Modify  | 11.863     | 11.995     | 12.094     |   2.2 | 12.66
Other   |            | 0.1028     |            |       |  0.11

Nlocal:         36.875 ave          42 max          25 min
Histogram: 1 0 0 0 0 1 0 3 2 1
Nghost:        2962.12 ave        3007 max        2912 min
Histogram: 2 0 1 1 0 0 0 1 1 2
Neighs:        22428.8 ave       25440 max       15407 min
Histogram: 1 0 0 0 0 1 0 3 2 1

Total # of neighbors = 179430
Ave neighs/atom = 608.23729
Ave special neighs/atom = 0
Neighbor list builds = 138
Dangerous builds = 5
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.6088
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.136088 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform5.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.1421     -29110.024      19668.915      3400.2575    
       200   673.91155     -29510.998      9501.0387      3400.2575    
       300   467.89254     -29770.472      3926.3701      3400.2575    
       400   386.83858     -29972.034      4366.032       3400.2575    
       500   356.29318     -30128.278     -1111.7962      3400.2575    
       600   319.14743     -30191.596      1815.9324      3400.2575    
       700   273.05672     -30189.778     -5364.9123      3400.2575    
       800   261.79266     -30170.325      6083.0258      3400.2575    
       900   328.53975     -30222.756     -2479.1926      3400.2575    
      1000   281.61623     -30189.474     -4676.0248      3400.2575    
      1100   310.79597     -30246.805      2461.8713      3400.2575    
      1200   302.91723     -30268.498     -7520.8003      3400.2575    
      1300   275.24132     -30248.884     -7736.0281      3400.2575    
      1400   290.8129      -30250.347     -5359.9598      3400.2575    
      1500   357.28177     -30316.217     -3172.1772      3400.2575    
      1600   317.72407     -30357.199      406.56911      3400.2575    
      1700   295.77397     -30391.935     -772.7351       3400.2575    
      1800   268.88569     -30386.361      591.79645      3400.2575    
      1900   308.76905     -30424.543     -9534.5891      3400.2575    
      2000   303.95423     -30418.497     -5452.179       3400.2575    
      2100   277.11491     -30387.154      1241.4254      3400.2575    
      2200   304.02863     -30405.16       10327.596      3400.2575    
      2300   304.24803     -30413.325     -13648.767      3400.2575    
      2400   313.53365     -30437.571     -12638.502      3400.2575    
      2500   279.64605     -30421.506     -2204.4101      3400.2575    
      2600   309.50151     -30463.043     -7784.4084      3400.2575    
      2700   316.14594     -30482.407     -6060.6705      3400.2575    
      2800   283.2598      -30458.581     -252.48591      3400.2575    
      2900   304.8202      -30487.805     -258.57087      3400.2575    
      3000   301.33779     -30507.428     -3280.2497      3400.2575    
      3100   276.0112      -30501.6       -8512.098       3400.2575    
      3200   283.74203     -30505.051     -14681.943      3400.2575    
      3300   313.75668     -30513.275     -8732.5554      3400.2575    
      3400   328.26967     -30528.492      1336.2768      3400.2575    
      3500   325.22747     -30548.294      4670.7102      3400.2575    
      3600   286.86043     -30534.003      2540.2588      3400.2575    
      3700   303.85347     -30536.685     -13634.052      3400.2575    
      3800   317.22        -30520.59      -421.66667      3400.2575    
      3900   342.81547     -30532.119     -76.686284      3400.2575    
      4000   299.14688     -30512.278      4932.7803      3400.2575    
      4100   270.42507     -30511.609      12856.957      3400.2575    
      4200   261.72464     -30515.522     -1870.3788      3400.2575    
      4300   298.77151     -30526.403     -2841.7181      3400.2575    
      4400   310.30483     -30522.219     -1080.9927      3400.2575    
      4500   311.59815     -30543.24       12333.817      3400.2575    
      4600   287.2533      -30556.933      9916.7993      3400.2575    
      4700   295.42653     -30584.229     -6725.8267      3400.2575    
      4800   256.03263     -30552.149     -2853.7089      3400.2575    
      4900   309.47982     -30570.443     -889.23965      3400.2575    
      5000   289.21266     -30519.104     -7978.4647      3400.2575    
Loop time of 93.0095 on 16 procs for 5000 steps with 295 atoms

Performance: 2.322 ns/day, 10.334 hours/ns, 53.758 timesteps/s, 15.859 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.739     | 74.751     | 77.868     |  19.3 | 80.37
Bond    | 0.0082125  | 0.008667   | 0.0092559  |   0.3 |  0.01
Neigh   | 2.2786     | 2.3469     | 2.4388     |   3.7 |  2.52
Comm    | 0.95263    | 4.0642     | 6.0705     |  82.5 |  4.37
Output  | 0.010791   | 0.025982   | 0.063102   |  12.4 |  0.03
Modify  | 11.582     | 11.673     | 11.746     |   1.7 | 12.55
Other   |            | 0.1401     |            |       |  0.15

Nlocal:         36.875 ave          42 max          34 min
Histogram: 3 0 0 1 0 3 0 0 0 1
Nghost:        3009.62 ave        3048 max        2964 min
Histogram: 1 1 0 1 1 0 1 1 0 2
Neighs:        22476.6 ave       25273 max       20790 min
Histogram: 3 0 0 1 0 3 0 0 0 1

Total # of neighbors = 179813
Ave neighs/atom = 609.53559
Ave special neighs/atom = 0
Neighbor list builds = 119
Dangerous builds = 5
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.498
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.6974)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.498
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.6974000000000000199, deltaxy = 0.076974
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.63660000000000005471, deltaxz = 0.006366
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.58050000000000001599, deltayz = -0.005805
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.16498 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform6.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.0392     -29109.957      19825.453      3400.2575    
       200   676.54448     -29513.219      7976.9306      3400.2575    
       300   474.58608     -29776.87       4411.274       3400.2575    
       400   384.41566     -29971.889      9458.8174      3400.2575    
       500   372.08045     -30148.693      2408.3749      3400.2575    
       600   280.02218     -30161.929     -2975.863       3400.2575    
       700   331.17697     -30255.113     -8294.6571      3400.2575    
       800   250.05822     -30202.9        1885.173       3400.2575    
       900   263.9811      -30218.504      11584.601      3400.2575    
      1000   327.93774     -30267.223     -7695.8946      3400.2575    
      1100   370.06348     -30331.765      4830.7084      3400.2575    
      1200   309.95401     -30343.025     -11375.149      3400.2575    
      1300   307.99314     -30392.543     -8977.2309      3400.2575    
      1400   242.03291     -30352.346     -15776.042      3400.2575    
      1500   278.56791     -30352.449     -8766.776       3400.2575    
      1600   334.46262     -30347.635     -5301.1617      3400.2575    
      1700   335.56499     -30340.97      -5627.7653      3400.2575    
      1800   314.72682     -30367.439      5171.1052      3400.2575    
      1900   306.19728     -30418.855      8530.6742      3400.2575    
      2000   312.54681     -30464.651     -5459.5251      3400.2575    
      2100   269.91395     -30451.837      370.92726      3400.2575    
      2200   300.52647     -30484.563      4794.732       3400.2575    
      2300   269.77304     -30452.114      6314.2512      3400.2575    
      2400   317.02667     -30473.22       15092.029      3400.2575    
      2500   296.29348     -30436.705     -1239.852       3400.2575    
      2600   292.23071     -30446.805     -4460.1433      3400.2575    
      2700   311.43515     -30490.716      5743.867       3400.2575    
      2800   274.86247     -30473.483      3244.5108      3400.2575    
      2900   302.81036     -30507.587     -2188.3258      3400.2575    
      3000   282.49491     -30482.73      -14710.781      3400.2575    
      3100   330.49021     -30518.984      895.19247      3400.2575    
      3200   266.37483     -30456.669     -1409.5788      3400.2575    
      3300   325.03583     -30506.785     -1602.1233      3400.2575    
      3400   286.5161      -30487.656     -8547.2213      3400.2575    
      3500   324.65758     -30551.751      6300.7579      3400.2575    
      3600   286.50892     -30559.888     -1784.1869      3400.2575    
      3700   276.43983     -30584.031     -14051.474      3400.2575    
      3800   281.66826     -30609.265      2012.9089      3400.2575    
      3900   280.45058     -30603.123     -2573.4255      3400.2575    
      4000   320.3625      -30612.649     -5447.8064      3400.2575    
      4100   353.62718     -30643.393      7643.2585      3400.2575    
      4200   270.30728     -30610.532     -4316.7348      3400.2575    
      4300   288.61969     -30657.872      995.62766      3400.2575    
      4400   272.58724     -30658.097     -6227.2454      3400.2575    
      4500   289.4268      -30661.361     -17637.21       3400.2575    
      4600   281.26281     -30646.023      2859.3498      3400.2575    
      4700   291.61696     -30650.733      1822.6144      3400.2575    
      4800   301.26252     -30660.348      3838.1372      3400.2575    
      4900   272.80059     -30655.894      1473.3301      3400.2575    
      5000   275.29167     -30670.173     -7576.4085      3400.2575    
Loop time of 94.5441 on 16 procs for 5000 steps with 295 atoms

Performance: 2.285 ns/day, 10.505 hours/ns, 52.885 timesteps/s, 15.601 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.621     | 75.618     | 79.473     |  35.9 | 79.98
Bond    | 0.0080961  | 0.0086016  | 0.0091023  |   0.3 |  0.01
Neigh   | 2.019      | 2.1061     | 2.2083     |   4.5 |  2.23
Comm    | 1.0884     | 4.9716     | 10.949     | 139.8 |  5.26
Output  | 0.010432   | 0.027536   | 0.061174   |  11.2 |  0.03
Modify  | 11.61      | 11.711     | 11.803     |   1.9 | 12.39
Other   |            | 0.1008     |            |       |  0.11

Nlocal:         36.875 ave          44 max          22 min
Histogram: 1 0 0 0 1 0 1 2 1 2
Nghost:         3017.5 ave        3099 max        2931 min
Histogram: 2 0 0 1 1 0 2 0 0 2
Neighs:        22395.8 ave       26314 max       13783 min
Histogram: 1 0 0 0 1 0 1 2 1 2

Total # of neighbors = 179166
Ave neighs/atom = 607.34237
Ave special neighs/atom = 0
Neighbor list builds = 105
Dangerous builds = 5
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.498
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.16498 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform6.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.6 | 118.2 | 119.7 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   0             -27051.653      123682.78      3400.2575    
       100   1026.2781     -29110.263      19489.197      3400.2575    
       200   671.53545     -29509.284      9387.4367      3400.2575    
       300   503.02228     -29803.472      7584.7344      3400.2575    
       400   431.65855     -30017.944      3092.4719      3400.2575    
       500   304.07822     -30084.466      7239.1103      3400.2575    
       600   317.47445     -30197.185     -5340.0262      3400.2575    
       700   310.83364     -30247.146     -2522.3029      3400.2575    
       800   296.00475     -30256.069      6750.9799      3400.2575    
       900   295.5058      -30244.736     -3008.6026      3400.2575    
      1000   309.16641     -30232.363     -1277.5894      3400.2575    
      1100   289.04492     -30205.731     -16862.739      3400.2575    
      1200   281.60612     -30224.85       2025.4406      3400.2575    
      1300   313.91278     -30288.635      1393.9352      3400.2575    
      1400   296.74872     -30299.434     -1646.551       3400.2575    
      1500   279.46771     -30289.606     -50.846746      3400.2575    
      1600   281.8058      -30280.612      9113.3284      3400.2575    
      1700   297.629       -30291.392     -4008.6306      3400.2575    
      1800   296.26661     -30310.875     -1610.0494      3400.2575    
      1900   277.7994      -30337.623      4815.908       3400.2575    
      2000   313.42406     -30404.571     -3669.2731      3400.2575    
      2100   275.69011     -30392.314     -3784.7908      3400.2575    
      2200   289.68979     -30406.184     -10048.467      3400.2575    
      2300   304.61315     -30393.818      9509.4164      3400.2575    
      2400   322.51637     -30370.493      3678.8247      3400.2575    
      2500   318.07612     -30366.632      1810.1355      3400.2575    
      2600   355.26847     -30443.966      1560.6999      3400.2575    
      2700   258.3858      -30425.579     -4066.6429      3400.2575    
      2800   312.79218     -30510.618      2398.7453      3400.2575    
      2900   283.01228     -30492.256      13394.197      3400.2575    
      3000   294.59842     -30487.51      -116.35623      3400.2575    
      3100   300.89928     -30476.091      246.23068      3400.2575    
      3200   343.08125     -30505.219      1166.2597      3400.2575    
      3300   289.18091     -30473.312      4480.8926      3400.2575    
      3400   290.40794     -30510.557     -8906.0717      3400.2575    
      3500   307.70068     -30554.726     -11105.378      3400.2575    
      3600   314.54502     -30555.237     -3567.7996      3400.2575    
      3700   321.68935     -30533.214     -4911.4756      3400.2575    
      3800   300.65935     -30488.021     -510.15927      3400.2575    
      3900   311.84094     -30489.311     -94.848849      3400.2575    
      4000   324.77947     -30519.133      1869.6158      3400.2575    
      4100   286.39907     -30508.605     -2929.3988      3400.2575    
      4200   265.30672     -30508.959     -12289.955      3400.2575    
      4300   283.67932     -30512.587     -9328.6826      3400.2575    
      4400   308.594       -30503.628      8849.6896      3400.2575    
      4500   345.81804     -30515.551     -10591.859      3400.2575    
      4600   304.62553     -30504.001     -18520.627      3400.2575    
      4700   276.93191     -30514.468      14428.995      3400.2575    
      4800   264.39748     -30522.482     -8576.1615      3400.2575    
      4900   297.18196     -30550.493      12321.166      3400.2575    
      5000   316.86945     -30563.257      2404.8773      3400.2575    
Loop time of 93.1977 on 16 procs for 5000 steps with 295 atoms

Performance: 2.318 ns/day, 10.355 hours/ns, 53.649 timesteps/s, 15.827 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.164     | 75.011     | 77.487     |  16.8 | 80.49
Bond    | 0.0082918  | 0.0086541  | 0.009113   |   0.2 |  0.01
Neigh   | 1.9553     | 2.0049     | 2.0926     |   3.4 |  2.15
Comm    | 1.9908     | 4.4683     | 6.3112     |  68.9 |  4.79
Output  | 0.010817   | 0.02594    | 0.062969   |  12.4 |  0.03
Modify  | 11.451     | 11.54      | 11.595     |   1.4 | 12.38
Other   |            | 0.1382     |            |       |  0.15

Nlocal:         36.875 ave          44 max          31 min
Histogram: 1 0 2 2 0 1 0 0 0 2
Nghost:        2961.25 ave        3025 max        2883 min
Histogram: 1 1 0 0 1 1 1 1 1 1
Neighs:        22422.6 ave       26544 max       19100 min
Histogram: 1 0 3 1 0 1 0 0 0 2

Total # of neighbors = 179381
Ave neighs/atom = 608.07119
Ave special neighs/atom = 0
Neighbor list builds = 102
Dangerous builds = 5
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:18:47
