LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 5*${nthermo}       # steps of equilibration run 20
variable nequil equal 5*100       
variable nrun equal 5*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 5*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333SiCOH
read_data       ${structure}.data
read_data       333SiCOH.data
Reading data file ...
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 7.0627e-05 on 8 procs for 1 steps with 373 atoms

49.2% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 8.38e-07   | 2.2699e-06 | 2.654e-06  |   0.0 |  3.21
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 5.238e-06  | 5.9541e-06 | 7.124e-06  |   0.0 |  8.43
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.24e-05   |            |       | 88.36

Nlocal:         46.625 ave          55 max          38 min
Histogram: 2 0 0 2 0 0 0 2 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333SiCOH_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 500

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = 39.36 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 123.1 | 123.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -37805.726      120410.25      0              1.1428982      4699.6115    
       100   971.48107     -39279.39      -18145.557     -7414.6569      1.1428982      4699.6115    
       200   652.02011     -39654.418     -10133.232     -9800.1832      1.1428982      4699.6115    
       300   479.64457     -39914.723     -331.70118     -2812.6453      1.1428982      4699.6115    
       400   389.29837     -40111.008     -12726.665     -6906.7446      1.1428982      4699.6115    
       500   312.1342      -40215.781      1702.1112     -3554.1859      1.1428982      4699.6115    
Loop time of 10.7618 on 8 procs for 500 steps with 373 atoms

Performance: 2.007 ns/day, 11.958 hours/ns, 46.461 timesteps/s, 17.330 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.5351     | 7.8243     | 8.1614     |   7.1 | 72.71
Bond    | 0.00084726 | 0.00089241 | 0.00094405 |   0.0 |  0.01
Neigh   | 0.95873    | 0.96815    | 0.97647    |   0.7 |  9.00
Comm    | 0.151      | 0.4878     | 0.77678    |  28.4 |  4.53
Output  | 0.00018676 | 0.00020636 | 0.00033664 |   0.0 |  0.00
Modify  | 1.4619     | 1.4704     | 1.48       |   0.6 | 13.66
Other   |            | 0.009987   |            |       |  0.09

Nlocal:         46.625 ave          60 max          42 min
Histogram: 3 2 1 0 0 1 0 0 0 1
Nghost:        3203.75 ave        3244 max        3171 min
Histogram: 2 1 1 0 1 0 1 0 0 2
Neighs:        25700.9 ave       32604 max       23272 min
Histogram: 3 2 1 0 0 1 0 0 0 1

Total # of neighbors = 205607
Ave neighs/atom = 551.2252
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333SiCOH_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 19.0492
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.0575
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.55

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--3554.18588274308)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--3554.18588274308)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--1520.74089553255)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--1520.74089553255)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-20.5534739435874)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-20.5534739435874)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1142.26397997736)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1142.26397997736)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1119.80137195092)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1119.80137195092)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1107.64029024917)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1107.64029024917)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 19.0492
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*19.0492
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.190492 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.190492 xy delta 0.107944 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.190492 xy delta 0.107944 xz delta -0.013894 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (18.858708 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (18.858708 14.0575 17.55) with tilt (-10.686456 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (18.858708 14.0575 17.55) with tilt (-10.686456 1.375506 -3.3406)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.4 | 125.1 | 126.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40204.603      33846.151      0              4652.6153    
       100   297.12666     -40318.202     -2718.4986     -4796.0334      4652.6153    
       200   272.905       -40366.544     -4091.0769     -2379.4967      4652.6153    
       300   291.87372     -40415.076     -7870.5625     -1807.4282      4652.6153    
       400   306.40017     -40433.905     -1229.7119     -3311.3299      4652.6153    
       500   324.30021     -40454.228     -2058.4368     -3727.0583      4652.6153    
Loop time of 10.9753 on 8 procs for 500 steps with 373 atoms

Performance: 1.968 ns/day, 12.195 hours/ns, 45.557 timesteps/s, 16.993 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.5476     | 7.959      | 8.4171     |  10.7 | 72.52
Bond    | 0.00082739 | 0.00088907 | 0.00092895 |   0.0 |  0.01
Neigh   | 0.96062    | 0.97445    | 0.99525    |   1.2 |  8.88
Comm    | 0.11993    | 0.57797    | 0.98958    |  39.6 |  5.27
Output  | 0.00091904 | 0.0011772  | 0.001357   |   0.5 |  0.01
Modify  | 1.431      | 1.452      | 1.4657     |   1.0 | 13.23
Other   |            | 0.009807   |            |       |  0.09

Nlocal:         46.625 ave          58 max          38 min
Histogram: 2 0 0 1 1 3 0 0 0 1
Nghost:        3191.75 ave        3244 max        3148 min
Histogram: 2 0 1 0 2 1 0 0 0 2
Neighs:        25906.8 ave       31796 max       21535 min
Histogram: 2 0 0 1 2 2 0 0 0 1

Total # of neighbors = 207254
Ave neighs/atom = 555.64075
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.4 | 124.8 | 126 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   324.30021     -40454.228     -2058.434       0              4652.6153    
       100   305.52676     -40454.132      1776.1772     -3610.853       4652.6153    
       200   298.42464     -40474.364      48.716919     -3281.5527      4652.6153    
       300   304.33132     -40484.921      6940.4929     -2381.7455      4652.6153    
       400   302.61439     -40487.915      9886.5285     -1634.9647      4652.6153    
       500   301.93627     -40504.074      7933.9373      916.45557      4652.6153    
Loop time of 10.9033 on 8 procs for 500 steps with 373 atoms

Performance: 1.981 ns/day, 12.115 hours/ns, 45.857 timesteps/s, 17.105 katom-step/s
97.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.4395     | 7.9857     | 8.3723     |  11.1 | 73.24
Bond    | 0.00083364 | 0.00088652 | 0.00094159 |   0.0 |  0.01
Neigh   | 0.94648    | 0.9604     | 0.98256    |   1.2 |  8.81
Comm    | 0.12435    | 0.51117    | 1.0575     |  43.8 |  4.69
Output  | 0.00017293 | 0.00018539 | 0.0002522  |   0.0 |  0.00
Modify  | 1.4131     | 1.4353     | 1.4492     |   1.0 | 13.16
Other   |            | 0.009695   |            |       |  0.09

Nlocal:         46.625 ave          56 max          38 min
Histogram: 1 2 0 0 0 1 2 1 0 1
Nghost:        3185.88 ave        3243 max        3149 min
Histogram: 2 0 3 0 1 0 0 0 1 1
Neighs:          25947 ave       30626 max       21435 min
Histogram: 1 2 0 0 0 1 2 1 0 1

Total # of neighbors = 207576
Ave neighs/atom = 556.50402
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 45.2987745242503
variable C2neg equal ${d2}
variable C2neg equal 28.4768241054239
variable C3neg equal ${d3}
variable C3neg equal -15.3199388528598
variable C4neg equal ${d4}
variable C4neg equal -4.35286197069355
variable C5neg equal ${d5}
variable C5neg equal -5.44245049733991
variable C6neg equal ${d6}
variable C6neg equal 13.6794527264755

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*19.0492
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.190492 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.190492 xy delta -0.107944 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.190492 xy delta -0.107944 xz delta 0.013894 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.239692 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.239692 14.0575 17.55) with tilt (-10.902344 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.239692 14.0575 17.55) with tilt (-10.902344 1.403294 -3.3406)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.1 | 123.3 | 124.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40194.858     -30349.628      0              4746.6076    
       100   300.67457     -40311.173     -7950.7381     -3664.1888      4746.6076    
       200   251.26885     -40332.392     -568.55999     -2847.7558      4746.6076    
       300   285.62467     -40393.048      3558.8221      1400.5722      4746.6076    
       400   290.96472     -40382.605     -8731.7394     -4654.9193      4746.6076    
       500   304.02011     -40374.219      5351.6616     -3081.5109      4746.6076    
Loop time of 10.6428 on 8 procs for 500 steps with 373 atoms

Performance: 2.030 ns/day, 11.825 hours/ns, 46.980 timesteps/s, 17.524 katom-step/s
98.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.3167     | 7.7289     | 8.1478     |  10.3 | 72.62
Bond    | 0.00084633 | 0.00089942 | 0.00096137 |   0.0 |  0.01
Neigh   | 0.94104    | 0.95642    | 0.97122    |   1.1 |  8.99
Comm    | 0.11219    | 0.53134    | 0.94307    |  39.2 |  4.99
Output  | 0.00080569 | 0.0010819  | 0.001269   |   0.5 |  0.01
Modify  | 1.3991     | 1.4145     | 1.429      |   1.0 | 13.29
Other   |            | 0.009684   |            |       |  0.09

Nlocal:         46.625 ave          55 max          42 min
Histogram: 2 0 1 3 0 0 1 0 0 1
Nghost:        3150.12 ave        3220 max        3088 min
Histogram: 2 2 0 0 0 0 0 2 0 2
Neighs:        25394.6 ave       29666 max       23051 min
Histogram: 2 0 3 0 1 0 1 0 0 1

Total # of neighbors = 203157
Ave neighs/atom = 544.65684
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.2 | 123.3 | 124.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.02011     -40374.219      5351.6442      0              4746.6076    
       100   321.87816     -40412.944      3134.6641     -2228.5847      4746.6076    
       200   293.43019     -40410.178      1335.8001     -2485.5217      4746.6076    
       300   308.95468     -40436.974     -15561.413     -6982.8268      4746.6076    
       400   313.1677      -40458.423      1980.3974     -2262.614       4746.6076    
       500   295.0735      -40466.231      2804.635      -4813.4308      4746.6076    
Loop time of 10.6186 on 8 procs for 500 steps with 373 atoms

Performance: 2.034 ns/day, 11.798 hours/ns, 47.087 timesteps/s, 17.563 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.2028     | 7.7733     | 8.1291     |  10.8 | 73.20
Bond    | 0.00086408 | 0.00091246 | 0.00097582 |   0.0 |  0.01
Neigh   | 0.93007    | 0.94889    | 0.96631    |   1.3 |  8.94
Comm    | 0.12883    | 0.48509    | 1.0549     |  43.4 |  4.57
Output  | 0.00014325 | 0.00015656 | 0.00022852 |   0.0 |  0.00
Modify  | 1.3825     | 1.4007     | 1.4185     |   1.1 | 13.19
Other   |            | 0.009676   |            |       |  0.09

Nlocal:         46.625 ave          60 max          35 min
Histogram: 1 0 1 0 3 2 0 0 0 1
Nghost:        3156.88 ave        3229 max        3098 min
Histogram: 1 2 1 0 1 1 0 0 0 2
Neighs:        25387.5 ave       32050 max       19571 min
Histogram: 1 0 1 0 3 2 0 0 0 1

Total # of neighbors = 203100
Ave neighs/atom = 544.50402
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 12.759299442404
variable C2pos equal ${d2}
variable C2pos equal -31.5558066138974
variable C3pos equal ${d3}
variable C3pos equal 38.1780525716924
variable C4pos equal ${d4}
variable C4pos equal 0.528772716999551
variable C5pos equal ${d5}
variable C5pos equal -1.88119806753592
variable C6pos equal ${d6}
variable C6pos equal 8.49955910188848

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(45.2987745242503+${C1pos})
variable C11 equal 0.5*(45.2987745242503+12.759299442404)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(28.4768241054239+${C2pos})
variable C21 equal 0.5*(28.4768241054239+-31.5558066138974)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-15.3199388528598+${C3pos})
variable C31 equal 0.5*(-15.3199388528598+38.1780525716924)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-4.35286197069355+${C4pos})
variable C41 equal 0.5*(-4.35286197069355+0.528772716999551)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-5.44245049733991+${C5pos})
variable C51 equal 0.5*(-5.44245049733991+-1.88119806753592)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(13.6794527264755+${C6pos})
variable C61 equal 0.5*(13.6794527264755+8.49955910188848)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.0575
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.0575
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.140575 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.140575 yz delta 0.033406 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 13.916925 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 13.916925 17.55) with tilt (-10.7944 1.3894 -3.307194)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.6 | 125.5 | 126.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40195.774      31568.352      0              4652.6153    
       100   308.83746     -40324.026     -2483.726      -4971.0579      4652.6153    
       200   273.56688     -40367.032     -6572.9858     -3857.3463      4652.6153    
       300   291.63061     -40416.995     -7428.974       700.39483      4652.6153    
       400   299.45068     -40426.51      -4106.7379     -2395.5735      4652.6153    
       500   307.76868     -40427.244      172.97101     -2853.5236      4652.6153    
Loop time of 10.9339 on 8 procs for 500 steps with 373 atoms

Performance: 1.976 ns/day, 12.149 hours/ns, 45.729 timesteps/s, 17.057 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.6179     | 8.0042     | 8.4061     |  10.2 | 73.21
Bond    | 0.00082784 | 0.00088757 | 0.00093985 |   0.0 |  0.01
Neigh   | 0.96317    | 0.97718    | 0.99074    |   1.1 |  8.94
Comm    | 0.11789    | 0.5191     | 0.90584    |  40.1 |  4.75
Output  | 0.0008235  | 0.0011047  | 0.0012983  |   0.5 |  0.01
Modify  | 1.4081     | 1.4215     | 1.4353     |   0.9 | 13.00
Other   |            | 0.009955   |            |       |  0.09

Nlocal:         46.625 ave          58 max          39 min
Histogram: 2 0 1 1 1 1 1 0 0 1
Nghost:           3200 ave        3259 max        3151 min
Histogram: 2 1 0 1 0 2 0 0 0 2
Neighs:        25930.8 ave       31822 max       22018 min
Histogram: 2 0 1 1 1 1 1 0 0 1

Total # of neighbors = 207446
Ave neighs/atom = 556.1555
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.8 | 125.2 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.76868     -40427.244      172.96915      0              4652.6153    
       100   307.65009     -40435.135     -10503.74      -2010.0547      4652.6153    
       200   301.85171     -40469.108      4607.8782     -2652.5147      4652.6153    
       300   297.62768     -40476.394     -930.20949      194.46173      4652.6153    
       400   312.12159     -40503.041      30.439321     -4525.7668      4652.6153    
       500   290.5689      -40498.229     -9167.8617     -3899.2363      4652.6153    
Loop time of 10.9767 on 8 procs for 500 steps with 373 atoms

Performance: 1.968 ns/day, 12.196 hours/ns, 45.551 timesteps/s, 16.990 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.5659     | 8.0928     | 8.4461     |  10.5 | 73.73
Bond    | 0.00084244 | 0.00090505 | 0.00096074 |   0.0 |  0.01
Neigh   | 0.95471    | 0.97631    | 0.99669    |   1.4 |  8.89
Comm    | 0.12291    | 0.47685    | 1.004      |  43.2 |  4.34
Output  | 0.00012956 | 0.00014353 | 0.00023648 |   0.0 |  0.00
Modify  | 1.3991     | 1.4198     | 1.4414     |   1.2 | 12.93
Other   |            | 0.009838   |            |       |  0.09

Nlocal:         46.625 ave          56 max          38 min
Histogram: 1 0 2 0 0 3 0 1 0 1
Nghost:        3218.25 ave        3268 max        3181 min
Histogram: 2 0 2 0 1 1 0 0 1 1
Neighs:        25956.2 ave       30698 max       21443 min
Histogram: 1 0 2 0 0 3 0 1 0 1

Total # of neighbors = 207650
Ave neighs/atom = 556.70241
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -3.4962235213578
variable C2neg equal ${d2}
variable C2neg equal -6.68830037624829
variable C3neg equal ${d3}
variable C3neg equal -46.4221690569659
variable C4neg equal ${d4}
variable C4neg equal -5.5291603258461
variable C5neg equal ${d5}
variable C5neg equal 3.95888094597528
variable C6neg equal ${d6}
variable C6neg equal 14.5432337333578

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.0575
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.140575 yz delta ${deltayz} remap units box
change_box all y delta 0 0.140575 yz delta -0.033406 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.198075 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.198075 17.55) with tilt (-10.7944 1.3894 -3.374006)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 122.4 | 123.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40205.788     -29806.162      0              4746.6076    
       100   287.17809     -40304.992     -3768.0295     -4320.9561      4746.6076    
       200   261.6733      -40346.16      -11604.598     -4512.0996      4746.6076    
       300   283.6429      -40386.285     -4705.4932     -3287.2738      4746.6076    
       400   312.3421      -40405.875      6967.6616     -1972.7243      4746.6076    
       500   328.17239     -40427.529     -8070.7769     -3543.6834      4746.6076    
Loop time of 10.6004 on 8 procs for 500 steps with 373 atoms

Performance: 2.038 ns/day, 11.778 hours/ns, 47.168 timesteps/s, 17.594 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.2591     | 7.6922     | 8.112      |  10.3 | 72.56
Bond    | 0.00083866 | 0.00088237 | 0.00092646 |   0.0 |  0.01
Neigh   | 0.93417    | 0.95207    | 0.97078    |   1.4 |  8.98
Comm    | 0.11315    | 0.53242    | 0.96556    |  39.4 |  5.02
Output  | 0.00084648 | 0.001128   | 0.0013192  |   0.5 |  0.01
Modify  | 1.3934     | 1.4121     | 1.4302     |   1.2 | 13.32
Other   |            | 0.009649   |            |       |  0.09

Nlocal:         46.625 ave          56 max          42 min
Histogram: 3 0 1 1 2 0 0 0 0 1
Nghost:        3147.62 ave        3229 max        3072 min
Histogram: 2 0 0 2 0 2 0 0 0 2
Neighs:        25437.1 ave       30163 max       23220 min
Histogram: 3 0 1 1 2 0 0 0 0 1

Total # of neighbors = 203497
Ave neighs/atom = 545.56836
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 122.4 | 123.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   328.17239     -40427.529     -8070.7733      0              4746.6076    
       100   300.13173     -40422.521      2770.5809     -4514.3716      4746.6076    
       200   310.26332     -40452.108      6126.8607     -1853.8692      4746.6076    
       300   322.93996     -40479.02       7890.39       -2430.262       4746.6076    
       400   279.82988     -40452.477     -8045.3523     -421.48767      4746.6076    
       500   286.2367      -40469.99      -4532.6382     -4009.9791      4746.6076    
Loop time of 10.5207 on 8 procs for 500 steps with 373 atoms

Performance: 2.053 ns/day, 11.690 hours/ns, 47.525 timesteps/s, 17.727 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.3287     | 7.7448     | 8.0968     |   9.4 | 73.61
Bond    | 0.00084759 | 0.00089713 | 0.00096493 |   0.0 |  0.01
Neigh   | 0.92436    | 0.94275    | 0.96192    |   1.4 |  8.96
Comm    | 0.10307    | 0.45472    | 0.87032    |  38.9 |  4.32
Output  | 0.00015295 | 0.0001631  | 0.00022936 |   0.0 |  0.00
Modify  | 1.3479     | 1.3678     | 1.3867     |   1.2 | 13.00
Other   |            | 0.009606   |            |       |  0.09

Nlocal:         46.625 ave          55 max          38 min
Histogram: 1 1 0 0 2 1 0 2 0 1
Nghost:         3141.5 ave        3198 max        3101 min
Histogram: 1 1 2 1 0 1 0 1 0 1
Neighs:          25372 ave       29443 max       20982 min
Histogram: 1 1 0 0 2 1 0 2 0 1

Total # of neighbors = 202976
Ave neighs/atom = 544.17158
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 4.61832453185151
variable C2pos equal ${d2}
variable C2pos equal -23.7184245923496
variable C3pos equal ${d3}
variable C3pos equal 58.0036910470564
variable C4pos equal ${d4}
variable C4pos equal 13.7325335061507
variable C5pos equal ${d5}
variable C5pos equal -1.47263717862091
variable C6pos equal ${d6}
variable C6pos equal 7.25266355103077

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-3.4962235213578+${C1pos})
variable C12 equal 0.5*(-3.4962235213578+4.61832453185151)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-6.68830037624829+${C2pos})
variable C22 equal 0.5*(-6.68830037624829+-23.7184245923496)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-46.4221690569659+${C3pos})
variable C32 equal 0.5*(-46.4221690569659+58.0036910470564)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-5.5291603258461+${C4pos})
variable C42 equal 0.5*(-5.5291603258461+13.7325335061507)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(3.95888094597528+${C5pos})
variable C52 equal 0.5*(3.95888094597528+-1.47263717862091)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(14.5432337333578+${C6pos})
variable C62 equal 0.5*(14.5432337333578+7.25266355103077)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.55
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.55
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.3745) with tilt (-10.7944 1.3894 -3.3406)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124 | 125.3 | 126.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40205.612      33162.492      0              4652.6153    
       100   299.39069     -40320.381     -2657.0383     -4507.6199      4652.6153    
       200   276.23808     -40371.721     -1186.2554     -5005.9762      4652.6153    
       300   279.74967     -40402.677     -11548.16      -1580.7537      4652.6153    
       400   314.81358     -40429.899      38.571641     -1959.2455      4652.6153    
       500   323.98093     -40423.388      3610.6089     -4363.1349      4652.6153    
Loop time of 10.9069 on 8 procs for 500 steps with 373 atoms

Performance: 1.980 ns/day, 12.119 hours/ns, 45.843 timesteps/s, 17.099 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.506      | 7.9645     | 8.3862     |  10.9 | 73.02
Bond    | 0.00081609 | 0.00088451 | 0.00095718 |   0.0 |  0.01
Neigh   | 0.95246    | 0.97434    | 0.99103    |   1.4 |  8.93
Comm    | 0.11148    | 0.53296    | 0.99121    |  42.0 |  4.89
Output  | 0.00078928 | 0.0010852  | 0.0012821  |   0.5 |  0.01
Modify  | 1.4065     | 1.4233     | 1.4445     |   1.1 | 13.05
Other   |            | 0.009821   |            |       |  0.09

Nlocal:         46.625 ave          60 max          38 min
Histogram: 1 1 1 1 2 1 0 0 0 1
Nghost:        3191.75 ave        3260 max        3132 min
Histogram: 2 1 1 0 0 0 1 1 0 2
Neighs:          25935 ave       32856 max       21428 min
Histogram: 1 1 1 1 2 1 0 0 0 1

Total # of neighbors = 207480
Ave neighs/atom = 556.24665
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.6 | 124.9 | 126.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   323.98093     -40423.388      3610.5842      0              4652.6153    
       100   332.02259     -40459.556      1399.9455     -1098.675       4652.6153    
       200   301.28741     -40453.965     -8729.94       -3148.137       4652.6153    
       300   305.70331     -40469.309     -6402.885      -5311.6355      4652.6153    
       400   291.8368      -40467.546     -4819.0709     -6983.3215      4652.6153    
       500   290.01146     -40478.828      5618.6548     -4037.9166      4652.6153    
Loop time of 10.9951 on 8 procs for 500 steps with 373 atoms

Performance: 1.965 ns/day, 12.217 hours/ns, 45.475 timesteps/s, 16.962 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.5399     | 8.08       | 8.4612     |  10.9 | 73.49
Bond    | 0.00085234 | 0.00089866 | 0.00098454 |   0.0 |  0.01
Neigh   | 0.94799    | 0.96539    | 0.98857    |   1.4 |  8.78
Comm    | 0.12377    | 0.50465    | 1.0444     |  43.8 |  4.59
Output  | 0.00013431 | 0.00014673 | 0.00021839 |   0.0 |  0.00
Modify  | 1.4106     | 1.4342     | 1.4521     |   1.2 | 13.04
Other   |            | 0.009794   |            |       |  0.09

Nlocal:         46.625 ave          61 max          40 min
Histogram: 3 0 1 2 1 0 0 0 0 1
Nghost:        3184.62 ave        3237 max        3143 min
Histogram: 2 0 1 2 0 1 0 0 0 2
Neighs:          25931 ave       33242 max       22519 min
Histogram: 2 1 1 2 1 0 0 0 0 1

Total # of neighbors = 207448
Ave neighs/atom = 556.16086
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -4.90140115855373
variable C2neg equal ${d2}
variable C2neg equal 17.4426524622688
variable C3neg equal ${d3}
variable C3neg equal -28.4765468915224
variable C4neg equal ${d4}
variable C4neg equal -9.0010671111022
variable C5neg equal ${d5}
variable C5neg equal -4.85535121332337
variable C6neg equal ${d6}
variable C6neg equal 5.25446907100239

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.55
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.7255) with tilt (-10.7944 1.3894 -3.3406)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.3 | 122.8 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40198.272     -26656.098      0              4746.6076    
       100   301.30016     -40315.051     -7117.1357     -3589.3073      4746.6076    
       200   268.48013     -40349.343     -8324.2209     -3796.0656      4746.6076    
       300   299.20595     -40394.384      881.72668     -695.54459      4746.6076    
       400   323.23476     -40396.09      -7745.0121     -722.04728      4746.6076    
       500   326.43578     -40404.36      -5869.5155     -6093.822       4746.6076    
Loop time of 10.6276 on 8 procs for 500 steps with 373 atoms

Performance: 2.032 ns/day, 11.808 hours/ns, 47.047 timesteps/s, 17.549 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.3088     | 7.6974     | 8.1213     |  10.3 | 72.43
Bond    | 0.00082796 | 0.00087471 | 0.0009129  |   0.0 |  0.01
Neigh   | 0.93851    | 0.95413    | 0.96729    |   1.1 |  8.98
Comm    | 0.10286    | 0.52578    | 0.91508    |  39.3 |  4.95
Output  | 0.00080506 | 0.001092   | 0.0012828  |   0.5 |  0.01
Modify  | 1.4265     | 1.4387     | 1.4535     |   0.9 | 13.54
Other   |            | 0.009613   |            |       |  0.09

Nlocal:         46.625 ave          61 max          39 min
Histogram: 2 0 2 1 2 0 0 0 0 1
Nghost:        3145.38 ave        3206 max        3096 min
Histogram: 2 2 0 0 0 1 0 1 0 2
Neighs:        25380.9 ave       32716 max       21525 min
Histogram: 2 0 2 2 1 0 0 0 0 1

Total # of neighbors = 203047
Ave neighs/atom = 544.36193
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 122.8 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   326.43578     -40404.36      -5869.528       0              4746.6076    
       100   321.86338     -40424.369      473.08286      1045.3381      4746.6076    
       200   314.03263     -40442.269     -270.7124      -1122.2395      4746.6076    
       300   321.25661     -40465.284     -7150.9758     -6492.0154      4746.6076    
       400   307.22968     -40470.283     -3193.6297     -4.0005396      4746.6076    
       500   290.54171     -40475.07       8522.8692     -1250.7054      4746.6076    
Loop time of 10.7182 on 8 procs for 500 steps with 373 atoms

Performance: 2.015 ns/day, 11.909 hours/ns, 46.649 timesteps/s, 17.400 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.3643     | 7.8558     | 8.2464     |  10.4 | 73.29
Bond    | 0.0008395  | 0.00089757 | 0.00094768 |   0.0 |  0.01
Neigh   | 0.93389    | 0.95509    | 0.97955    |   1.5 |  8.91
Comm    | 0.10378    | 0.49502    | 0.98587    |  41.2 |  4.62
Output  | 0.0001438  | 0.0001623  | 0.00021819 |   0.0 |  0.00
Modify  | 1.3769     | 1.4016     | 1.4236     |   1.2 | 13.08
Other   |            | 0.009652   |            |       |  0.09

Nlocal:         46.625 ave          55 max          43 min
Histogram: 4 0 0 0 3 0 0 0 0 1
Nghost:        3207.62 ave        3275 max        3167 min
Histogram: 1 3 0 1 0 1 1 0 0 1
Neighs:        25401.9 ave       29398 max       23435 min
Histogram: 2 2 0 0 3 0 0 0 0 1

Total # of neighbors = 203215
Ave neighs/atom = 544.81233
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -23.3400156396427
variable C2pos equal ${d2}
variable C2pos equal -47.4617551279669
variable C3pos equal ${d3}
variable C3pos equal -8.68673473328699
variable C4pos equal ${d4}
variable C4pos equal 5.13503817057541
variable C5pos equal ${d5}
variable C5pos equal -6.5350205523109
variable C6pos equal ${d6}
variable C6pos equal 0.316114898107446

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-4.90140115855373+${C1pos})
variable C13 equal 0.5*(-4.90140115855373+-23.3400156396427)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(17.4426524622688+${C2pos})
variable C23 equal 0.5*(17.4426524622688+-47.4617551279669)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-28.4765468915224+${C3pos})
variable C33 equal 0.5*(-28.4765468915224+-8.68673473328699)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-9.0010671111022+${C4pos})
variable C43 equal 0.5*(-9.0010671111022+5.13503817057541)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-4.85535121332337+${C5pos})
variable C53 equal 0.5*(-4.85535121332337+-6.5350205523109)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(5.25446907100239+${C6pos})
variable C63 equal 0.5*(5.25446907100239+0.316114898107446)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.55
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.55
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.5161)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.8 | 124.4 | 126 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40212.661      2230.5832      0              4699.6115    
       100   298.14425     -40322.525     -3202.7497     -4641.7662      4699.6115    
       200   268.43598     -40360.962     -8231.8137     -5039.9757      4699.6115    
       300   292.71311     -40411.871     -12885.127      895.04743      4699.6115    
       400   301.08748     -40421.167     -233.48382     -4685.1386      4699.6115    
       500   317.76673     -40432.327     -2632.2906     -5169.8895      4699.6115    
Loop time of 10.8596 on 8 procs for 500 steps with 373 atoms

Performance: 1.989 ns/day, 12.066 hours/ns, 46.042 timesteps/s, 17.174 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.4421     | 7.872      | 8.3706     |  10.7 | 72.49
Bond    | 0.00081944 | 0.00087866 | 0.00091806 |   0.0 |  0.01
Neigh   | 0.95063    | 0.96872    | 0.98567    |   1.3 |  8.92
Comm    | 0.095603   | 0.59355    | 1.0237     |  38.9 |  5.47
Output  | 0.00082525 | 0.001102   | 0.0012874  |   0.5 |  0.01
Modify  | 1.3966     | 1.4135     | 1.4311     |   1.1 | 13.02
Other   |            | 0.009752   |            |       |  0.09

Nlocal:         46.625 ave          59 max          38 min
Histogram: 1 1 0 1 4 0 0 0 0 1
Nghost:        3186.75 ave        3237 max        3150 min
Histogram: 3 0 0 1 1 0 1 0 1 1
Neighs:          25650 ave       32018 max       21310 min
Histogram: 1 1 0 1 4 0 0 0 0 1

Total # of neighbors = 205200
Ave neighs/atom = 550.13405
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.9 | 124.4 | 126 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   317.76673     -40432.327     -2632.2989      0              4699.6115    
       100   317.49515     -40454.967      3752.3739      379.74211      4699.6115    
       200   287.2506      -40449.168      1300.3753      266.55466      4699.6115    
       300   302.06679     -40475.026      5581.6143     -3914.8679      4699.6115    
       400   303.06298     -40495.957      4397.2462     -4078.0506      4699.6115    
       500   280.5576      -40485.418      5160.0005     -994.85558      4699.6115    
Loop time of 10.8345 on 8 procs for 500 steps with 373 atoms

Performance: 1.994 ns/day, 12.038 hours/ns, 46.149 timesteps/s, 17.214 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.3925     | 7.9133     | 8.3525     |  10.7 | 73.04
Bond    | 0.00082684 | 0.00089189 | 0.0009354  |   0.0 |  0.01
Neigh   | 0.9472     | 0.96163    | 0.97546    |   1.1 |  8.88
Comm    | 0.10345    | 0.54215    | 1.0627     |  40.7 |  5.00
Output  | 0.00014813 | 0.00015775 | 0.00020973 |   0.0 |  0.00
Modify  | 1.3928     | 1.4067     | 1.4214     |   0.9 | 12.98
Other   |            | 0.009664   |            |       |  0.09

Nlocal:         46.625 ave          59 max          39 min
Histogram: 2 1 0 1 1 2 0 0 0 1
Nghost:        3168.75 ave        3229 max        3130 min
Histogram: 2 0 1 2 1 0 0 1 0 1
Neighs:        25651.5 ave       31807 max       21763 min
Histogram: 2 1 0 1 1 2 0 0 0 1

Total # of neighbors = 205212
Ave neighs/atom = 550.16622
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 25.9324142641109
variable C2neg equal ${d2}
variable C2neg equal 22.518925877897
variable C3neg equal ${d3}
variable C3neg equal -2.74544618344023
variable C4neg equal ${d4}
variable C4neg equal -4.33152235228296
variable C5neg equal ${d5}
variable C5neg equal 7.60828021642052
variable C6neg equal ${d6}
variable C6neg equal 2.1946821300403

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.55
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.1651)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.2 | 123.9 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40212.103      1301.8483      0              4699.6115    
       100   302.42805     -40326.284     -7524.1319     -4711.7972      4699.6115    
       200   268.95362     -40358.354     -9406.1376     -5130.2726      4699.6115    
       300   300.31274     -40404.252      2411.6026      1052.74        4699.6115    
       400   324.10384     -40416.561     -1389.1995     -1704.8559      4699.6115    
       500   338.87076     -40450.532     -6604.7162     -5934.4212      4699.6115    
Loop time of 10.8309 on 8 procs for 500 steps with 373 atoms

Performance: 1.994 ns/day, 12.034 hours/ns, 46.164 timesteps/s, 17.219 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.427      | 7.8701     | 8.2982     |  11.0 | 72.66
Bond    | 0.000849   | 0.00090116 | 0.00095089 |   0.0 |  0.01
Neigh   | 0.94979    | 0.96551    | 0.97997    |   1.5 |  8.91
Comm    | 0.12807    | 0.55576    | 0.99937    |  41.4 |  5.13
Output  | 0.00081491 | 0.0010913  | 0.0012794  |   0.5 |  0.01
Modify  | 1.4127     | 1.4277     | 1.4432     |   1.2 | 13.18
Other   |            | 0.009788   |            |       |  0.09

Nlocal:         46.625 ave          56 max          41 min
Histogram: 3 0 0 1 1 1 1 0 0 1
Nghost:        3177.62 ave        3257 max        3119 min
Histogram: 2 0 1 1 2 0 0 0 1 1
Neighs:          25676 ave       30467 max       22773 min
Histogram: 3 0 0 1 1 1 1 0 0 1

Total # of neighbors = 205408
Ave neighs/atom = 550.69169
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 123.9 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   338.87076     -40450.532     -6604.7433      0              4699.6115    
       100   299.66589     -40427.852      2524.2068     -2175.2611      4699.6115    
       200   300.76343     -40455.639      1687.1365     -2844.4734      4699.6115    
       300   295.49901     -40452.107     -5233.5202     -2323.2766      4699.6115    
       400   296.02127     -40459.384      11285.166      2064.1241      4699.6115    
       500   288.10674     -40466.658      2713.0078     -746.0987       4699.6115    
Loop time of 10.8192 on 8 procs for 500 steps with 373 atoms

Performance: 1.996 ns/day, 12.021 hours/ns, 46.214 timesteps/s, 17.238 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.347      | 7.878      | 8.2762     |  11.2 | 72.82
Bond    | 0.00084335 | 0.00090224 | 0.00098817 |   0.0 |  0.01
Neigh   | 0.93557    | 0.95352    | 0.96879    |   1.3 |  8.81
Comm    | 0.1415     | 0.53939    | 1.0708     |  42.8 |  4.99
Output  | 0.00013326 | 0.00014331 | 0.00021071 |   0.0 |  0.00
Modify  | 1.4228     | 1.4375     | 1.4554     |   1.0 | 13.29
Other   |            | 0.009717   |            |       |  0.09

Nlocal:         46.625 ave          58 max          41 min
Histogram: 1 2 1 2 1 0 0 0 0 1
Nghost:        3144.25 ave        3191 max        3112 min
Histogram: 3 0 1 0 0 1 1 0 1 1
Neighs:        25687.6 ave       31414 max       22936 min
Histogram: 1 2 1 2 1 0 0 0 0 1

Total # of neighbors = 205501
Ave neighs/atom = 550.94102
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -28.4529434150837
variable C2pos equal ${d2}
variable C2pos equal -36.2980934445976
variable C3pos equal ${d3}
variable C3pos equal -27.6240988366488
variable C4pos equal ${d4}
variable C4pos equal -0.340441644265168
variable C5pos equal ${d5}
variable C5pos equal -11.0398645024362
variable C6pos equal ${d6}
variable C6pos equal 0.931778349740804

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(25.9324142641109+${C1pos})
variable C14 equal 0.5*(25.9324142641109+-28.4529434150837)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(22.518925877897+${C2pos})
variable C24 equal 0.5*(22.518925877897+-36.2980934445976)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-2.74544618344023+${C3pos})
variable C34 equal 0.5*(-2.74544618344023+-27.6240988366488)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-4.33152235228296+${C4pos})
variable C44 equal 0.5*(-4.33152235228296+-0.340441644265168)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(7.60828021642052+${C5pos})
variable C54 equal 0.5*(7.60828021642052+-11.0398645024362)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(2.1946821300403+${C6pos})
variable C64 equal 0.5*(2.1946821300403+0.931778349740804)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.55
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.55
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.2139 -3.3406)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40211.985      747.31901      0              4699.6115    
       100   307.58337     -40331.482     -3614.7503     -3605.1456      4699.6115    
       200   263.36878     -40353.625     -5746.5607     -5972.7132      4699.6115    
       300   285.84064     -40398.694      4761.0499      912.50729      4699.6115    
       400   318.8597      -40425.71       451.69844     -2042.3874      4699.6115    
       500   329.57428     -40440.527     -4659.8228     -3822.3438      4699.6115    
Loop time of 10.78 on 8 procs for 500 steps with 373 atoms

Performance: 2.004 ns/day, 11.978 hours/ns, 46.382 timesteps/s, 17.301 katom-step/s
98.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.4196     | 7.8513     | 8.2631     |  10.6 | 72.83
Bond    | 0.00084396 | 0.00089493 | 0.00095891 |   0.0 |  0.01
Neigh   | 0.94771    | 0.96331    | 0.98236    |   1.3 |  8.94
Comm    | 0.11307    | 0.52397    | 0.956      |  41.1 |  4.86
Output  | 0.00078083 | 0.0010799  | 0.0012902  |   0.6 |  0.01
Modify  | 1.4113     | 1.4297     | 1.4449     |   1.1 | 13.26
Other   |            | 0.00975    |            |       |  0.09

Nlocal:         46.625 ave          55 max          41 min
Histogram: 1 1 1 1 2 1 0 0 0 1
Nghost:        3174.88 ave        3225 max        3137 min
Histogram: 2 0 1 1 1 1 0 0 0 2
Neighs:        25690.5 ave       29943 max       22855 min
Histogram: 1 1 1 1 2 1 0 0 0 1

Total # of neighbors = 205524
Ave neighs/atom = 551.00268
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   329.57428     -40440.527     -4659.7982      0              4699.6115    
       100   320.04215     -40455.123     -8028.4322     -5925.0952      4699.6115    
       200   300.67897     -40459.932     -9948.622       1673.818       4699.6115    
       300   314.19826     -40484.169     -12479.203     -2378.2596      4699.6115    
       400   302.39993     -40491.536      1985.115      -3637.7085      4699.6115    
       500   296.10649     -40511.758      1150.7108     -1057.621       4699.6115    
Loop time of 10.6781 on 8 procs for 500 steps with 373 atoms

Performance: 2.023 ns/day, 11.865 hours/ns, 46.825 timesteps/s, 17.466 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.4715     | 7.8813     | 8.2141     |   9.2 | 73.81
Bond    | 0.00085395 | 0.00090614 | 0.00095753 |   0.0 |  0.01
Neigh   | 0.94369    | 0.95637    | 0.97512    |   1.2 |  8.96
Comm    | 0.11483    | 0.44753    | 0.85721    |  38.5 |  4.19
Output  | 0.00014464 | 0.00015838 | 0.00024745 |   0.0 |  0.00
Modify  | 1.3634     | 1.3821     | 1.395      |   1.0 | 12.94
Other   |            | 0.009684   |            |       |  0.09

Nlocal:         46.625 ave          56 max          34 min
Histogram: 1 0 0 1 0 1 3 0 1 1
Nghost:        3201.12 ave        3256 max        3165 min
Histogram: 2 0 1 1 1 1 1 0 0 1
Neighs:        25639.5 ave       30197 max       19022 min
Histogram: 1 0 0 1 0 1 2 1 1 1

Total # of neighbors = 205116
Ave neighs/atom = 549.90885
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 25.2964432292289
variable C2neg equal ${d2}
variable C2neg equal 68.3266197138252
variable C3neg equal ${d3}
variable C3neg equal -31.269749908304
variable C4neg equal ${d4}
variable C4neg equal -2.04724227700713
variable C5neg equal ${d5}
variable C5neg equal 14.4276595167641
variable C6neg equal ${d6}
variable C6neg equal 9.55384621571613

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.55
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.5649 -3.3406)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124.1 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40212.861      3336.1598      0              4699.6115    
       100   297.82764     -40321.348     -3624.3647     -3877.1024      4699.6115    
       200   266.15568     -40352.542     -1913.553      -3501.8169      4699.6115    
       300   285.31529     -40389.755     -6596.4626     -2306.2874      4699.6115    
       400   302.52229     -40399.455     -3791.5645     -1066.0801      4699.6115    
       500   328.2599      -40418.255     -4153.62       -4264.9497      4699.6115    
Loop time of 10.7847 on 8 procs for 500 steps with 373 atoms

Performance: 2.003 ns/day, 11.983 hours/ns, 46.362 timesteps/s, 17.293 katom-step/s
98.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.4004     | 7.811      | 8.2551     |  10.3 | 72.43
Bond    | 0.00083077 | 0.00087802 | 0.00092206 |   0.0 |  0.01
Neigh   | 0.95065    | 0.97074    | 1.0033     |   1.8 |  9.00
Comm    | 0.097062   | 0.54055    | 0.95192    |  39.1 |  5.01
Output  | 0.00078208 | 0.001067   | 0.0012689  |   0.5 |  0.01
Modify  | 1.4175     | 1.4508     | 1.4702     |   1.5 | 13.45
Other   |            | 0.00965    |            |       |  0.09

Nlocal:         46.625 ave          57 max          41 min
Histogram: 2 1 1 1 0 2 0 0 0 1
Nghost:           3176 ave        3243 max        3119 min
Histogram: 2 0 1 0 2 1 0 0 1 1
Neighs:        25644.4 ave       30997 max       22758 min
Histogram: 2 1 1 1 0 2 0 0 0 1

Total # of neighbors = 205155
Ave neighs/atom = 550.0134
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.1 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   328.2599      -40418.255     -4153.6276      0              4699.6115    
       100   301.10261     -40416.011      12372.183      582.81757      4699.6115    
       200   293.04149     -40429.458     -6357.5568     -452.38321      4699.6115    
       300   307.57855     -40453.573     -8951.4901     -5262.1185      4699.6115    
       400   306.46831     -40474.388     -8372.2697     -1049.3014      4699.6115    
       500   290.34537     -40480.357      1696.7442     -305.65669      4699.6115    
Loop time of 10.8049 on 8 procs for 500 steps with 373 atoms

Performance: 1.999 ns/day, 12.005 hours/ns, 46.275 timesteps/s, 17.261 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.3194     | 7.871      | 8.2588     |  10.8 | 72.85
Bond    | 0.00084996 | 0.00088722 | 0.00092421 |   0.0 |  0.01
Neigh   | 0.94311    | 0.96265    | 0.98918    |   1.7 |  8.91
Comm    | 0.11321    | 0.50052    | 1.053      |  42.8 |  4.63
Output  | 0.00013444 | 0.00014664 | 0.00020868 |   0.0 |  0.00
Modify  | 1.433      | 1.46       | 1.4787     |   1.4 | 13.51
Other   |            | 0.00967    |            |       |  0.09

Nlocal:         46.625 ave          58 max          39 min
Histogram: 2 0 2 0 1 1 1 0 0 1
Nghost:        3164.38 ave        3217 max        3133 min
Histogram: 1 2 1 2 0 0 0 0 1 1
Neighs:        25652.9 ave       31363 max       21874 min
Histogram: 2 1 1 0 1 1 1 0 0 1

Total # of neighbors = 205223
Ave neighs/atom = 550.19571
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -32.9157220413967
variable C2pos equal ${d2}
variable C2pos equal -28.4151983537979
variable C3pos equal ${d3}
variable C3pos equal 28.3131504948854
variable C4pos equal ${d4}
variable C4pos equal 13.9419229946559
variable C5pos equal ${d5}
variable C5pos equal -7.36154596667092
variable C6pos equal ${d6}
variable C6pos equal -7.19095789804572

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(25.2964432292289+${C1pos})
variable C15 equal 0.5*(25.2964432292289+-32.9157220413967)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(68.3266197138252+${C2pos})
variable C25 equal 0.5*(68.3266197138252+-28.4151983537979)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-31.269749908304+${C3pos})
variable C35 equal 0.5*(-31.269749908304+28.3131504948854)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-2.04724227700713+${C4pos})
variable C45 equal 0.5*(-2.04724227700713+13.9419229946559)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(14.4276595167641+${C5pos})
variable C55 equal 0.5*(14.4276595167641+-7.36154596667092)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(9.55384621571613+${C6pos})
variable C65 equal 0.5*(9.55384621571613+-7.19095789804572)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.0575

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.0575
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.140575 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.934975 1.3894 -3.3406)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.2 | 124.7 | 126.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40214.139      2661.6266      0              4699.6115    
       100   299.46742     -40325.167     -5846.5317     -4991.7964      4699.6115    
       200   264.24768     -40355.067     -16148.428     -3514.2367      4699.6115    
       300   301.68814     -40415.507      4840.3472      387.13366      4699.6115    
       400   314.52893     -40426.895     -2771.6288     -2475.3851      4699.6115    
       500   307.1171      -40410.829     -8685.9938     -6782.4217      4699.6115    
Loop time of 10.8083 on 8 procs for 500 steps with 373 atoms

Performance: 1.998 ns/day, 12.009 hours/ns, 46.261 timesteps/s, 17.255 katom-step/s
98.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.4464     | 7.8372     | 8.2986     |  10.1 | 72.51
Bond    | 0.00086408 | 0.0008923  | 0.00092344 |   0.0 |  0.01
Neigh   | 0.94897    | 0.97167    | 0.99148    |   1.6 |  8.99
Comm    | 0.096895   | 0.55817    | 0.94928    |  38.1 |  5.16
Output  | 0.00080478 | 0.0010737  | 0.0012489  |   0.5 |  0.01
Modify  | 1.4094     | 1.4296     | 1.4513     |   1.3 | 13.23
Other   |            | 0.00978    |            |       |  0.09

Nlocal:         46.625 ave          58 max          38 min
Histogram: 1 0 1 2 1 1 1 0 0 1
Nghost:        3173.75 ave        3238 max        3113 min
Histogram: 1 1 0 0 4 0 0 0 0 2
Neighs:        25683.9 ave       31526 max       21343 min
Histogram: 1 1 0 2 1 1 1 0 0 1

Total # of neighbors = 205471
Ave neighs/atom = 550.86059
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.3 | 124.5 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.1171      -40410.829     -8686.0086      0              4699.6115    
       100   307.42719     -40432.663      1160.008      -3639.3185      4699.6115    
       200   307.67678     -40458.974      2433.5019     -3715.39        4699.6115    
       300   316.27985     -40474.312      5120.3226     -2054.7645      4699.6115    
       400   299.58229     -40472.821      5253.113      -4038.6751      4699.6115    
       500   283.72789     -40478.679      3894.0781     -4223.566       4699.6115    
Loop time of 10.7339 on 8 procs for 500 steps with 373 atoms

Performance: 2.012 ns/day, 11.927 hours/ns, 46.582 timesteps/s, 17.375 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.3493     | 7.879      | 8.2454     |  10.1 | 73.40
Bond    | 0.00084276 | 0.00089107 | 0.00092917 |   0.0 |  0.01
Neigh   | 0.94098    | 0.96428    | 0.98711    |   1.8 |  8.98
Comm    | 0.099568   | 0.46608    | 0.99572    |  41.4 |  4.34
Output  | 0.00012536 | 0.00013814 | 0.00020456 |   0.0 |  0.00
Modify  | 1.3911     | 1.4138     | 1.4361     |   1.4 | 13.17
Other   |            | 0.009654   |            |       |  0.09

Nlocal:         46.625 ave          60 max          39 min
Histogram: 1 2 1 2 0 1 0 0 0 1
Nghost:        3161.38 ave        3240 max        3100 min
Histogram: 1 0 2 2 0 1 0 1 0 1
Neighs:        25681.4 ave       32393 max       21852 min
Histogram: 1 2 1 2 0 1 0 0 0 1

Total # of neighbors = 205451
Ave neighs/atom = 550.80697
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -6.78249418511109
variable C2neg equal ${d2}
variable C2neg equal 38.0223360823417
variable C3neg equal ${d3}
variable C3neg equal -9.82127610615014
variable C4neg equal ${d4}
variable C4neg equal -13.8084389918214
variable C5neg equal ${d5}
variable C5neg equal 2.48530200815576
variable C6neg equal ${d6}
variable C6neg equal 0.63547159869813

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.0575
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.140575 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.653825 1.3894 -3.3406)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 500
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.1 | 123.4 | 125.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.1342      -40209.947      898.08485      0              4699.6115    
       100   297.75832     -40319.559     -3739.7371     -4087.995       4699.6115    
       200   271.61945     -40363.514     -5756.631      -5715.6142      4699.6115    
       300   295.8263      -40414.98      -3573.0672      633.6661       4699.6115    
       400   291.51291     -40403.508     -954.3171      -3967.8958      4699.6115    
       500   312.42271     -40416.543      16113.047     -3906.9483      4699.6115    
Loop time of 10.6892 on 8 procs for 500 steps with 373 atoms

Performance: 2.021 ns/day, 11.877 hours/ns, 46.776 timesteps/s, 17.447 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.3816     | 7.7633     | 8.1948     |   9.8 | 72.63
Bond    | 0.00084689 | 0.00088167 | 0.0009203  |   0.0 |  0.01
Neigh   | 0.94572    | 0.96253    | 0.98001    |   1.4 |  9.00
Comm    | 0.099428   | 0.53062    | 0.91276    |  37.5 |  4.96
Output  | 0.00085318 | 0.0011325  | 0.0013174  |   0.5 |  0.01
Modify  | 1.4042     | 1.421      | 1.438      |   1.2 | 13.29
Other   |            | 0.009739   |            |       |  0.09

Nlocal:         46.625 ave          58 max          39 min
Histogram: 1 1 0 2 3 0 0 0 0 1
Nghost:        3171.12 ave        3233 max        3121 min
Histogram: 3 0 1 0 0 1 1 0 0 2
Neighs:        25653.5 ave       31459 max       21763 min
Histogram: 1 1 0 3 2 0 0 0 0 1

Total # of neighbors = 205228
Ave neighs/atom = 550.20912
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 500
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 123.6 | 125.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.42271     -40416.543      16113.028      0              4699.6115    
       100   306.09888     -40432.306     -5139.8577     -5564.6209      4699.6115    
       200   298.92058     -40451.467     -16251.843     -1878.8401      4699.6115    
       300   299.78131     -40460.783     -8394.2852     -5432.1637      4699.6115    
       400   299.03564     -40479.437      1205.4147     -1933.4755      4699.6115    
       500   296.29733     -40495.723     -3460.6577      671.26541      4699.6115    
Loop time of 10.7856 on 8 procs for 500 steps with 373 atoms

Performance: 2.003 ns/day, 11.984 hours/ns, 46.358 timesteps/s, 17.292 katom-step/s
98.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.3428     | 7.8986     | 8.2762     |  10.7 | 73.23
Bond    | 0.000845   | 0.00088463 | 0.00093853 |   0.0 |  0.01
Neigh   | 0.94045    | 0.9538     | 0.97173    |   1.2 |  8.84
Comm    | 0.11819    | 0.49544    | 1.0515     |  42.7 |  4.59
Output  | 0.00014855 | 0.00016114 | 0.00022552 |   0.0 |  0.00
Modify  | 1.4087     | 1.4269     | 1.44       |   1.0 | 13.23
Other   |            | 0.009764   |            |       |  0.09

Nlocal:         46.625 ave          63 max          39 min
Histogram: 1 2 3 0 1 0 0 0 0 1
Nghost:           3153 ave        3188 max        3126 min
Histogram: 1 1 0 2 2 0 0 1 0 1
Neighs:        25682.5 ave       33879 max       21754 min
Histogram: 1 2 3 0 1 0 0 0 0 1

Total # of neighbors = 205460
Ave neighs/atom = 550.8311
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -42.8143852621506
variable C2pos equal ${d2}
variable C2pos equal -27.0809193686009
variable C3pos equal ${d3}
variable C3pos equal 13.1724127404237
variable C4pos equal ${d4}
variable C4pos equal 6.87279872047162
variable C5pos equal ${d5}
variable C5pos equal 2.66594072947655
variable C6pos equal ${d6}
variable C6pos equal -11.7827157994661

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-6.78249418511109+${C1pos})
variable C16 equal 0.5*(-6.78249418511109+-42.8143852621506)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(38.0223360823417+${C2pos})
variable C26 equal 0.5*(38.0223360823417+-27.0809193686009)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-9.82127610615014+${C3pos})
variable C36 equal 0.5*(-9.82127610615014+13.1724127404237)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-13.8084389918214+${C4pos})
variable C46 equal 0.5*(-13.8084389918214+6.87279872047162)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(2.48530200815576+${C5pos})
variable C56 equal 0.5*(2.48530200815576+2.66594072947655)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(0.63547159869813+${C6pos})
variable C66 equal 0.5*(0.63547159869813+-11.7827157994661)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 29.0290369833271
variable C22all equal ${C22}
variable C22all equal -15.2033624842989
variable C33all equal ${C33}
variable C33all equal -18.5816408124047

variable C44all equal ${C44}
variable C44all equal -2.33598199827406
variable C55all equal ${C55}
variable C55all equal 3.53305677504659
variable C66all equal ${C66}
variable C66all equal -5.57362210038398

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(0.561050505246855+${C21})
variable C12all equal 0.5*(0.561050505246855+-1.53949125423675)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(-14.1207083990982+${C31})
variable C13all equal 0.5*(-14.1207083990982+11.4290568594163)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(-15.0095513328491+${C32})
variable C23all equal 0.5*(-15.0095513328491+5.79076099504525)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-1.2602645754864+${C41})
variable C14all equal 0.5*(-1.2602645754864+-1.912044626847)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-3.8096394060839+${C51})
variable C15all equal 0.5*(-3.8096394060839+-3.66182428243792)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-24.7984397236308+${C61})
variable C16all equal 0.5*(-24.7984397236308+11.089505914182)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-6.8895837833503+${C42})
variable C24all equal 0.5*(-6.8895837833503+4.1016865901523)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(19.9557106800136+${C52})
variable C25all equal 0.5*(19.9557106800136+1.24312188367719)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(5.4707083568704+${C62})
variable C26all equal 0.5*(5.4707083568704+10.8979486421943)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-15.1847725100445+${C43})
variable C34all equal 0.5*(-15.1847725100445+-1.9330144702634)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-1.4782997067093+${C53})
variable C35all equal 0.5*(-1.4782997067093+-5.69518588281714)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(1.67556831713678+${C63})
variable C36all equal 0.5*(1.67556831713678+2.78529198455492)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(5.94734035882439+${C54})
variable C45all equal 0.5*(5.94734035882439+-1.71579214300784)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-3.46782013567489+${C64})
variable C46all equal 0.5*(-3.46782013567489+1.56323023989055)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(2.57562136881615+${C65})
variable C56all equal 0.5*(2.57562136881615+1.1814441588352)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:04:31
