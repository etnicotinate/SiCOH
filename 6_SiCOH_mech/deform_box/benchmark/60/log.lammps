LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 60*${nthermo}       # steps of equilibration run 10
variable nequil equal 60*100       
variable nrun equal 60*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 60*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-11-vasp
read_data       ${structure}.data
read_data       333-EXP-11-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.005 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.63788e-05 on 8 procs for 1 steps with 274 atoms

51.9% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.676e-06  | 1.676e-06  | 1.676e-06  |   0.0 |  2.97
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.191e-06  | 4.191e-06  | 4.191e-06  |   0.0 |  7.43
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.051e-05  |            |       | 89.59

Nlocal:          34.25 ave          40 max          23 min
Histogram: 1 0 0 0 0 0 2 3 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-11-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 6000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -8.2 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.8 | 110.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -29524.072      53373.102      1.4594291      3472.1201    
       100   940.83325     -30895.433     -22221.566      1.4594291      3472.1201    
       200   655.32859     -31410.555     -8415.0945      1.4594291      3472.1201    
       300   492.44705     -31703.584     -1794.1004      1.4594291      3472.1201    
       400   382.80684     -31863.571     -399.08344      1.4594291      3472.1201    
       500   340.51122     -31988.881     -4396.9622      1.4594291      3472.1201    
       600   278.76054     -32030.093     -12030.124      1.4594291      3472.1201    
       700   252.54387     -32039.073     -16008.085      1.4594291      3472.1201    
       800   303.17696     -32059.227     -7196.0812      1.4594291      3472.1201    
       900   316.31868     -32035.623      1880.9547      1.4594291      3472.1201    
      1000   302.25251     -32011.681      399.58501      1.4594291      3472.1201    
      1100   315.72134     -32030.621     -1937.705       1.4594291      3472.1201    
      1200   304.92451     -32062.996     -4858.2292      1.4594291      3472.1201    
      1300   271.27974     -32068.968     -12188.651      1.4594291      3472.1201    
      1400   282.30555     -32083.975     -5263.1535      1.4594291      3472.1201    
      1500   284.15138     -32063.957     -2027.0405      1.4594291      3472.1201    
      1600   304.84901     -32054.903     -8468.5027      1.4594291      3472.1201    
      1700   320.05144     -32056.724     -12833.076      1.4594291      3472.1201    
      1800   304.8515      -32060.022     -6647.9777      1.4594291      3472.1201    
      1900   292.71773     -32083.757     -1193.4113      1.4594291      3472.1201    
      2000   272.13786     -32083.142      6047.8677      1.4594291      3472.1201    
      2100   289.96718     -32084.631      9390.5456      1.4594291      3472.1201    
      2200   287.75492     -32058.426     -9151.3398      1.4594291      3472.1201    
      2300   335.25197     -32079.165     -16200.698      1.4594291      3472.1201    
      2400   310.32653     -32067.983      2160.6232      1.4594291      3472.1201    
      2500   290.62987     -32076.478     -2874.5909      1.4594291      3472.1201    
      2600   291.63604     -32096.204      1291.0485      1.4594291      3472.1201    
      2700   278.45821     -32085.212      2152.4342      1.4594291      3472.1201    
      2800   295.16014     -32075.293      11384.18       1.4594291      3472.1201    
      2900   321.3704      -32074.659      4968.7777      1.4594291      3472.1201    
      3000   317.98161     -32069.827      4987.1493      1.4594291      3472.1201    
      3100   315.69129     -32093.196     -2919.9481      1.4594291      3472.1201    
      3200   272.69984     -32080.299     -10479.085      1.4594291      3472.1201    
      3300   295.4357      -32094.378     -2307.7923      1.4594291      3472.1201    
      3400   306.68136     -32082.661      166.83382      1.4594291      3472.1201    
      3500   303.62197     -32071.67      -7119.6858      1.4594291      3472.1201    
      3600   295.73041     -32073.133     -3795.8248      1.4594291      3472.1201    
      3700   277.22679     -32074.502     -11588.427      1.4594291      3472.1201    
      3800   297.79238     -32096.778     -7570.1459      1.4594291      3472.1201    
      3900   281.6086      -32077.626     -6662.3657      1.4594291      3472.1201    
      4000   300.60001     -32070.467      2359.5495      1.4594291      3472.1201    
      4100   294.06074     -32057.62       5645.1046      1.4594291      3472.1201    
      4200   301.27329     -32073.305     -18150.364      1.4594291      3472.1201    
      4300   303.9283      -32079.447      7855.4458      1.4594291      3472.1201    
      4400   305.65864     -32079.704      2286.7804      1.4594291      3472.1201    
      4500   322.922       -32092.465     -3549.397       1.4594291      3472.1201    
      4600   285.80906     -32064.212     -12844.728      1.4594291      3472.1201    
      4700   314.3524      -32094.977     -4345.0284      1.4594291      3472.1201    
      4800   296.7886      -32095.23      -3105.819       1.4594291      3472.1201    
      4900   274.49523     -32085.05       4288.4756      1.4594291      3472.1201    
      5000   303.35124     -32096.072      7339.555       1.4594291      3472.1201    
      5100   312.81138     -32085.288     -9208.7156      1.4594291      3472.1201    
      5200   315.87031     -32080.161      1911.4367      1.4594291      3472.1201    
      5300   294.51043     -32063.337     -7181.957       1.4594291      3472.1201    
      5400   302.37637     -32077.028     -5387.4033      1.4594291      3472.1201    
      5500   300.55289     -32083.698     -11712.412      1.4594291      3472.1201    
      5600   286.81598     -32082.197     -4124.5423      1.4594291      3472.1201    
      5700   287.94838     -32087.873     -17730.521      1.4594291      3472.1201    
      5800   288.56291     -32084.062     -6294.3873      1.4594291      3472.1201    
      5900   309.02052     -32089.82       5873.2398      1.4594291      3472.1201    
      6000   332.32223     -32090.501     -1939.7511      1.4594291      3472.1201    
Loop time of 230.853 on 8 procs for 6000 steps with 274 atoms

Performance: 1.123 ns/day, 21.375 hours/ns, 25.991 timesteps/s, 7.121 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 137.25     | 169.03     | 194.1      | 174.8 | 73.22
Bond    | 0.016346   | 0.0179     | 0.020175   |   1.0 |  0.01
Neigh   | 9.4965     | 11.951     | 13.367     |  41.0 |  5.18
Comm    | 3.5061     | 28.611     | 60.405     | 424.9 | 12.39
Output  | 0.0027161  | 0.0029616  | 0.004423   |   1.0 |  0.00
Modify  | 19.73      | 21.117     | 23.612     |  31.0 |  9.15
Other   |            | 0.1216     |            |       |  0.05

Nlocal:          34.25 ave          42 max          23 min
Histogram: 1 1 0 1 0 0 0 2 2 1
Nghost:        2811.12 ave        2830 max        2782 min
Histogram: 1 0 0 1 1 1 1 0 1 2
Neighs:          18916 ave       22943 max       12866 min
Histogram: 1 1 0 1 0 0 0 1 2 2

Total # of neighbors = 151328
Ave neighs/atom = 552.29197
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-11-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.8189
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.842
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.0755

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4312
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 1.195
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.3798

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal lx-${len0}
variable dlen equal lx-16.8189
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta -0.01195 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.02301     -32054.411     -17099.973      1.4596724      3471.5415    
       200   302.72939     -32087.307     -11053.927      1.4599157      3470.9628    
       300   288.63608     -32091.653     -3527.6828      1.4601592      3470.3841    
       400   290.13738     -32093.085     -4699.314       1.4604027      3469.8054    
       500   307.21612     -32101.159     -22467.704      1.4606463      3469.2267    
       600   294.01891     -32085.686     -7927.7478      1.46089        3468.648     
       700   287.49465     -32063.772     -2963.2574      1.4611338      3468.0693    
       800   316.47979     -32083.82      -6262.2041      1.4613776      3467.4906    
       900   304.40462     -32094.865     -10068.761      1.4616215      3466.912     
      1000   293.54452     -32102.135     -4880.4653      1.4618655      3466.3333    
      1100   275.26917     -32087.553     -10060.149      1.4621096      3465.7546    
      1200   301.66101     -32087.099     -5928.1839      1.4623538      3465.1759    
      1300   300.65401     -32068.546     -7518.0104      1.4625981      3464.5972    
      1400   295.88698     -32063.049     -193.04664      1.4628424      3464.0185    
      1500   292.43634     -32069.621     -8403.9202      1.4630868      3463.4398    
      1600   299.04493     -32079.419     -11095.992      1.4633313      3462.8612    
      1700   305.6095      -32091.31      -16728.985      1.4635759      3462.2825    
      1800   322.03292     -32119.395     -1513.2891      1.4638206      3461.7038    
      1900   289.88879     -32108.254     -3937.5898      1.4640653      3461.1251    
      2000   290.27871     -32118.359     -6241.7517      1.4643101      3460.5464    
      2100   298.08021     -32141.703      6293.0265      1.464555       3459.9677    
      2200   288.12016     -32129.347     -4602.3184      1.4648         3459.389     
      2300   297.6533      -32109.242     -5307.6956      1.4650451      3458.8103    
      2400   294.81733     -32094.27      -8016.2485      1.4652903      3458.2317    
      2500   323.29643     -32106.113     -7951.1701      1.4655355      3457.653     
      2600   297.93415     -32099.209     -4931.9074      1.4657808      3457.0743    
      2700   315.58507     -32136.216     -14046.135      1.4660262      3456.4956    
      2800   288.75344     -32112.32      -12801.978      1.4662717      3455.9169    
      2900   300.39123     -32113.682     -1124.7915      1.4665173      3455.3382    
      3000   303.56427     -32107.68      -5130.305       1.4667629      3454.7595    
      3100   316.99066     -32099.543     -17241.513      1.4670086      3454.1809    
      3200   313.4546      -32093.366     -5876.7328      1.4672545      3453.6022    
      3300   299.72669     -32117.095      3695.2289      1.4675003      3453.0235    
      3400   308.74884     -32135.77      -11033.866      1.4677463      3452.4448    
      3500   305.91605     -32144.843     -10940.158      1.4679924      3451.8661    
      3600   293.57913     -32138.425     -6066.4115      1.4682385      3451.2874    
      3700   299.57017     -32128.875     -2864.9         1.4684848      3450.7087    
      3800   291.803       -32098.525     -4396.1954      1.4687311      3450.13      
      3900   325.55664     -32116.303     -7247.5783      1.4689775      3449.5514    
      4000   289.53381     -32115.981      7024.5544      1.4692239      3448.9727    
      4100   280.04137     -32119.537      4872.3867      1.4694705      3448.394     
      4200   309.41947     -32138.61      -6899.9463      1.4697171      3447.8153    
      4300   297.67218     -32119.212      7334.3563      1.4699638      3447.2366    
      4400   321.04056     -32119.16      -6351.7966      1.4702106      3446.6579    
      4500   315.85527     -32093.304     -3142.6604      1.4704575      3446.0792    
      4600   303.81032     -32106.31       13283.516      1.4707045      3445.5006    
      4700   297.36612     -32124.37      -1918.4157      1.4709516      3444.9219    
      4800   295.11804     -32121.162     -3761.5565      1.4711987      3444.3432    
      4900   306.38091     -32134.434     -6305.5719      1.4714459      3443.7645    
      5000   300.29707     -32142.112     -5608.4432      1.4716932      3443.1858    
      5100   296.9855      -32156.148     -11983.699      1.4719406      3442.6071    
      5200   290.27762     -32154.455     -11495.155      1.4721881      3442.0284    
      5300   291.76232     -32128         -15035.768      1.4724356      3441.4497    
      5400   310.61006     -32125.86       4815.4018      1.4726832      3440.8711    
      5500   320.1559      -32136.001     -14684.845      1.472931       3440.2924    
      5600   293.57042     -32132.062     -15397.65       1.4731788      3439.7137    
      5700   297.43596     -32159.066     -12547.248      1.4734267      3439.135     
      5800   263.90962     -32133.926     -10030.38       1.4736746      3438.5563    
      5900   309.93754     -32141.007     -6157.4679      1.4739227      3437.9776    
      6000   311.45655     -32133.162     -10010.603      1.4741708      3437.3989    
Loop time of 235.378 on 8 procs for 6000 steps with 274 atoms

Performance: 1.101 ns/day, 21.794 hours/ns, 25.491 timesteps/s, 6.985 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 151.32     | 186.57     | 197.79     | 103.8 | 79.26
Bond    | 0.016361   | 0.018518   | 0.021317   |   1.1 |  0.01
Neigh   | 10.938     | 13.148     | 13.744     |  23.5 |  5.59
Comm    | 3.1045     | 14.324     | 49.576     | 374.7 |  6.09
Output  | 0.017217   | 0.019652   | 0.021649   |   1.1 |  0.01
Modify  | 20.527     | 21.147     | 23.377     |  18.7 |  8.98
Other   |            | 0.1492     |            |       |  0.06

Nlocal:          34.25 ave          42 max          24 min
Histogram: 1 1 0 1 0 0 1 2 1 1
Nghost:         2851.5 ave        2869 max        2829 min
Histogram: 1 1 0 1 1 0 0 1 0 3
Neighs:        19112.8 ave       23141 max       13640 min
Histogram: 1 1 0 1 0 0 1 2 1 1

Total # of neighbors = 152902
Ave neighs/atom = 558.0365
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta 0.01195 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.03266     -32054.449     -17119.697      1.4591859      3472.6988    
       200   301.31449     -32085.601     -9690.6729      1.4589428      3473.2775    
       300   287.77379     -32090.534     -8862.7216      1.4586997      3473.8562    
       400   288.82563     -32092.334     -5081.0285      1.4584568      3474.4349    
       500   299.50953     -32092.746     -20858.693      1.4582139      3475.0136    
       600   295.51452     -32079.287     -9556.755       1.4579711      3475.5923    
       700   328.48163     -32090.208     -3063.8856      1.4577284      3476.1709    
       800   326.74948     -32094.243     -1600.4563      1.4574858      3476.7496    
       900   290.72397     -32091.159     -737.24087      1.4572432      3477.3283    
      1000   305.92449     -32112.465     -4852.7758      1.4570008      3477.907     
      1100   314.22929     -32113.893     -13630.383      1.4567584      3478.4857    
      1200   307.11973     -32086.083     -2768.6992      1.4565161      3479.0644    
      1300   328.47233     -32084.56      -3396.2321      1.4562738      3479.6431    
      1400   307.74069     -32074.339     -7910.1049      1.4560317      3480.2218    
      1500   304.74989     -32084.929     -4698.2893      1.4557896      3480.8004    
      1600   281.26158     -32070.933      1846.9192      1.4555476      3481.3791    
      1700   300.07175     -32090.314     -6853.9141      1.4553057      3481.9578    
      1800   317.66262     -32107.049     -8001.0622      1.4550639      3482.5365    
      1900   282.60823     -32081.318      4287.311       1.4548222      3483.1152    
      2000   298.85771     -32103.023     -8845.8412      1.4545805      3483.6939    
      2100   302.17096     -32099.859     -1684.5213      1.4543389      3484.2726    
      2200   300.70892     -32073.097     -392.34072      1.4540974      3484.8512    
      2300   299.61211     -32066.786      4284.076       1.453856       3485.4299    
      2400   314.12318     -32092.841      10338.377      1.4536146      3486.0086    
      2500   289.04017     -32093.816     -9887.8955      1.4533734      3486.5873    
      2600   292.22797     -32098.011     -5881.7737      1.4531322      3487.166     
      2700   305.85886     -32105.024     -28.284367      1.4528911      3487.7447    
      2800   307.94789     -32091.439     -5059.4062      1.4526501      3488.3234    
      2900   330.16369     -32089.364     -2431.3946      1.4524091      3488.9021    
      3000   292.03445     -32068.352     -4327.4017      1.4521683      3489.4807    
      3100   299.9541      -32088.1       -14398.139      1.4519275      3490.0594    
      3200   310.16935     -32099.646     -6573.4596      1.4516868      3490.6381    
      3300   320.24915     -32105.744     -4762.0309      1.4514461      3491.2168    
      3400   294.63916     -32086.492      4837.471       1.4512056      3491.7955    
      3500   294.77086     -32098.685     -14244.03       1.4509651      3492.3742    
      3600   293.86161     -32092.298      3961.4441      1.4507247      3492.9529    
      3700   293.46265     -32066.726     -6446.0441      1.4504844      3493.5315    
      3800   320.36381     -32085.862     -2559.2671      1.4502442      3494.1102    
      3900   275.35215     -32065.261     -10254.848      1.4500041      3494.6889    
      4000   283.59064     -32096.766     -5387.5933      1.449764       3495.2676    
      4100   279.32239     -32113.121     -8752.4435      1.449524       3495.8463    
      4200   273.48846     -32088.025     -8534.541       1.4492841      3496.425     
      4300   319.59566     -32095.121     -4963.6046      1.4490443      3497.0037    
      4400   317.49471     -32086.029     -352.00342      1.4488045      3497.5824    
      4500   305.3521      -32077.592     -7456.4159      1.4485649      3498.161     
      4600   294.24614     -32073.577     -2377.1619      1.4483253      3498.7397    
      4700   313.28488     -32091.685      10346.665      1.4480858      3499.3184    
      4800   284.04378     -32079.381     -12681.82       1.4478463      3499.8971    
      4900   290.49863     -32107.584     -4122.9422      1.447607       3500.4758    
      5000   281.85425     -32103.406     -6028.371       1.4473677      3501.0545    
      5100   296.6042      -32100.472      1747.6454      1.4471285      3501.6332    
      5200   310.50904     -32080.986     -6778.9246      1.4468894      3502.2118    
      5300   305.33985     -32069.944     -1128.1489      1.4466504      3502.7905    
      5400   294.95072     -32070.432     -266.15454      1.4464114      3503.3692    
      5500   299.0431      -32097.579     -2287.2051      1.4461725      3503.9479    
      5600   294.90347     -32105.002     -2128.1149      1.4459337      3504.5266    
      5700   293.77944     -32098.571      305.12183      1.445695       3505.1053    
      5800   294.47286     -32083.126     -279.65969      1.4454564      3505.684     
      5900   307.78699     -32077.811     -11974.209      1.4452178      3506.2627    
      6000   313.89818     -32083.774     -10067.706      1.4449793      3506.8413    
Loop time of 231.828 on 8 procs for 6000 steps with 274 atoms

Performance: 1.118 ns/day, 21.466 hours/ns, 25.881 timesteps/s, 7.091 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.34     | 185.75     | 194.65     |  71.3 | 80.12
Bond    | 0.017127   | 0.01899    | 0.021718   |   1.1 |  0.01
Neigh   | 11.345     | 13.065     | 13.68      |  18.4 |  5.64
Comm    | 3.5863     | 12.5       | 34.872     | 274.8 |  5.39
Output  | 0.017025   | 0.019498   | 0.02157    |   1.1 |  0.01
Modify  | 19.74      | 20.337     | 22.087     |  15.0 |  8.77
Other   |            | 0.1436     |            |       |  0.06

Nlocal:          34.25 ave          44 max          23 min
Histogram: 1 1 1 0 1 0 0 2 0 2
Nghost:         2800.5 ave        2827 max        2785 min
Histogram: 3 0 1 0 2 0 0 0 1 1
Neighs:        18736.5 ave       23909 max       12841 min
Histogram: 1 1 1 0 1 0 0 2 1 1

Total # of neighbors = 149892
Ave neighs/atom = 547.05109
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal ly-${len0}
variable dlen equal ly-12.842
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta -0.004312 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.06916     -32054.45      -17081.155      1.4596724      3471.5415    
       200   302.01577     -32086.562     -10076.943      1.4599157      3470.9628    
       300   288.04837     -32091.187     -3984.3958      1.4601592      3470.3841    
       400   287.92397     -32091.38      -4875.451       1.4604027      3469.8054    
       500   298.52253     -32092.536     -18933.896      1.4606463      3469.2267    
       600   296.75705     -32083.466     -2122.4935      1.46089        3468.648     
       700   284.02373     -32059.417     -9072.1657      1.4611338      3468.0693    
       800   311.04824     -32080.827     -5228.7203      1.4613776      3467.4906    
       900   297.38814     -32091.94      -718.23952      1.4616215      3466.912     
      1000   283.72835     -32094.847     -3719.0248      1.4618655      3466.3333    
      1100   269.52459     -32084.364     -5376.7424      1.4621096      3465.7546    
      1200   300.46307     -32087.449     -4900.9253      1.4623538      3465.1759    
      1300   314.61599     -32076.928     -16554.937      1.4625981      3464.5972    
      1400   322.29771     -32088.246     -13834.352      1.4628424      3464.0185    
      1500   300.12779     -32088.231     -8664.8424      1.4630868      3463.4398    
      1600   283.51223     -32081.718     -6581.0336      1.4633313      3462.8612    
      1700   300.27671     -32094.525     -3466.9661      1.4635759      3462.2825    
      1800   322.58614     -32112.349     -6019.5941      1.4638206      3461.7038    
      1900   288.28748     -32085.054     -2024.2358      1.4640653      3461.1251    
      2000   321.32473     -32094.521     -2279.0661      1.4643101      3460.5464    
      2100   340.86402     -32078.059     -7142.3005      1.464555       3459.9677    
      2200   305.38485     -32072.725     -2310.5633      1.4648         3459.389     
      2300   293.68435     -32083.74      -2930.903       1.4650451      3458.8103    
      2400   283.4956      -32085.094     -5211.063       1.4652903      3458.2317    
      2500   301.08592     -32107.166      1628.0496      1.4655355      3457.653     
      2600   267.69029     -32091.515     -5768.5855      1.4657808      3457.0743    
      2700   304.58632     -32124.147     -13012.839      1.4660262      3456.4956    
      2800   297.49475     -32116.855     -825.98059      1.4662717      3455.9169    
      2900   313.67383     -32120.008     -13337.192      1.4665173      3455.3382    
      3000   304.35572     -32090.737     -9937.9008      1.4667629      3454.7595    
      3100   320.79496     -32093.55      -8434.351       1.4670086      3454.1809    
      3200   299.83641     -32094.279     -1226.322       1.4672545      3453.6022    
      3300   292.61214     -32111.644     -7395.8297      1.4675003      3453.0235    
      3400   301.29607     -32118.473     -2434.4294      1.4677463      3452.4448    
      3500   282.66764     -32094.743     -8136.6977      1.4679924      3451.8661    
      3600   322.71572     -32106.075     -3181.6051      1.4682385      3451.2874    
      3700   302.14589     -32087.005     -12949.675      1.4684848      3450.7087    
      3800   303.98404     -32104.718     -2855.881       1.4687311      3450.13      
      3900   277.76065     -32119.636     -14751.042      1.4689775      3449.5514    
      4000   285.02647     -32119.879      230.98048      1.4692239      3448.9727    
      4100   290.00791     -32099.945     -11829.16       1.4694705      3448.394     
      4200   308.66831     -32101.942     -5285.8202      1.4697171      3447.8153    
      4300   308.27856     -32093.957     -13750.212      1.4699638      3447.2366    
      4400   304.7229      -32103.467     -8196.7549      1.4702106      3446.6579    
      4500   292.73696     -32126.672     -11096.872      1.4704575      3446.0792    
      4600   293.99436     -32126.004      4098.0845      1.4707045      3445.5006    
      4700   294.39523     -32110.706     -3734.3478      1.4709516      3444.9219    
      4800   290.93752     -32091.706     -5267.187       1.4711987      3444.3432    
      4900   308.05881     -32088.76      -7116.9613      1.4714459      3443.7645    
      5000   322.96723     -32100.97      -14279.3        1.4716932      3443.1858    
      5100   310.85939     -32099.262     -8399.4668      1.4719406      3442.6071    
      5200   297.61963     -32104.211      6563.1786      1.4721881      3442.0284    
      5300   291.55095     -32108.901     -4805.9985      1.4724356      3441.4497    
      5400   298.1406      -32108.458     -1103.2143      1.4726832      3440.8711    
      5500   333.56913     -32103.086     -8621.0226      1.472931       3440.2924    
      5600   311.85674     -32079.892     -10824.722      1.4731788      3439.7137    
      5700   296.02643     -32083.841      11342.301      1.4734267      3439.135     
      5800   297.08563     -32095.061     -17150.248      1.4736746      3438.5563    
      5900   309.04483     -32110.169     -6786.8467      1.4739227      3437.9776    
      6000   323.71671     -32120.65      -12286.778      1.4741708      3437.3989    
Loop time of 233.137 on 8 procs for 6000 steps with 274 atoms

Performance: 1.112 ns/day, 21.587 hours/ns, 25.736 timesteps/s, 7.052 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 183.17     | 190.31     | 195.93     |  37.4 | 81.63
Bond    | 0.016695   | 0.018454   | 0.021222   |   1.1 |  0.01
Neigh   | 13.268     | 13.428     | 13.559     |   2.9 |  5.76
Comm    | 3.1733     | 8.8397     | 16.018     | 174.9 |  3.79
Output  | 0.018479   | 0.021234   | 0.023731   |   1.3 |  0.01
Modify  | 20.261     | 20.384     | 20.524     |   2.2 |  8.74
Other   |            | 0.1397     |            |       |  0.06

Nlocal:          34.25 ave          43 max          24 min
Histogram: 1 1 1 0 0 1 1 1 0 2
Nghost:        2857.38 ave        2884 max        2846 min
Histogram: 4 1 1 0 0 0 0 0 1 1
Neighs:          19133 ave       23737 max       13637 min
Histogram: 1 1 1 0 0 1 1 1 0 2

Total # of neighbors = 153064
Ave neighs/atom = 558.62774
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta 0.004312 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.04664     -32054.44      -17139.831      1.4591859      3472.6988    
       200   303.68456     -32087.524     -9980.6113      1.4589428      3473.2775    
       300   281.80389     -32085.426     -5724.4671      1.4586997      3473.8562    
       400   288.93355     -32092.605     -4277.6137      1.4584568      3474.4349    
       500   294.63585     -32089.678     -19416.219      1.4582139      3475.0136    
       600   289.35879     -32076.623     -12260.892      1.4579711      3475.5923    
       700   306.17645     -32071.125      3298.9105      1.4577284      3476.1709    
       800   337.57386     -32099.429     -4377.2862      1.4574858      3476.7496    
       900   298.67911     -32095.811     -8845.6876      1.4572432      3477.3283    
      1000   320.31481     -32127.364     -2293.3664      1.4570008      3477.907     
      1100   296.32664     -32104.615     -3816.2825      1.4567584      3478.4857    
      1200   286.76981     -32074.696      3798.2072      1.4565161      3479.0644    
      1300   300.84024     -32067.487     -10340.103      1.4562738      3479.6431    
      1400   304.92422     -32075.346     -5584.9221      1.4560317      3480.2218    
      1500   280.50015     -32068.44      -253.99565      1.4557896      3480.8004    
      1600   298.882       -32088.764     -915.31102      1.4555476      3481.3791    
      1700   323.88244     -32094.864     -17548.711      1.4553057      3481.9578    
      1800   324.80142     -32069.071     -5866.2411      1.4550639      3482.5365    
      1900   337.38088     -32095.778     -5321.9998      1.4548222      3483.1152    
      2000   309.40336     -32098.616     -8332.2416      1.4545805      3483.6939    
      2100   290.68356     -32087.984      1266.7719      1.4543389      3484.2726    
      2200   313.49446     -32109.461      4049.4138      1.4540974      3484.8512    
      2300   293.81067     -32105.947     -3310.308       1.453856       3485.4299    
      2400   285.3929      -32102.953     -2139.0784      1.4536146      3486.0086    
      2500   298.00057     -32087.664     -3987.9574      1.4533734      3486.5873    
      2600   328.50425     -32100.228     -6012.5543      1.4531322      3487.166     
      2700   284.0707      -32080.728     -7029.9017      1.4528911      3487.7447    
      2800   306.93498     -32106.779      1115.9767      1.4526501      3488.3234    
      2900   313.48774     -32109.077      11858.613      1.4524091      3488.9021    
      3000   302.732       -32102.014      2614.6681      1.4521683      3489.4807    
      3100   288.46942     -32104.423     -11560.966      1.4519275      3490.0594    
      3200   294.1101      -32115.791     -14413.239      1.4516868      3490.6381    
      3300   300.18564     -32101.036     -2320.0334      1.4514461      3491.2168    
      3400   314.67746     -32088.041     -6132.6654      1.4512056      3491.7955    
      3500   310.4001      -32093.792     -1741.0882      1.4509651      3492.3742    
      3600   306.2783      -32114.592     -7094.5563      1.4507247      3492.9529    
      3700   299.04186     -32119.245      1953.0097      1.4504844      3493.5315    
      3800   289.00518     -32107.016      2284.2993      1.4502442      3494.1102    
      3900   300.68511     -32104.241     -10803.244      1.4500041      3494.6889    
      4000   330.24485     -32091.47      -2498.5462      1.449764       3495.2676    
      4100   330.22787     -32095.245     -803.03691      1.449524       3495.8463    
      4200   312.61411     -32108.019     -9885.9057      1.4492841      3496.425     
      4300   295.88959     -32111.878      1471.6827      1.4490443      3497.0037    
      4400   296.7828      -32110.969     -486.64141      1.4488045      3497.5824    
      4500   310.09317     -32108.565     -13605.364      1.4485649      3498.161     
      4600   317.8461      -32098.187      2012.8047      1.4483253      3498.7397    
      4700   329.74976     -32103.73       4755.9988      1.4480858      3499.3184    
      4800   304.49744     -32110.221     -6586.1708      1.4478463      3499.8971    
      4900   310.95911     -32129.499     -8301.3933      1.447607       3500.4758    
      5000   305.87591     -32125.006     -4821.6187      1.4473677      3501.0545    
      5100   297.42358     -32097.932     -14014.468      1.4471285      3501.6332    
      5200   328.78405     -32099.353     -4293.0407      1.4468894      3502.2118    
      5300   328.44673     -32112.489      5150.7961      1.4466504      3502.7905    
      5400   304.78749     -32107.688      3562.7165      1.4464114      3503.3692    
      5500   303.26383     -32105.6       -3215.2926      1.4461725      3503.9479    
      5600   304.39694     -32109.389     -1497.8225      1.4459337      3504.5266    
      5700   301.72613     -32146.513     -13797.862      1.445695       3505.1053    
      5800   278.22648     -32130.043     -10420.253      1.4454564      3505.684     
      5900   294.94504     -32122.513      3709.8668      1.4452178      3506.2627    
      6000   291.65556     -32101.711      3180.252       1.4449793      3506.8413    
Loop time of 229.244 on 8 procs for 6000 steps with 274 atoms

Performance: 1.131 ns/day, 21.226 hours/ns, 26.173 timesteps/s, 7.171 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 170.85     | 183.21     | 191.85     |  53.2 | 79.92
Bond    | 0.017331   | 0.018772   | 0.020802   |   0.9 |  0.01
Neigh   | 12.124     | 12.895     | 13.278     |  12.3 |  5.62
Comm    | 4.1219     | 12.803     | 25.182     | 201.9 |  5.58
Output  | 0.017989   | 0.020575   | 0.02278    |   1.2 |  0.01
Modify  | 19.8       | 20.156     | 20.92      |  10.0 |  8.79
Other   |            | 0.1434     |            |       |  0.06

Nlocal:          34.25 ave          44 max          22 min
Histogram: 1 1 0 1 0 0 1 2 1 1
Nghost:        2777.75 ave        2799 max        2750 min
Histogram: 1 0 0 2 1 1 0 0 0 3
Neighs:        18733.4 ave       23869 max       12306 min
Histogram: 1 1 0 1 0 0 1 2 1 1

Total # of neighbors = 149867
Ave neighs/atom = 546.95985
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal lz-${len0}
variable dlen equal lz-16.0755
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.160755 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.06035     -32054.437     -17112.733      1.4596724      3471.5415    
       200   304.13073     -32088.098     -10335.716      1.4599157      3470.9628    
       300   286.49927     -32089.449     -3324.8059      1.4601592      3470.3841    
       400   284.69014     -32089.473     -4314.6646      1.4604027      3469.8054    
       500   291.7593      -32089.465     -16882.966      1.4606463      3469.2267    
       600   293.08977     -32083.223     -10566.309      1.46089        3468.648     
       700   286.05713     -32059.634      2028.9654      1.4611338      3468.0693    
       800   330.0527      -32090.118     -5978.0233      1.4613776      3467.4906    
       900   293.85562     -32081.217     -5151.915       1.4616215      3466.912     
      1000   293.28739     -32100.236     -5510.0438      1.4618655      3466.3333    
      1100   293.95645     -32107.127     -15212.817      1.4621096      3465.7546    
      1200   299.4545      -32095.256     -4673.733       1.4623538      3465.1759    
      1300   317.96573     -32085.441     -1373.9808      1.4625981      3464.5972    
      1400   307.61581     -32075.318     -14509.526      1.4628424      3464.0185    
      1500   288.62573     -32066.617      6376.2885      1.4630868      3463.4398    
      1600   307.00725     -32085.616     -691.07935      1.4633313      3462.8612    
      1700   299.80959     -32084.457     -9504.485       1.4635759      3462.2825    
      1800   309.74389     -32101.434     -7198.1376      1.4638206      3461.7038    
      1900   313.53476     -32108.651      2779.4631      1.4640653      3461.1251    
      2000   290.14125     -32091.392     -7353.2355      1.4643101      3460.5464    
      2100   290.23057     -32090.387     -17401.432      1.464555       3459.9677    
      2200   304.82591     -32082.026      11242.298      1.4648         3459.389     
      2300   329.08605     -32087.736     -4875.7058      1.4650451      3458.8103    
      2400   309.80028     -32089.668     -7390.7179      1.4652903      3458.2317    
      2500   297.1462      -32106.073     -15287.073      1.4655355      3457.653     
      2600   283.50426     -32093.275     -16163.322      1.4657808      3457.0743    
      2700   302.5927      -32094.559     -2021.8405      1.4660262      3456.4956    
      2800   333.734       -32102.645     -9909.6219      1.4662717      3455.9169    
      2900   305.85286     -32083.824     -3948.8058      1.4665173      3455.3382    
      3000   293.96439     -32110.306     -3510.8183      1.4667629      3454.7595    
      3100   291.21109     -32107.103      1536.475       1.4670086      3454.1809    
      3200   301.97403     -32095.654     -4748.4938      1.4672545      3453.6022    
      3300   323.89583     -32099.009      3347.5592      1.4675003      3453.0235    
      3400   297.02282     -32083.828     -14106.558      1.4677463      3452.4448    
      3500   293.6263      -32084.041     -3442.2254      1.4679924      3451.8661    
      3600   311.48085     -32096.449     -9247.2084      1.4682385      3451.2874    
      3700   283.84985     -32076.829     -13600.412      1.4684848      3450.7087    
      3800   313.09849     -32108.538     -6319.3819      1.4687311      3450.13      
      3900   293.22452     -32102.989     -9976.0597      1.4689775      3449.5514    
      4000   307.50196     -32112.713     -16865.032      1.4692239      3448.9727    
      4100   294.36282     -32087.949     -3481.0555      1.4694705      3448.394     
      4200   333.70686     -32101.48       1350.0979      1.4697171      3447.8153    
      4300   298.90165     -32095.353     -15733.821      1.4699638      3447.2366    
      4400   289.43332     -32107.746     -4332.5296      1.4702106      3446.6579    
      4500   313.41121     -32130.457     -8193.9334      1.4704575      3446.0792    
      4600   308.30982     -32126.358     -1437.0878      1.4707045      3445.5006    
      4700   301.48802     -32116.089     -574.29958      1.4709516      3444.9219    
      4800   310.30161     -32115.424     -16276.069      1.4711987      3444.3432    
      4900   312.88503     -32120.732     -9643.8617      1.4714459      3443.7645    
      5000   286.42025     -32122.543     -9294.4712      1.4716932      3443.1858    
      5100   275.10647     -32122.672     -5419.0833      1.4719406      3442.6071    
      5200   282.02438     -32108.317      1968.5523      1.4721881      3442.0284    
      5300   302.46416     -32109.638      1003.3884      1.4724356      3441.4497    
      5400   316.19866     -32115.099     -7525.056       1.4726832      3440.8711    
      5500   310.06456     -32119.114     -7021.8787      1.472931       3440.2924    
      5600   271.82738     -32112.739     -8729.2242      1.4731788      3439.7137    
      5700   285.34652     -32123.542      10947.006      1.4734267      3439.135     
      5800   287.57386     -32119.459     -8828.5003      1.4736746      3438.5563    
      5900   304.75783     -32120.833     -7094.5413      1.4739227      3437.9776    
      6000   290.34548     -32101.569     -3126.7853      1.4741708      3437.3989    
Loop time of 237.558 on 8 procs for 6000 steps with 274 atoms

Performance: 1.091 ns/day, 21.996 hours/ns, 25.257 timesteps/s, 6.920 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 151.11     | 188.73     | 199.53     | 112.2 | 79.45
Bond    | 0.015358   | 0.017522   | 0.020116   |   1.2 |  0.01
Neigh   | 10.698     | 13.14      | 13.751     |  26.2 |  5.53
Comm    | 3.665      | 14.476     | 52.129     | 405.6 |  6.09
Output  | 0.016333   | 0.018743   | 0.02072    |   1.1 |  0.01
Modify  | 20.409     | 21.042     | 23.465     |  20.5 |  8.86
Other   |            | 0.1296     |            |       |  0.05

Nlocal:          34.25 ave          44 max          25 min
Histogram: 2 0 1 0 0 2 1 0 1 1
Nghost:        2860.38 ave        2897 max        2840 min
Histogram: 2 1 2 0 1 0 0 1 0 1
Neighs:        19108.4 ave       24224 max       14170 min
Histogram: 2 0 1 0 0 2 1 0 1 1

Total # of neighbors = 152867
Ave neighs/atom = 557.90876
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.160755 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.01154     -32054.442     -17103.095      1.4591859      3472.6988    
       200   300.90134     -32085.517     -10044.151      1.4589428      3473.2775    
       300   286.5762      -32090.158     -6391.2683      1.4586997      3473.8562    
       400   292.805       -32095.241     -8360.6176      1.4584568      3474.4349    
       500   294.60298     -32088.201     -21321.334      1.4582139      3475.0136    
       600   288.88374     -32074.347     -7099.427       1.4579711      3475.5923    
       700   297.05006     -32062.059      2475.4158      1.4577284      3476.1709    
       800   318.45764     -32079.824      4134.4553      1.4574858      3476.7496    
       900   297.13612     -32085.452     -11630.994      1.4572432      3477.3283    
      1000   284.91229     -32097.323     -912.24533      1.4570008      3477.907     
      1100   304.21119     -32114.271     -3662.2707      1.4567584      3478.4857    
      1200   301.89223     -32090.233     -3172.9757      1.4565161      3479.0644    
      1300   313.53397     -32082.303      6127.8276      1.4562738      3479.6431    
      1400   302.18937     -32075.643     -15535.551      1.4560317      3480.2218    
      1500   314.0624      -32090.435     -2702.1246      1.4557896      3480.8004    
      1600   293.12832     -32092.463      3695.3263      1.4555476      3481.3791    
      1700   277.51887     -32105.232      784.21794      1.4553057      3481.9578    
      1800   297.85639     -32115.994     -2047.8575      1.4550639      3482.5365    
      1900   297.10388     -32090.953     -4477.0509      1.4548222      3483.1152    
      2000   312.29207     -32093.805     -12847.165      1.4545805      3483.6939    
      2100   312.35141     -32084.921      11700.914      1.4543389      3484.2726    
      2200   310.2368      -32078.99      -2436.2779      1.4540974      3484.8512    
      2300   291.21971     -32079.831     -12360.536      1.453856       3485.4299    
      2400   294.04965     -32105.988     -505.83246      1.4536146      3486.0086    
      2500   299.19966     -32105.779     -7558.541       1.4533734      3486.5873    
      2600   291.21634     -32081.19      -11098.722      1.4531322      3487.166     
      2700   289.59534     -32077.849      1798.6713      1.4528911      3487.7447    
      2800   314.54663     -32099.726     -729.10296      1.4526501      3488.3234    
      2900   298.11903     -32085.565     -8796.8934      1.4524091      3488.9021    
      3000   302.483       -32080.786     -3456.9875      1.4521683      3489.4807    
      3100   327.75335     -32088.607     -5985.7232      1.4519275      3490.0594    
      3200   293.07459     -32076.239      224.09146      1.4516868      3490.6381    
      3300   316.29139     -32120.074     -6125.0889      1.4514461      3491.2168    
      3400   273.23516     -32090.49       5106.5515      1.4512056      3491.7955    
      3500   315.79867     -32113.425     -810.52067      1.4509651      3492.3742    
      3600   297.87693     -32088.893     -11008.782      1.4507247      3492.9529    
      3700   299.14411     -32072.267     -11713.062      1.4504844      3493.5315    
      3800   292.14238     -32066.12       4687.7607      1.4502442      3494.1102    
      3900   285.24427     -32085.15      -15821.009      1.4500041      3494.6889    
      4000   281.98889     -32099.105     -8740.5279      1.449764       3495.2676    
      4100   286.63341     -32103.727     -4393.8968      1.449524       3495.8463    
      4200   295.41143     -32098.119      6360.7339      1.4492841      3496.425     
      4300   320.75561     -32085.599     -12642.36       1.4490443      3497.0037    
      4400   332.0817      -32085.96       11678.906      1.4488045      3497.5824    
      4500   324.48132     -32097.767      1555.3388      1.4485649      3498.161     
      4600   323.01878     -32116.078     -3519.8455      1.4483253      3498.7397    
      4700   292.57346     -32110.156     -5958.7372      1.4480858      3499.3184    
      4800   303.24406     -32126.004      2322.1441      1.4478463      3499.8971    
      4900   296.05836     -32119.957     -6708.121       1.447607       3500.4758    
      5000   295.25332     -32130.117      3304.1341      1.4473677      3501.0545    
      5100   282.99043     -32132.427     -6828.3988      1.4471285      3501.6332    
      5200   281.08527     -32118.943     -2892.7067      1.4468894      3502.2118    
      5300   301.22427     -32109.689     -14276.586      1.4466504      3502.7905    
      5400   304.07654     -32105.033     -3809.3679      1.4464114      3503.3692    
      5500   312.03978     -32118.397     -553.11726      1.4461725      3503.9479    
      5600   286.44927     -32120.137     -6952.153       1.4459337      3504.5266    
      5700   277.97261     -32134.756     -4659.9439      1.445695       3505.1053    
      5800   271.00104     -32138.915      657.76907      1.4454564      3505.684     
      5900   292.64158     -32138.478      489.285        1.4452178      3506.2627    
      6000   287.05728     -32106.632     -8251.3852      1.4449793      3506.8413    
Loop time of 231.696 on 8 procs for 6000 steps with 274 atoms

Performance: 1.119 ns/day, 21.453 hours/ns, 25.896 timesteps/s, 7.096 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 131.92     | 177.23     | 194.32     | 180.3 | 76.49
Bond    | 0.015918   | 0.018383   | 0.021975   |   1.3 |  0.01
Neigh   | 9.7685     | 12.331     | 13.49      |  39.7 |  5.32
Comm    | 3.702      | 20.811     | 66.131     | 526.5 |  8.98
Output  | 0.019153   | 0.022142   | 0.025182   |   1.4 |  0.01
Modify  | 20.005     | 21.149     | 23.714     |  30.3 |  9.13
Other   |            | 0.1313     |            |       |  0.06

Nlocal:          34.25 ave          44 max          20 min
Histogram: 1 0 1 1 0 0 0 3 0 2
Nghost:        2783.75 ave        2801 max        2762 min
Histogram: 1 0 1 0 1 0 3 1 0 1
Neighs:          18716 ave       23766 max       11172 min
Histogram: 1 0 1 1 0 0 0 2 1 2

Total # of neighbors = 149728
Ave neighs/atom = 546.45255
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4312)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.168189 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.04211     -32054.436     -17107.63       1.4594291      3472.1201    
       200   302.15335     -32086.402     -10253.615      1.4594291      3472.1201    
       300   291.7647      -32093.999     -3266.2643      1.4594291      3472.1201    
       400   287.6479      -32091.505     -3250.6214      1.4594291      3472.1201    
       500   294.51634     -32087.89      -14749.193      1.4594291      3472.1201    
       600   308.87277     -32091.674     -5195.2137      1.4594291      3472.1201    
       700   290.30918     -32060.62      -2262.6518      1.4594291      3472.1201    
       800   319.50619     -32082.874     -9499.5546      1.4594291      3472.1201    
       900   291.05289     -32085.099     -6576.0302      1.4594291      3472.1201    
      1000   273.94023     -32091.629     -1261.66        1.4594291      3472.1201    
      1100   285.01353     -32103.536     -10746.112      1.4594291      3472.1201    
      1200   300.79428     -32092.393     -3230.8233      1.4594291      3472.1201    
      1300   303.51993     -32078.541     -7307.5118      1.4594291      3472.1201    
      1400   292.20949     -32075.732     -16962.225      1.4594291      3472.1201    
      1500   320.07226     -32101.68       539.27551      1.4594291      3472.1201    
      1600   305.26123     -32091.558     -6378.377       1.4594291      3472.1201    
      1700   283.4488      -32105.053     -12648.375      1.4594291      3472.1201    
      1800   294.60965     -32123.415     -4633.6067      1.4594291      3472.1201    
      1900   265.76588     -32084.762     -20205.784      1.4594291      3472.1201    
      2000   300.63885     -32084.863     -21896.266      1.4594291      3472.1201    
      2100   313.55436     -32082.618     -14644.052      1.4594291      3472.1201    
      2200   319.5617      -32091.526     -3333.3388      1.4594291      3472.1201    
      2300   283.50789     -32088.11      -3539.3415      1.4594291      3472.1201    
      2400   276.6894      -32089.656      7848.6252      1.4594291      3472.1201    
      2500   314.14921     -32111.444     -1635.4878      1.4594291      3472.1201    
      2600   292.83222     -32096.246      661.99039      1.4594291      3472.1201    
      2700   274.88314     -32106.223     -4846.3763      1.4594291      3472.1201    
      2800   269.48858     -32121.025     -1080.4909      1.4594291      3472.1201    
      2900   262.80908     -32101.882     -9065.6024      1.4594291      3472.1201    
      3000   292.26875     -32103.428     -4473.0301      1.4594291      3472.1201    
      3100   289.07096     -32087.74      -17122.192      1.4594291      3472.1201    
      3200   309.34367     -32089.995      3091.7072      1.4594291      3472.1201    
      3300   341.80346     -32111.277     -4604.2882      1.4594291      3472.1201    
      3400   326.30705     -32101.367     -2776.5601      1.4594291      3472.1201    
      3500   287.45772     -32097.482     -3198.1413      1.4594291      3472.1201    
      3600   285.80499     -32112.889     -264.0121       1.4594291      3472.1201    
      3700   293.51683     -32111.646     -6138.6138      1.4594291      3472.1201    
      3800   309.45576     -32101.734     -5838.7699      1.4594291      3472.1201    
      3900   316.51059     -32102.231      316.50077      1.4594291      3472.1201    
      4000   304.27964     -32093.519     -6731.3383      1.4594291      3472.1201    
      4100   307.22478     -32091.731     -3009.4105      1.4594291      3472.1201    
      4200   306.76271     -32097.12      -1853.1715      1.4594291      3472.1201    
      4300   280.62592     -32109.518     -7194.2962      1.4594291      3472.1201    
      4400   280.47478     -32103.111     -18050.339      1.4594291      3472.1201    
      4500   309.1223      -32116.933     -6777.1873      1.4594291      3472.1201    
      4600   285.09986     -32090.378     -7218.8467      1.4594291      3472.1201    
      4700   314.11724     -32088.827      6387.2399      1.4594291      3472.1201    
      4800   330.55672     -32092.124     -19014.175      1.4594291      3472.1201    
      4900   288.96863     -32093.63      -5484.9168      1.4594291      3472.1201    
      5000   302.10321     -32111.595     -2338.7329      1.4594291      3472.1201    
      5100   290.5089      -32106.923     -3954.752       1.4594291      3472.1201    
      5200   290.70382     -32123.11      -63.889049      1.4594291      3472.1201    
      5300   263.2632      -32115.83      -8355.7204      1.4594291      3472.1201    
      5400   301.45089     -32126.862     -11846.844      1.4594291      3472.1201    
      5500   313.87103     -32111.385     -5686.3244      1.4594291      3472.1201    
      5600   298.83033     -32100.884     -6120.3551      1.4594291      3472.1201    
      5700   303.97327     -32115.627     -8832.1617      1.4594291      3472.1201    
      5800   276.51305     -32113.343     -1016.4564      1.4594291      3472.1201    
      5900   261.83256     -32117.331     -3293.2564      1.4594291      3472.1201    
      6000   303.34033     -32127.157      3399.9882      1.4594291      3472.1201    
Loop time of 231.959 on 8 procs for 6000 steps with 274 atoms

Performance: 1.117 ns/day, 21.478 hours/ns, 25.867 timesteps/s, 7.087 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 177.9      | 187.5      | 194.87     |  43.6 | 80.83
Bond    | 0.01681    | 0.018754   | 0.022551   |   1.3 |  0.01
Neigh   | 12.425     | 13.177     | 13.614     |   8.7 |  5.68
Comm    | 3.2648     | 10.661     | 20.233     | 183.7 |  4.60
Output  | 0.01727    | 0.01956    | 0.021575   |   1.1 |  0.01
Modify  | 20.042     | 20.442     | 21.218     |   7.1 |  8.81
Other   |            | 0.1375     |            |       |  0.06

Nlocal:          34.25 ave          44 max          24 min
Histogram: 1 0 0 2 0 2 1 0 1 1
Nghost:        2814.25 ave        2844 max        2794 min
Histogram: 2 1 0 1 2 0 0 0 1 1
Neighs:          18957 ave       24093 max       13438 min
Histogram: 1 0 0 2 0 2 1 0 1 1

Total # of neighbors = 151656
Ave neighs/atom = 553.48905
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.168189 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.03666     -32054.44      -17109.772      1.4594291      3472.1201    
       200   303.87192     -32087.955     -8572.9127      1.4594291      3472.1201    
       300   283.71272     -32087.197     -3148.997       1.4594291      3472.1201    
       400   290.55777     -32094.099     -5648.7893      1.4594291      3472.1201    
       500   290.76895     -32088.121     -18896.16       1.4594291      3472.1201    
       600   288.48077     -32077.788     -5907.1215      1.4594291      3472.1201    
       700   300.13322     -32068.356      4673.7442      1.4594291      3472.1201    
       800   319.32356     -32084.43      -14719.152      1.4594291      3472.1201    
       900   292.19127     -32088.575     -8604.3108      1.4594291      3472.1201    
      1000   301.35511     -32111.501      3926.4753      1.4594291      3472.1201    
      1100   297.59781     -32108.146      1040.7636      1.4594291      3472.1201    
      1200   287.8746      -32077.704     -9857.8117      1.4594291      3472.1201    
      1300   325.39865     -32086.35      -3758.336       1.4594291      3472.1201    
      1400   294.67709     -32071.373     -10249.621      1.4594291      3472.1201    
      1500   293.69925     -32081.771      751.25834      1.4594291      3472.1201    
      1600   302.17425     -32095.782     -809.55733      1.4594291      3472.1201    
      1700   273.07544     -32101.673     -8148.1082      1.4594291      3472.1201    
      1800   288.06298     -32117.74      -3149.3004      1.4594291      3472.1201    
      1900   289.15154     -32096.187      4441.8391      1.4594291      3472.1201    
      2000   296.75082     -32090.549     -42.734152      1.4594291      3472.1201    
      2100   288.20467     -32072.573     -11367.664      1.4594291      3472.1201    
      2200   306.46644     -32071.357     -4240.1479      1.4594291      3472.1201    
      2300   296.12037     -32074.189      297.62366      1.4594291      3472.1201    
      2400   281.26912     -32089.709      1309.0515      1.4594291      3472.1201    
      2500   284.47743     -32092.146     -18232.266      1.4594291      3472.1201    
      2600   300.41026     -32095.723     -16221.685      1.4594291      3472.1201    
      2700   291.28181     -32081.105      2335.8009      1.4594291      3472.1201    
      2800   319.07472     -32088.403     -1987.2742      1.4594291      3472.1201    
      2900   294.79128     -32076.412     -3204.2928      1.4594291      3472.1201    
      3000   317.71147     -32117.891     -8134.5429      1.4594291      3472.1201    
      3100   291.08458     -32113.9       -11070.413      1.4594291      3472.1201    
      3200   279.33839     -32103.933     -12512.944      1.4594291      3472.1201    
      3300   295.92357     -32086.221     -14903.078      1.4594291      3472.1201    
      3400   313.25956     -32094.461     -10145.44       1.4594291      3472.1201    
      3500   302.06867     -32098.907     -1768.5943      1.4594291      3472.1201    
      3600   286.30722     -32099.816     -5347.6948      1.4594291      3472.1201    
      3700   297.23327     -32116.889      5988.5237      1.4594291      3472.1201    
      3800   287.67724     -32097.708      2869.2524      1.4594291      3472.1201    
      3900   314.47975     -32090.207      4060.4488      1.4594291      3472.1201    
      4000   319.50484     -32090.146     -5343.4962      1.4594291      3472.1201    
      4100   284.6164      -32087.644     -9145.0531      1.4594291      3472.1201    
      4200   283.36163     -32101.246      5346.3951      1.4594291      3472.1201    
      4300   302.32267     -32117.747      1683.7673      1.4594291      3472.1201    
      4400   294.07395     -32100.325     -6322.995       1.4594291      3472.1201    
      4500   311.43836     -32082.237     -5977.2694      1.4594291      3472.1201    
      4600   336.29472     -32108.396      1517.8563      1.4594291      3472.1201    
      4700   312.6445      -32106.923     -1013.0997      1.4594291      3472.1201    
      4800   284.49331     -32090.937     -8236.4604      1.4594291      3472.1201    
      4900   298.06002     -32101.944      4397.5584      1.4594291      3472.1201    
      5000   321.60629     -32109.022     -10742.882      1.4594291      3472.1201    
      5100   326.69608     -32092.584     -7580.4431      1.4594291      3472.1201    
      5200   334.64882     -32114.288     -10431.577      1.4594291      3472.1201    
      5300   286.89008     -32102.43      -5047.6018      1.4594291      3472.1201    
      5400   298.27925     -32113.105     -15171.641      1.4594291      3472.1201    
      5500   292.38707     -32103.552     -12058.686      1.4594291      3472.1201    
      5600   323.45131     -32106.092     -2625.8865      1.4594291      3472.1201    
      5700   335.7154      -32099.846     -13990.713      1.4594291      3472.1201    
      5800   300.62245     -32090.398     -1758.2882      1.4594291      3472.1201    
      5900   269.22636     -32096.535      215.64208      1.4594291      3472.1201    
      6000   295.34762     -32112.152     -9101.2132      1.4594291      3472.1201    
Loop time of 223.22 on 8 procs for 6000 steps with 274 atoms

Performance: 1.161 ns/day, 20.669 hours/ns, 26.879 timesteps/s, 7.365 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 151.6      | 168.6      | 186.74     |  84.0 | 75.53
Bond    | 0.016456   | 0.018108   | 0.021979   |   1.4 |  0.01
Neigh   | 11.274     | 12.217     | 13.35      |  19.4 |  5.47
Comm    | 3.8782     | 22.046     | 39.069     | 232.6 |  9.88
Output  | 0.016439   | 0.018853   | 0.020797   |   1.1 |  0.01
Modify  | 19.067     | 20.187     | 21.111     |  15.1 |  9.04
Other   |            | 0.1364     |            |       |  0.06

Nlocal:          34.25 ave          40 max          24 min
Histogram: 1 1 0 1 0 0 0 1 0 4
Nghost:        2814.75 ave        2838 max        2792 min
Histogram: 2 1 0 1 0 0 1 0 1 2
Neighs:        18940.2 ave       22048 max       13508 min
Histogram: 1 1 0 1 0 0 0 1 0 4

Total # of neighbors = 151522
Ave neighs/atom = 553
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-1.195)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.12842 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.04109     -32054.441     -17109.16       1.4594291      3472.1201    
       200   303.814       -32087.771     -9637.7259      1.4594291      3472.1201    
       300   284.29028     -32087.72      -3182.6559      1.4594291      3472.1201    
       400   287.02138     -32091.395     -11180.17       1.4594291      3472.1201    
       500   283.30641     -32082.111     -18831.659      1.4594291      3472.1201    
       600   287.39787     -32077.049     -5010.8628      1.4594291      3472.1201    
       700   307.01985     -32072.878      11707.109      1.4594291      3472.1201    
       800   319.02227     -32081.653     -7627.4364      1.4594291      3472.1201    
       900   296.96256     -32086.224     -5936.6353      1.4594291      3472.1201    
      1000   305.32539     -32110.035      2545.2177      1.4594291      3472.1201    
      1100   295.16393     -32106.42       5208.8789      1.4594291      3472.1201    
      1200   297.19865     -32099.187      4107.3303      1.4594291      3472.1201    
      1300   325.33075     -32091.59      -8757.9017      1.4594291      3472.1201    
      1400   296.60555     -32071.322     -6684.2585      1.4594291      3472.1201    
      1500   305.54044     -32087.036     -11172.087      1.4594291      3472.1201    
      1600   301.94054     -32096.13      -4647.8646      1.4594291      3472.1201    
      1700   278.63646     -32111.417     -12494.463      1.4594291      3472.1201    
      1800   277.55017     -32116.502     -6610.9599      1.4594291      3472.1201    
      1900   280.92157     -32102.104      9202.6399      1.4594291      3472.1201    
      2000   307.11573     -32101.753      116.20385      1.4594291      3472.1201    
      2100   305.08759     -32091.137     -12364.991      1.4594291      3472.1201    
      2200   308.28848     -32090.484     -1403.0155      1.4594291      3472.1201    
      2300   299.7815      -32096.18      -5520.2003      1.4594291      3472.1201    
      2400   276.99221     -32103.336     -182.68893      1.4594291      3472.1201    
      2500   297.6149      -32109.136     -6067.0291      1.4594291      3472.1201    
      2600   286.07849     -32084.662     -13320.637      1.4594291      3472.1201    
      2700   294.26591     -32085.817     -18015.594      1.4594291      3472.1201    
      2800   293.27433     -32078.055      3017.0242      1.4594291      3472.1201    
      2900   317.16408     -32086.55      -3500.7757      1.4594291      3472.1201    
      3000   306.37671     -32097.539     -10991.979      1.4594291      3472.1201    
      3100   300.43746     -32118.663      2762.5083      1.4594291      3472.1201    
      3200   278.6533      -32095.072     -8571.2778      1.4594291      3472.1201    
      3300   298.1091      -32086.981     -3255.0224      1.4594291      3472.1201    
      3400   306.39528     -32079.743     -7771.5052      1.4594291      3472.1201    
      3500   304.39025     -32077.702     -3091.4903      1.4594291      3472.1201    
      3600   296.13769     -32086.277      15259.318      1.4594291      3472.1201    
      3700   284.57279     -32100.956     -1177.0531      1.4594291      3472.1201    
      3800   288.23337     -32099.44       7645.7381      1.4594291      3472.1201    
      3900   318.38715     -32116.877     -5710.3759      1.4594291      3472.1201    
      4000   336.51464     -32126.109     -7906.7897      1.4594291      3472.1201    
      4100   302.82099     -32090.633      3438.2376      1.4594291      3472.1201    
      4200   327.3051      -32087.068     -1051.7259      1.4594291      3472.1201    
      4300   317.98188     -32064.579     -6208.8639      1.4594291      3472.1201    
      4400   300.5292      -32065.508      4183.1165      1.4594291      3472.1201    
      4500   302.80382     -32101.25      -9144.2803      1.4594291      3472.1201    
      4600   290.84809     -32092.816     -1749.2891      1.4594291      3472.1201    
      4700   305.63033     -32089.494     -9713.5255      1.4594291      3472.1201    
      4800   308.17904     -32075.111     -11466.606      1.4594291      3472.1201    
      4900   300.7694      -32078.121     -1226.7812      1.4594291      3472.1201    
      5000   295.81451     -32109.606     -1504.7         1.4594291      3472.1201    
      5100   282.5224      -32100.566      1413.7526      1.4594291      3472.1201    
      5200   277.8821      -32080.85      -6040.3033      1.4594291      3472.1201    
      5300   303.71933     -32082.919     -20337.516      1.4594291      3472.1201    
      5400   312.08528     -32084.607      4310.3355      1.4594291      3472.1201    
      5500   296.80935     -32079.286      7211.4069      1.4594291      3472.1201    
      5600   288.44362     -32097.743     -278.81209      1.4594291      3472.1201    
      5700   285.70845     -32113.087     -15462.281      1.4594291      3472.1201    
      5800   305.24765     -32111.318     -9161.4952      1.4594291      3472.1201    
      5900   302.43533     -32090.277      3470.682       1.4594291      3472.1201    
      6000   307.85453     -32085.54      -4737.8093      1.4594291      3472.1201    
Loop time of 214.665 on 8 procs for 6000 steps with 274 atoms

Performance: 1.207 ns/day, 19.876 hours/ns, 27.951 timesteps/s, 7.658 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 118.93     | 141.35     | 180.67     | 192.9 | 65.85
Bond    | 0.014826   | 0.016785   | 0.02033    |   1.5 |  0.01
Neigh   | 9.4446     | 10.646     | 13.749     |  51.1 |  4.96
Comm    | 2.1931     | 41.522     | 63.914     | 355.9 | 19.34
Output  | 0.013711   | 0.015532   | 0.017213   |   1.0 |  0.01
Modify  | 17.884     | 21         | 22.197     |  36.6 |  9.78
Other   |            | 0.1176     |            |       |  0.05

Nlocal:          34.25 ave          42 max          21 min
Histogram: 1 0 1 1 0 0 0 2 0 3
Nghost:        2817.12 ave        2845 max        2793 min
Histogram: 2 0 0 1 2 1 0 0 0 2
Neighs:        18915.8 ave       23049 max       11841 min
Histogram: 1 0 1 1 0 0 0 2 0 3

Total # of neighbors = 151326
Ave neighs/atom = 552.28467
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.12842 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.03819     -32054.437     -17106.542      1.4594291      3472.1201    
       200   301.59758     -32086.148     -9997.9086      1.4594291      3472.1201    
       300   287.85434     -32090.451     -7281.3453      1.4594291      3472.1201    
       400   289.84499     -32093.039     -7822.0825      1.4594291      3472.1201    
       500   292.59558     -32086.544     -16949.756      1.4594291      3472.1201    
       600   289.04514     -32076.073     -3907.9982      1.4594291      3472.1201    
       700   307.17063     -32071.995      1530.5792      1.4594291      3472.1201    
       800   312.4972      -32070.858     -701.57616      1.4594291      3472.1201    
       900   295.5047      -32074.584     -2436.1483      1.4594291      3472.1201    
      1000   273.55151     -32081.238     -3731.2299      1.4594291      3472.1201    
      1100   303.2945      -32108.628      300.86568      1.4594291      3472.1201    
      1200   295.99369     -32085.79      -7784.6541      1.4594291      3472.1201    
      1300   325.03778     -32089.13      -17052.462      1.4594291      3472.1201    
      1400   299.66544     -32065.186     -11886.636      1.4594291      3472.1201    
      1500   323.71371     -32093.794     -981.28848      1.4594291      3472.1201    
      1600   298.47316     -32079.479     -5941.1192      1.4594291      3472.1201    
      1700   306.39788     -32087.362     -404.80958      1.4594291      3472.1201    
      1800   296.343       -32092.128      4195.8516      1.4594291      3472.1201    
      1900   278.30542     -32093.745      130.82705      1.4594291      3472.1201    
      2000   300.37418     -32111.445     -6986.7564      1.4594291      3472.1201    
      2100   301.92276     -32080.582      1521.3551      1.4594291      3472.1201    
      2200   305.5137      -32070.362     -15261.86       1.4594291      3472.1201    
      2300   298.22268     -32071.52       1477.7592      1.4594291      3472.1201    
      2400   304.67756     -32102.856     -4959.5786      1.4594291      3472.1201    
      2500   288.78804     -32099.702     -7976.4506      1.4594291      3472.1201    
      2600   278.76776     -32090.25      -5896.6994      1.4594291      3472.1201    
      2700   302.37812     -32098.146     -2022.6044      1.4594291      3472.1201    
      2800   299.80686     -32085.373     -5307.8504      1.4594291      3472.1201    
      2900   318.30163     -32076.983     -2214.9649      1.4594291      3472.1201    
      3000   337.28324     -32060.944     -5926.5401      1.4594291      3472.1201    
      3100   329.42856     -32066.664      1663.3167      1.4594291      3472.1201    
      3200   303.77929     -32074.812     -3991.0185      1.4594291      3472.1201    
      3300   303.9167      -32086.891     -3535.2753      1.4594291      3472.1201    
      3400   312.79522     -32108.171     -2709.6068      1.4594291      3472.1201    
      3500   302.91211     -32101.478      1733.9373      1.4594291      3472.1201    
      3600   307.72262     -32083.663      3315.7185      1.4594291      3472.1201    
      3700   320.21012     -32077.937     -6975.4201      1.4594291      3472.1201    
      3800   325.83251     -32094.578     -5529.8485      1.4594291      3472.1201    
      3900   287.89705     -32096.05      -1561.1146      1.4594291      3472.1201    
      4000   268.72883     -32084.303      4285.8245      1.4594291      3472.1201    
      4100   321.74788     -32106.048      953.06662      1.4594291      3472.1201    
      4200   321.76633     -32101.471     -6863.9709      1.4594291      3472.1201    
      4300   300.5277      -32099.938     -3069.4578      1.4594291      3472.1201    
      4400   311.61129     -32112.391     -10379.214      1.4594291      3472.1201    
      4500   309.37969     -32107.785      1325.6705      1.4594291      3472.1201    
      4600   316.85734     -32102.631     -3199.2603      1.4594291      3472.1201    
      4700   324.86743     -32091.598      8795.9631      1.4594291      3472.1201    
      4800   300.50959     -32093.366     -7053.6183      1.4594291      3472.1201    
      4900   288.8327      -32113.008     -5743.0078      1.4594291      3472.1201    
      5000   292.84219     -32126.276     -9775.6775      1.4594291      3472.1201    
      5100   279.3653      -32110.862     -1881.9505      1.4594291      3472.1201    
      5200   302.14948     -32106.591      2531.956       1.4594291      3472.1201    
      5300   304.89777     -32092.038     -4129.431       1.4594291      3472.1201    
      5400   286.37364     -32077.621     -12674.733      1.4594291      3472.1201    
      5500   274.14045     -32104.745     -11539.383      1.4594291      3472.1201    
      5600   293.07055     -32124.463     -12902.633      1.4594291      3472.1201    
      5700   295.88289     -32109.525     -9785.0351      1.4594291      3472.1201    
      5800   303.70161     -32100.51      -1747.6622      1.4594291      3472.1201    
      5900   321.2524      -32107.645     -2095.1666      1.4594291      3472.1201    
      6000   295.97468     -32121.894     -7377.0395      1.4594291      3472.1201    
Loop time of 206.208 on 8 procs for 6000 steps with 274 atoms

Performance: 1.257 ns/day, 19.093 hours/ns, 29.097 timesteps/s, 7.973 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 116.07     | 129.92     | 174.62     | 151.6 | 63.00
Bond    | 0.015178   | 0.016531   | 0.019988   |   1.2 |  0.01
Neigh   | 9.3763     | 10.011     | 13.36      |  40.3 |  4.85
Comm    | 1.5155     | 46.242     | 60.085     | 254.2 | 22.42
Output  | 0.01295    | 0.014833   | 0.016464   |   1.0 |  0.01
Modify  | 16.539     | 19.882     | 20.518     |  28.5 |  9.64
Other   |            | 0.1243     |            |       |  0.06

Nlocal:          34.25 ave          43 max          24 min
Histogram: 1 1 1 0 0 1 1 1 0 2
Nghost:        2829.62 ave        2849 max        2809 min
Histogram: 1 1 1 1 0 1 0 0 0 3
Neighs:        18928.2 ave       23538 max       13481 min
Histogram: 1 1 1 0 0 1 1 1 0 2

Total # of neighbors = 151426
Ave neighs/atom = 552.64964
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.3798)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.160755 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.02725     -32054.428     -17126.889      1.4594291      3472.1201    
       200   302.96051     -32086.962     -9977.8673      1.4594291      3472.1201    
       300   283.14117     -32086.999     -6099.7326      1.4594291      3472.1201    
       400   290.56017     -32093.881     -6858.4086      1.4594291      3472.1201    
       500   292.07406     -32087.724     -23265.849      1.4594291      3472.1201    
       600   300.13903     -32085.975     -5327.608       1.4594291      3472.1201    
       700   302.33284     -32069.62      -2748.9621      1.4594291      3472.1201    
       800   317.22155     -32084.607     -8975.9397      1.4594291      3472.1201    
       900   303.35239     -32100.394     -1167.4136      1.4594291      3472.1201    
      1000   307.51071     -32116.096     -10305.714      1.4594291      3472.1201    
      1100   294.36804     -32099.561     -9926.0085      1.4594291      3472.1201    
      1200   298.76551     -32081.627     -5023.9941      1.4594291      3472.1201    
      1300   320.09221     -32077.733     -10652.147      1.4594291      3472.1201    
      1400   311.80978     -32082.529     -2659.3715      1.4594291      3472.1201    
      1500   295.75624     -32080.656     -4110.2246      1.4594291      3472.1201    
      1600   308.24688     -32090.703     -7116.7445      1.4594291      3472.1201    
      1700   278.28417     -32074.062      853.72222      1.4594291      3472.1201    
      1800   283.3968      -32112.842      344.87883      1.4594291      3472.1201    
      1900   277.39115     -32106.522     -5579.52        1.4594291      3472.1201    
      2000   284.84917     -32090.716      3270.6458      1.4594291      3472.1201    
      2100   300.30067     -32087.203     -9145.2099      1.4594291      3472.1201    
      2200   309.0072      -32084.085     -4271.5368      1.4594291      3472.1201    
      2300   298.6955      -32084.955     -9256.4813      1.4594291      3472.1201    
      2400   270.56468     -32091.732     -4118.0442      1.4594291      3472.1201    
      2500   274.28387     -32095.547     -5089.9143      1.4594291      3472.1201    
      2600   282.49206     -32087.703     -13835.039      1.4594291      3472.1201    
      2700   306.43054     -32096.647      2942.5299      1.4594291      3472.1201    
      2800   289.65375     -32081.058      1010.6296      1.4594291      3472.1201    
      2900   303.44792     -32083.515     -6202.4262      1.4594291      3472.1201    
      3000   315.16274     -32074.884      10565.567      1.4594291      3472.1201    
      3100   313.16669     -32064.558     -13410.333      1.4594291      3472.1201    
      3200   301.67822     -32083.271     -7292.4868      1.4594291      3472.1201    
      3300   295.2308      -32093.491     -1350.2874      1.4594291      3472.1201    
      3400   292.73792     -32091.882     -8905.0433      1.4594291      3472.1201    
      3500   297.52276     -32089.112      6232.2915      1.4594291      3472.1201    
      3600   283.8358      -32062.413     -4789.3964      1.4594291      3472.1201    
      3700   318.71469     -32065.908     -15035.516      1.4594291      3472.1201    
      3800   308.66492     -32067.519     -14160.056      1.4594291      3472.1201    
      3900   299.41797     -32084.262     -4115.8831      1.4594291      3472.1201    
      4000   299.96862     -32093.485     -5027.8124      1.4594291      3472.1201    
      4100   302.2759      -32092.83      -5138.4266      1.4594291      3472.1201    
      4200   313.92852     -32093.996     -2792.6033      1.4594291      3472.1201    
      4300   318.33706     -32099.361     -8645.7042      1.4594291      3472.1201    
      4400   293.84531     -32105.942      2810.592       1.4594291      3472.1201    
      4500   293.53983     -32119.402      1727.7056      1.4594291      3472.1201    
      4600   278.3629      -32099.952     -7413.1485      1.4594291      3472.1201    
      4700   315.00829     -32102.109     -14305.443      1.4594291      3472.1201    
      4800   299.96645     -32078.698     -16625.621      1.4594291      3472.1201    
      4900   300.27284     -32087.109     -12201.491      1.4594291      3472.1201    
      5000   294.77357     -32094.539     -11327.842      1.4594291      3472.1201    
      5100   299.09342     -32095.591      2067.6922      1.4594291      3472.1201    
      5200   316.95454     -32101.919     -9089.9063      1.4594291      3472.1201    
      5300   325.91687     -32076.047     -13041.524      1.4594291      3472.1201    
      5400   312.60124     -32073.613     -2471.2361      1.4594291      3472.1201    
      5500   278.00154     -32075.257     -5785.3856      1.4594291      3472.1201    
      5600   291.67904     -32091.919     -2842.0156      1.4594291      3472.1201    
      5700   303.75113     -32098.689     -2752.0451      1.4594291      3472.1201    
      5800   323.43868     -32101.86      -4659.9008      1.4594291      3472.1201    
      5900   325.67493     -32089.161     -11176.566      1.4594291      3472.1201    
      6000   321.55655     -32094.566     -15469.132      1.4594291      3472.1201    
Loop time of 210.999 on 8 procs for 6000 steps with 274 atoms

Performance: 1.228 ns/day, 19.537 hours/ns, 28.436 timesteps/s, 7.792 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 118.35     | 133.47     | 179.13     | 155.3 | 63.25
Bond    | 0.01503    | 0.016976   | 0.020536   |   1.5 |  0.01
Neigh   | 9.4788     | 10.138     | 13.523     |  41.4 |  4.80
Comm    | 1.5267     | 47.218     | 62.335     | 261.2 | 22.38
Output  | 0.012343   | 0.01413    | 0.015766   |   1.0 |  0.01
Modify  | 16.649     | 20.027     | 20.687     |  29.5 |  9.49
Other   |            | 0.1195     |            |       |  0.06

Nlocal:          34.25 ave          45 max          22 min
Histogram: 1 1 1 0 0 1 1 1 0 2
Nghost:        2819.25 ave        2842 max        2805 min
Histogram: 2 2 0 1 1 0 0 0 0 2
Neighs:        18911.1 ave       24569 max       12446 min
Histogram: 1 1 1 0 0 1 1 1 0 2

Total # of neighbors = 151289
Ave neighs/atom = 552.14964
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.160755 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 6000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   332.32223     -32090.501     -1939.7632      1.4594291      3472.1201    
       100   282.02905     -32054.429     -17100.406      1.4594291      3472.1201    
       200   302.49979     -32086.888     -10396.628      1.4594291      3472.1201    
       300   289.06641     -32092.008     -3586.202       1.4594291      3472.1201    
       400   290.80055     -32093.568     -5070.0959      1.4594291      3472.1201    
       500   296.38267     -32090.179     -17812.127      1.4594291      3472.1201    
       600   306.04224     -32089.9       -1999.3679      1.4594291      3472.1201    
       700   300.98058     -32068.243      4026.5054      1.4594291      3472.1201    
       800   322.97942     -32086.754     -12528.111      1.4594291      3472.1201    
       900   297.54542     -32092.85      -9552.7644      1.4594291      3472.1201    
      1000   308.07375     -32113.377     -999.03126      1.4594291      3472.1201    
      1100   291.87079     -32100.07      -4811.3805      1.4594291      3472.1201    
      1200   308.63236     -32091.362     -2766.2176      1.4594291      3472.1201    
      1300   306.87377     -32071.262     -1579.7004      1.4594291      3472.1201    
      1400   308.81461     -32073.608     -10157.74       1.4594291      3472.1201    
      1500   315.02287     -32093.502     -860.76206      1.4594291      3472.1201    
      1600   310.19013     -32092.771     -393.4693       1.4594291      3472.1201    
      1700   314.5946      -32097.89       428.69787      1.4594291      3472.1201    
      1800   299.12658     -32090.128     -13458.557      1.4594291      3472.1201    
      1900   295.94519     -32087.789     -13151.427      1.4594291      3472.1201    
      2000   307.63386     -32084.707     -8421.7474      1.4594291      3472.1201    
      2100   321.7973      -32085.439      2560.8196      1.4594291      3472.1201    
      2200   310.66187     -32082.048      717.94933      1.4594291      3472.1201    
      2300   275.50408     -32078.642      3631.6429      1.4594291      3472.1201    
      2400   275.39779     -32089.081     -969.3807       1.4594291      3472.1201    
      2500   299.02583     -32097.687     -1070.1006      1.4594291      3472.1201    
      2600   292.28509     -32074.645     -10849.512      1.4594291      3472.1201    
      2700   306.55698     -32085.018     -6574.4544      1.4594291      3472.1201    
      2800   305.69918     -32088.079      2960.1997      1.4594291      3472.1201    
      2900   292.85185     -32087.236      1609.0341      1.4594291      3472.1201    
      3000   278.53178     -32098.99       1432.1432      1.4594291      3472.1201    
      3100   293.32222     -32110.828     -6598.9644      1.4594291      3472.1201    
      3200   290.52287     -32077.837     -12729.084      1.4594291      3472.1201    
      3300   317.64176     -32092.062      668.30168      1.4594291      3472.1201    
      3400   301.05085     -32081.672     -8329.0921      1.4594291      3472.1201    
      3500   296.88686     -32085.161     -4307.0908      1.4594291      3472.1201    
      3600   301.41726     -32084.085     -8601.3861      1.4594291      3472.1201    
      3700   329.67447     -32096.523      2118.6915      1.4594291      3472.1201    
      3800   305.20479     -32076.886      95.747974      1.4594291      3472.1201    
      3900   312.04182     -32104.574     -5514.1672      1.4594291      3472.1201    
      4000   282.99227     -32103.821     -4034.7668      1.4594291      3472.1201    
      4100   280.10939     -32097.883     -1397.8023      1.4594291      3472.1201    
      4200   302.95798     -32095.829     -2387.3612      1.4594291      3472.1201    
      4300   318.11667     -32092.237     -16594.965      1.4594291      3472.1201    
      4400   308.66055     -32092.813     -541.99416      1.4594291      3472.1201    
      4500   294.63826     -32094.298     -8498.1264      1.4594291      3472.1201    
      4600   294.5316      -32104.751     -9377.935       1.4594291      3472.1201    
      4700   285.7314      -32102.394     -12385.464      1.4594291      3472.1201    
      4800   319.66555     -32111.586      3840.1875      1.4594291      3472.1201    
      4900   316.71238     -32074.33      -4004.9689      1.4594291      3472.1201    
      5000   296.48718     -32063.856     -8898.4529      1.4594291      3472.1201    
      5100   326.77808     -32103.041      3811.8787      1.4594291      3472.1201    
      5200   289.18019     -32090.224     -1638.7219      1.4594291      3472.1201    
      5300   275.30995     -32081.506     -6225.4689      1.4594291      3472.1201    
      5400   293.04757     -32095.251     -2248.3702      1.4594291      3472.1201    
      5500   300.74846     -32101.125     -3631.1814      1.4594291      3472.1201    
      5600   298.70838     -32100.941      953.13153      1.4594291      3472.1201    
      5700   300.40994     -32099.315      4493.5142      1.4594291      3472.1201    
      5800   306.81442     -32109.311      7988.4591      1.4594291      3472.1201    
      5900   286.87528     -32103.071     -9523.3811      1.4594291      3472.1201    
      6000   287.50156     -32116.949     -10192.226      1.4594291      3472.1201    
Loop time of 210.5 on 8 procs for 6000 steps with 274 atoms

Performance: 1.231 ns/day, 19.491 hours/ns, 28.504 timesteps/s, 7.810 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 119.42     | 131.83     | 179.02     | 157.8 | 62.63
Bond    | 0.015059   | 0.017025   | 0.020223   |   1.4 |  0.01
Neigh   | 9.3767     | 9.9405     | 13.494     |  42.6 |  4.72
Comm    | 1.461      | 48.694     | 61.107     | 260.0 | 23.13
Output  | 0.012154   | 0.013941   | 0.015516   |   1.0 |  0.01
Modify  | 16.354     | 19.88      | 20.448     |  29.9 |  9.44
Other   |            | 0.1234     |            |       |  0.06

Nlocal:          34.25 ave          45 max          19 min
Histogram: 1 0 0 2 0 0 2 1 1 1
Nghost:           2808 ave        2831 max        2794 min
Histogram: 3 0 0 1 0 3 0 0 0 1
Neighs:        18918.1 ave       24486 max       10729 min
Histogram: 1 0 0 2 0 0 0 3 0 2

Total # of neighbors = 151345
Ave neighs/atom = 552.35401
Ave special neighs/atom = 0
Neighbor list builds = 600
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:48:48
