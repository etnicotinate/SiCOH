LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333SiCOH
read_data       ${structure}.data
read_data       333SiCOH.data
Reading data file ...
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.014 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              332.6584       3235.7085    
         1   300            0              0              332.6584       3235.7085    
Loop time of 0.000101121 on 8 procs for 1 steps with 373 atoms

57.4% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.537e-06  | 2.7417e-06 | 3.702e-06  |   0.0 |  2.71
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 2.793e-06  | 6.7656e-06 | 9.429e-06  |   0.0 |  6.69
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 9.161e-05  |            |       | 90.60

Nlocal:         46.625 ave          55 max          38 min
Histogram: 2 0 0 2 0 0 0 2 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = 39.36 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 123.1 | 123.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -37805.726      120410.25      0              1.1428982      4699.6115    
       100   903.04092     -39179.581     -28649.235     -9792.4337      1.1428982      4699.6115    
       200   651.54509     -39633.63      -16474.908     -9178.1277      1.1428982      4699.6115    
       300   531.14314     -39954.318     -824.25296      925.97749      1.1428982      4699.6115    
       400   376.67395     -40083.235      6915.4492     -5459.9373      1.1428982      4699.6115    
       500   324.42538     -40213.574      2669.6096     -377.7467       1.1428982      4699.6115    
       600   300.76819     -40311.14      -1810.0617     -4140.8544      1.1428982      4699.6115    
       700   281.72264     -40367.996     -2349.1868     -3475.9704      1.1428982      4699.6115    
       800   268.37001     -40371.69       1898.4375     -1620.8598      1.1428982      4699.6115    
       900   294.17996     -40367.959     -11183.084     -4091.1805      1.1428982      4699.6115    
      1000   343.75483     -40372.467     -542.96193     -2247.5154      1.1428982      4699.6115    
      1100   328.9223      -40354.056     -9308.1225     -3182.1826      1.1428982      4699.6115    
      1200   305.68736     -40363.235      6435.1285     -3051.8267      1.1428982      4699.6115    
      1300   294.51427     -40394.567      948.64458     -2956.7914      1.1428982      4699.6115    
      1400   289.13804     -40430.091     -6449.2616     -3414.9335      1.1428982      4699.6115    
      1500   275.57473     -40440.729     -4342.4294     -3572.1092      1.1428982      4699.6115    
      1600   287.09849     -40435.242      3166.2204     -4688.9169      1.1428982      4699.6115    
      1700   310.08056     -40420.722      92.799466     -3731.3702      1.1428982      4699.6115    
      1800   315.7728      -40422.46      -4416.3968     -1859.2642      1.1428982      4699.6115    
      1900   311.06666     -40457.401      1745.9021     -3375.2609      1.1428982      4699.6115    
      2000   294.19945     -40475.217     -2480.3365      504.58325      1.1428982      4699.6115    
Loop time of 43.2705 on 8 procs for 2000 steps with 373 atoms

Performance: 1.997 ns/day, 12.020 hours/ns, 46.221 timesteps/s, 17.240 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.588     | 31.946     | 33.227     |  14.5 | 73.83
Bond    | 0.0034215  | 0.003539   | 0.0036791  |   0.1 |  0.01
Neigh   | 3.9008     | 3.9131     | 3.9275     |   0.5 |  9.04
Comm    | 0.51403    | 1.7937     | 3.1521     |  61.3 |  4.15
Output  | 0.00067208 | 0.00073643 | 0.0010626  |   0.0 |  0.00
Modify  | 5.5601     | 5.5741     | 5.5868     |   0.4 | 12.88
Other   |            | 0.03925    |            |       |  0.09

Nlocal:         46.625 ave          54 max          35 min
Histogram: 1 0 0 0 2 2 0 0 1 2
Nghost:        3242.75 ave        3312 max        3188 min
Histogram: 2 0 0 1 1 2 1 0 0 1
Neighs:        25675.8 ave       29569 max       19588 min
Histogram: 1 0 0 0 2 2 0 0 1 2

Total # of neighbors = 205406
Ave neighs/atom = 550.68633
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333SiCOH_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 19.0492
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.0575
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.55

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-504.5832513659)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-504.5832513659)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2132.48321742359)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2132.48321742359)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3270.12669728435)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3270.12669728435)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1494.22124125237)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1494.22124125237)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--767.303950747086)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--767.303950747086)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-150.532010756433)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-150.532010756433)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 19.0492
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*19.0492
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.190492 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.190492 xy delta 0.107944 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.190492 xy delta 0.107944 xz delta -0.013894 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (18.858708 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (18.858708 14.0575 17.55) with tilt (-10.686456 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (18.858708 14.0575 17.55) with tilt (-10.686456 1.375506 -3.3406)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.9 | 126.5 | 128.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40460.791      29405.965      0              4652.6153    
       100   308.8194      -40495.719     -4718.6587     -2389.1521      4652.6153    
       200   287.17874     -40468.408     -358.85927     -493.42378      4652.6153    
       300   296.15915     -40460.297      1504.2393     -5250.7488      4652.6153    
       400   320.42553     -40481.561     -3046.9765     -1398.7263      4652.6153    
       500   301.15081     -40474.306     -8704.917      -7250.9273      4652.6153    
       600   292.17416     -40480.937     -9910.461      -4556.4205      4652.6153    
       700   283.60901     -40474.103     -6000.6758     -6794.2855      4652.6153    
       800   311.43277     -40505.357     -7819.4876     -7727.0721      4652.6153    
       900   308.83851     -40513.921      1898.5502     -4388.0207      4652.6153    
      1000   304.74791     -40530.152     -187.2155      -5279.0919      4652.6153    
      1100   277.21785     -40511.056     -10496.424     -7218.7068      4652.6153    
      1200   303.9752      -40526.72      -4198.6113     -2350.5162      4652.6153    
      1300   314.92254     -40516.191     -11339.24      -3563.1482      4652.6153    
      1400   305.29476     -40501.586     -2829.4172     -719.33341      4652.6153    
      1500   301.8167      -40511.69      -2094.4371     -3806.86        4652.6153    
      1600   299.86104     -40532.62      -13895.791     -4582.3431      4652.6153    
      1700   297.70516     -40553.749     -5420.9748      2120.0895      4652.6153    
      1800   279.62007     -40536.016     -13551.48      -6011.2607      4652.6153    
      1900   309.22037     -40551.114      1976.1        -4375.1854      4652.6153    
      2000   318.14244     -40539.036     -1940.324      -5326.8653      4652.6153    
Loop time of 44.9758 on 8 procs for 2000 steps with 373 atoms

Performance: 1.921 ns/day, 12.493 hours/ns, 44.468 timesteps/s, 16.587 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.935     | 33.376     | 34.875     |  17.7 | 74.21
Bond    | 0.0034693  | 0.0036145  | 0.0036866  |   0.1 |  0.01
Neigh   | 3.9346     | 3.9938     | 4.0577     |   2.0 |  8.88
Comm    | 0.49518    | 1.9945     | 3.435      |  72.6 |  4.43
Output  | 0.003216   | 0.0043082  | 0.0050258  |   1.0 |  0.01
Modify  | 5.4992     | 5.5639     | 5.6239     |   1.8 | 12.37
Other   |            | 0.03945    |            |       |  0.09

Nlocal:         46.625 ave          55 max          40 min
Histogram: 1 1 2 0 1 0 0 1 1 1
Nghost:         3274.5 ave        3344 max        3211 min
Histogram: 2 0 2 0 0 0 1 1 1 1
Neighs:        25993.1 ave       30406 max       22540 min
Histogram: 1 1 2 0 1 0 1 1 0 1

Total # of neighbors = 207945
Ave neighs/atom = 557.4933
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124 | 126.5 | 128.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   318.14244     -40539.036     -1940.3259      0              4652.6153    
       100   326.69692     -40554.863     -3656.8576     -6428.5646      4652.6153    
       200   267.01623     -40526.208     -6690.1354     -5548.9272      4652.6153    
       300   303.3535      -40570.746      4827.6854     -4445.8543      4652.6153    
       400   307.32674     -40581.894      1095.513      -3693.6887      4652.6153    
       500   287.74711     -40566.932     -361.06228      238.6516       4652.6153    
       600   297.08047     -40576.181      2023.5419     -3056.9345      4652.6153    
       700   300.08491     -40550.562     -2283.4501     -834.9705       4652.6153    
       800   315.71966     -40550.595     -3543.2626     -957.56909      4652.6153    
       900   288.29765     -40531.195     -10624.564     -5211.3179      4652.6153    
      1000   298.79485     -40563.903     -4910.7955     -2083.2488      4652.6153    
      1100   276.32058     -40572.237     -2558.9575     -2971.6478      4652.6153    
      1200   286.80232     -40572.74      -2378.0354     -5422.4599      4652.6153    
      1300   307.52733     -40577.802     -8374.7857     -2103.9112      4652.6153    
      1400   306.42979     -40560.684     -3327.6983     -204.73768      4652.6153    
      1500   303.67168     -40544.965     -10942.626     -5714.5172      4652.6153    
      1600   311.57088     -40565.783      3688.446      -4034.3589      4652.6153    
      1700   278.50752     -40570.016     -5874.9986     -1320.5788      4652.6153    
      1800   287.14875     -40583.503     -11731.429     -4452.2246      4652.6153    
      1900   290.09022     -40568.704     -3381.3016     -1484.0818      4652.6153    
      2000   304.23483     -40567.814     -4638.6304     -3629.5705      4652.6153    
Loop time of 46.2895 on 8 procs for 2000 steps with 373 atoms

Performance: 1.867 ns/day, 12.858 hours/ns, 43.206 timesteps/s, 16.116 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 33.054     | 34.574     | 36.192     |  16.7 | 74.69
Bond    | 0.0036812  | 0.0038266  | 0.0039775  |   0.2 |  0.01
Neigh   | 3.8944     | 3.987      | 4.102      |   3.1 |  8.61
Comm    | 0.45356    | 2.0712     | 3.591      |  68.2 |  4.47
Output  | 0.00060657 | 0.00066451 | 0.0009606  |   0.0 |  0.00
Modify  | 5.4975     | 5.6132     | 5.7066     |   2.6 | 12.13
Other   |            | 0.03989    |            |       |  0.09

Nlocal:         46.625 ave          52 max          39 min
Histogram: 1 0 1 1 0 0 1 2 0 2
Nghost:        3249.75 ave        3312 max        3192 min
Histogram: 1 1 0 2 0 1 1 0 1 1
Neighs:        26002.5 ave       28964 max       21972 min
Histogram: 1 0 1 1 0 0 1 2 0 2

Total # of neighbors = 208020
Ave neighs/atom = 557.69437
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -41.8893133247099
variable C2neg equal ${d2}
variable C2neg equal -61.4974690866043
variable C3neg equal ${d3}
variable C3neg equal -93.7320105913785
variable C4neg equal ${d4}
variable C4neg equal -26.0609870759399
variable C5neg equal ${d5}
variable C5neg equal 1.29787072744965
variable C6neg equal ${d6}
variable C6neg equal -13.5639845897878

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*19.0492
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.190492 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.190492 xy delta -0.107944 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.190492 xy delta -0.107944 xz delta 0.013894 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.239692 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.239692 14.0575 17.55) with tilt (-10.902344 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.239692 14.0575 17.55) with tilt (-10.902344 1.403294 -3.3406)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124.6 | 127.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40455.811     -37865.079      0              4746.6076    
       100   309.24444     -40490.285     -8233.3085     -4035.4853      4746.6076    
       200   289.07296     -40465.689     -9661.744      -4791.2873      4746.6076    
       300   313.6377      -40473.35      -9531.9092     -4092.2168      4746.6076    
       400   311.69391     -40464.54      -1576.6784     -2937.5615      4746.6076    
       500   294.38077     -40460.527     -6214.3316     -6474.9923      4746.6076    
       600   291.58074     -40469.018     -2402.32       -5052.6424      4746.6076    
       700   305.41447     -40474.271     -2919.1166     -5553.6372      4746.6076    
       800   306.84503     -40461.328     -5655.3873     -3254.0943      4746.6076    
       900   298.9809      -40455.074     -1093.8038     -2745.5425      4746.6076    
      1000   302.5376      -40475.373     -3442.5468     -5131.3618      4746.6076    
      1100   293.94779     -40491.029     -9386.0009     -4768.9771      4746.6076    
      1200   289.84081     -40496.405     -2677.7988     -951.70066      4746.6076    
      1300   323.90783     -40524.167     -8391.9752     -6100.4288      4746.6076    
      1400   318.4955      -40516.861     -3047.1486     -5600.5055      4746.6076    
      1500   291.76821     -40510.906     -2306.9991     -1458.0137      4746.6076    
      1600   277.78099     -40515.769     -6765.064      -7526.9907      4746.6076    
      1700   283.10836     -40524.58      -11524.193     -4494.2756      4746.6076    
      1800   284.75849     -40510.374     -5292.0737     -751.53798      4746.6076    
      1900   323.36841     -40536.219     -13223.51      -4636.7435      4746.6076    
      2000   313.662       -40529.399     -8731.4834     -6586.6668      4746.6076    
Loop time of 43.6313 on 8 procs for 2000 steps with 373 atoms

Performance: 1.980 ns/day, 12.120 hours/ns, 45.839 timesteps/s, 17.098 katom-step/s
98.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.111     | 32.368     | 33.672     |  15.8 | 74.18
Bond    | 0.0034952  | 0.0035878  | 0.0037277  |   0.1 |  0.01
Neigh   | 3.8569     | 3.9138     | 4.015      |   2.6 |  8.97
Comm    | 0.46664    | 1.772      | 3.028      |  67.4 |  4.06
Output  | 0.0030111  | 0.00397    | 0.0046265  |   0.9 |  0.01
Modify  | 5.4295     | 5.5314     | 5.5893     |   2.2 | 12.68
Other   |            | 0.03888    |            |       |  0.09

Nlocal:         46.625 ave          53 max          39 min
Histogram: 1 0 1 0 0 3 0 2 0 1
Nghost:        3218.62 ave        3272 max        3173 min
Histogram: 2 1 1 0 0 0 2 0 1 1
Neighs:        25388.9 ave       28382 max       21549 min
Histogram: 1 0 0 1 2 0 1 1 1 1

Total # of neighbors = 203111
Ave neighs/atom = 544.53351
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.8 | 127.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   313.662       -40529.399     -8731.4827      0              4746.6076    
       100   291.24911     -40513.475     -8973.4253     -1154.728       4746.6076    
       200   312.92445     -40570.103     -9579.8491     -2335.7989      4746.6076    
       300   280.13111     -40555.652     -5099.2872      79.765675      4746.6076    
       400   294.97535     -40558.922     -5493.9704     -2559.3097      4746.6076    
       500   313.38885     -40566.803     -3456.6152      3048.3521      4746.6076    
       600   302.22047     -40566.723     -11637.048     -4440.4866      4746.6076    
       700   296.81825     -40594.769     -6956.1224     -9719.2722      4746.6076    
       800   290.29306     -40591.479     -13653.993     -6845.4934      4746.6076    
       900   290.85528     -40576.985     -8081.7668     -1927.4308      4746.6076    
      1000   287.56107     -40557.416     -11585.573     -7078.055       4746.6076    
      1100   310.52088     -40579.332     -4397.3431     -475.87746      4746.6076    
      1200   283.57136     -40565.269     -3375.5741     -3274.9124      4746.6076    
      1300   290.60498     -40594.827      5413.9211     -3995.6075      4746.6076    
      1400   273.24487     -40603.217     -10687.892     -7513.8558      4746.6076    
      1500   294.00966     -40604.158     -5758.6937     -1528.2389      4746.6076    
      1600   305.57493     -40594.113     -16346.263     -1334.659       4746.6076    
      1700   295.88576     -40576.112     -3951.4641     -5812.6638      4746.6076    
      1800   304.97108     -40577.789     -10649.884     -5128.9171      4746.6076    
      1900   310.75586     -40575.726     -2974.7098     -7450.0393      4746.6076    
      2000   307.20681     -40592.599     -7492.0531     -4379.9529      4746.6076    
Loop time of 43.7278 on 8 procs for 2000 steps with 373 atoms

Performance: 1.976 ns/day, 12.147 hours/ns, 45.737 timesteps/s, 17.060 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.251     | 32.51      | 33.717     |  15.0 | 74.35
Bond    | 0.0035274  | 0.0036062  | 0.0036798  |   0.1 |  0.01
Neigh   | 3.8258     | 3.9012     | 3.9844     |   2.8 |  8.92
Comm    | 0.49702    | 1.7042     | 2.9623     |  65.5 |  3.90
Output  | 0.00051571 | 0.00056429 | 0.00083942 |   0.0 |  0.00
Modify  | 5.4849     | 5.5694     | 5.6459     |   2.4 | 12.74
Other   |            | 0.03896    |            |       |  0.09

Nlocal:         46.625 ave          55 max          41 min
Histogram: 2 1 1 1 0 0 1 1 0 1
Nghost:        3217.88 ave        3287 max        3162 min
Histogram: 2 1 1 0 0 0 2 1 0 1
Neighs:        25381.5 ave       29415 max       22710 min
Histogram: 2 1 1 1 0 0 2 0 0 1

Total # of neighbors = 203052
Ave neighs/atom = 544.37534
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 49.4925625283922
variable C2pos equal ${d2}
variable C2pos equal 72.5841743497618
variable C3pos equal ${d3}
variable C3pos equal 72.3326555743075
variable C4pos equal ${d4}
variable C4pos equal 13.0573193257564
variable C5pos equal ${d5}
variable C5pos equal -4.9529139850513
variable C6pos equal ${d6}
variable C6pos equal 4.5017116106956

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-41.8893133247099+${C1pos})
variable C11 equal 0.5*(-41.8893133247099+49.4925625283922)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-61.4974690866043+${C2pos})
variable C21 equal 0.5*(-61.4974690866043+72.5841743497618)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-93.7320105913785+${C3pos})
variable C31 equal 0.5*(-93.7320105913785+72.3326555743075)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-26.0609870759399+${C4pos})
variable C41 equal 0.5*(-26.0609870759399+13.0573193257564)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(1.29787072744965+${C5pos})
variable C51 equal 0.5*(1.29787072744965+-4.9529139850513)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-13.5639845897878+${C6pos})
variable C61 equal 0.5*(-13.5639845897878+4.5017116106956)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.0575
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.0575
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.140575 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.140575 yz delta 0.033406 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 13.916925 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 13.916925 17.55) with tilt (-10.7944 1.3894 -3.307194)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.8 | 126.7 | 128.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40466.86       29955.669      0              4652.6153    
       100   308.68608     -40498.707     -10691.293     -3842.4023      4652.6153    
       200   288.17686     -40468.058     -5688.5056     -1715.1652      4652.6153    
       300   317.5867      -40477.501     -3923.3342     -4123.4938      4652.6153    
       400   309.71239     -40471.498     -7323.7518     -2534.0803      4652.6153    
       500   295.57331     -40486.057     -10297.145     -6334.5535      4652.6153    
       600   278.35827     -40489.08       794.81742     -4712.2885      4652.6153    
       700   291.39851     -40491.575     -7347.2968     -5670.4316      4652.6153    
       800   311.00511     -40484.364      801.23676     -3845.0153      4652.6153    
       900   314.54457     -40464.772     -10612.472     -4900.1213      4652.6153    
      1000   310.79826     -40475.351     -7159.2915     -8635.3207      4652.6153    
      1100   311.13541     -40520.361     -10212.765     -6901.4467      4652.6153    
      1200   280.6528      -40530.768     -15156.72      -8173.3736      4652.6153    
      1300   284.7901      -40544.033     -11520.836     -8174.4672      4652.6153    
      1400   296.0659      -40529.457      4357.1311     -4969.3091      4652.6153    
      1500   309.87157     -40502.602      2195.6478     -5561.195       4652.6153    
      1600   320.10974     -40497.47      -6811.6686     -8781.5289      4652.6153    
      1700   298.66539     -40503.664     -1596.8787     -4403.343       4652.6153    
      1800   291.88246     -40527.595     -11962.466     -6542.4817      4652.6153    
      1900   297.18424     -40547.316     -8842.0756     -4851.5638      4652.6153    
      2000   296.2393      -40545.015     -5487.6239     -673.44505      4652.6153    
Loop time of 44.8713 on 8 procs for 2000 steps with 373 atoms

Performance: 1.926 ns/day, 12.464 hours/ns, 44.572 timesteps/s, 16.625 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.927     | 33.219     | 34.721     |  17.6 | 74.03
Bond    | 0.0033392  | 0.0035379  | 0.0036458  |   0.1 |  0.01
Neigh   | 3.9122     | 3.9937     | 4.0487     |   2.3 |  8.90
Comm    | 0.48562    | 1.9865     | 3.2793     |  72.0 |  4.43
Output  | 0.0030602  | 0.0039848  | 0.0046454  |   0.9 |  0.01
Modify  | 5.568      | 5.625      | 5.7085     |   2.0 | 12.54
Other   |            | 0.03932    |            |       |  0.09

Nlocal:         46.625 ave          55 max          38 min
Histogram: 1 1 0 0 3 0 0 1 0 2
Nghost:        3243.38 ave        3299 max        3194 min
Histogram: 2 0 1 0 1 0 2 1 0 1
Neighs:        25972.9 ave       30064 max       21550 min
Histogram: 1 1 0 0 3 0 0 0 1 2

Total # of neighbors = 207783
Ave neighs/atom = 557.05898
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.9 | 126.7 | 128.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.2393      -40545.015     -5487.6142      0              4652.6153    
       100   305.46729     -40541.683     -1677.2901     -3528.3931      4652.6153    
       200   308.12518     -40519.593     -4374.3558     -5789.6621      4652.6153    
       300   320.47204     -40510.759     -13153.407     -6595.9657      4652.6153    
       400   310.33841     -40500.472      521.38104     -3847.3394      4652.6153    
       500   324.25119     -40556.762     -3994.8303     -2823.5738      4652.6153    
       600   296.891       -40547.044     -2396.852      -6295.4097      4652.6153    
       700   305.96631     -40556.788     -6231.0016     -11416.846      4652.6153    
       800   289.96572     -40531.185     -6193.2934     -4229.1021      4652.6153    
       900   297.1975      -40524.825      1641.7665     -4374.0589      4652.6153    
      1000   312.35935     -40543.39      -15322.014     -7770.3947      4652.6153    
      1100   299.39988     -40567.43      -14545.506     -9793.5767      4652.6153    
      1200   291.65564     -40580.743     -3586.4368      2607.9868      4652.6153    
      1300   314.08766     -40608.219     -4351.3201     -1696.4266      4652.6153    
      1400   296.38922     -40589.818     -9423.5794     -9870.5594      4652.6153    
      1500   307.03261     -40582.373     -8194.1101     -9373.6194      4652.6153    
      1600   321.26493     -40579.105     -17390.273     -7119.2051      4652.6153    
      1700   309.39625     -40584.054     -1694.761      -5821.81        4652.6153    
      1800   295.27417     -40604.216     -8941.3639     -4228.7456      4652.6153    
      1900   295.74724     -40608.445      337.13186     -4344.6362      4652.6153    
      2000   300.67656     -40606.225     -8005.7664     -7502.0988      4652.6153    
Loop time of 46.5225 on 8 procs for 2000 steps with 373 atoms

Performance: 1.857 ns/day, 12.923 hours/ns, 42.990 timesteps/s, 16.035 katom-step/s
98.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 33.067     | 34.72      | 36.204     |  16.4 | 74.63
Bond    | 0.0035574  | 0.0037633  | 0.0038984  |   0.2 |  0.01
Neigh   | 3.9008     | 4.0002     | 4.2052     |   4.6 |  8.60
Comm    | 0.59746    | 2.0792     | 3.7314     |  67.1 |  4.47
Output  | 0.00056795 | 0.00065061 | 0.0009173  |   0.0 |  0.00
Modify  | 5.4712     | 5.6789     | 5.7784     |   3.9 | 12.21
Other   |            | 0.03974    |            |       |  0.09

Nlocal:         46.625 ave          53 max          39 min
Histogram: 1 0 0 0 3 1 1 0 0 2
Nghost:         3235.5 ave        3296 max        3186 min
Histogram: 1 1 0 2 1 0 2 0 0 1
Neighs:        25983.8 ave       29088 max       21930 min
Histogram: 1 0 0 0 3 1 1 0 0 2

Total # of neighbors = 207870
Ave neighs/atom = 557.29223
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -81.1277058450496
variable C2neg equal ${d2}
variable C2neg equal -18.8660531227046
variable C3neg equal ${d3}
variable C3neg equal -129.992383267196
variable C4neg equal ${d4}
variable C4neg equal -19.4979072106402
variable C5neg equal ${d5}
variable C5neg equal -0.712715489167099
variable C6neg equal ${d6}
variable C6neg equal -4.97272059071943

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.0575
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.140575 yz delta ${deltayz} remap units box
change_box all y delta 0 0.140575 yz delta -0.033406 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.198075 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.198075 17.55) with tilt (-10.7944 1.3894 -3.374006)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.2 | 124.3 | 126.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40450.664     -37060.242      0              4746.6076    
       100   310.46101     -40488.59      -6582.4924     -3062.7252      4746.6076    
       200   283.69054     -40458.677     -4052.5126     -3490.3693      4746.6076    
       300   293.8192      -40452.408     -12713.697     -2941.7006      4746.6076    
       400   313.85768     -40463.527      3660.9499     -2453.3416      4746.6076    
       500   304.77764     -40457.113     -2685.1609     -7967.6985      4746.6076    
       600   303.88822     -40466.516     -1597.4982     -4067.6877      4746.6076    
       700   288.23143     -40471.801     -11239.401     -2235.6019      4746.6076    
       800   293.77111     -40497.621      244.81583     -3100.29        4746.6076    
       900   295.8111      -40498.128     -2676.6512     -654.79855      4746.6076    
      1000   305.75004     -40501.557     -7691.0777     -4198.6998      4746.6076    
      1100   296.74311     -40492.566     -1536.0264     -7036.1496      4746.6076    
      1200   285.49927     -40494.431     -7308.3254     -5239.5913      4746.6076    
      1300   306.63924     -40541.419     -3254.0074     -6072.8096      4746.6076    
      1400   298.8826      -40556.094     -2697.0499     -931.53867      4746.6076    
      1500   300.46106     -40570.054     -7112.598      -3616.586       4746.6076    
      1600   294.65668     -40558.975     -14585.53      -4362.4061      4746.6076    
      1700   310.75601     -40555.323      1957.2308     -6332.5991      4746.6076    
      1800   308.60791     -40535.054     -480.30762     -7475.3531      4746.6076    
      1900   299.2023      -40538.506     -9188.5982     -3847.4373      4746.6076    
      2000   283.91394     -40545.091     -2357.9616     -4190.8833      4746.6076    
Loop time of 43.3912 on 8 procs for 2000 steps with 373 atoms

Performance: 1.991 ns/day, 12.053 hours/ns, 46.092 timesteps/s, 17.192 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.867     | 32.098     | 33.365     |  15.7 | 73.97
Bond    | 0.003459   | 0.0035906  | 0.0037158  |   0.1 |  0.01
Neigh   | 3.8368     | 3.9207     | 4.0995     |   3.9 |  9.04
Comm    | 0.45522    | 1.7188     | 2.9486     |  67.7 |  3.96
Output  | 0.0029698  | 0.003916   | 0.0045462  |   0.9 |  0.01
Modify  | 5.4245     | 5.607      | 5.6929     |   3.4 | 12.92
Other   |            | 0.03888    |            |       |  0.09

Nlocal:         46.625 ave          54 max          38 min
Histogram: 1 0 1 1 1 1 0 0 1 2
Nghost:        3213.75 ave        3251 max        3185 min
Histogram: 2 1 0 1 0 1 1 1 0 1
Neighs:        25443.8 ave       28936 max       20990 min
Histogram: 1 0 1 1 1 1 0 0 1 2

Total # of neighbors = 203550
Ave neighs/atom = 545.71046
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 124.1 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   283.91394     -40545.091     -2357.9844      0              4746.6076    
       100   311.46933     -40568.673     -5231.2517     -3565.7648      4746.6076    
       200   292.5574      -40550.994     -2762.8449      190.0499       4746.6076    
       300   283.84879     -40569.342     -1243.7174     -7079.8712      4746.6076    
       400   306.34176     -40596.241     -6550.0191     -7937.2836      4746.6076    
       500   300.41062     -40571.544     -872.79965     -796.80295      4746.6076    
       600   310.44434     -40547.596     -3479.3864     -2126.831       4746.6076    
       700   327.74911     -40558.626     -567.92762     -2168.1619      4746.6076    
       800   307.35322     -40551.996     -5612.8074     -2961.4663      4746.6076    
       900   297.69329     -40554.903      7246.7454     -3904.296       4746.6076    
      1000   286.76114     -40552.064     -14089.76      -6629.9668      4746.6076    
      1100   309.64915     -40572.678     -14890.556     -5517.7083      4746.6076    
      1200   328.63939     -40566.064     -6511.093      -3472.1411      4746.6076    
      1300   310.68857     -40546.099     -1078.3005     -214.54088      4746.6076    
      1400   306.095       -40567.387     -12219.685     -5036.1595      4746.6076    
      1500   290.62793     -40573.027      1741.2871     -687.54066      4746.6076    
      1600   301.17838     -40584.265     -4133.4683     -6293.9061      4746.6076    
      1700   290.04436     -40561.105      178.54561     -4101.0682      4746.6076    
      1800   299.95952     -40544.392      1082.1647      713.76143      4746.6076    
      1900   331.78367     -40567.684      1093.5503     -4891.4636      4746.6076    
      2000   306.3751      -40556.419     -2754.425      -5680.4391      4746.6076    
Loop time of 43.9351 on 8 procs for 2000 steps with 373 atoms

Performance: 1.967 ns/day, 12.204 hours/ns, 45.522 timesteps/s, 16.980 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.051     | 32.362     | 33.905     |  17.4 | 73.66
Bond    | 0.0034995  | 0.0036078  | 0.0037288  |   0.1 |  0.01
Neigh   | 3.8257     | 3.8746     | 3.9314     |   1.6 |  8.82
Comm    | 0.36759    | 1.9061     | 3.2158     |  71.6 |  4.34
Output  | 0.0005199  | 0.00056036 | 0.00082895 |   0.0 |  0.00
Modify  | 5.6899     | 5.7496     | 5.7999     |   1.4 | 13.09
Other   |            | 0.03877    |            |       |  0.09

Nlocal:         46.625 ave          59 max          32 min
Histogram: 1 0 2 0 0 1 0 2 1 1
Nghost:        3194.25 ave        3261 max        3142 min
Histogram: 2 1 1 0 0 0 1 2 0 1
Neighs:        25342.1 ave       31412 max       17784 min
Histogram: 1 0 2 0 0 1 0 2 1 1

Total # of neighbors = 202737
Ave neighs/atom = 543.53083
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 62.6697389645321
variable C2pos equal ${d2}
variable C2pos equal 10.714305257699
variable C3pos equal ${d3}
variable C3pos equal 135.117585315604
variable C4pos equal ${d4}
variable C4pos equal 14.0430788436212
variable C5pos equal ${d5}
variable C5pos equal -8.95432658247092
variable C6pos equal ${d6}
variable C6pos equal 3.37587470951555

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-81.1277058450496+${C1pos})
variable C12 equal 0.5*(-81.1277058450496+62.6697389645321)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-18.8660531227046+${C2pos})
variable C22 equal 0.5*(-18.8660531227046+10.714305257699)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-129.992383267196+${C3pos})
variable C32 equal 0.5*(-129.992383267196+135.117585315604)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-19.4979072106402+${C4pos})
variable C42 equal 0.5*(-19.4979072106402+14.0430788436212)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-0.712715489167099+${C5pos})
variable C52 equal 0.5*(-0.712715489167099+-8.95432658247092)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-4.97272059071943+${C6pos})
variable C62 equal 0.5*(-4.97272059071943+3.37587470951555)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.55
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.55
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.3745) with tilt (-10.7944 1.3894 -3.3406)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.4 | 126.9 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40461.545      29259.616      0              4652.6153    
       100   312.58725     -40499.364     -9209.9097     -2917.5514      4652.6153    
       200   285.17746     -40469.284     -2245.174      -794.5092       4652.6153    
       300   323.45343     -40496.042     -8970.9336     -6283.7327      4652.6153    
       400   316.56391     -40483.854     -5432.2305     -1936.1033      4652.6153    
       500   295.12233     -40477.581     -3502.6706     -6282.2562      4652.6153    
       600   311.81126     -40505.866      4565.5695     -6291.4768      4652.6153    
       700   294.26045     -40473.816     -8116.4287     -4981.5203      4652.6153    
       800   306.14158     -40476.317     -6981.5229     -5839.6434      4652.6153    
       900   302.07855     -40487.224      1408.0386     -4118.5875      4652.6153    
      1000   278.61214     -40483.75      -7366.2445     -5847.5682      4652.6153    
      1100   299.21621     -40510.974     -14067.03      -4983.7414      4652.6153    
      1200   294.05229     -40504.943     -9141.4795     -2555.2643      4652.6153    
      1300   294.6408      -40501.036     -8725.4296     -4278.3         4652.6153    
      1400   296.0341      -40496.627      2843.9991     -818.89336      4652.6153    
      1500   300.52777     -40497.968      88.490261     -2454.2171      4652.6153    
      1600   316.50155     -40505.199      1718.9748     -4800.6079      4652.6153    
      1700   291.53337     -40472.524     -8716.5748     -967.6043       4652.6153    
      1800   295.80383     -40479.561     -2688.1211     -148.67738      4652.6153    
      1900   290.89007     -40475.965     -1801.2001     -6281.8804      4652.6153    
      2000   291.40691     -40481.619     -9422.9573     -6564.4725      4652.6153    
Loop time of 44.4833 on 8 procs for 2000 steps with 373 atoms

Performance: 1.942 ns/day, 12.356 hours/ns, 44.961 timesteps/s, 16.770 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.833     | 33.162     | 34.496     |  15.3 | 74.55
Bond    | 0.0034492  | 0.0035746  | 0.0037283  |   0.1 |  0.01
Neigh   | 3.9152     | 3.9981     | 4.1057     |   2.7 |  8.99
Comm    | 0.40124    | 1.7368     | 3.0682     |  66.8 |  3.90
Output  | 0.0030005  | 0.0039438  | 0.0045768  |   0.9 |  0.01
Modify  | 5.4312     | 5.5394     | 5.6234     |   2.3 | 12.45
Other   |            | 0.0393     |            |       |  0.09

Nlocal:         46.625 ave          54 max          33 min
Histogram: 1 0 0 0 0 2 2 0 1 2
Nghost:           3242 ave        3312 max        3175 min
Histogram: 1 1 1 1 0 1 1 0 0 2
Neighs:          25994 ave       30097 max       18827 min
Histogram: 1 0 0 0 0 3 1 0 1 2

Total # of neighbors = 207952
Ave neighs/atom = 557.51206
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.3 | 126.8 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.40691     -40481.619     -9422.9534      0              4652.6153    
       100   318.06134     -40526.175     -8062.6515     -2176.2633      4652.6153    
       200   321.32216     -40558.176     -3615.9077     -1177.2054      4652.6153    
       300   299.87568     -40547.792     -7596.0369     -5051.6651      4652.6153    
       400   303.47094     -40544.493     -5530.757      -4846.1567      4652.6153    
       500   309.16936     -40544.446      3243.1088     -5347.659       4652.6153    
       600   329.73684     -40558.147     -2848.3027      3074.594       4652.6153    
       700   323.70894     -40547.784     -10618.467     -4600.0491      4652.6153    
       800   296.11123     -40536.915     -958.27764     -2456.7862      4652.6153    
       900   291.76898     -40558.166     -6646.0063     -2715.1909      4652.6153    
      1000   280.15594     -40555.603     -14462.578     -5960.97        4652.6153    
      1100   285.02209     -40551.153     -8180.8469     -6350.2125      4652.6153    
      1200   322.23435     -40553.437     -7235.9137     -3756.5987      4652.6153    
      1300   319.06702     -40549.468     -1456.8457     -6833.2083      4652.6153    
      1400   304.35789     -40555.648     -9538.2134     -2005.1182      4652.6153    
      1500   311.24892     -40574.386      5275.8952     -1521.7598      4652.6153    
      1600   300.69251     -40572.246     -7335.2065     -6772.9721      4652.6153    
      1700   279.49447     -40563.427     -3076.3822     -3294.7958      4652.6153    
      1800   296.33769     -40595.291     -8135.4627     -2906.4021      4652.6153    
      1900   279.81562     -40582.669     -13132.558      391.04727      4652.6153    
      2000   289.1242      -40569.925     -14742.223      474.24863      4652.6153    
Loop time of 45.0908 on 8 procs for 2000 steps with 373 atoms

Performance: 1.916 ns/day, 12.525 hours/ns, 44.355 timesteps/s, 16.544 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.866     | 33.392     | 35.074     |  18.0 | 74.06
Bond    | 0.0034682  | 0.0035732  | 0.0037184  |   0.1 |  0.01
Neigh   | 3.9001     | 3.9957     | 4.1128     |   2.8 |  8.86
Comm    | 0.34861    | 2.0316     | 3.5564     |  73.2 |  4.51
Output  | 0.00051627 | 0.000567   | 0.00086806 |   0.0 |  0.00
Modify  | 5.5101     | 5.628      | 5.7254     |   2.4 | 12.48
Other   |            | 0.03922    |            |       |  0.09

Nlocal:         46.625 ave          51 max          38 min
Histogram: 1 0 0 0 1 1 2 0 0 3
Nghost:        3264.62 ave        3326 max        3205 min
Histogram: 1 1 0 2 0 2 0 0 0 2
Neighs:        25993.4 ave       28391 max       21487 min
Histogram: 1 0 0 0 1 1 0 2 1 2

Total # of neighbors = 207947
Ave neighs/atom = 557.49866
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -0.307365520621664
variable C2neg equal ${d2}
variable C2neg equal -11.6755999265514
variable C3neg equal ${d3}
variable C3neg equal -55.7912290145447
variable C4neg equal ${d4}
variable C4neg equal -15.2513948067213
variable C5neg equal ${d5}
variable C5neg equal 9.54081099765799
variable C6neg equal ${d6}
variable C6neg equal -4.19180550808626

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.55
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.7255) with tilt (-10.7944 1.3894 -3.3406)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.9 | 127.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40455.811     -37515.089      0              4746.6076    
       100   307.1169      -40487.45      -4849.8386     -2863.5868      4746.6076    
       200   297.32959     -40472.062     -8439.4059     -5242.128       4746.6076    
       300   292.79437     -40450.87      -13817.49      -3033.1687      4746.6076    
       400   314.38508     -40465.472     -7325.7399     -2630.5457      4746.6076    
       500   303.90206     -40467.428      818.07992     -5779.8065      4746.6076    
       600   296.41553     -40483.7       -1810.9867     -5196.3519      4746.6076    
       700   286.57378     -40500.117     -10726.437     -4432.0299      4746.6076    
       800   291.60817     -40518.203     -4993.2379     -4747.8467      4746.6076    
       900   298.71355     -40515.898      7034.328      -4528.2032      4746.6076    
      1000   297.13453     -40494.033     -10590.497     -10288.995      4746.6076    
      1100   299.80598     -40482.14      -10778.993     -2631.0476      4746.6076    
      1200   303.84725     -40492.048     -5153.224      -5741.9778      4746.6076    
      1300   303.70441     -40509.285     -12823.742     -6688.4517      4746.6076    
      1400   286.23528     -40510.211     -3369.4721     -3275.2808      4746.6076    
      1500   279.27124     -40511.474     -3135.6467     -3404.9828      4746.6076    
      1600   301.3572      -40523.788     -8020.0225     -6657.7389      4746.6076    
      1700   311.31099     -40514.642     -2794.624      -4929.0063      4746.6076    
      1800   307.84794     -40504.035     -8097.9815     -6802.5139      4746.6076    
      1900   326.269       -40546.112     -12629.817     -6155.8284      4746.6076    
      2000   290.79668     -40547.186     -13173.164     -3162.2576      4746.6076    
Loop time of 43.6587 on 8 procs for 2000 steps with 373 atoms

Performance: 1.979 ns/day, 12.127 hours/ns, 45.810 timesteps/s, 17.087 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.938     | 32.132     | 33.776     |  17.5 | 73.60
Bond    | 0.0034178  | 0.0035706  | 0.0037014  |   0.1 |  0.01
Neigh   | 3.8139     | 3.8896     | 3.9577     |   2.3 |  8.91
Comm    | 0.43762    | 2.0798     | 3.2739     |  68.7 |  4.76
Output  | 0.003062   | 0.0040146  | 0.0046792  |   0.9 |  0.01
Modify  | 5.4417     | 5.5108     | 5.5874     |   2.0 | 12.62
Other   |            | 0.03872    |            |       |  0.09

Nlocal:         46.625 ave          56 max          36 min
Histogram: 1 0 0 0 1 4 0 1 0 1
Nghost:        3183.75 ave        3241 max        3130 min
Histogram: 2 1 0 0 1 0 0 2 1 1
Neighs:        25441.5 ave       30341 max       19920 min
Histogram: 1 0 0 0 1 4 1 0 0 1

Total # of neighbors = 203532
Ave neighs/atom = 545.6622
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.7 | 126.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.79668     -40547.186     -13173.136      0              4746.6076    
       100   290.6044      -40541.183     -11906.198     -9966.9019      4746.6076    
       200   301.25945     -40519.426     -9378.7717     -7711.6901      4746.6076    
       300   326.26605     -40531.076     -3221.0756     -7748.6148      4746.6076    
       400   302.00899     -40523.022     -4263.613      -7339.842       4746.6076    
       500   309.95888     -40547.893     -8831.0545     -7407.604       4746.6076    
       600   288.07411     -40534.865      3550.5514     -3087.5983      4746.6076    
       700   293.74274     -40546.168     -7443.9772     -8316.4529      4746.6076    
       800   299.97487     -40580.283     -13548.059     -4427.9093      4746.6076    
       900   272.79082     -40570.32      -6527.9803     -4861.41        4746.6076    
      1000   292.14245     -40565.327      861.04647     -8407.8261      4746.6076    
      1100   286.57718     -40541.343     -17285.325     -6806.7445      4746.6076    
      1200   300.07984     -40543.253     -8875.2555     -3804.0763      4746.6076    
      1300   312.00716     -40544.867     -4449.2837     -7322.6442      4746.6076    
      1400   294.49336     -40540.391     -1343.7364     -7809.5586      4746.6076    
      1500   280.06129     -40556.897     -9716.9983     -6625.771       4746.6076    
      1600   284.03166     -40558.691     -7547.0713     -1291.6682      4746.6076    
      1700   321.53533     -40570.739     -6044.6366     -5317.8996      4746.6076    
      1800   309.88598     -40547.281     -8901.3114     -4193.4223      4746.6076    
      1900   291.30741     -40531.916     -14552.624     -8770.4788      4746.6076    
      2000   303.90511     -40553.284     -3319.853      -3741.3656      4746.6076    
Loop time of 43.9895 on 8 procs for 2000 steps with 373 atoms

Performance: 1.964 ns/day, 12.219 hours/ns, 45.465 timesteps/s, 16.959 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.849     | 32.271     | 34.187     |  17.6 | 73.36
Bond    | 0.0034184  | 0.0035643  | 0.0037501  |   0.2 |  0.01
Neigh   | 3.7994     | 3.8858     | 4.0152     |   3.3 |  8.83
Comm    | 0.34711    | 2.2611     | 3.6824     |  66.3 |  5.14
Output  | 0.00051808 | 0.00056268 | 0.00084292 |   0.0 |  0.00
Modify  | 5.3986     | 5.5287     | 5.616      |   2.8 | 12.57
Other   |            | 0.03874    |            |       |  0.09

Nlocal:         46.625 ave          57 max          39 min
Histogram: 1 1 0 2 1 1 1 0 0 1
Nghost:           3172 ave        3213 max        3135 min
Histogram: 1 1 2 0 0 1 1 0 0 2
Neighs:          25415 ave       30806 max       21475 min
Histogram: 1 1 0 2 1 2 0 0 0 1

Total # of neighbors = 203320
Ave neighs/atom = 545.09383
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 43.0220766344956
variable C2pos equal ${d2}
variable C2pos equal 27.1454720946693
variable C3pos equal ${d3}
variable C3pos equal 117.269128969603
variable C4pos equal ${d4}
variable C4pos equal 12.1855477528682
variable C5pos equal ${d5}
variable C5pos equal -5.87285477020375
variable C6pos equal ${d6}
variable C6pos equal -5.05188441080071

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-0.307365520621664+${C1pos})
variable C13 equal 0.5*(-0.307365520621664+43.0220766344956)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-11.6755999265514+${C2pos})
variable C23 equal 0.5*(-11.6755999265514+27.1454720946693)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-55.7912290145447+${C3pos})
variable C33 equal 0.5*(-55.7912290145447+117.269128969603)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-15.2513948067213+${C4pos})
variable C43 equal 0.5*(-15.2513948067213+12.1855477528682)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(9.54081099765799+${C5pos})
variable C53 equal 0.5*(9.54081099765799+-5.87285477020375)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-4.19180550808626+${C6pos})
variable C63 equal 0.5*(-4.19180550808626+-5.05188441080071)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.55
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.55
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.5161)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.7 | 128.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40469.2       -2763.789       0              4699.6115    
       100   311.48716     -40502.076     -6783.4733     -4461.3271      4699.6115    
       200   294.13781     -40470.553     -6273.5437     -413.47487      4699.6115    
       300   317.2792      -40471.287     -15193.131     -3771.7965      4699.6115    
       400   305.38134     -40456.055     -13181.966     -1198.7268      4699.6115    
       500   300.66646     -40464.523     -4247.0043     -5339.8815      4699.6115    
       600   299.00563     -40472.357     -9175.9882     -2095.2401      4699.6115    
       700   307.22512     -40487.733     -3518.8935     -5018.8306      4699.6115    
       800   293.88166     -40483.256     -13098.889     -2150.5813      4699.6115    
       900   301.53668     -40503.07      -6750.1072     -5809.6964      4699.6115    
      1000   294.76372     -40498.702     -1809.0615     -6558.0607      4699.6115    
      1100   299.99428     -40502.12      -3021.2378     -5854.8284      4699.6115    
      1200   301.47001     -40523.46       861.8783      -6601.1974      4699.6115    
      1300   296.74781     -40535.261     -15328.922     -3570.4565      4699.6115    
      1400   314.96727     -40546.846     -6586.8022     -2192.0915      4699.6115    
      1500   299.01223     -40528.035     -4831.2009     -7324.39        4699.6115    
      1600   292.82291     -40520.289     -4150.1212     -3867.4731      4699.6115    
      1700   311.80965     -40535.767      1335.6422     -2902.6073      4699.6115    
      1800   312.13631     -40521.793     -8051.2853     -4911.4695      4699.6115    
      1900   313.11184     -40521.055     -9523.6245     -6229.1376      4699.6115    
      2000   304.75226     -40525.805     -2787.4178     -3460.8247      4699.6115    
Loop time of 44.6195 on 8 procs for 2000 steps with 373 atoms

Performance: 1.936 ns/day, 12.394 hours/ns, 44.823 timesteps/s, 16.719 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.296     | 32.852     | 34.449     |  19.0 | 73.63
Bond    | 0.0033701  | 0.0035206  | 0.0036067  |   0.1 |  0.01
Neigh   | 3.906      | 3.9859     | 4.1007     |   2.8 |  8.93
Comm    | 0.47741    | 2.0765     | 3.635      |  75.8 |  4.65
Output  | 0.0030246  | 0.0039745  | 0.0045983  |   0.9 |  0.01
Modify  | 5.5445     | 5.6585     | 5.7377     |   2.4 | 12.68
Other   |            | 0.03932    |            |       |  0.09

Nlocal:         46.625 ave          55 max          42 min
Histogram: 1 2 1 2 0 1 0 0 0 1
Nghost:         3273.5 ave        3331 max        3214 min
Histogram: 1 2 0 0 1 0 0 2 1 1
Neighs:        25691.6 ave       29700 max       23326 min
Histogram: 1 2 1 1 1 0 1 0 0 1

Total # of neighbors = 205533
Ave neighs/atom = 551.02681
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.6 | 125.9 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.75226     -40525.805     -2787.3894      0              4699.6115    
       100   302.78924     -40539.831      1432.6223     -4828.5406      4699.6115    
       200   281.66475     -40542.825     -2839.3665     -5494.9392      4699.6115    
       300   311.78981     -40582.401      1010.8393     -7480.9293      4699.6115    
       400   291.32408     -40562.897     -3739.0816     -8409.0121      4699.6115    
       500   298.14652     -40559.874     -1339.9878     -6259.5514      4699.6115    
       600   289.77207     -40537.545     -3054.5167     -4520.0327      4699.6115    
       700   344.11171     -40567.07      -8049.9412     -7946.271       4699.6115    
       800   328.39251     -40547.4       -4266.7113     -6051.9194      4699.6115    
       900   307.56096     -40567.398     -3631.128      -4959.1971      4699.6115    
      1000   303.7986      -40578.785     -5297.4631     -4849.7469      4699.6115    
      1100   288.53137     -40568.731     -2248.4777     -2257.8911      4699.6115    
      1200   308.22542     -40581.401     -15430.842     -4599.1812      4699.6115    
      1300   318.65629     -40569.218     -7964.3695     -8214.6827      4699.6115    
      1400   321.75395     -40569.848      1918.2456     -2351.1683      4699.6115    
      1500   285.54125     -40566.182     -7813.7711     -8323.4115      4699.6115    
      1600   283.69227     -40572.731     -6504.5484     -2399.2407      4699.6115    
      1700   296.96431     -40574.151     -11378.401     -5117.6688      4699.6115    
      1800   299.18951     -40563.399     -80.404422     -6167.5033      4699.6115    
      1900   302.78155     -40576.258     -12489.895     -5436.3257      4699.6115    
      2000   269.49042     -40579.606     -19040.972     -4613.7311      4699.6115    
Loop time of 44.8862 on 8 procs for 2000 steps with 373 atoms

Performance: 1.925 ns/day, 12.468 hours/ns, 44.557 timesteps/s, 16.620 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.434     | 32.98      | 34.781     |  19.4 | 73.47
Bond    | 0.003441   | 0.0035585  | 0.0037108  |   0.1 |  0.01
Neigh   | 3.9185     | 4.0114     | 4.211      |   4.8 |  8.94
Comm    | 0.34649    | 2.1484     | 3.6973     |  76.2 |  4.79
Output  | 0.00051927 | 0.00056197 | 0.00084396 |   0.0 |  0.00
Modify  | 5.5039     | 5.7027     | 5.796      |   4.0 | 12.70
Other   |            | 0.03963    |            |       |  0.09

Nlocal:         46.625 ave          54 max          38 min
Histogram: 1 0 0 1 1 2 1 1 0 1
Nghost:        3220.88 ave        3288 max        3162 min
Histogram: 1 1 1 0 1 2 0 1 0 1
Neighs:        25708.6 ave       29254 max       21328 min
Histogram: 1 0 0 1 2 1 0 2 0 1

Total # of neighbors = 205669
Ave neighs/atom = 551.39142
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -51.8613204702819
variable C2neg equal ${d2}
variable C2neg equal -50.1940384709741
variable C3neg equal ${d3}
variable C3neg equal -73.713473723261
variable C4neg equal ${d4}
variable C4neg equal -3.82912463492647
variable C5neg equal ${d5}
variable C5neg equal -0.431286487025287
variable C6neg equal ${d6}
variable C6neg equal -6.37457971785304

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.55
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.1651)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 125.3 | 127.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40473.096     -1949.7183      0              4699.6115    
       100   304.33627     -40495.93      -7583.3935     -4519.4543      4699.6115    
       200   285.89347     -40462.291     -7572.7687     -3403.2253      4699.6115    
       300   321.47229     -40479.118     -5901.9384     -3232.0585      4699.6115    
       400   319.79003     -40476.039     -3388.6054     -1008.2932      4699.6115    
       500   303.79929     -40481.033     -4307.2463     -6583.22        4699.6115    
       600   281.95152     -40480.98      -10903.098     -5600.3578      4699.6115    
       700   290.57954     -40504.323     -9568.2071     -3503.9707      4699.6115    
       800   301.49728     -40516.204     -4021.3342     -4273.1437      4699.6115    
       900   311.99186     -40526.39      -1842.6462     -2517.0547      4699.6115    
      1000   305.29804     -40529.397     -8055.1547     -7893.8956      4699.6115    
      1100   274.12869     -40511.185     -2025.1545     -6792.8705      4699.6115    
      1200   315.34223     -40550.598     -7068.1447     -10398.193      4699.6115    
      1300   311.36255     -40558.069     -2682.7969     -6971.6851      4699.6115    
      1400   296.23187     -40568.935     -9251.9444     -5039.1007      4699.6115    
      1500   287.87917     -40568.296     -9062.3564     -6224.2415      4699.6115    
      1600   298.90156     -40563.816     -1650.1206     -3524.3175      4699.6115    
      1700   309.14247     -40551.961     -1091.1203     -2326.7944      4699.6115    
      1800   310.03741     -40533.847      7346.5275     -3579.0451      4699.6115    
      1900   307.03167     -40529.41      -2377.2501     -5327.568       4699.6115    
      2000   317.66747     -40561.485     -13673.947     -5077.528       4699.6115    
Loop time of 43.8936 on 8 procs for 2000 steps with 373 atoms

Performance: 1.968 ns/day, 12.193 hours/ns, 45.565 timesteps/s, 16.996 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.51      | 32.649     | 33.922     |  15.2 | 74.38
Bond    | 0.0034531  | 0.0036117  | 0.0037511  |   0.2 |  0.01
Neigh   | 3.8558     | 3.9365     | 4.1106     |   3.8 |  8.97
Comm    | 0.44294    | 1.7168     | 2.8574     |  66.3 |  3.91
Output  | 0.0030001  | 0.0040092  | 0.0046697  |   1.0 |  0.01
Modify  | 5.3708     | 5.5445     | 5.6249     |   3.2 | 12.63
Other   |            | 0.03897    |            |       |  0.09

Nlocal:         46.625 ave          52 max          35 min
Histogram: 1 0 0 0 1 0 2 1 0 3
Nghost:        3218.75 ave        3282 max        3162 min
Histogram: 1 2 0 0 1 1 0 2 0 1
Neighs:        25665.1 ave       28312 max       19567 min
Histogram: 1 0 0 0 1 0 2 1 0 3

Total # of neighbors = 205321
Ave neighs/atom = 550.45845
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 125.1 | 127.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   317.66747     -40561.485     -13673.98       0              4699.6115    
       100   310.79818     -40566.286     -13611.9       -4753.1801      4699.6115    
       200   279.57701     -40566.93      -3320.3422     -5125.0209      4699.6115    
       300   294.07362     -40582.193      410.2264      -5403.1624      4699.6115    
       400   297.72011     -40569.685     -11097.991     -5922.4384      4699.6115    
       500   298.85484     -40556.378     -3347.3375     -6848.3605      4699.6115    
       600   304.90168     -40560.483     -2071.726      -3748.2645      4699.6115    
       700   278.52035     -40574.609     -12093.575     -9420.5265      4699.6115    
       800   297.94424     -40605.394     -7526.4272     -6171.2489      4699.6115    
       900   286.76433     -40587.087     -3809.0747     -5570.8559      4699.6115    
      1000   282.40443     -40554.937      4749.1024     -5096.3867      4699.6115    
      1100   302.90427     -40558.096      1430.2726     -4044.8778      4699.6115    
      1200   307.38188     -40571.622      7911.4442     -7361.4453      4699.6115    
      1300   304.65506     -40585.294     -3962.0779     -3646.8652      4699.6115    
      1400   304.11206     -40601.003     -16159.836     -6369.2742      4699.6115    
      1500   291.67834     -40591.919     -9801.2918     -5130.3996      4699.6115    
      1600   306.6795      -40605.392     -15077.418     -6879.7924      4699.6115    
      1700   307.9721      -40603.109      561.37596     -10014.364      4699.6115    
      1800   299.35751     -40586.026     -5572.4727     -6678.6824      4699.6115    
      1900   313.42453     -40580.162      4035.152      -5185.7711      4699.6115    
      2000   340.1523      -40573.567     -3757.1088     -4846.0772      4699.6115    
Loop time of 43.9782 on 8 procs for 2000 steps with 373 atoms

Performance: 1.965 ns/day, 12.216 hours/ns, 45.477 timesteps/s, 16.963 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.524     | 32.67      | 34.049     |  16.6 | 74.29
Bond    | 0.0034604  | 0.0036053  | 0.0036737  |   0.1 |  0.01
Neigh   | 3.8437     | 3.9146     | 3.9665     |   2.2 |  8.90
Comm    | 0.51173    | 1.8918     | 3.0379     |  69.0 |  4.30
Output  | 0.00053456 | 0.00058173 | 0.00087762 |   0.0 |  0.00
Modify  | 5.4052     | 5.4584     | 5.5293     |   1.9 | 12.41
Other   |            | 0.03895    |            |       |  0.09

Nlocal:         46.625 ave          55 max          33 min
Histogram: 1 0 0 0 1 2 1 0 2 1
Nghost:        3224.12 ave        3277 max        3173 min
Histogram: 1 1 0 1 1 1 1 0 1 1
Neighs:        25689.8 ave       30189 max       18575 min
Histogram: 1 0 0 0 1 2 1 0 2 1

Total # of neighbors = 205518
Ave neighs/atom = 550.9866
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 54.2155665701647
variable C2pos equal ${d2}
variable C2pos equal 7.72789177225956
variable C3pos equal ${d3}
variable C3pos equal 87.7486913951721
variable C4pos equal ${d4}
variable C4pos equal 11.0624848244997
variable C5pos equal ${d5}
variable C5pos equal 11.8721444479
variable C6pos equal ${d6}
variable C6pos equal 14.6561594503214

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-51.8613204702819+${C1pos})
variable C14 equal 0.5*(-51.8613204702819+54.2155665701647)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-50.1940384709741+${C2pos})
variable C24 equal 0.5*(-50.1940384709741+7.72789177225956)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-73.713473723261+${C3pos})
variable C34 equal 0.5*(-73.713473723261+87.7486913951721)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-3.82912463492647+${C4pos})
variable C44 equal 0.5*(-3.82912463492647+11.0624848244997)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-0.431286487025287+${C5pos})
variable C54 equal 0.5*(-0.431286487025287+11.8721444479)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-6.37457971785304+${C6pos})
variable C64 equal 0.5*(-6.37457971785304+14.6561594503214)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.55
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.55
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.2139 -3.3406)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40469.737     -1479.3297      0              4699.6115    
       100   309.89485     -40500.171     -4707.801      -3478.5225      4699.6115    
       200   303.46606     -40481.029     -2269.6296     -2574.1335      4699.6115    
       300   316.25126     -40474.953     -9865.8257     -2367.0341      4699.6115    
       400   315.92304     -40471.798     -3518.2255     -2446.3427      4699.6115    
       500   290.48078     -40465.032      1137.3125     -7760.3227      4699.6115    
       600   294.91503     -40480.234     -3878.8707     -3826.1953      4699.6115    
       700   288.26118     -40464.601     -16777.064     -3877.2106      4699.6115    
       800   323.89056     -40488.274     -11222.08      -5608.6878      4699.6115    
       900   300.62248     -40470.678     -5494.226      -3996.2237      4699.6115    
      1000   307.14562     -40507.281     -7433.3904     -7206.5773      4699.6115    
      1100   287.57039     -40525.292      1052.2664     -9293.5987      4699.6115    
      1200   267.13341     -40521.682     -717.02861     -6697.483       4699.6115    
      1300   282.21822     -40521.16      -5197.0661     -3433.4239      4699.6115    
      1400   289.7695      -40502.353     -5004.3991     -6130.9749      4699.6115    
      1500   310.46322     -40526.242     -136.54348     -4373.1701      4699.6115    
      1600   301.87806     -40542.076     -224.82749     -709.97001      4699.6115    
      1700   280.33875     -40548.658     -10699.321     -6620.8537      4699.6115    
      1800   298.78952     -40584.374      2170.4216     -3903.2887      4699.6115    
      1900   296.2147      -40576.275      5349.2986     -3411.2675      4699.6115    
      2000   302.89892     -40565.231     -7926.7066     -3234.0464      4699.6115    
Loop time of 44.1874 on 8 procs for 2000 steps with 373 atoms

Performance: 1.955 ns/day, 12.274 hours/ns, 45.262 timesteps/s, 16.883 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.513     | 32.906     | 34.08      |  16.3 | 74.47
Bond    | 0.0035025  | 0.0035815  | 0.0036595  |   0.1 |  0.01
Neigh   | 3.8816     | 3.9412     | 3.991      |   1.8 |  8.92
Comm    | 0.52772    | 1.703      | 3.0954     |  71.5 |  3.85
Output  | 0.0030764  | 0.0040253  | 0.0046583  |   0.9 |  0.01
Modify  | 5.5418     | 5.5907     | 5.6508     |   1.5 | 12.65
Other   |            | 0.03928    |            |       |  0.09

Nlocal:         46.625 ave          58 max          36 min
Histogram: 1 1 0 1 0 3 0 1 0 1
Nghost:        3242.38 ave        3270 max        3210 min
Histogram: 1 0 1 1 2 0 0 0 1 2
Neighs:          25658 ave       31255 max       20192 min
Histogram: 1 1 0 1 0 3 0 1 0 1

Total # of neighbors = 205264
Ave neighs/atom = 550.30563
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.5 | 125.9 | 128.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.89892     -40565.231     -7926.6998      0              4699.6115    
       100   289.99271     -40559.929     -11403.975     -8753.6032      4699.6115    
       200   285.58387     -40577.07      -5332.178      -4744.818       4699.6115    
       300   273.66433     -40587.172     -8316.4259     -8614.8765      4699.6115    
       400   294.55072     -40596.908     -1855.0282     -3718.5029      4699.6115    
       500   296.37838     -40562.908     -8523.6354     -7473.6931      4699.6115    
       600   302.42283     -40563.583     -8030.7238     -4083.937       4699.6115    
       700   318.91408     -40596.019     -5385.4211     -5057.0833      4699.6115    
       800   294.22516     -40597.391     -4901.7272     -1055.656       4699.6115    
       900   285.86166     -40587.101     -9211.9962     -4491.4036      4699.6115    
      1000   299.583       -40584.701     -5091.063      -5673.4759      4699.6115    
      1100   291.94027     -40558.823     -12098.324     -8127.0708      4699.6115    
      1200   320.36553     -40584.889      7929.8753      124.79506      4699.6115    
      1300   307.45948     -40583.341     -11083.061     -4805.1314      4699.6115    
      1400   288.73491     -40572.592     -8065.5737      49.039758      4699.6115    
      1500   279.02429     -40570.354     -762.65724      3321.8723      4699.6115    
      1600   302.40604     -40576.793     -1217.2023     -4234.3001      4699.6115    
      1700   315.70803     -40565.372      11.120382     -296.46552      4699.6115    
      1800   315.82477     -40580.743     -686.48357     -1181.6455      4699.6115    
      1900   299.67991     -40582.272      5136.3339     -2750.915       4699.6115    
      2000   301.02563     -40593.722     -15505.449     -3433.9336      4699.6115    
Loop time of 44.4942 on 8 procs for 2000 steps with 373 atoms

Performance: 1.942 ns/day, 12.359 hours/ns, 44.950 timesteps/s, 16.766 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.481     | 33.094     | 34.197     |  18.5 | 74.38
Bond    | 0.0035028  | 0.0035574  | 0.0036782  |   0.1 |  0.01
Neigh   | 3.8743     | 3.9021     | 3.9243     |   0.7 |  8.77
Comm    | 0.73348    | 1.8305     | 3.4391     |  78.5 |  4.11
Output  | 0.00054078 | 0.00058181 | 0.00086338 |   0.0 |  0.00
Modify  | 5.6037     | 5.6241     | 5.6497     |   0.6 | 12.64
Other   |            | 0.03884    |            |       |  0.09

Nlocal:         46.625 ave          58 max          35 min
Histogram: 2 0 0 1 2 0 1 0 0 2
Nghost:        3237.12 ave        3253 max        3203 min
Histogram: 1 1 0 0 0 0 0 1 2 3
Neighs:        25638.1 ave       31215 max       19689 min
Histogram: 2 0 0 1 2 0 0 1 0 2

Total # of neighbors = 205105
Ave neighs/atom = 549.87936
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -39.9070216248099
variable C2neg equal ${d2}
variable C2neg equal -44.9994497313156
variable C3neg equal ${d3}
variable C3neg equal -91.1832695341002
variable C4neg equal ${d4}
variable C4neg equal -0.417659294969697
variable C5neg equal ${d5}
variable C5neg equal 8.50319372503614
variable C6neg equal ${d6}
variable C6neg equal -1.93615997809491

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.55
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.1755 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.5649 -3.3406)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 125.5 | 127.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40471.683     -4932.7945      0              4699.6115    
       100   309.45139     -40500.928     -8066.0196     -3795.9154      4699.6115    
       200   282.20493     -40456.531     -9028.805      -4064.6622      4699.6115    
       300   323.83093     -40478.319     -3129.6319     -4612.0141      4699.6115    
       400   315.11465     -40466.894     -4981.6652     -3379.4574      4699.6115    
       500   304.89174     -40473.297     -12650.628     -7610.6092      4699.6115    
       600   288.80247     -40476.987     -14244.699     -9415.0309      4699.6115    
       700   287.43908     -40499.513     -9243.4171     -3616.0889      4699.6115    
       800   284.89715     -40506.088     -4397.6769     -5224.4539      4699.6115    
       900   283.45359     -40501.406      4793.6227     -4318.5566      4699.6115    
      1000   298.78248     -40504.929     -13741.982     -6455.1221      4699.6115    
      1100   318.13727     -40510.428     -4327.4231     -6133.5341      4699.6115    
      1200   309.08098     -40500.934     -12235.789     -4695.9897      4699.6115    
      1300   307.06554     -40516.426     -1248.1184      191.05815      4699.6115    
      1400   285.67246     -40518.223     -13788.496     -7096.4909      4699.6115    
      1500   277.48816     -40509.179     -11873.05      -5281.6884      4699.6115    
      1600   298.37696     -40504.171     -6241.3249     -8094.8162      4699.6115    
      1700   328.04414     -40514.24       3482.9223      1131.3363      4699.6115    
      1800   314.039       -40529.83       4113.0872     -1618.896       4699.6115    
      1900   303.82197     -40563.216     -2668.6659     -1811.9254      4699.6115    
      2000   285.58376     -40565.627      2612.1357     -4825.633       4699.6115    
Loop time of 44.0499 on 8 procs for 2000 steps with 373 atoms

Performance: 1.961 ns/day, 12.236 hours/ns, 45.403 timesteps/s, 16.935 katom-step/s
98.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.425     | 32.637     | 34.117     |  16.6 | 74.09
Bond    | 0.0034171  | 0.0035284  | 0.0037021  |   0.2 |  0.01
Neigh   | 3.8753     | 3.9304     | 3.9741     |   1.7 |  8.92
Comm    | 0.47927    | 1.9586     | 3.1694     |  67.7 |  4.45
Output  | 0.0029488  | 0.0039425  | 0.0045683  |   0.9 |  0.01
Modify  | 5.4331     | 5.4776     | 5.5337     |   1.5 | 12.44
Other   |            | 0.03888    |            |       |  0.09

Nlocal:         46.625 ave          50 max          39 min
Histogram: 1 0 1 0 0 0 1 1 0 4
Nghost:           3253 ave        3296 max        3222 min
Histogram: 3 0 0 0 1 1 2 0 0 1
Neighs:        25725.5 ave       27667 max       21654 min
Histogram: 1 0 1 0 0 0 1 1 1 3

Total # of neighbors = 205804
Ave neighs/atom = 551.75335
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.4 | 125.7 | 127.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   285.58376     -40565.627      2612.1178      0              4699.6115    
       100   301.37141     -40563.564      2547.7427     -3639.1109      4699.6115    
       200   300.31114     -40541.609     -776.07477     -5112.7891      4699.6115    
       300   304.28102     -40545.797      1930.7245     -3507.9133      4699.6115    
       400   300.15368     -40544.126     -6607.5196     -4364.2537      4699.6115    
       500   296.34897     -40560.805     -13203.987     -6074.9987      4699.6115    
       600   273.33073     -40566.967     -1845.2064     -4473.0437      4699.6115    
       700   291.68773     -40584.648     -6495.8717     -4973.7042      4699.6115    
       800   298.79154     -40579.341     -8219.6413     -5111.3489      4699.6115    
       900   296.02583     -40570.451     -3715.7169     -2090.18        4699.6115    
      1000   301.68532     -40573.297     -10993.222     -3608.3504      4699.6115    
      1100   304.57177     -40576.262     -2925.694      -2439.8894      4699.6115    
      1200   294.00756     -40586.315      1240.9877     -4340.091       4699.6115    
      1300   286.0603      -40602.375     -4597.6659     -1202.1276      4699.6115    
      1400   276.62953     -40584.67      -4476.6719     -5613.6566      4699.6115    
      1500   299.33696     -40574.788     -12945.726     -7198.4858      4699.6115    
      1600   301.72377     -40568.506     -5937.0169     -1637.7339      4699.6115    
      1700   320.43234     -40594.168     -9786.3449     -2515.9265      4699.6115    
      1800   298.27176     -40597.319     -6387.4602     -7810.4702      4699.6115    
      1900   298.01815     -40614.727     -5243.8152     -3149.2609      4699.6115    
      2000   284.8746      -40603.461     -4034.9804     -2276.5271      4699.6115    
Loop time of 44.173 on 8 procs for 2000 steps with 373 atoms

Performance: 1.956 ns/day, 12.270 hours/ns, 45.276 timesteps/s, 16.888 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.559     | 32.758     | 34.47      |  16.1 | 74.16
Bond    | 0.0034236  | 0.0035758  | 0.0036455  |   0.1 |  0.01
Neigh   | 3.8535     | 3.9288     | 3.9785     |   2.2 |  8.89
Comm    | 0.34163    | 2.0543     | 3.2528     |  64.2 |  4.65
Output  | 0.00052625 | 0.00057515 | 0.00084271 |   0.0 |  0.00
Modify  | 5.3386     | 5.389      | 5.4646     |   1.9 | 12.20
Other   |            | 0.03912    |            |       |  0.09

Nlocal:         46.625 ave          53 max          41 min
Histogram: 1 1 2 0 1 0 0 0 2 1
Nghost:        3228.62 ave        3276 max        3183 min
Histogram: 1 1 1 0 0 3 0 1 0 1
Neighs:        25724.4 ave       28720 max       22788 min
Histogram: 1 0 3 0 1 0 0 0 1 2

Total # of neighbors = 205795
Ave neighs/atom = 551.72922
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 28.1796008977678
variable C2pos equal ${d2}
variable C2pos equal 48.9552167235676
variable C3pos equal ${d3}
variable C3pos equal 66.5489155706114
variable C4pos equal ${d4}
variable C4pos equal 16.3606473276768
variable C5pos equal ${d5}
variable C5pos equal -9.17283703407825
variable C6pos equal ${d6}
variable C6pos equal 3.90038067234802

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-39.9070216248099+${C1pos})
variable C15 equal 0.5*(-39.9070216248099+28.1796008977678)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-44.9994497313156+${C2pos})
variable C25 equal 0.5*(-44.9994497313156+48.9552167235676)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-91.1832695341002+${C3pos})
variable C35 equal 0.5*(-91.1832695341002+66.5489155706114)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-0.417659294969697+${C4pos})
variable C45 equal 0.5*(-0.417659294969697+16.3606473276768)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(8.50319372503614+${C5pos})
variable C55 equal 0.5*(8.50319372503614+-9.17283703407825)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-1.93615997809491+${C6pos})
variable C65 equal 0.5*(-1.93615997809491+3.90038067234802)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.0575

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.0575
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.140575 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.934975 1.3894 -3.3406)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123 | 126 | 128.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40470.292     -516.46524      0              4699.6115    
       100   312.10529     -40502.428     -6086.9935     -4341.9059      4699.6115    
       200   290.41795     -40465.47       576.52852     -1686.9078      4699.6115    
       300   319.39297     -40471.385     -14610.994     -6068.4327      4699.6115    
       400   313.44623     -40462.433     -9478.9433     -872.395        4699.6115    
       500   273.40424     -40445.926     -1637.7252     -9335.6777      4699.6115    
       600   282.08959     -40472.914     -5773.293      -7555.6285      4699.6115    
       700   284.19515     -40472.176     -6897.5753     -2945.7467      4699.6115    
       800   320.29102     -40494.905     -3470.6245     -3472.7946      4699.6115    
       900   312.05246     -40492.271     -1208.5532     -1836.6607      4699.6115    
      1000   291.79635     -40510.965     -4177.5672     -9056.4709      4699.6115    
      1100   305.64121     -40566.386     -6084.8621     -6078.9405      4699.6115    
      1200   282.07259     -40551.953     -5773.2502     -4481.4815      4699.6115    
      1300   292.24833     -40531.813     -2579.8046     -6512.4328      4699.6115    
      1400   300.76238     -40503.946     -528.54555     -6466.4157      4699.6115    
      1500   338.15267     -40537.337     -3103.4539     -317.03557      4699.6115    
      1600   308.65275     -40550.692     -5967.4282     -3563.0686      4699.6115    
      1700   277.51025     -40561.192     -11240.349     -3148.9903      4699.6115    
      1800   270.14389     -40567.559     -11480.128     -6068.7416      4699.6115    
      1900   290.027       -40571.748     -13812.525     -3121.5435      4699.6115    
      2000   320.22697     -40570.367     -4254.8338     -6176.969       4699.6115    
Loop time of 44.3299 on 8 procs for 2000 steps with 373 atoms

Performance: 1.949 ns/day, 12.314 hours/ns, 45.116 timesteps/s, 16.828 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.537     | 32.779     | 34.289     |  17.8 | 73.94
Bond    | 0.0034188  | 0.0035573  | 0.0036708  |   0.1 |  0.01
Neigh   | 3.8754     | 3.944      | 3.9996     |   2.2 |  8.90
Comm    | 0.46884    | 1.981      | 3.2252     |  72.3 |  4.47
Output  | 0.0029972  | 0.0039434  | 0.0045847  |   0.9 |  0.01
Modify  | 5.524      | 5.5792     | 5.6496     |   1.9 | 12.59
Other   |            | 0.03925    |            |       |  0.09

Nlocal:         46.625 ave          52 max          39 min
Histogram: 1 0 0 1 0 1 2 2 0 1
Nghost:        3261.75 ave        3351 max        3183 min
Histogram: 2 0 1 0 1 2 0 1 0 1
Neighs:        25709.8 ave       28108 max       21781 min
Histogram: 1 0 0 1 0 0 3 0 2 1

Total # of neighbors = 205678
Ave neighs/atom = 551.41555
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.1 | 126 | 128.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   320.22697     -40570.367     -4254.845       0              4699.6115    
       100   297.32203     -40553.381     -9442.4056     -1948.3517      4699.6115    
       200   283.06146     -40559.234     -16832.075     -7182.5841      4699.6115    
       300   286.23516     -40589.035      1003.1136     -2350.066       4699.6115    
       400   281.8417      -40585.124     -1205.429      -2231.4019      4699.6115    
       500   275.34945     -40534.102     -13204.979     -2775.5376      4699.6115    
       600   328.01774     -40583.654      5749.3804     -3767.4814      4699.6115    
       700   296.46702     -40570.675      2157.3951     -4400.0982      4699.6115    
       800   282.97525     -40578.239     -2902.336      -1155.1822      4699.6115    
       900   300.5175      -40596.591     -3769.3304     -2792.152       4699.6115    
      1000   307.12188     -40582.222     -15833.238     -7883.2699      4699.6115    
      1100   317.08265     -40560.019     -5508.5383     -4891.5254      4699.6115    
      1200   301.31912     -40549.881     -2011.5631     -4667.3615      4699.6115    
      1300   313.03639     -40579.65      -9365.5964     -4594.4415      4699.6115    
      1400   315.29677     -40598.305      2925.1714      248.84469      4699.6115    
      1500   303.3238      -40599.315     -1673.8543     -4530.3884      4699.6115    
      1600   301.64798     -40594.068      3471.3827     -9847.4005      4699.6115    
      1700   321.8105      -40612.697      6675.2665     -997.28887      4699.6115    
      1800   293.11624     -40585.402      5954.4323      230.05029      4699.6115    
      1900   286.68085     -40573.006      13.898163      212.76526      4699.6115    
      2000   319.25657     -40583.326     -2000.3972     -6413.795       4699.6115    
Loop time of 44.9869 on 8 procs for 2000 steps with 373 atoms

Performance: 1.921 ns/day, 12.496 hours/ns, 44.457 timesteps/s, 16.583 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.534     | 33.035     | 34.802     |  19.7 | 73.43
Bond    | 0.0034964  | 0.0036246  | 0.0038629  |   0.2 |  0.01
Neigh   | 3.8319     | 3.9679     | 4.2117     |   5.4 |  8.82
Comm    | 0.38461    | 2.155      | 3.6577     |  77.4 |  4.79
Output  | 0.00052988 | 0.00057222 | 0.00085256 |   0.0 |  0.00
Modify  | 5.5441     | 5.7849     | 5.9208     |   4.4 | 12.86
Other   |            | 0.03937    |            |       |  0.09

Nlocal:         46.625 ave          55 max          38 min
Histogram: 1 1 0 1 1 1 0 1 1 1
Nghost:        3264.12 ave        3321 max        3216 min
Histogram: 2 0 1 0 1 2 0 1 0 1
Neighs:        25678.5 ave       29636 max       21184 min
Histogram: 1 0 1 1 1 0 1 1 1 1

Total # of neighbors = 205428
Ave neighs/atom = 550.74531
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -70.1004671280077
variable C2neg equal ${d2}
variable C2neg equal -21.2283706054883
variable C3neg equal ${d3}
variable C3neg equal -130.460157710568
variable C4neg equal ${d4}
variable C4neg equal -8.00976189841274
variable C5neg equal ${d5}
variable C5neg equal 2.0911020521555
variable C6neg equal ${d6}
variable C6neg equal 8.75619778678861

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.0575
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.140575 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.653825 1.3894 -3.3406)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 125.2 | 127.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40471.937     -3836.3258      0              4699.6115    
       100   306.95281     -40498.743     -6195.2201     -4026.3466      4699.6115    
       200   291.54469     -40467.285     -5076.1399     -2805.1633      4699.6115    
       300   313.65193     -40467.84       640.70609     -3710.2158      4699.6115    
       400   308.29888     -40461.599      566.93458     -1579.7532      4699.6115    
       500   299.62342     -40474.849     -4126.1504     -5272.9355      4699.6115    
       600   293.03431     -40482.931     -7096.7928     -8031.3758      4699.6115    
       700   285.63766     -40471.645     -11422.744     -1825.7841      4699.6115    
       800   308.54839     -40487.307      3361.6666     -1613.0985      4699.6115    
       900   286.8695      -40452.116      2566.1983     -2976.8176      4699.6115    
      1000   309.44654     -40479.818     -3883.2445     -3400.9261      4699.6115    
      1100   300.55108     -40491.084     -4867.8037     -7739.3629      4699.6115    
      1200   285.94046     -40491.104     -4484.8676     -10412.722      4699.6115    
      1300   305.13406     -40510.017     -1721.7205     -1691.6481      4699.6115    
      1400   299.01738     -40497.681     -9713.4475     -4027.528       4699.6115    
      1500   290.43045     -40478.963     -9304.858      -7395.0858      4699.6115    
      1600   309.04115     -40503.347     -4323.8506     -6895.3174      4699.6115    
      1700   286.70969     -40504.7       -555.75441     -4958.6962      4699.6115    
      1800   282.54937     -40522.513      2169.8529     -1402.2506      4699.6115    
      1900   286.35367     -40530.229      3305.5331      1168.7849      4699.6115    
      2000   315.25503     -40543.412     -7493.1785     -1383.9651      4699.6115    
Loop time of 44.2938 on 8 procs for 2000 steps with 373 atoms

Performance: 1.951 ns/day, 12.304 hours/ns, 45.153 timesteps/s, 16.842 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.449     | 32.591     | 34.3       |  17.0 | 73.58
Bond    | 0.0034504  | 0.0035492  | 0.0037084  |   0.1 |  0.01
Neigh   | 3.8509     | 3.9358     | 4.125      |   4.0 |  8.89
Comm    | 0.38453    | 2.0958     | 3.2406     |  67.2 |  4.73
Output  | 0.0029785  | 0.0039597  | 0.0046103  |   0.9 |  0.01
Modify  | 5.4367     | 5.6241     | 5.7102     |   3.3 | 12.70
Other   |            | 0.03922    |            |       |  0.09

Nlocal:         46.625 ave          53 max          39 min
Histogram: 1 0 2 0 1 0 1 1 0 2
Nghost:        3235.88 ave        3293 max        3191 min
Histogram: 3 0 1 0 0 0 0 3 0 1
Neighs:        25724.5 ave       28742 max       21784 min
Histogram: 1 0 1 1 1 0 1 0 1 2

Total # of neighbors = 205796
Ave neighs/atom = 551.7319
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.2 | 125.4 | 127.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   315.25503     -40543.412     -7493.1972      0              4699.6115    
       100   312.65785     -40545.638      3370.916      -3772.5359      4699.6115    
       200   295.23709     -40540.125     -2844.6018     -4583.3675      4699.6115    
       300   285.12616     -40554.546     -7915.9274     -3421.982       4699.6115    
       400   291.80334     -40573.012     -5921.756      -4732.3302      4699.6115    
       500   292.08257     -40540.692     -10877.792     -6267.1465      4699.6115    
       600   311.44495     -40545.196     -2611.3626     -5852.0703      4699.6115    
       700   288.74959     -40536.995     -823.43102      713.13448      4699.6115    
       800   301.02953     -40569.639     -7144.7892     -2215.1907      4699.6115    
       900   282.54079     -40552.457     -5128.0229     -4969.0052      4699.6115    
      1000   313.82653     -40570.185     -6468.0229     -7176.7935      4699.6115    
      1100   304.15361     -40544.546     -6889.1371     -4557.8702      4699.6115    
      1200   287.99859     -40545.802     -1052.0098     -3973.8929      4699.6115    
      1300   309.32678     -40596.397     -8096.4728     -1592.0488      4699.6115    
      1400   292.85547     -40586.239     -4506.2281     -2655.1491      4699.6115    
      1500   297.0798      -40581.273     -2230.3335     -3171.9134      4699.6115    
      1600   291.22028     -40556.681     -6119.6095     -7673.3228      4699.6115    
      1700   326.58993     -40570.64      -2768.0609     -5342.3348      4699.6115    
      1800   328.72278     -40574.855     -2597.0544     -4819.7872      4699.6115    
      1900   278.67571     -40539.712     -3939.3052     -1168.9597      4699.6115    
      2000   296.7221      -40581.523     -582.12617     -5517.1202      4699.6115    
Loop time of 44.1892 on 8 procs for 2000 steps with 373 atoms

Performance: 1.955 ns/day, 12.275 hours/ns, 45.260 timesteps/s, 16.882 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.629     | 32.925     | 34.42      |  14.4 | 74.51
Bond    | 0.0035284  | 0.0036081  | 0.0037564  |   0.1 |  0.01
Neigh   | 3.8628     | 3.9324     | 4.0019     |   2.4 |  8.90
Comm    | 0.36232    | 1.8581     | 3.1543     |  60.7 |  4.20
Output  | 0.00052262 | 0.00056435 | 0.00084494 |   0.0 |  0.00
Modify  | 5.3594     | 5.4305     | 5.5015     |   2.1 | 12.29
Other   |            | 0.03917    |            |       |  0.09

Nlocal:         46.625 ave          52 max          38 min
Histogram: 1 0 0 0 1 2 0 1 1 2
Nghost:        3224.12 ave        3281 max        3160 min
Histogram: 1 1 1 1 0 0 0 1 1 2
Neighs:        25720.1 ave       28765 max       21070 min
Histogram: 1 0 0 0 2 1 1 0 2 1

Total # of neighbors = 205761
Ave neighs/atom = 551.63807
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 61.0149098976099
variable C2pos equal ${d2}
variable C2pos equal 67.6362690917278
variable C3pos equal ${d3}
variable C3pos equal 89.3848789457229
variable C4pos equal ${d4}
variable C4pos equal 0.819650138516057
variable C5pos equal ${d5}
variable C5pos equal -9.85754814945709
variable C6pos equal ${d6}
variable C6pos equal -3.58714458147778

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-70.1004671280077+${C1pos})
variable C16 equal 0.5*(-70.1004671280077+61.0149098976099)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-21.2283706054883+${C2pos})
variable C26 equal 0.5*(-21.2283706054883+67.6362690917278)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-130.460157710568+${C3pos})
variable C36 equal 0.5*(-130.460157710568+89.3848789457229)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-8.00976189841274+${C4pos})
variable C46 equal 0.5*(-8.00976189841274+0.819650138516057)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(2.0911020521555+${C5pos})
variable C56 equal 0.5*(2.0911020521555+-9.85754814945709)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(8.75619778678861+${C6pos})
variable C66 equal 0.5*(8.75619778678861+-3.58714458147778)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 3.80162460184115
variable C22all equal ${C22}
variable C22all equal -4.0758739325028
variable C33all equal ${C33}
variable C33all equal 30.7389499775292

variable C44all equal ${C44}
variable C44all equal 3.61668009478662
variable C55all equal ${C55}
variable C55all equal -0.334821654521056
variable C66all equal ${C66}
variable C66all equal 2.58452660265541

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-9.22898344025875+${C21})
variable C12all equal 0.5*(-9.22898344025875+5.54335263157875)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(21.357355556937+${C31})
variable C13all equal 0.5*(21.357355556937+-10.6996775085355)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(7.73493608405895+${C32})
variable C23all equal 0.5*(7.73493608405895+2.562601024204)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(1.1771230499414+${C41})
variable C14all equal 0.5*(1.1771230499414+-6.50183387509175)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-5.86371036352105+${C51})
variable C15all equal 0.5*(-5.86371036352105+-1.82752162880082)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-4.5427786151989+${C61})
variable C16all equal 0.5*(-4.5427786151989+-4.5311364895461)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-21.2330733493573+${C42})
variable C24all equal 0.5*(-21.2330733493573+-2.7274141835095)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(1.977883496126+${C52})
variable C25all equal 0.5*(1.977883496126+-4.83352103581901)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(23.2039492431197+${C62})
variable C26all equal 0.5*(23.2039492431197+-0.79842294060194)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(7.01760883595555+${C43})
variable C34all equal 0.5*(7.01760883595555+-1.53292352692655)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-12.3171769817444+${C53})
variable C35all equal 0.5*(-12.3171769817444+1.83397811372712)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-20.5376393824226+${C63})
variable C36all equal 0.5*(-20.5376393824226+-4.62184495944348)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(7.97149401635355+${C54})
variable C45all equal 0.5*(7.97149401635355+5.72042898043736)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-3.59505587994834+${C64})
variable C46all equal 0.5*(-3.59505587994834+4.14078986623418)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-3.88322304865079+${C65})
variable C56all equal 0.5*(-3.88322304865079+0.982110347126555)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:18:31
