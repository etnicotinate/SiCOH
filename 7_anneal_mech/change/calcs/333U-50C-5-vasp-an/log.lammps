LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-5-vasp-an
read_data       ${structure}.data
read_data       333U-50C-5-vasp-an.data
Reading data file ...
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  350 atoms
  reading velocities ...
  350 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              312.09081      3816.0058    
         1   300            0              0              312.09081      3816.0058    
Loop time of 4.47489e-05 on 8 procs for 1 steps with 350 atoms

51.1% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.34e-07   | 1.63e-07   | 2.16e-07   |   0.0 |  0.36
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.69e-07   | 1.0148e-06 | 1.132e-06  |   0.0 |  2.27
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.357e-05  |            |       | 97.37

Nlocal:          43.75 ave          48 max          39 min
Histogram: 1 0 0 2 1 0 2 1 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.4 | 130 | 131.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -41262.556     -800.07054      0              1.737228       3738.5639    
       100   303.25539     -41252.064      3695.3185     -89.366972      1.737228       3738.5639    
       200   329.83131     -41256.975     -5129.7212      796.4096       1.737228       3738.5639    
       300   304.37764     -41231.859      5123.6253     -1406.4714      1.737228       3738.5639    
       400   295.99995     -41267.796      1799.2349     -2028.0588      1.737228       3738.5639    
       500   285.61215     -41259.084     -13030.69      -7047.5778      1.737228       3738.5639    
       600   287.17298     -41245.44      -6638.434      -14.171983      1.737228       3738.5639    
       700   304.79562     -41240.258      7335.7978     -1052.5714      1.737228       3738.5639    
       800   318.66561     -41247.554      2338.4461     -78.300923      1.737228       3738.5639    
       900   283.61171     -41240.663     -4126.3589      2952.8758      1.737228       3738.5639    
      1000   297.99774     -41280.089     -9230.7053     -5872.201       1.737228       3738.5639    
      1100   291.03215     -41263.296     -3349.9883     -1551.339       1.737228       3738.5639    
      1200   311.15342     -41258.32      -11760.172      1611.7529      1.737228       3738.5639    
      1300   307.05128     -41244.52      -2064.6871     -1058.3679      1.737228       3738.5639    
      1400   305.44626     -41253.164     -2471.8802      2747.6744      1.737228       3738.5639    
      1500   282.14822     -41263.995      2878.9234      736.33195      1.737228       3738.5639    
      1600   276.56828     -41258.167     -6224.4509      1385.6215      1.737228       3738.5639    
      1700   291.09479     -41250.912     -3591.0593      466.92691      1.737228       3738.5639    
      1800   307.42344     -41252.498     -4997.9032     -1043.4312      1.737228       3738.5639    
      1900   315.75584     -41258.95      -3163.4949     -2054.4441      1.737228       3738.5639    
      2000   289.20158     -41249.632     -5135.9957      1253.0994      1.737228       3738.5639    
Loop time of 97.5019 on 8 procs for 2000 steps with 350 atoms

Performance: 0.886 ns/day, 27.084 hours/ns, 20.512 timesteps/s, 7.179 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.217     | 77.323     | 82.262     |  95.8 | 79.30
Bond    | 0.00072409 | 0.00079976 | 0.0009851  |   0.0 |  0.00
Neigh   | 4.4135     | 6.0452     | 6.4519     |  25.4 |  6.20
Comm    | 0.8064     | 5.7379     | 27.855     | 351.8 |  5.88
Output  | 0.0011037  | 0.0012392  | 0.0017738  |   0.6 |  0.00
Modify  | 7.9208     | 8.3524     | 9.979      |  21.6 |  8.57
Other   |            | 0.0418     |            |       |  0.04

Nlocal:          43.75 ave          48 max          36 min
Histogram: 1 0 0 0 1 1 0 2 1 2
Nghost:         3352.5 ave        3379 max        3317 min
Histogram: 1 0 0 1 2 0 1 0 1 2
Neighs:        28695.8 ave       31336 max       23879 min
Histogram: 1 0 0 0 2 0 0 2 1 2

Total # of neighbors = 229566
Ave neighs/atom = 655.90286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-5-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.5387154558726
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4170067184353
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.9322199223083

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-1253.0993950643)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-1253.0993950643)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--9132.31449896996)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--9132.31449896996)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-1622.30031668922)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-1622.30031668922)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1031.26831497638)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1031.26831497638)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1739.5466368942)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1739.5466368942)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-2911.51649118783)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-2911.51649118783)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.5387154558726
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.5387154558726
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.155387154558726 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.155387154558726 xy delta 0.0774906665315158 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.155387154558726 xy delta 0.0774906665315158 xz delta 0.01537821112214 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.453071 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.453071 13.818203 17.78526) with tilt (-7.671576 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.453071 13.818203 17.78526) with tilt (-7.671576 -1.5224429 0.14232347)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.7 | 131 | 132.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41234.459      46885.011      0              3701.1783    
       100   278.03603     -41258.863      13321.711      12657.137      3701.1783    
       200   289.09501     -41269.918     -450.40331     -2181.0494      3701.1783    
       300   298.32938     -41270.549     -35.793194      756.42172      3701.1783    
       400   307.35082     -41267.055     -614.68366      2477.2646      3701.1783    
       500   297.86447     -41236.887     -8882.3615      1519.1533      3701.1783    
       600   348.26114     -41260.734      3801.9433      7288.3266      3701.1783    
       700   309.37357     -41240.819     -2973.8229      3465.685       3701.1783    
       800   297.40721     -41252.706     -1237.6853      2753.3005      3701.1783    
       900   284.60467     -41246.551      13661.297      7693.8126      3701.1783    
      1000   306.31322     -41267.661      4607.3828      1822.3958      3701.1783    
      1100   305.03592     -41252.662     -6781.5958     -1678.5113      3701.1783    
      1200   317.96448     -41251.53      -1915.4972     -351.30196      3701.1783    
      1300   314.66499     -41266.142     -3408.8003     -5001.7292      3701.1783    
      1400   282.6912      -41263.212      1409.2528      4929.9923      3701.1783    
      1500   315.52866     -41292.591      10794.832      560.69117      3701.1783    
      1600   305.03306     -41267.963     -444.37543     -4715.414       3701.1783    
      1700   300.409       -41238.693      4235.8146     -2029.5688      3701.1783    
      1800   320.73831     -41226.307     -5597.2593      2888.2798      3701.1783    
      1900   320.2565      -41239.769      6469.6397      7774.2325      3701.1783    
      2000   296.42264     -41233.295     -3614.5997      4941.6227      3701.1783    
Loop time of 98.8329 on 8 procs for 2000 steps with 350 atoms

Performance: 0.874 ns/day, 27.454 hours/ns, 20.236 timesteps/s, 7.083 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.721     | 78.74      | 83.292     |  94.4 | 79.67
Bond    | 0.00067312 | 0.00077397 | 0.00092116 |   0.0 |  0.00
Neigh   | 4.4648     | 6.1126     | 6.5028     |  25.4 |  6.18
Comm    | 0.91704    | 5.4578     | 27.492     | 358.9 |  5.52
Output  | 0.00431    | 0.0052221  | 0.0059457  |   0.8 |  0.01
Modify  | 8.0618     | 8.4752     | 10.115     |  21.6 |  8.58
Other   |            | 0.04126    |            |       |  0.04

Nlocal:          43.75 ave          49 max          38 min
Histogram: 1 0 0 1 1 2 2 0 0 1
Nghost:        3391.25 ave        3419 max        3353 min
Histogram: 1 0 0 3 0 0 0 1 1 2
Neighs:        29022.1 ave       32362 max       25434 min
Histogram: 1 0 0 1 1 2 2 0 0 1

Total # of neighbors = 232177
Ave neighs/atom = 663.36286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.7 | 131 | 132.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42264     -41233.295     -3614.6448      0              3701.1783    
       100   289.166       -41232.995     -15014.285      3469.2965      3701.1783    
       200   276.49538     -41246.435     -13521.002      1846.9598      3701.1783    
       300   280.84612     -41276.649      3891.4991      8123.6744      3701.1783    
       400   291.24324     -41283.225     -10376.094      629.67095      3701.1783    
       500   270.64525     -41247.415      9262.3199      1515.5478      3701.1783    
       600   305.47682     -41266.135      16108.266     -85.860065      3701.1783    
       700   310.30004     -41263.623     -2699.3459     -678.42485      3701.1783    
       800   304.04725     -41261.039      6056.9424      2049.3214      3701.1783    
       900   301.80724     -41288.537      3608.6353      4268.5916      3701.1783    
      1000   272.57294     -41270.784     -8465.6726     -4280.2134      3701.1783    
      1100   298.68096     -41274.881      14259.043      2419.6762      3701.1783    
      1200   297.54444     -41260.92      -5185.5664     -1821.3541      3701.1783    
      1300   289.12029     -41255.341      2535.1968      2199.2282      3701.1783    
      1400   293.61582     -41263.356     -3196.5439     -578.19145      3701.1783    
      1500   296.95038     -41252.426     -7031.0668      3234.9966      3701.1783    
      1600   325.4271      -41256.333     -6823.8035      1687.5192      3701.1783    
      1700   339.22364     -41271.782      7521.7574     -3296.2007      3701.1783    
      1800   305.72447     -41273.11       8915.2151      3545.5549      3701.1783    
      1900   291.34614     -41266.421      1542.8105      5202.8816      3701.1783    
      2000   296.53831     -41269.98       5277.1283     -3160.665       3701.1783    
Loop time of 99.1652 on 8 procs for 2000 steps with 350 atoms

Performance: 0.871 ns/day, 27.546 hours/ns, 20.168 timesteps/s, 7.059 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.576     | 78.86      | 83.794     |  95.5 | 79.52
Bond    | 0.0006668  | 0.00077761 | 0.00090758 |   0.0 |  0.00
Neigh   | 4.4824     | 6.134      | 6.5408     |  25.5 |  6.19
Comm    | 0.73997    | 5.6615     | 27.956     | 356.7 |  5.71
Output  | 0.0008295  | 0.00093282 | 0.001372   |   0.0 |  0.00
Modify  | 8.0356     | 8.466      | 10.112     |  21.7 |  8.54
Other   |            | 0.04163    |            |       |  0.04

Nlocal:          43.75 ave          48 max          39 min
Histogram: 1 1 1 0 0 2 0 1 0 2
Nghost:        3390.75 ave        3439 max        3351 min
Histogram: 1 1 1 2 0 0 1 1 0 1
Neighs:        28975.6 ave       31805 max       26043 min
Histogram: 2 0 1 0 0 2 0 1 0 2

Total # of neighbors = 231805
Ave neighs/atom = 662.3
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -44.7224675384467
variable C2neg equal ${d2}
variable C2neg equal 33.7034226117595
variable C3neg equal ${d3}
variable C3neg equal -16.9462808479382
variable C4neg equal ${d4}
variable C4neg equal -3.66171372108444
variable C5neg equal ${d5}
variable C5neg equal 16.6693047296377
variable C6neg equal ${d6}
variable C6neg equal -26.1862964419686

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.5387154558726
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.155387154558726 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.155387154558726 xy delta -0.0774906665315158 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.155387154558726 xy delta -0.0774906665315158 xz delta -0.01537821112214 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.763845 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.763845 13.818203 17.78526) with tilt (-7.8265573 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.763845 13.818203 17.78526) with tilt (-7.8265573 -1.5531993 0.14232347)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.7 | 129.9 | 131.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41230.897     -48636.107      0              3775.9495    
       100   276.28968     -41253.87      -4154.542      -4998.4513      3775.9495    
       200   285.18281     -41260.962     -6313.4954     -7293.5603      3775.9495    
       300   299.27146     -41262.053      892.83132     -1694.1997      3775.9495    
       400   300.31224     -41247.087     -2211.4063     -5550.8472      3775.9495    
       500   305.60142     -41232.72      -489.18135     -6138.8768      3775.9495    
       600   306.769       -41216.398     -5492.943      -7789.2256      3775.9495    
       700   317.17555     -41214.649     -7986.4785     -7380.7754      3775.9495    
       800   293.61156     -41219.962     -10299.934     -2472.3022      3775.9495    
       900   298.66212     -41246.992     -3507.5151     -6755.5668      3775.9495    
      1000   298.89424     -41256.097      1508.9734     -4138.8962      3775.9495    
      1100   299.9682      -41249.115     -44.438129     -3544.3766      3775.9495    
      1200   320.95424     -41244.495      9326.6448      3463.7265      3775.9495    
      1300   328.45933     -41237.088     -5973.6374     -5467.3577      3775.9495    
      1400   302.62035     -41233.78      -12166.098     -3532.3762      3775.9495    
      1500   294.9722      -41242.303     -1152.8399     -6001.0686      3775.9495    
      1600   286.51605     -41239.061      3035.7591     -4444.4119      3775.9495    
      1700   302.20682     -41259.964     -3658.1779     -6297.5438      3775.9495    
      1800   289.76735     -41249.191      10969.612     -3101.8642      3775.9495    
      1900   300.42809     -41247.348     -6769.3527     -6879.2735      3775.9495    
      2000   311.03947     -41233.769     -2038.6276     -3765.1355      3775.9495    
Loop time of 96.4497 on 8 procs for 2000 steps with 350 atoms

Performance: 0.896 ns/day, 26.792 hours/ns, 20.736 timesteps/s, 7.258 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.448     | 76.602     | 81.122     |  92.2 | 79.42
Bond    | 0.00065142 | 0.00075898 | 0.0008843  |   0.0 |  0.00
Neigh   | 4.3965     | 6.025      | 6.4421     |  25.4 |  6.25
Comm    | 0.83448    | 5.345      | 26.511     | 349.0 |  5.54
Output  | 0.0040744  | 0.0049569  | 0.0056711  |   0.8 |  0.01
Modify  | 7.991      | 8.4306     | 10.054     |  21.5 |  8.74
Other   |            | 0.04151    |            |       |  0.04

Nlocal:          43.75 ave          49 max          40 min
Histogram: 2 0 0 2 2 0 0 1 0 1
Nghost:           3334 ave        3372 max        3292 min
Histogram: 1 1 0 0 2 1 1 0 0 2
Neighs:          28393 ave       31579 max       26078 min
Histogram: 2 0 0 2 2 0 0 1 0 1

Total # of neighbors = 227144
Ave neighs/atom = 648.98286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.6 | 129.9 | 131 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.03947     -41233.769     -2038.6879      0              3775.9495    
       100   305.34136     -41237.822      5901.9742     -1601.875       3775.9495    
       200   289.6238      -41254.093      5009.5343      2347.1045      3775.9495    
       300   296.19889     -41271.2       -5038.5922     -2992.1699      3775.9495    
       400   295.43469     -41256.268      7407.0046     -2057.5401      3775.9495    
       500   293.55619     -41241.323      6592.1176      1880.1251      3775.9495    
       600   315.27924     -41246.723     -13074.721     -6763.4711      3775.9495    
       700   300.74175     -41223.779     -8278.1715     -5409.7978      3775.9495    
       800   315.44756     -41251.508      10463.446     -4818.7186      3775.9495    
       900   279.95496     -41251.15      -10939.064     -8139.0331      3775.9495    
      1000   289.99546     -41260.566      335.47914      920.4803       3775.9495    
      1100   298.82949     -41240.475     -2843.5281     -4872.2535      3775.9495    
      1200   293.38744     -41225.45       1818.2628     -4989.3554      3775.9495    
      1300   301.62654     -41239.061      6885.6793     -1940.1731      3775.9495    
      1400   288.44598     -41243.91       4017.2209     -5363.6855      3775.9495    
      1500   298.93664     -41279.666     -1749.4315      2737.2436      3775.9495    
      1600   283.91479     -41271.004     -5231.517      -6803.1528      3775.9495    
      1700   293.2796      -41241.993     -15461.166     -4560.0439      3775.9495    
      1800   329.36046     -41263.016      8989.3669     -1744.442       3775.9495    
      1900   296.08894     -41232.317     -3668.5131      2232.3635      3775.9495    
      2000   313.20301     -41251.27      -18666.32      -2346.7485      3775.9495    
Loop time of 98.2511 on 8 procs for 2000 steps with 350 atoms

Performance: 0.879 ns/day, 27.292 hours/ns, 20.356 timesteps/s, 7.125 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.335     | 77.423     | 81.6       |  79.2 | 78.80
Bond    | 0.00066817 | 0.00075294 | 0.00087777 |   0.0 |  0.00
Neigh   | 4.6361     | 6.0668     | 6.4639     |  22.7 |  6.17
Comm    | 1.7797     | 5.9518     | 24.049     | 285.6 |  6.06
Output  | 0.00082689 | 0.00094546 | 0.001395   |   0.0 |  0.00
Modify  | 8.3637     | 8.7669     | 10.194     |  18.9 |  8.92
Other   |            | 0.04091    |            |       |  0.04

Nlocal:          43.75 ave          49 max          38 min
Histogram: 1 1 0 2 0 0 0 2 1 1
Nghost:        3361.12 ave        3408 max        3308 min
Histogram: 1 0 0 1 2 0 1 2 0 1
Neighs:          28401 ave       31607 max       24860 min
Histogram: 1 1 0 2 0 0 0 2 1 1

Total # of neighbors = 227208
Ave neighs/atom = 649.16571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 36.475459048927
variable C2pos equal ${d2}
variable C2pos equal -29.4602798945451
variable C3pos equal ${d3}
variable C3pos equal 54.7151757029292
variable C4pos equal ${d4}
variable C4pos equal 15.9018708705082
variable C5pos equal ${d5}
variable C5pos equal -22.9341342791816
variable C6pos equal ${d6}
variable C6pos equal 11.2577048493079

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-44.7224675384467+${C1pos})
variable C11 equal 0.5*(-44.7224675384467+36.475459048927)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(33.7034226117595+${C2pos})
variable C21 equal 0.5*(33.7034226117595+-29.4602798945451)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-16.9462808479382+${C3pos})
variable C31 equal 0.5*(-16.9462808479382+54.7151757029292)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-3.66171372108444+${C4pos})
variable C41 equal 0.5*(-3.66171372108444+15.9018708705082)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(16.6693047296377+${C5pos})
variable C51 equal 0.5*(16.6693047296377+-22.9341342791816)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-26.1862964419686+${C6pos})
variable C61 equal 0.5*(-26.1862964419686+11.2577048493079)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4170067184353
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4170067184353
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134170067184353 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134170067184353 yz delta -0.00142323467109325 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.684033 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.684033 17.78526) with tilt (-7.7490667 -1.5378211 0.14090023)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.6 | 131.6 | 132.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41241.598      45829.511      0              3701.1783    
       100   283.58037     -41271.465      6840.4063      5916.2149      3701.1783    
       200   287.90479     -41275.717     -11853.288     -6327.559       3701.1783    
       300   297.6509      -41275.806      1595.764       2193.6172      3701.1783    
       400   292.68474     -41257.099      6673.9831     -1062.0961      3701.1783    
       500   299.31193     -41242.509      1114.8784     -621.52274      3701.1783    
       600   306.50464     -41227.858     -5554.4646      1598.5063      3701.1783    
       700   313.07279     -41244.792      13982.502     -310.66502      3701.1783    
       800   300.19469     -41269.261     -1214.5542      748.31507      3701.1783    
       900   292.666       -41275.242     -9418.777       7121.4601      3701.1783    
      1000   292.71458     -41271.43      -2620.0587     -537.52629      3701.1783    
      1100   287.63307     -41236.933     -15731.339     -1527.1808      3701.1783    
      1200   304.53169     -41246.991      10716.033      4684.4743      3701.1783    
      1300   293.70136     -41253.867      10811.706     -1822.1401      3701.1783    
      1400   290.09252     -41260.788      12056.768     -2577.2047      3701.1783    
      1500   311.15808     -41274.144      11150.415      801.77145      3701.1783    
      1600   290.03809     -41241.013     -1310.1682      1790.2433      3701.1783    
      1700   320.19107     -41260.418     -4590.1384     -3859.2814      3701.1783    
      1800   309.00588     -41250.753      7007.6038      4690.1628      3701.1783    
      1900   301.56819     -41265.979      5408.8271     -206.98499      3701.1783    
      2000   285.22419     -41269.387      995.72626      1926.1739      3701.1783    
Loop time of 99.0305 on 8 procs for 2000 steps with 350 atoms

Performance: 0.872 ns/day, 27.508 hours/ns, 20.196 timesteps/s, 7.069 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.483     | 80.433     | 83.216     |  51.3 | 81.22
Bond    | 0.00062101 | 0.00073544 | 0.00087128 |   0.0 |  0.00
Neigh   | 5.3414     | 6.2108     | 6.4375     |  13.5 |  6.27
Comm    | 1.4234     | 4.2114     | 16.161     | 224.3 |  4.25
Output  | 0.0041045  | 0.0050612  | 0.0058164  |   0.8 |  0.01
Modify  | 7.8988     | 8.1289     | 9.0012     |  11.9 |  8.21
Other   |            | 0.04076    |            |       |  0.04

Nlocal:          43.75 ave          49 max          40 min
Histogram: 1 2 0 0 2 1 1 0 0 1
Nghost:        3402.38 ave        3435 max        3369 min
Histogram: 2 0 1 0 1 1 1 0 0 2
Neighs:        28994.4 ave       32303 max       26610 min
Histogram: 1 2 0 0 2 1 1 0 0 1

Total # of neighbors = 231955
Ave neighs/atom = 662.72857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.6 | 131.6 | 132.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   285.22419     -41269.387      995.71521      0              3701.1783    
       100   286.39604     -41259.521      11198.148      8686.9483      3701.1783    
       200   300.48208     -41244.796     -1687.5037      678.45304      3701.1783    
       300   309.75537     -41238.247     -10759.866      1843.3625      3701.1783    
       400   298.01786     -41236.996     -2470.2241     -4472.0015      3701.1783    
       500   302.36573     -41264.111     -6567.611       1272.3323      3701.1783    
       600   313.9084      -41279.637      1745.0258      2030.8882      3701.1783    
       700   312.15982     -41281.183      3248.5621     -1782.2492      3701.1783    
       800   288.9761      -41259.445     -10745.599     -7306.5555      3701.1783    
       900   321.98991     -41281.64       23947.187      2778.7553      3701.1783    
      1000   288.38632     -41242.345     -1600.5066     -1116.8139      3701.1783    
      1100   299.9498      -41262.102      7345.2495     -2429.2643      3701.1783    
      1200   294.89951     -41278.852     -7555.7782      3544.8402      3701.1783    
      1300   292.56726     -41286.036      1472.3968     -5592.9848      3701.1783    
      1400   304.76741     -41280.069      4903.1544      516.27258      3701.1783    
      1500   335.61131     -41276.657      5660.58        3364.5538      3701.1783    
      1600   301.64152     -41246.957     -17105.096     -2334.4733      3701.1783    
      1700   297.05953     -41264.208     -6840.55        1125.8132      3701.1783    
      1800   289.6966      -41270.776     -2091.6418      280.67059      3701.1783    
      1900   298.11945     -41276.397      498.25719     -1515.7168      3701.1783    
      2000   314.82417     -41249.704      12994.234     -2064.8261      3701.1783    
Loop time of 98.9077 on 8 procs for 2000 steps with 350 atoms

Performance: 0.874 ns/day, 27.474 hours/ns, 20.221 timesteps/s, 7.077 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 80.081     | 81.936     | 83.173     |  10.9 | 82.84
Bond    | 0.00061239 | 0.00072347 | 0.00088992 |   0.0 |  0.00
Neigh   | 6.2366     | 6.342      | 6.4345     |   2.5 |  6.41
Comm    | 1.3117     | 2.5526     | 4.4091     |  61.6 |  2.58
Output  | 0.00098135 | 0.0010552  | 0.0014222  |   0.4 |  0.00
Modify  | 7.9405     | 8.0344     | 8.1356     |   2.2 |  8.12
Other   |            | 0.04061    |            |       |  0.04

Nlocal:          43.75 ave          48 max          37 min
Histogram: 1 0 0 0 2 1 1 0 0 3
Nghost:        3371.25 ave        3421 max        3315 min
Histogram: 1 0 0 1 3 0 1 0 1 1
Neighs:        29033.5 ave       31732 max       24758 min
Histogram: 1 0 0 0 2 1 1 0 0 3

Total # of neighbors = 232268
Ave neighs/atom = 663.62286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -33.6188797916664
variable C2neg equal ${d2}
variable C2neg equal 72.9459989722896
variable C3neg equal ${d3}
variable C3neg equal -19.3262085755424
variable C4neg equal ${d4}
variable C4neg equal 12.6909711102968
variable C5neg equal ${d5}
variable C5neg equal 10.8895887531292
variable C6neg equal ${d6}
variable C6neg equal -2.83614848848581

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4170067184353
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.134170067184353 yz delta ${deltayz} remap units box
change_box all y delta 0 0.134170067184353 yz delta 0.00142323467109325 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.952373 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.952373 17.78526) with tilt (-7.7490667 -1.5378211 0.1437467)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.1 | 129.3 | 130.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41223.42      -47221.3        0              3775.9495    
       100   273.01347     -41244.154      1775.61        829.53387      3775.9495    
       200   287.92025     -41258.804     -1418.824      -3391.436       3775.9495    
       300   305.09611     -41265.442     -3940.0728     -2357.1497      3775.9495    
       400   304.55843     -41247.246     -7310.2094     -4473.0973      3775.9495    
       500   321.39377     -41243.521      120.27174     -2350.6228      3775.9495    
       600   302.86714     -41216.174      3901.4916     -1864.6539      3775.9495    
       700   302.24219     -41234.861     -4699.3906     -1818.27        3775.9495    
       800   286.34098     -41244.825      1661.4327     -2031.8251      3775.9495    
       900   301.17356     -41255.652     -3810.5185     -2686.51        3775.9495    
      1000   304.65433     -41239.661      11094.335     -4497.0361      3775.9495    
      1100   314.28993     -41228.024      1257.6621     -2959.8242      3775.9495    
      1200   310.03814     -41213.874     -6411.4455     -5921.6195      3775.9495    
      1300   288.90551     -41223.005     -10692.413     -6173.8634      3775.9495    
      1400   289.1036      -41244.502     -6563.2446     -3610.0144      3775.9495    
      1500   281.93134     -41239.733     -5839.2199     -5487.4034      3775.9495    
      1600   274.56833     -41213.632     -802.21806     -5947.227       3775.9495    
      1700   303.58497     -41217.47      -1255.6413     -3598.401       3775.9495    
      1800   318.9722      -41235.079      4065.4811     -1100.1595      3775.9495    
      1900   281.19107     -41233.253      2201.0001      3531.1249      3775.9495    
      2000   290.46513     -41253.277      3601.9519      2153.6719      3775.9495    
Loop time of 94.8775 on 8 procs for 2000 steps with 350 atoms

Performance: 0.911 ns/day, 26.355 hours/ns, 21.080 timesteps/s, 7.378 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.767     | 77.617     | 78.955     |  19.0 | 81.81
Bond    | 0.0006521  | 0.00072408 | 0.0008446  |   0.0 |  0.00
Neigh   | 5.7459     | 6.0549     | 6.176      |   5.3 |  6.38
Comm    | 1.9224     | 3.2666     | 7.1077     |  92.4 |  3.44
Output  | 0.0041862  | 0.0050727  | 0.0057302  |   0.7 |  0.01
Modify  | 7.7684     | 7.8935     | 8.211      |   4.8 |  8.32
Other   |            | 0.03969    |            |       |  0.04

Nlocal:          43.75 ave          51 max          40 min
Histogram: 3 1 0 1 0 2 0 0 0 1
Nghost:        3328.12 ave        3369 max        3282 min
Histogram: 1 1 0 1 1 0 1 1 0 2
Neighs:        28424.6 ave       32893 max       26137 min
Histogram: 3 1 0 1 0 2 0 0 0 1

Total # of neighbors = 227397
Ave neighs/atom = 649.70571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.1 | 129.3 | 130.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.46513     -41253.277      3601.9433      0              3775.9495    
       100   297.81027     -41247.981      6412.2725      3040.5411      3775.9495    
       200   330.27115     -41252.615      957.05573      2392.4191      3775.9495    
       300   295.19407     -41205.832     -18326.284     -3497.4937      3775.9495    
       400   310.70852     -41231.652     -12447.999     -193.21994      3775.9495    
       500   309.3954      -41244.071     -5389.531      -7002.1733      3775.9495    
       600   301.34899     -41239.833      132.97108     -4296.4493      3775.9495    
       700   311.4435      -41262.633      3454.9212     -2091.7655      3775.9495    
       800   283.88892     -41255.84      -4687.1595     -2197.855       3775.9495    
       900   268.55496     -41260.789      1953.4202      1489.2995      3775.9495    
      1000   282.41918     -41254.489     -9471.8284      94.184372      3775.9495    
      1100   294.40813     -41241.557      8717.1033     -3036.3434      3775.9495    
      1200   295.83649     -41234.731     -4672.3284     -4988.7886      3775.9495    
      1300   308.98123     -41244.885     -2403.5082      4177.0437      3775.9495    
      1400   305.39761     -41252.169     -16691.155      723.66999      3775.9495    
      1500   289.76883     -41256.366     -3009.9418     -1164.8133      3775.9495    
      1600   299.198       -41277.533     -10170.224     -2924.5415      3775.9495    
      1700   299.40985     -41271.04      -4947.6907     -2645.3802      3775.9495    
      1800   276.10224     -41207.607     -4527.1495     -2321.1842      3775.9495    
      1900   314.03135     -41234.21      -4445.489      -2636.9661      3775.9495    
      2000   301.36298     -41237.184     -12986.212      1428.041       3775.9495    
Loop time of 94.2739 on 8 procs for 2000 steps with 350 atoms

Performance: 0.916 ns/day, 26.187 hours/ns, 21.215 timesteps/s, 7.425 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.957     | 75.054     | 79.314     |  92.6 | 79.61
Bond    | 0.0006195  | 0.00071752 | 0.0008226  |   0.0 |  0.00
Neigh   | 4.3474     | 5.8992     | 6.2089     |  24.4 |  6.26
Comm    | 1.0757     | 5.3471     | 26.423     | 346.6 |  5.67
Output  | 0.00076756 | 0.00083024 | 0.0011236  |   0.0 |  0.00
Modify  | 7.6122     | 7.9332     | 9.5083     |  21.3 |  8.42
Other   |            | 0.03863    |            |       |  0.04

Nlocal:          43.75 ave          48 max          37 min
Histogram: 1 0 0 1 1 0 2 0 1 2
Nghost:        3332.62 ave        3372 max        3283 min
Histogram: 1 0 0 3 0 0 1 1 0 2
Neighs:        28417.9 ave       31305 max       24182 min
Histogram: 1 0 0 1 1 0 2 1 0 2

Total # of neighbors = 227343
Ave neighs/atom = 649.55143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -1.77259593700631
variable C2pos equal ${d2}
variable C2pos equal -33.8275920543438
variable C3pos equal ${d3}
variable C3pos equal 6.18928605703525
variable C4pos equal ${d4}
variable C4pos equal -4.15105164558896
variable C5pos equal ${d5}
variable C5pos equal 0.16258480218166
variable C6pos equal ${d6}
variable C6pos equal 21.9902622895498

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-33.6188797916664+${C1pos})
variable C12 equal 0.5*(-33.6188797916664+-1.77259593700631)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(72.9459989722896+${C2pos})
variable C22 equal 0.5*(72.9459989722896+-33.8275920543438)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-19.3262085755424+${C3pos})
variable C32 equal 0.5*(-19.3262085755424+6.18928605703525)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(12.6909711102968+${C4pos})
variable C42 equal 0.5*(12.6909711102968+-4.15105164558896)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(10.8895887531292+${C5pos})
variable C52 equal 0.5*(10.8895887531292+0.16258480218166)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-2.83614848848581+${C6pos})
variable C62 equal 0.5*(-2.83614848848581+21.9902622895498)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.9322199223083
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.9322199223083
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.179322199223083 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.605938) with tilt (-7.7490667 -1.5378211 0.14232347)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 130.9 | 132 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41231.328      52325.507      0              3701.1783    
       100   278.8223      -41256.351      9671.9713      6812.7802      3701.1783    
       200   296.92337     -41275.533     -3087.1158     -3644.0838      3701.1783    
       300   292.79428     -41261.031     -2820.7004     -424.03636      3701.1783    
       400   297.65444     -41251.15       14799.91       1595.8753      3701.1783    
       500   299.40265     -41227.184      8202.0267     -931.3265       3701.1783    
       600   302.21616     -41222.957     -9392.3272     -1543.0784      3701.1783    
       700   296.20822     -41259.615     -14583.595     -4587.6986      3701.1783    
       800   272.82944     -41251.788     -2674.6435      640.93441      3701.1783    
       900   295.61037     -41268.998      2668.278       9115.8919      3701.1783    
      1000   296.96211     -41244.222     -8378.1586      1564.6495      3701.1783    
      1100   310.47541     -41239.371      6115.7068     -1493.2998      3701.1783    
      1200   296.27324     -41238.221      440.8998       5700.6124      3701.1783    
      1300   292.13353     -41250.29       657.99521     -973.68929      3701.1783    
      1400   312.18503     -41277.177      2433.7263     -2349.8167      3701.1783    
      1500   310.5989      -41271.535     -5372.0776     -4402.4774      3701.1783    
      1600   295.88849     -41247.935     -8307.2516     -1688.5902      3701.1783    
      1700   303.04408     -41257.357     -2581.7999     -583.96228      3701.1783    
      1800   301.32626     -41263.152     -1074.005       487.78702      3701.1783    
      1900   293.82354     -41260.402      4003.8861      560.59708      3701.1783    
      2000   301.46042     -41249.694     -5964.6543     -202.33135      3701.1783    
Loop time of 97.4379 on 8 procs for 2000 steps with 350 atoms

Performance: 0.887 ns/day, 27.066 hours/ns, 20.526 timesteps/s, 7.184 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.45      | 77.745     | 82.165     |  96.2 | 79.79
Bond    | 0.00060732 | 0.00071708 | 0.00082779 |   0.0 |  0.00
Neigh   | 4.4258     | 6.0451     | 6.3704     |  25.0 |  6.20
Comm    | 1.1725     | 5.5969     | 27.869     | 358.0 |  5.74
Output  | 0.0037463  | 0.0045145  | 0.0051036  |   0.7 |  0.00
Modify  | 7.6696     | 8.006      | 9.6517     |  22.1 |  8.22
Other   |            | 0.03962    |            |       |  0.04

Nlocal:          43.75 ave          48 max          37 min
Histogram: 1 0 0 1 0 2 1 0 1 2
Nghost:           3376 ave        3409 max        3340 min
Histogram: 1 1 1 0 1 0 0 1 2 1
Neighs:        28988.6 ave       31773 max       24676 min
Histogram: 1 0 0 1 0 2 1 0 1 2

Total # of neighbors = 231909
Ave neighs/atom = 662.59714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 130.9 | 132 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.46042     -41249.694     -5964.6102      0              3701.1783    
       100   278.78289     -41232.01       8096.3109      7404.963       3701.1783    
       200   302.35215     -41276.212      5145.9003      4809.1738      3701.1783    
       300   280.11874     -41274.05      -3884.6674     -3862.2488      3701.1783    
       400   297.28604     -41272.017     -669.6318      -4628.7974      3701.1783    
       500   302.62261     -41252.309     -7494.2552      2774.5582      3701.1783    
       600   302.97478     -41249.67      -11452.997     -7979.1857      3701.1783    
       700   305.10621     -41259.274     -19169.523     -2512.4289      3701.1783    
       800   298.76567     -41262.503     -6746.2096     -136.57209      3701.1783    
       900   290.63774     -41270.518      1553.1048      7763.5588      3701.1783    
      1000   282.6875      -41271.836     -7493.7294     -3300.7787      3701.1783    
      1100   295.06443     -41283.038     -1555.3429     -1921.5795      3701.1783    
      1200   275.39602     -41239.49      -9310.0004     -2306.3936      3701.1783    
      1300   300.31182     -41238.253      8508.3603     -7142.5779      3701.1783    
      1400   302.83404     -41247.202     -4277.0167      4814.6681      3701.1783    
      1500   305.16797     -41263.834     -7993.6757     -337.4841       3701.1783    
      1600   288.43258     -41270.695     -7420.7136     -3172.5741      3701.1783    
      1700   295.28673     -41303.656     -8416.8391      4276.4283      3701.1783    
      1800   286.3676      -41292.071     -8462.1344     -40.77182       3701.1783    
      1900   303.36897     -41267.52       5732.2347     -62.355386      3701.1783    
      2000   288.9677      -41237.069      4418.5951     -2943.0688      3701.1783    
Loop time of 98.0822 on 8 procs for 2000 steps with 350 atoms

Performance: 0.881 ns/day, 27.245 hours/ns, 20.391 timesteps/s, 7.137 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.948     | 78.149     | 82.546     |  95.8 | 79.68
Bond    | 0.0006589  | 0.00072078 | 0.00080512 |   0.0 |  0.00
Neigh   | 4.4658     | 6.0636     | 6.402      |  24.7 |  6.18
Comm    | 1.4224     | 5.8076     | 27.988     | 350.9 |  5.92
Output  | 0.00081031 | 0.00087259 | 0.0012181  |   0.0 |  0.00
Modify  | 7.6715     | 8.0205     | 9.6427     |  21.8 |  8.18
Other   |            | 0.03966    |            |       |  0.04

Nlocal:          43.75 ave          48 max          36 min
Histogram: 1 0 1 0 0 1 0 0 3 2
Nghost:        3382.25 ave        3416 max        3343 min
Histogram: 1 0 1 1 1 0 1 1 1 1
Neighs:        29026.1 ave       31660 max       24104 min
Histogram: 1 0 1 0 0 1 0 0 3 2

Total # of neighbors = 232209
Ave neighs/atom = 663.45429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -42.5176745787171
variable C2neg equal ${d2}
variable C2neg equal -39.7929396666743
variable C3neg equal ${d3}
variable C3neg equal -10.9283315039613
variable C4neg equal ${d4}
variable C4neg equal 2.73615232442986
variable C5neg equal ${d5}
variable C5neg equal 17.3055922304465
variable C6neg equal ${d6}
variable C6neg equal -6.02062733819557

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.9322199223083
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.179322199223083 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.964582) with tilt (-7.7490667 -1.5378211 0.14232347)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.9 | 129.8 | 130.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41229.169     -49979.596      0              3775.9495    
       100   278.0971      -41254.664      1268.5496      61.256483      3775.9495    
       200   283.9573      -41259.33      -1208.8644     -3341.2952      3775.9495    
       300   296.93212     -41260.322     -13203.446     -2435.9072      3775.9495    
       400   306.87986     -41254.02      -3826.3124     -733.41434      3775.9495    
       500   302.70355     -41229.779      4983.9388     -1453.3872      3775.9495    
       600   314.79088     -41227.374      4746.3373      193.1433       3775.9495    
       700   310.90859     -41235.304      2841.2275     -2110.0835      3775.9495    
       800   301.45185     -41260.367      6498.5435      1535.0418      3775.9495    
       900   280.11911     -41251.913     -7679.7843      217.56227      3775.9495    
      1000   283.69573     -41248.677     -11001.587     -2555.9119      3775.9495    
      1100   311.02836     -41248.325     -2330.3535      102.82492      3775.9495    
      1200   326.0584      -41257.411     -1670.7597     -1603.7142      3775.9495    
      1300   295.96026     -41231.646     -4916.4219     -2460.5987      3775.9495    
      1400   286.43086     -41228.103     -3206.1918     -3018.0885      3775.9495    
      1500   301.4685      -41248.343      20227.494      3060.8657      3775.9495    
      1600   288.91565     -41238.012     -2755.0962     -1710.6811      3775.9495    
      1700   299.32023     -41248.299     -8269.1438     -9104.6354      3775.9495    
      1800   293.90356     -41242.798     -10492.295     -1365.7768      3775.9495    
      1900   296.63824     -41236.79      -6276.3095     -5160.2743      3775.9495    
      2000   308.08308     -41222.262     -14316.64      -48.886685      3775.9495    
Loop time of 94.6408 on 8 procs for 2000 steps with 350 atoms

Performance: 0.913 ns/day, 26.289 hours/ns, 21.133 timesteps/s, 7.396 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.316     | 75.863     | 80.148     |  94.1 | 80.16
Bond    | 0.00060395 | 0.00072795 | 0.00083737 |   0.0 |  0.00
Neigh   | 3.8066     | 5.2512     | 5.5312     |  23.9 |  5.55
Comm    | 1.3225     | 5.6112     | 27.139     | 345.7 |  5.93
Output  | 0.0037905  | 0.0046372  | 0.0052457  |   0.7 |  0.00
Modify  | 7.5804     | 7.8708     | 9.3374     |  19.8 |  8.32
Other   |            | 0.0389     |            |       |  0.04

Nlocal:          43.75 ave          48 max          38 min
Histogram: 1 0 1 0 1 0 2 0 1 2
Nghost:           3344 ave        3395 max        3282 min
Histogram: 1 1 0 0 0 2 1 1 1 1
Neighs:        28407.2 ave       31190 max       24904 min
Histogram: 1 1 0 1 0 2 0 1 0 2

Total # of neighbors = 227258
Ave neighs/atom = 649.30857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.9 | 129.8 | 130.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.08308     -41222.262     -14316.644      0              3775.9495    
       100   324.06891     -41261.256      3363.8233     -1290.9732      3775.9495    
       200   304.32333     -41258.946     -2066.2322      3656.7502      3775.9495    
       300   286.67221     -41241.02      -6356.4592     -880.50195      3775.9495    
       400   290.09083     -41245.349     -2787.3887      2443.8132      3775.9495    
       500   296.32883     -41272.764     -15269.9       -9307.9646      3775.9495    
       600   270.9501      -41264.861     -12157.935     -9444.4266      3775.9495    
       700   307.86325     -41278.364     -1472.1282     -1983.9062      3775.9495    
       800   309.04846     -41256.857     -14700.533     -744.41583      3775.9495    
       900   311.69128     -41263.747      94.155315     -1920.2649      3775.9495    
      1000   306.98127     -41269.163     -1636.7632     -5339.008       3775.9495    
      1100   308.49737     -41281.048     -19655.921     -4958.3902      3775.9495    
      1200   278.71515     -41273.432     -3766.9862     -1139.0607      3775.9495    
      1300   285.34015     -41278.024     -12000.104      1158.5358      3775.9495    
      1400   312.44718     -41271.043     -10737.635      2411.8674      3775.9495    
      1500   313.68614     -41260.057     -2268.035      -6473.6902      3775.9495    
      1600   293.4873      -41241.914      5675.2491      5482.3927      3775.9495    
      1700   310.07888     -41258.399     -1930.7256      1997.9233      3775.9495    
      1800   298.28761     -41245.443      5660.5132     -664.8142       3775.9495    
      1900   282.07983     -41234.571      3850.6535     -6169.0825      3775.9495    
      2000   284.1972      -41255.278      6129.8128      4160.3717      3775.9495    
Loop time of 94.5063 on 8 procs for 2000 steps with 350 atoms

Performance: 0.914 ns/day, 26.252 hours/ns, 21.163 timesteps/s, 7.407 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.742     | 75.798     | 79.91      |  96.2 | 80.20
Bond    | 0.00063197 | 0.00073537 | 0.00082474 |   0.0 |  0.00
Neigh   | 3.8244     | 5.3104     | 5.6009     |  24.4 |  5.62
Comm    | 1.3523     | 5.4697     | 27.506     | 357.9 |  5.79
Output  | 0.00073293 | 0.00079001 | 0.001115   |   0.0 |  0.00
Modify  | 7.5885     | 7.8879     | 9.3955     |  20.3 |  8.35
Other   |            | 0.03936    |            |       |  0.04

Nlocal:          43.75 ave          49 max          37 min
Histogram: 1 1 0 1 0 2 0 0 1 2
Nghost:        3317.25 ave        3359 max        3259 min
Histogram: 1 0 0 0 1 2 1 2 0 1
Neighs:        28422.9 ave       31849 max       24344 min
Histogram: 1 1 0 1 0 2 0 1 0 2

Total # of neighbors = 227383
Ave neighs/atom = 649.66571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -29.4579370926835
variable C2pos equal ${d2}
variable C2pos equal -21.9064227396521
variable C3pos equal ${d3}
variable C3pos equal 26.0849897991452
variable C4pos equal ${d4}
variable C4pos equal -2.09789777792015
variable C5pos equal ${d5}
variable C5pos equal -4.75835560920035
variable C6pos equal ${d6}
variable C6pos equal 0.796035122482743

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-42.5176745787171+${C1pos})
variable C13 equal 0.5*(-42.5176745787171+-29.4579370926835)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-39.7929396666743+${C2pos})
variable C23 equal 0.5*(-39.7929396666743+-21.9064227396521)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-10.9283315039613+${C3pos})
variable C33 equal 0.5*(-10.9283315039613+26.0849897991452)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(2.73615232442986+${C4pos})
variable C43 equal 0.5*(2.73615232442986+-2.09789777792015)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(17.3055922304465+${C5pos})
variable C53 equal 0.5*(17.3055922304465+-4.75835560920035)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-6.02062733819557+${C6pos})
variable C63 equal 0.5*(-6.02062733819557+0.796035122482743)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.9322199223083
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.9322199223083
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.179322199223083 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 -0.036998732)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.5 | 130.4 | 131.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41250.106     -5161.3091      0              3738.5639    
       100   266.65935     -41259.354      7642.6664      2933.4994      3738.5639    
       200   279.79365     -41270.304     -2301.9979     -4133.0019      3738.5639    
       300   300.94569     -41278.827     -5268.0272     -1938.2431      3738.5639    
       400   303.93731     -41271.45       4514.2393      1179.2155      3738.5639    
       500   301.61824     -41249.55       12898.424     -2076.8085      3738.5639    
       600   313.64224     -41244.645      6084.4213      3926.4555      3738.5639    
       700   309.1629      -41244.094      706.9618      -1978.0396      3738.5639    
       800   303.14938     -41276.906      579.51324     -432.67217      3738.5639    
       900   290.88377     -41273.5       -6848.7367      180.57178      3738.5639    
      1000   297.57511     -41271.732     -7716.6023     -1775.1795      3738.5639    
      1100   313.21723     -41263.807     -7096.945      -4932.97        3738.5639    
      1200   315.07623     -41257.931     -5810.9273     -2361.0653      3738.5639    
      1300   296.95998     -41247.619     -1787.6597      547.90184      3738.5639    
      1400   293.67828     -41249.954     -1263.5906      3613.686       3738.5639    
      1500   308.02215     -41261.537     -1533.5344      685.95575      3738.5639    
      1600   291.00703     -41225.55      -4483.5191     -2155.7496      3738.5639    
      1700   342.54605     -41243.873     -509.04448     -3615.1918      3738.5639    
      1800   314.71859     -41234.098      987.7786       2073.8425      3738.5639    
      1900   300.90486     -41239.602     -2331.2286     -3316.1163      3738.5639    
      2000   309.11638     -41262.339      8005.0021      3026.8191      3738.5639    
Loop time of 96.7349 on 8 procs for 2000 steps with 350 atoms

Performance: 0.893 ns/day, 26.871 hours/ns, 20.675 timesteps/s, 7.236 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.624     | 77.377     | 81.299     |  93.7 | 79.99
Bond    | 0.00070317 | 0.00075318 | 0.00081814 |   0.0 |  0.00
Neigh   | 4.3773     | 5.9859     | 6.3092     |  25.1 |  6.19
Comm    | 1.4275     | 5.3551     | 27.089     | 356.0 |  5.54
Output  | 0.0037728  | 0.0045748  | 0.0051818  |   0.7 |  0.00
Modify  | 7.6394     | 7.9718     | 9.6029     |  22.0 |  8.24
Other   |            | 0.03947    |            |       |  0.04

Nlocal:          43.75 ave          48 max          38 min
Histogram: 1 0 0 1 0 2 1 0 1 2
Nghost:        3358.25 ave        3392 max        3328 min
Histogram: 1 1 1 1 0 1 1 0 1 1
Neighs:          28688 ave       31491 max       25150 min
Histogram: 1 0 1 0 2 1 0 1 1 1

Total # of neighbors = 229504
Ave neighs/atom = 655.72571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.5 | 130.4 | 131.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.11638     -41262.339      8004.9768      0              3738.5639    
       100   280.66229     -41239.701      2373.1651      1887.6487      3738.5639    
       200   279.28675     -41249.876      12571.469     -616.75469      3738.5639    
       300   288.05141     -41278.422     -17999.982      2497.0057      3738.5639    
       400   277.1866      -41264.126     -14366.778     -4973.6398      3738.5639    
       500   324.52627     -41279.244     -1510.0655     -5807.1985      3738.5639    
       600   294.85713     -41243.558      1523.7603      1412.1225      3738.5639    
       700   319.7919      -41265.758      420.38107      2301.7643      3738.5639    
       800   303.70231     -41266.228     -654.2964      -731.6843       3738.5639    
       900   265.37935     -41256.468      6895.2212      502.13951      3738.5639    
      1000   291.44834     -41272.668     -3657.2506      808.69896      3738.5639    
      1100   300.73869     -41260.092      7466.8395     -282.46797      3738.5639    
      1200   290.63781     -41240.882     -865.8097      -363.77017      3738.5639    
      1300   299.07747     -41237.491      4075.1303     -2017.9776      3738.5639    
      1400   296.33931     -41236.961     -9994.2802     -1773.407       3738.5639    
      1500   293.36406     -41265.122     -22324.023      2242.6599      3738.5639    
      1600   265.89191     -41251.243     -7327.6763     -3778.5737      3738.5639    
      1700   288.0803      -41255.701     -6024.565      -2920.0824      3738.5639    
      1800   301.9775      -41253.651     -1868.8697     -1307.2916      3738.5639    
      1900   305.76753     -41252.081      7397.08       -1609.526       3738.5639    
      2000   287.95249     -41237.906     -329.36102     -4177.562       3738.5639    
Loop time of 96.3662 on 8 procs for 2000 steps with 350 atoms

Performance: 0.897 ns/day, 26.768 hours/ns, 20.754 timesteps/s, 7.264 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.899     | 79.903     | 80.784     |   8.0 | 82.92
Bond    | 0.00066126 | 0.00072871 | 0.00082752 |   0.0 |  0.00
Neigh   | 5.9906     | 6.2102     | 6.3366     |   4.5 |  6.44
Comm    | 1.483      | 2.3639     | 3.3699     |  46.3 |  2.45
Output  | 0.00085161 | 0.00094682 | 0.0013233  |   0.0 |  0.00
Modify  | 7.7188     | 7.8474     | 8.0717     |   4.1 |  8.14
Other   |            | 0.04002    |            |       |  0.04

Nlocal:          43.75 ave          48 max          36 min
Histogram: 1 0 0 0 1 2 0 0 1 3
Nghost:        3355.38 ave        3393 max        3315 min
Histogram: 1 0 0 2 1 2 0 0 0 2
Neighs:        28687.8 ave       31242 max       23821 min
Histogram: 1 0 0 0 1 2 0 0 1 3

Total # of neighbors = 229502
Ave neighs/atom = 655.72
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -55.0261763748019
variable C2neg equal ${d2}
variable C2neg equal 21.7085331901865
variable C3neg equal ${d3}
variable C3neg equal 15.287051827765
variable C4neg equal ${d4}
variable C4neg equal 0.0938834886220303
variable C5neg equal ${d5}
variable C5neg equal 16.1547880453947
variable C6neg equal ${d6}
variable C6neg equal -13.4106392933985

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.9322199223083
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.179322199223083 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.32164567)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.4 | 131.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41240.272     -3567.7984      0              3738.5639    
       100   273.62906     -41258.846     -1378.2434      1110.9321      3738.5639    
       200   292.11306     -41275.866      5844.9785     -5645.7312      3738.5639    
       300   292.51703     -41264.587     -12753.5       -518.46357      3738.5639    
       400   293.60746     -41250.609     -133.77931     -2589.9522      3738.5639    
       500   288.22674     -41224.369      13499.441     -627.6102       3738.5639    
       600   300.33619     -41226.602     -10602.86      -4861.5758      3738.5639    
       700   301.94656     -41244.379     -8379.3652     -5568.2129      3738.5639    
       800   281.12449     -41260.346      8787.3987     -502.63572      3738.5639    
       900   297.41162     -41272.81       206.66793      5695.247       3738.5639    
      1000   285.76123     -41241.348      13433.782      1823.9904      3738.5639    
      1100   319.04348     -41251.828      6207.4426     -3345.8748      3738.5639    
      1200   308.65771     -41243.459      6523.6818     -2572.037       3738.5639    
      1300   297.43562     -41260.047      5877.9263      964.3312       3738.5639    
      1400   274.52542     -41245.481      1765.3943      2905.2147      3738.5639    
      1500   295.12753     -41253.696      2332.0541     -1718.2536      3738.5639    
      1600   304.67705     -41258.467      3625.315      -2652.7092      3738.5639    
      1700   307.01043     -41260.347     -6632.3405     -103.98461      3738.5639    
      1800   298.64739     -41252.615     -14138.936     -298.53144      3738.5639    
      1900   288.59322     -41252.583     -6314.6728      288.55108      3738.5639    
      2000   285.0299      -41269.196     -2841.8637     -207.35222      3738.5639    
Loop time of 96.5564 on 8 procs for 2000 steps with 350 atoms

Performance: 0.895 ns/day, 26.821 hours/ns, 20.713 timesteps/s, 7.250 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.044     | 77.86      | 80.913     |  68.2 | 80.64
Bond    | 0.00064689 | 0.00072123 | 0.00081782 |   0.0 |  0.00
Neigh   | 4.8702     | 6.1129     | 6.3913     |  19.2 |  6.33
Comm    | 1.5555     | 4.6085     | 20.41      | 280.1 |  4.77
Output  | 0.0039931  | 0.0048468  | 0.0054296  |   0.7 |  0.01
Modify  | 7.6435     | 7.9299     | 9.1894     |  17.0 |  8.21
Other   |            | 0.03951    |            |       |  0.04

Nlocal:          43.75 ave          46 max          41 min
Histogram: 1 0 1 0 1 0 2 0 2 1
Nghost:        3352.12 ave        3385 max        3317 min
Histogram: 2 0 0 1 0 1 1 1 1 1
Neighs:          28720 ave       30157 max       27065 min
Histogram: 1 1 0 1 0 2 0 1 1 1

Total # of neighbors = 229760
Ave neighs/atom = 656.45714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.4 | 131.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   285.0299      -41269.196     -2841.894       0              3738.5639    
       100   308.47795     -41278.62      -2554.9866     -1002.2139      3738.5639    
       200   315.38278     -41261.738     -6046.3058     -2318.9993      3738.5639    
       300   286.61385     -41230.645     -5871.8002     -3354.5669      3738.5639    
       400   303.27254     -41250.01      -273.25845     -615.07898      3738.5639    
       500   290.89396     -41240.753     -12549.618     -1775.4572      3738.5639    
       600   295.6651      -41256.239     -14668.597     -6836.3829      3738.5639    
       700   294.74731     -41282.165      3655.7246      5559.1939      3738.5639    
       800   295.76798     -41287.164      7274.0189      498.13761      3738.5639    
       900   298.84243     -41253.645     -20000.521      357.64921      3738.5639    
      1000   295.15312     -41236.309     -6251.0083     -127.07997      3738.5639    
      1100   327.24333     -41268.648     -9469.605       369.01498      3738.5639    
      1200   297.49555     -41246.327     -5500.2668      3940.0428      3738.5639    
      1300   291.92562     -41253.932     -2164.1348     -230.56079      3738.5639    
      1400   297.62319     -41278.664      5292.2501      4870.5364      3738.5639    
      1500   282.70784     -41269.75       5095.36        1596.9201      3738.5639    
      1600   311.55769     -41273.91       17.578322      628.85859      3738.5639    
      1700   314.34304     -41253.704     -13782.545     -1630.2853      3738.5639    
      1800   317.82925     -41269.68       4207.3885      2276.3369      3738.5639    
      1900   285.95719     -41249.56      -5015.0735     -6256.2155      3738.5639    
      2000   303.79875     -41269.598     -2483.1578      3038.8715      3738.5639    
Loop time of 96.0947 on 8 procs for 2000 steps with 350 atoms

Performance: 0.899 ns/day, 26.693 hours/ns, 20.813 timesteps/s, 7.284 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.931     | 76.696     | 80.277     |  94.2 | 79.81
Bond    | 0.0006736  | 0.00072967 | 0.00084842 |   0.0 |  0.00
Neigh   | 4.4251     | 6.0575     | 6.3529     |  25.1 |  6.30
Comm    | 1.8466     | 5.4334     | 27.182     | 353.6 |  5.65
Output  | 0.00081948 | 0.00088722 | 0.0011943  |   0.0 |  0.00
Modify  | 7.5633     | 7.8666     | 9.5191     |  22.3 |  8.19
Other   |            | 0.03979    |            |       |  0.04

Nlocal:          43.75 ave          49 max          34 min
Histogram: 1 0 0 1 1 0 0 0 3 2
Nghost:           3363 ave        3404 max        3308 min
Histogram: 1 0 0 0 3 0 2 0 1 1
Neighs:        28710.6 ave       31958 max       22532 min
Histogram: 1 0 0 1 1 0 0 0 3 2

Total # of neighbors = 229685
Ave neighs/atom = 656.24286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -18.0943357344672
variable C2pos equal ${d2}
variable C2pos equal -12.2563084398773
variable C3pos equal ${d3}
variable C3pos equal 29.781892873248
variable C4pos equal ${d4}
variable C4pos equal 2.97806088829475
variable C5pos equal ${d5}
variable C5pos equal -3.77517374000395
variable C6pos equal ${d6}
variable C6pos equal 9.27607208107333

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-55.0261763748019+${C1pos})
variable C14 equal 0.5*(-55.0261763748019+-18.0943357344672)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(21.7085331901865+${C2pos})
variable C24 equal 0.5*(21.7085331901865+-12.2563084398773)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(15.287051827765+${C3pos})
variable C34 equal 0.5*(15.287051827765+29.781892873248)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(0.0938834886220303+${C4pos})
variable C44 equal 0.5*(0.0938834886220303+2.97806088829475)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(16.1547880453947+${C5pos})
variable C54 equal 0.5*(16.1547880453947+-3.77517374000395)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-13.4106392933985+${C6pos})
variable C64 equal 0.5*(-13.4106392933985+9.27607208107333)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.9322199223083
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.9322199223083
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.179322199223083 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.7171433 0.14232347)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.5 | 130.4 | 131.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41248.964     -5563.4172      0              3738.5639    
       100   261.12776     -41252.683      9418.4249      2688.3592      3738.5639    
       200   277.55542     -41266.805     -5161.4173     -3634.2147      3738.5639    
       300   299.08416     -41272.95       5395.6158     -2573.9466      3738.5639    
       400   302.47124     -41266.259      3874.4147     -3144.2689      3738.5639    
       500   287.64742     -41232.25       10302.473     -3795.6551      3738.5639    
       600   302.69599     -41232.963      2597.2723     -1180.3914      3738.5639    
       700   305.78988     -41234.232     -4269.3762     -521.97172      3738.5639    
       800   286.56856     -41247.104      14020.223     -2466.7544      3738.5639    
       900   296.18032     -41270.42      -2540.2011      2324.1307      3738.5639    
      1000   289.15553     -41250.595     -6651.7096     -255.4164       3738.5639    
      1100   311.42801     -41253.983     -4381.6081      1354.0915      3738.5639    
      1200   301.54954     -41242.469      2385.5085      439.57761      3738.5639    
      1300   322.04721     -41267.235      2197.8108      297.31963      3738.5639    
      1400   285.90815     -41240.359      2084.5875      1341.6346      3738.5639    
      1500   308.68911     -41275.136     -5693.8465     -2566.7984      3738.5639    
      1600   294.65543     -41278.63      -3112.0433     -4393.34        3738.5639    
      1700   290.0989      -41269.647     -4598.9925     -7216.6495      3738.5639    
      1800   295.81875     -41245.153      7228.2497      2213.4074      3738.5639    
      1900   297.09992     -41230.979     -3913.8282      4402.9394      3738.5639    
      2000   321.25015     -41253.651      4671.4438      683.05709      3738.5639    
Loop time of 95.9532 on 8 procs for 2000 steps with 350 atoms

Performance: 0.900 ns/day, 26.654 hours/ns, 20.844 timesteps/s, 7.295 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.633     | 76.581     | 80.573     |  95.1 | 79.81
Bond    | 0.00067494 | 0.00073902 | 0.00086357 |   0.0 |  0.00
Neigh   | 4.4229     | 6.0235     | 6.3166     |  24.7 |  6.28
Comm    | 1.3958     | 5.3926     | 27.324     | 358.2 |  5.62
Output  | 0.0039098  | 0.0048425  | 0.0055002  |   0.8 |  0.01
Modify  | 7.6135     | 7.9108     | 9.5314     |  21.8 |  8.24
Other   |            | 0.04006    |            |       |  0.04

Nlocal:          43.75 ave          49 max          39 min
Histogram: 1 0 2 0 0 2 1 0 1 1
Nghost:        3365.38 ave        3392 max        3334 min
Histogram: 1 1 0 2 0 0 0 1 1 2
Neighs:        28678.2 ave       31960 max       25719 min
Histogram: 1 1 1 0 2 1 0 0 1 1

Total # of neighbors = 229426
Ave neighs/atom = 655.50286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.5 | 130.4 | 131.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   321.25015     -41253.651      4671.4722      0              3738.5639    
       100   309.57529     -41258.76       1650.8539      3762.8208      3738.5639    
       200   263.4723      -41233.37       5202.2769     -510.26892      3738.5639    
       300   291.35909     -41258.991      2068.409      -1300.9733      3738.5639    
       400   303.179       -41267.085     -939.06038      616.16808      3738.5639    
       500   303.0147      -41260.42      -2193.5102      1914.717       3738.5639    
       600   325.56785     -41271.148     -4483.9903     -369.28141      3738.5639    
       700   318.96669     -41241.909      3181.0061      3434.8302      3738.5639    
       800   323.92578     -41227.981      4536.4345      2698.3524      3738.5639    
       900   318.98637     -41251.281     -17220.439     -3093.1368      3738.5639    
      1000   284.65523     -41239.81      -12922.982      2051.0566      3738.5639    
      1100   304.80572     -41264.127     -1452.5024      5581.5728      3738.5639    
      1200   302.39341     -41263.315     -11774.85      -1137.5404      3738.5639    
      1300   295.40856     -41260.298      1677.0626     -3015.8919      3738.5639    
      1400   286.06751     -41257.029      6087.2716     -2501.6085      3738.5639    
      1500   302.42709     -41267.547      4877.1342     -155.04219      3738.5639    
      1600   303.96183     -41240.553      1888.4651     -4459.0597      3738.5639    
      1700   296.98676     -41223.017     -6834.8942     -4638.3535      3738.5639    
      1800   303.35389     -41233.631      5465.014      -7002.4429      3738.5639    
      1900   301.77278     -41263.774     -8849.3081     -3903.8593      3738.5639    
      2000   279.05461     -41267.737     -12653.468     -6111.8425      3738.5639    
Loop time of 96.2638 on 8 procs for 2000 steps with 350 atoms

Performance: 0.898 ns/day, 26.740 hours/ns, 20.776 timesteps/s, 7.272 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.729     | 76.837     | 80.705     |  95.7 | 79.82
Bond    | 0.00068612 | 0.00074591 | 0.00087125 |   0.0 |  0.00
Neigh   | 4.429      | 6.0412     | 6.3375     |  24.9 |  6.28
Comm    | 1.5355     | 5.4096     | 27.501     | 360.4 |  5.62
Output  | 0.00082155 | 0.00089861 | 0.0012635  |   0.0 |  0.00
Modify  | 7.6338     | 7.934      | 9.5674     |  22.0 |  8.24
Other   |            | 0.03988    |            |       |  0.04

Nlocal:          43.75 ave          46 max          37 min
Histogram: 1 0 0 0 0 1 1 1 0 4
Nghost:         3364.5 ave        3409 max        3311 min
Histogram: 1 0 0 1 2 1 1 0 1 1
Neighs:        28705.2 ave       30225 max       24510 min
Histogram: 1 0 0 0 0 1 1 1 0 4

Total # of neighbors = 229642
Ave neighs/atom = 656.12
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -74.6252734820463
variable C2neg equal ${d2}
variable C2neg equal 18.5635240450488
variable C3neg equal ${d3}
variable C3neg equal -42.0304628308112
variable C4neg equal ${d4}
variable C4neg equal 10.5697583283014
variable C5neg equal ${d5}
variable C5neg equal 18.6726407372351
variable C6neg equal ${d6}
variable C6neg equal -34.6793060444965

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.9322199223083
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.179322199223083 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.3584989 0.14232347)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.3 | 131.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41241.427     -3592.3517      0              3738.5639    
       100   278.30917     -41264.531      1421.7821      2745.4542      3738.5639    
       200   283.03443     -41267.851     -2561.5254     -3776.405       3738.5639    
       300   292.80979     -41266.085     -5512.7126     -1051.2594      3738.5639    
       400   298.62197     -41256.171     -3724.7576     -403.04657      3738.5639    
       500   292.93096     -41233.979     -1408.5239     -2890.3957      3738.5639    
       600   313.82453     -41248.727     -2057.6472     -1448.0434      3738.5639    
       700   310.93879     -41264.401     -20359.499      1168.1774      3738.5639    
       800   285.92445     -41266.878      6374.2551      1994.3207      3738.5639    
       900   282.25831     -41261.015     -139.64541      1213.8523      3738.5639    
      1000   314.65088     -41271.188     -138.53695      2236.3682      3738.5639    
      1100   304.68194     -41239.953      226.11122     -2721.8303      3738.5639    
      1200   289.57545     -41227.987     -9436.2255      430.77769      3738.5639    
      1300   294.86368     -41240.932     -10760.142     -2440.5734      3738.5639    
      1400   305.34484     -41251.784     -1662.0689      3084.0846      3738.5639    
      1500   297.92507     -41241.069     -7467.1008     -7999.281       3738.5639    
      1600   293.55649     -41248.466     -3260.5584     -3838.31        3738.5639    
      1700   292.85443     -41265.412     -1028.5445      833.86574      3738.5639    
      1800   277.71339     -41275.63      -12906.869     -5759.1724      3738.5639    
      1900   279.36474     -41282.475     -5503.0708     -543.08203      3738.5639    
      2000   303.95245     -41273.918     -5946.1265     -420.71029      3738.5639    
Loop time of 95.8993 on 8 procs for 2000 steps with 350 atoms

Performance: 0.901 ns/day, 26.639 hours/ns, 20.855 timesteps/s, 7.299 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.43      | 76.603     | 80.715     |  96.2 | 79.88
Bond    | 0.00063283 | 0.00074765 | 0.00086153 |   0.0 |  0.00
Neigh   | 4.3738     | 5.9755     | 6.2901     |  24.9 |  6.23
Comm    | 1.2743     | 5.3902     | 27.545     | 362.2 |  5.62
Output  | 0.0036538  | 0.0044646  | 0.005058   |   0.7 |  0.00
Modify  | 7.5627     | 7.8847     | 9.5078     |  21.9 |  8.22
Other   |            | 0.04062    |            |       |  0.04

Nlocal:          43.75 ave          48 max          41 min
Histogram: 1 1 3 0 1 0 0 1 0 1
Nghost:           3364 ave        3408 max        3319 min
Histogram: 1 1 2 0 0 0 0 2 1 1
Neighs:        28739.1 ave       31439 max       27071 min
Histogram: 1 1 3 0 1 0 1 0 0 1

Total # of neighbors = 229913
Ave neighs/atom = 656.89429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.3 | 131.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.95245     -41273.918     -5946.0738      0              3738.5639    
       100   305.30529     -41267.696     -3904.5817      4710.3692      3738.5639    
       200   318.06887     -41249.61      -9507.1351     -3560.1994      3738.5639    
       300   323.63254     -41237.182      1877.2573      4366.6923      3738.5639    
       400   315.9734      -41242.92       5897.6304      1432.6184      3738.5639    
       500   305.5303      -41249.532      7824.745      -3173.6783      3738.5639    
       600   303.26488     -41258.605      11685.715      407.57138      3738.5639    
       700   290.82075     -41251.044     -2859.4807     -1237.1027      3738.5639    
       800   292.88764     -41271.354     -1317.2757      3037.6425      3738.5639    
       900   274.72795     -41276.484     -3138.9308      2394.7203      3738.5639    
      1000   276.00084     -41272.393     -11347.965      1449.8945      3738.5639    
      1100   293.464       -41257.753     -2197.1811     -4994.5738      3738.5639    
      1200   286.15951     -41241.238     -6597.3107      2690.7973      3738.5639    
      1300   308.74913     -41254.582     -9496.8798     -813.33935      3738.5639    
      1400   313.13493     -41252.64      -3952.2534      1107.1246      3738.5639    
      1500   302.50918     -41269.074      4429.7173     -3761.1423      3738.5639    
      1600   281.45221     -41271.481     -9137.3392     -232.77445      3738.5639    
      1700   288.60939     -41267.077     -7517.8558      1784.8204      3738.5639    
      1800   295.18084     -41254.983      715.05174      4342.0261      3738.5639    
      1900   306.91591     -41260.153     -9598.9562      3102.9198      3738.5639    
      2000   300.74481     -41252.389     -2018.5396     -6921.5103      3738.5639    
Loop time of 95.8957 on 8 procs for 2000 steps with 350 atoms

Performance: 0.901 ns/day, 26.638 hours/ns, 20.856 timesteps/s, 7.300 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.125     | 76.544     | 80.693     |  97.4 | 79.82
Bond    | 0.00062585 | 0.00072871 | 0.00083431 |   0.0 |  0.00
Neigh   | 4.3667     | 5.9853     | 6.2961     |  25.1 |  6.24
Comm    | 1.2289     | 5.3837     | 27.786     | 367.0 |  5.61
Output  | 0.00076757 | 0.0008404  | 0.0011865  |   0.0 |  0.00
Modify  | 7.6231     | 7.94       | 9.5793     |  22.1 |  8.28
Other   |            | 0.04076    |            |       |  0.04

Nlocal:          43.75 ave          49 max          37 min
Histogram: 1 0 1 0 0 2 1 1 1 1
Nghost:        3368.62 ave        3407 max        3323 min
Histogram: 1 0 1 0 2 2 0 0 0 2
Neighs:        28687.2 ave       31962 max       24455 min
Histogram: 1 0 1 0 2 0 1 1 1 1

Total # of neighbors = 229498
Ave neighs/atom = 655.70857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 82.829233197611
variable C2pos equal ${d2}
variable C2pos equal 29.5385025656599
variable C3pos equal ${d3}
variable C3pos equal 92.0957835495484
variable C4pos equal ${d4}
variable C4pos equal -0.0103799975513172
variable C5pos equal ${d5}
variable C5pos equal -3.25979143868774
variable C6pos equal ${d6}
variable C6pos equal 5.9405989766787

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-74.6252734820463+${C1pos})
variable C15 equal 0.5*(-74.6252734820463+82.829233197611)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(18.5635240450488+${C2pos})
variable C25 equal 0.5*(18.5635240450488+29.5385025656599)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-42.0304628308112+${C3pos})
variable C35 equal 0.5*(-42.0304628308112+92.0957835495484)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(10.5697583283014+${C4pos})
variable C45 equal 0.5*(10.5697583283014+-0.0103799975513172)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(18.6726407372351+${C5pos})
variable C55 equal 0.5*(18.6726407372351+-3.25979143868774)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-34.6793060444965+${C6pos})
variable C65 equal 0.5*(-34.6793060444965+5.9405989766787)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4170067184353

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4170067184353
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.134170067184353 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.8832367 -1.5378211 0.14232347)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.6 | 130.8 | 132 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41245.831     -3188.5806      0              3738.5639    
       100   277.72552     -41268.178      6194.9209      2156.5015      3738.5639    
       200   279.29995     -41267.213      9496.9429     -3930.1027      3738.5639    
       300   295.41503     -41273.228     -3011.5495      689.77271      3738.5639    
       400   299.79291     -41262.128      4740.3763     -2325.383       3738.5639    
       500   297.83305     -41240.824     -7409.8738     -10082.286      3738.5639    
       600   310.61543     -41244.72      -4216.552      -112.24187      3738.5639    
       700   280.37314     -41237.716     -12217.987     -3761.7652      3738.5639    
       800   275.01964     -41260.355      1645.7536      2985.2688      3738.5639    
       900   296.62588     -41272.603     -2039.128       3627.3009      3738.5639    
      1000   302.67132     -41256.947     -4291.5866      146.26673      3738.5639    
      1100   303.93218     -41243.565     -6988.4275      159.91019      3738.5639    
      1200   297.44953     -41237.253     -9847.7607     -3179.5735      3738.5639    
      1300   312.55813     -41264.073     -7477.6862      1844.207       3738.5639    
      1400   284.70068     -41249.288     -6012.218      -1557.6365      3738.5639    
      1500   294.51868     -41256.379      5371.4228      1288.979       3738.5639    
      1600   284.112       -41241.793      1027.4023     -5446.8329      3738.5639    
      1700   314.32801     -41266.542     -4531.6969     -5708.5877      3738.5639    
      1800   287.54627     -41236.802      13708.425     -1846.9876      3738.5639    
      1900   305.023       -41249.6        3200.0634      677.86162      3738.5639    
      2000   304.94382     -41233.973     -3783.4069      2455.8824      3738.5639    
Loop time of 96.2269 on 8 procs for 2000 steps with 350 atoms

Performance: 0.898 ns/day, 26.730 hours/ns, 20.784 timesteps/s, 7.274 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.97      | 75.762     | 81.14      |  97.1 | 78.73
Bond    | 0.00064016 | 0.00074711 | 0.00090206 |   0.0 |  0.00
Neigh   | 4.4341     | 5.9624     | 6.3513     |  25.8 |  6.20
Comm    | 1.1762     | 6.5494     | 27.328     | 330.1 |  6.81
Output  | 0.003804   | 0.0046578  | 0.0053093  |   0.7 |  0.00
Modify  | 7.5119     | 7.907      | 9.4524     |  22.6 |  8.22
Other   |            | 0.04027    |            |       |  0.04

Nlocal:          43.75 ave          51 max          36 min
Histogram: 2 0 0 0 2 1 0 0 2 1
Nghost:         3363.5 ave        3412 max        3309 min
Histogram: 1 0 0 3 0 0 1 1 1 1
Neighs:        28687.4 ave       33124 max       23815 min
Histogram: 2 0 0 0 2 1 0 0 2 1

Total # of neighbors = 229499
Ave neighs/atom = 655.71143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.6 | 130.8 | 131.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.94382     -41233.973     -3783.4181      0              3738.5639    
       100   313.3876      -41244.563     -9896.3815     -1404.1753      3738.5639    
       200   300.76172     -41268.606     -18337.165      108.97121      3738.5639    
       300   284.10773     -41259.084     -8565.9522     -2393.4543      3738.5639    
       400   307.05239     -41265.414      13664.071      2363.7274      3738.5639    
       500   313.8507      -41252.689      7026.6594     -4301.3748      3738.5639    
       600   299.9916      -41233.272      7580.6851      6234.0654      3738.5639    
       700   287.2477      -41225.185      516.02666     -1060.0874      3738.5639    
       800   298.58226     -41253.498     -3372.7223     -5165.2636      3738.5639    
       900   280.67635     -41266.956      6022.896       2181.2584      3738.5639    
      1000   282.6619      -41262.706      4050.0992      2702.2838      3738.5639    
      1100   285.96234     -41238.338      2316.449       1021.9218      3738.5639    
      1200   298.99374     -41237.604      1934.6686     -62.181358      3738.5639    
      1300   305.53314     -41242.023     -9488.7331     -3473.6267      3738.5639    
      1400   309.13671     -41253.54       5902.5823     -2819.4912      3738.5639    
      1500   295.39693     -41274.519     -2426.7212     -732.3265       3738.5639    
      1600   282.38517     -41265.854      14464.69       1455.3082      3738.5639    
      1700   298.42952     -41266.678      8183.6266      3748.7054      3738.5639    
      1800   283.58991     -41239.02       7362.8128     -2068.9143      3738.5639    
      1900   299.38197     -41247.311     -1368.715       5330.9925      3738.5639    
      2000   291.48836     -41236.021     -3890.4575     -3034.2851      3738.5639    
Loop time of 97.0916 on 8 procs for 2000 steps with 350 atoms

Performance: 0.890 ns/day, 26.970 hours/ns, 20.599 timesteps/s, 7.210 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.616     | 75.78      | 81.534     | 101.8 | 78.05
Bond    | 0.00062161 | 0.00074724 | 0.00093273 |   0.0 |  0.00
Neigh   | 4.4574     | 5.9771     | 6.4047     |  27.3 |  6.16
Comm    | 1.4082     | 7.1581     | 27.31      | 331.0 |  7.37
Output  | 0.0007224  | 0.00081778 | 0.0011471  |   0.0 |  0.00
Modify  | 7.7005     | 8.1346     | 9.6719     |  23.6 |  8.38
Other   |            | 0.03995    |            |       |  0.04

Nlocal:          43.75 ave          47 max          36 min
Histogram: 1 0 0 0 0 0 2 1 2 2
Nghost:        3385.75 ave        3428 max        3339 min
Histogram: 1 0 1 1 1 1 1 0 1 1
Neighs:        28698.9 ave       30921 max       23859 min
Histogram: 1 0 0 0 0 1 1 2 1 2

Total # of neighbors = 229591
Ave neighs/atom = 655.97429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -43.4419238124192
variable C2neg equal ${d2}
variable C2neg equal 31.1478387428337
variable C3neg equal ${d3}
variable C3neg equal -29.7892952926212
variable C4neg equal ${d4}
variable C4neg equal -3.56810457933514
variable C5neg equal ${d5}
variable C5neg equal 11.8779142035717
variable C6neg equal ${d6}
variable C6neg equal -8.38978408382461

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.7490667 -1.5378211 0.14232347)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4170067184353
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.134170067184353 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.069742272 0.40119664 -0.14695996) to (15.608458 13.818203 17.78526) with tilt (-7.6148966 -1.5378211 0.14232347)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.9 | 130.1 | 131.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.20158     -41245.934     -5314.4298      0              3738.5639    
       100   265.22252     -41254.885      2882.0173      2567.2308      3738.5639    
       200   284.67812     -41272.881     -278.53338     -3605.7291      3738.5639    
       300   283.13804     -41260.437     -9636.4337     -1570.6882      3738.5639    
       400   305.99461     -41271.023      2548.62        1341.7237      3738.5639    
       500   288.6197      -41234.76      -374.92636     -2932.9052      3738.5639    
       600   296.89723     -41225.047      4419.7951     -1698.6999      3738.5639    
       700   307.59349     -41240.537     -4984.8549     -1032.0136      3738.5639    
       800   296.85766     -41267.659     -4501.4503     -368.50374      3738.5639    
       900   295.42257     -41276.966     -6300.2795     -774.63084      3738.5639    
      1000   294.84524     -41268.774      12411.688      3462.6942      3738.5639    
      1100   316.87086     -41261.683     -4967.8392     -3469.019       3738.5639    
      1200   305.09259     -41244.527     -9305.5725     -2206.8288      3738.5639    
      1300   301.37588     -41251.126      357.73258     -4102.7263      3738.5639    
      1400   304.26848     -41263.806     -1913.0519     -1759.5825      3738.5639    
      1500   301.32763     -41260.269     -2162.0058     -2962.8109      3738.5639    
      1600   289.83559     -41249.386     -6424.9216     -1942.196       3738.5639    
      1700   306.88696     -41246.63      -4862.3246     -4586.9404      3738.5639    
      1800   321.5181      -41231.593      3753.2533     -1159.739       3738.5639    
      1900   311.65488     -41232.195      1401.1903      3370.2001      3738.5639    
      2000   297.68959     -41247.828     -12365.043     -5658.5252      3738.5639    
Loop time of 92.647 on 8 procs for 2000 steps with 350 atoms

Performance: 0.933 ns/day, 25.735 hours/ns, 21.587 timesteps/s, 7.556 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.8       | 65.078     | 78.431     | 121.2 | 70.24
Bond    | 0.00058005 | 0.0007467  | 0.00088204 |   0.0 |  0.00
Neigh   | 4.3676     | 5.2239     | 6.2801     |  35.0 |  5.64
Comm    | 0.77827    | 14.121     | 24.392     | 260.0 | 15.24
Output  | 0.0036444  | 0.0045034  | 0.0051195  |   0.7 |  0.00
Modify  | 7.124      | 8.1834     | 9.0487     |  28.2 |  8.83
Other   |            | 0.03553    |            |       |  0.04

Nlocal:          43.75 ave          48 max          38 min
Histogram: 1 0 0 1 0 2 0 2 0 2
Nghost:        3348.12 ave        3386 max        3304 min
Histogram: 1 1 1 1 0 0 0 0 3 1
Neighs:        28691.2 ave       31342 max       25067 min
Histogram: 1 0 0 1 1 1 2 0 0 2

Total # of neighbors = 229530
Ave neighs/atom = 655.8
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.9 | 130.1 | 131.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   297.68959     -41247.828     -12365.036      0              3738.5639    
       100   307.26259     -41265.909      257.14581      3846.2514      3738.5639    
       200   291.56305     -41281.62      -7770.9039     -3921.6977      3738.5639    
       300   274.52425     -41269.683     -6160.4492     -377.6026       3738.5639    
       400   289.27086     -41268.946      5657.2751      702.4342       3738.5639    
       500   291.89356     -41251.527      2784.2375     -3385.9867      3738.5639    
       600   306.169       -41254.674     -24824.836     -404.71828      3738.5639    
       700   301.94297     -41252.439     -5105.3733     -930.01174      3738.5639    
       800   276.48457     -41256.653     -5123.1181     -150.44138      3738.5639    
       900   276.69455     -41267.353     -16453.148     -510.09192      3738.5639    
      1000   290.28133     -41269.223     -6715.9067     -3537.1118      3738.5639    
      1100   303.67109     -41270.435      10861.305      331.0025       3738.5639    
      1200   275.3192      -41234.352     -14835.484     -6766.2184      3738.5639    
      1300   309.96246     -41263.419     -1333.0494     -3168.3517      3738.5639    
      1400   318.50024     -41268.912      660.46992     -3723.2208      3738.5639    
      1500   299.03166     -41251.061     -7984.2112      775.42207      3738.5639    
      1600   287.33995     -41256.665     -5546.7181     -4447.4278      3738.5639    
      1700   286.54106     -41264.19      -9275.9166     -3543.5983      3738.5639    
      1800   307.41222     -41272.468      10555.626     -659.46721      3738.5639    
      1900   298.62764     -41232.402     -4462.178       1217.4414      3738.5639    
      2000   325.33932     -41257.58      -13442.649     -2269.5003      3738.5639    
Loop time of 75.1135 on 8 procs for 2000 steps with 350 atoms

Performance: 1.150 ns/day, 20.865 hours/ns, 26.626 timesteps/s, 9.319 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.714     | 56.486     | 62.73      |  59.0 | 75.20
Bond    | 0.00049552 | 0.00069703 | 0.00082557 |   0.0 |  0.00
Neigh   | 4.3672     | 4.6717     | 5.1929     |  17.4 |  6.22
Comm    | 0.92019    | 7.1595     | 10.929     | 165.5 |  9.53
Output  | 0.00072753 | 0.00081725 | 0.0011208  |   0.0 |  0.00
Modify  | 6.2359     | 6.7581     | 7.0656     |  14.6 |  9.00
Other   |            | 0.03639    |            |       |  0.05

Nlocal:          43.75 ave          52 max          38 min
Histogram: 2 0 1 1 1 1 1 0 0 1
Nghost:        3348.38 ave        3419 max        3273 min
Histogram: 1 0 1 0 2 1 1 1 0 1
Neighs:        28689.4 ave       33817 max       25134 min
Histogram: 2 0 1 1 2 0 1 0 0 1

Total # of neighbors = 229515
Ave neighs/atom = 655.75714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 35.6927417940351
variable C2pos equal ${d2}
variable C2pos equal 9.05248578619456
variable C3pos equal ${d3}
variable C3pos equal 74.5995550585522
variable C4pos equal ${d4}
variable C4pos equal -4.93900214673637
variable C5pos equal ${d5}
variable C5pos equal -3.25617091435581
variable C6pos equal ${d6}
variable C6pos equal 18.4117282327982

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-43.4419238124192+${C1pos})
variable C16 equal 0.5*(-43.4419238124192+35.6927417940351)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(31.1478387428337+${C2pos})
variable C26 equal 0.5*(31.1478387428337+9.05248578619456)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-29.7892952926212+${C3pos})
variable C36 equal 0.5*(-29.7892952926212+74.5995550585522)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-3.56810457933514+${C4pos})
variable C46 equal 0.5*(-3.56810457933514+-4.93900214673637)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(11.8779142035717+${C5pos})
variable C56 equal 0.5*(11.8779142035717+-3.25617091435581)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-8.38978408382461+${C6pos})
variable C66 equal 0.5*(-8.38978408382461+18.4117282327982)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal -4.12350424475985
variable C22all equal ${C22}
variable C22all equal 19.5592034589729
variable C33all equal ${C33}
variable C33all equal 7.57832914759195

variable C44all equal ${C44}
variable C44all equal 1.53597218845839
variable C55all equal ${C55}
variable C55all equal 7.70642464927368
variable C66all equal ${C66}
variable C66all equal 5.0109720744868

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-17.6957378643364+${C21})
variable C12all equal 0.5*(-17.6957378643364+2.1215713586072)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(-35.9878058357003+${C31})
variable C13all equal 0.5*(-35.9878058357003+18.8844474274955)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(-30.8496812031632+${C32})
variable C23all equal 0.5*(-30.8496812031632+-6.56846125925357)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-36.5602560546346+${C41})
variable C14all equal 0.5*(-36.5602560546346+6.12007857471188)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(4.10197985778235+${C51})
variable C15all equal 0.5*(4.10197985778235+-3.13241477477195)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-3.87459100919205+${C61})
variable C16all equal 0.5*(-3.87459100919205+-7.46429579633035)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(4.7261123751546+${C42})
variable C24all equal 0.5*(4.7261123751546+4.26995973235392)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(24.0510133053544+${C52})
variable C25all equal 0.5*(24.0510133053544+5.52608677765543)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(20.1001622645141+${C62})
variable C26all equal 0.5*(20.1001622645141+9.57705690053199)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(22.5344723505065+${C43})
variable C34all equal 0.5*(22.5344723505065+0.319127273254855)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(25.0326603593686+${C53})
variable C35all equal 0.5*(25.0326603593686+6.27361831062307)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(22.4051298829655+${C63})
variable C36all equal 0.5*(22.4051298829655+-2.61229610785641)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(5.27968916537504+${C54})
variable C45all equal 0.5*(5.27968916537504+6.18980715269537)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-4.25355336303575+${C64})
variable C46all equal 0.5*(-4.25355336303575+-2.06728360616258)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(4.31087164460795+${C65})
variable C56all equal 0.5*(4.31087164460795+-14.3693535339089)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:39:55
