LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-48-vasp-an
read_data       ${structure}.data
read_data       333U-50C-48-vasp-an.data
Reading data file ...
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
  reading velocities ...
  386 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              344.28356      3972.3183    
         1   300            0              0              344.28356      3972.3183    
Loop time of 5.82895e-05 on 8 procs for 1 steps with 386 atoms

51.0% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1e-07      | 2.405e-07  | 3.34e-07   |   0.0 |  0.41
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.55e-07   | 1.3593e-06 | 1.716e-06  |   0.0 |  2.33
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.669e-05  |            |       | 97.26

Nlocal:          48.25 ave          60 max          44 min
Histogram: 3 2 1 1 0 0 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.2 | 135.5 | 138.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -44838.325      7323.1908      0              1.7098395      3961.9145    
       100   302.83793     -44839.353     -1975.1033      2019.0834      1.7098395      3961.9145    
       200   308.29389     -44850.741      1813.7827      3220.5448      1.7098395      3961.9145    
       300   278.10756     -44840.864     -5922.7859      1252.7248      1.7098395      3961.9145    
       400   284.87473     -44857.694     -1535.3684      108.75992      1.7098395      3961.9145    
       500   296.72769     -44845.273     -378.51041      2491.3412      1.7098395      3961.9145    
       600   305.89208     -44840.824     -4374.9059      47.849899      1.7098395      3961.9145    
       700   302.06624     -44833.549      5518.4001     -4589.1204      1.7098395      3961.9145    
       800   289.95843     -44827.606      3437.8364     -989.80139      1.7098395      3961.9145    
       900   298.16147     -44841.333      4847.9341     -3064.6819      1.7098395      3961.9145    
      1000   300.20192     -44851.359      10631.925      1857.7805      1.7098395      3961.9145    
      1100   296.05803     -44855.887      8460.763       603.06067      1.7098395      3961.9145    
      1200   291.0935      -44882.805     -7637.1195      1479.3586      1.7098395      3961.9145    
      1300   300.36443     -44904.495     -8634.1514      3278.6593      1.7098395      3961.9145    
      1400   280.86294     -44856.137      5777.7655     -700.20292      1.7098395      3961.9145    
      1500   283.38593     -44835.075      4196.2816     -675.63769      1.7098395      3961.9145    
      1600   294.11068     -44837.7        7030.739      -1028.5653      1.7098395      3961.9145    
      1700   295.91608     -44837.004     -3444.2574      77.697841      1.7098395      3961.9145    
      1800   300.25509     -44846.195     -11628.53      -2778.1755      1.7098395      3961.9145    
      1900   300.83719     -44873.774      5052.2177     -241.73466      1.7098395      3961.9145    
      2000   291.26286     -44877.617     -3327.6028      486.92005      1.7098395      3961.9145    
Loop time of 102.322 on 8 procs for 2000 steps with 386 atoms

Performance: 0.844 ns/day, 28.423 hours/ns, 19.546 timesteps/s, 7.545 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.58      | 71.539     | 85.254     | 144.7 | 69.92
Bond    | 0.00064651 | 0.00079355 | 0.00095628 |   0.0 |  0.00
Neigh   | 4.7698     | 5.7113     | 6.7766     |  37.7 |  5.58
Comm    | 1.9927     | 15.706     | 28.667     | 308.7 | 15.35
Output  | 0.0011178  | 0.0011973  | 0.0016143  |   0.5 |  0.00
Modify  | 8.2526     | 9.3251     | 10.267     |  29.6 |  9.11
Other   |            | 0.03818    |            |       |  0.04

Nlocal:          48.25 ave          60 max          44 min
Histogram: 3 1 1 2 0 0 0 0 0 1
Nghost:        3482.25 ave        3523 max        3444 min
Histogram: 2 0 1 1 0 0 1 1 1 1
Neighs:        32830.9 ave       40192 max       29910 min
Histogram: 3 0 2 2 0 0 0 0 0 1

Total # of neighbors = 262647
Ave neighs/atom = 680.43264
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-48-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.0516330040906
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.1238923442901
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.7042063635054

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-486.920052395774)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-486.920052395774)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-2349.61719692543)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-2349.61719692543)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-4149.14840364185)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-4149.14840364185)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1755.80325406581)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1755.80325406581)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--3018.31527686688)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--3018.31527686688)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1935.07189592762)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1935.07189592762)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 17.0516330040906
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0516330040906
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.170516330040906 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.170516330040906 xy delta 0.0748600885902973 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.170516330040906 xy delta 0.0748600885902973 xz delta -0.00020638724903703 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.7164 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.7164 13.356446 17.510153) with tilt (-7.4111488 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.7164 13.356446 17.510153) with tilt (-7.4111488 0.020432338 -0.89755173)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135.5 | 136.8 | 139 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44861.338      45905.639      0              3922.2954    
       100   317.31048     -44879.285     -3081.3252      12302.581      3922.2954    
       200   306.62691     -44832.434      17182.335      3146.4421      3922.2954    
       300   325.37654     -44844.548      4301.885       8061.299       3922.2954    
       400   318.66661     -44850.379      19988.191      9240.3286      3922.2954    
       500   305.55958     -44852.132     -9217.782       3206.3112      3922.2954    
       600   294.23824     -44849.169     -6118.073       5789.5086      3922.2954    
       700   294.82335     -44853.908      2514.8185      10466.156      3922.2954    
       800   311.04417     -44861.931      7895.3297      11434.058      3922.2954    
       900   318.38214     -44846.425      2119.5111      7777.5777      3922.2954    
      1000   323.17806     -44850.39       8698.6079      4528.537       3922.2954    
      1100   295.82667     -44847.68       4923.7258      7924.7299      3922.2954    
      1200   299.42221     -44870.227     -1785.3482      3838.7325      3922.2954    
      1300   302.8868      -44868.447      2163.258       4326.9874      3922.2954    
      1400   299.33525     -44853.632      14161.488      7188.3155      3922.2954    
      1500   319.26874     -44855.035      15088.175      60.420853      3922.2954    
      1600   313.48657     -44813.33       4131.4859      10350.925      3922.2954    
      1700   318.35453     -44788.159      3236.1567      5312.2682      3922.2954    
      1800   309.64644     -44809.901      9361.5054      5455.0642      3922.2954    
      1900   302.53824     -44826.652     -11708.502      2548.5713      3922.2954    
      2000   300.43889     -44848.522      12253.573      10574.728      3922.2954    
Loop time of 102.174 on 8 procs for 2000 steps with 386 atoms

Performance: 0.846 ns/day, 28.382 hours/ns, 19.575 timesteps/s, 7.556 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.198     | 69.944     | 86.384     | 145.4 | 68.46
Bond    | 0.00058681 | 0.0007742  | 0.0010183  |   0.0 |  0.00
Neigh   | 4.8422     | 5.6085     | 6.8698     |  40.1 |  5.49
Comm    | 0.91264    | 17.353     | 28.097     | 291.8 | 16.98
Output  | 0.0041656  | 0.005075   | 0.0056402  |   0.8 |  0.00
Modify  | 7.9589     | 9.2244     | 9.9901     |  31.4 |  9.03
Other   |            | 0.03724    |            |       |  0.04

Nlocal:          48.25 ave          60 max          41 min
Histogram: 1 1 2 0 3 0 0 0 0 1
Nghost:        3501.62 ave        3551 max        3449 min
Histogram: 1 0 1 2 1 0 1 0 0 2
Neighs:        33169.6 ave       40619 max       28518 min
Histogram: 1 1 2 0 3 0 0 0 0 1

Total # of neighbors = 265357
Ave neighs/atom = 687.45337
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.8 | 136.7 | 139 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   300.43889     -44848.522      12253.53       0              3922.2954    
       100   300.6551      -44844.266      282.90684      8189.6972      3922.2954    
       200   316.34148     -44849.015      8944.5452      6117.9699      3922.2954    
       300   307.35604     -44835.7        12133.429      3413.8535      3922.2954    
       400   305.20966     -44857.787      5773.7644      1466.1041      3922.2954    
       500   299.75215     -44875.179     -259.51265      2148.4403      3922.2954    
       600   285.67648     -44860.347      16294.598      5716.975       3922.2954    
       700   312.16291     -44867.334      11738.917      7036.036       3922.2954    
       800   293.56034     -44820.796      12177.175      8173.2437      3922.2954    
       900   338.37897     -44829.682      12923.322      9469.0479      3922.2954    
      1000   317.82692     -44822.605      8749.0622      7559.0677      3922.2954    
      1100   308.64857     -44841.221      13302.33       6328.8082      3922.2954    
      1200   304.28496     -44854.21      -5031.3075      4043.1706      3922.2954    
      1300   306.75719     -44873.65       1493.267       5139.0733      3922.2954    
      1400   302.33072     -44880.029      10963.96       8951.3495      3922.2954    
      1500   292.7375      -44880.628      16703.582      7595.3702      3922.2954    
      1600   297.8417      -44882.587      3132.227       10381.429      3922.2954    
      1700   287.77743     -44838.841     -3262.6817      3971.852       3922.2954    
      1800   307.52656     -44843.777      14770.773      4250.8612      3922.2954    
      1900   290.59449     -44846.251      5340.8955      3743.2982      3922.2954    
      2000   301.83931     -44878.655      5287.7383      9372.8102      3922.2954    
Loop time of 101.817 on 8 procs for 2000 steps with 386 atoms

Performance: 0.849 ns/day, 28.282 hours/ns, 19.643 timesteps/s, 7.582 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.903     | 69.74      | 85.915     | 144.8 | 68.50
Bond    | 0.00060255 | 0.00075632 | 0.00096612 |   0.0 |  0.00
Neigh   | 4.8416     | 5.6106     | 6.8799     |  40.3 |  5.51
Comm    | 1.0369     | 17.211     | 28.046     | 291.5 | 16.90
Output  | 0.00081873 | 0.00092805 | 0.0012565  |   0.0 |  0.00
Modify  | 7.9421     | 9.217      | 9.9846     |  31.6 |  9.05
Other   |            | 0.03672    |            |       |  0.04

Nlocal:          48.25 ave          59 max          41 min
Histogram: 2 0 1 0 2 2 0 0 0 1
Nghost:        3500.38 ave        3548 max        3461 min
Histogram: 1 2 0 0 2 1 0 0 1 1
Neighs:        33184.5 ave       39981 max       28543 min
Histogram: 2 0 1 0 2 2 0 0 0 1

Total # of neighbors = 265476
Ave neighs/atom = 687.76166
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 90.0362820517363
variable C2neg equal ${d2}
variable C2neg equal 36.679816443794
variable C3neg equal ${d3}
variable C3neg equal 48.1588494755944
variable C4neg equal ${d4}
variable C4neg equal 7.42008923299004
variable C5neg equal ${d5}
variable C5neg equal 15.410982678602
variable C6neg equal ${d6}
variable C6neg equal -35.352351558741

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0516330040906
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.170516330040906 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.170516330040906 xy delta -0.0748600885902973 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.170516330040906 xy delta -0.0748600885902973 xz delta 0.00020638724903703 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (17.057433 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (17.057433 13.356446 17.510153) with tilt (-7.5608689 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (17.057433 13.356446 17.510153) with tilt (-7.5608689 0.020845112 -0.89755173)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.1 | 134.6 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44854.891     -44287.952      0              4001.5336    
       100   306.5577      -44860.586     -10524.541     -3931.4899      4001.5336    
       200   301.92904     -44822.752      2765.4802     -6589.007       4001.5336    
       300   315.78486     -44823.532     -3491.8701     -141.98163      4001.5336    
       400   302.8335      -44825.974     -3914.973      -7007.7904      4001.5336    
       500   299.36278     -44836.957     -6637.8128     -1949.8787      4001.5336    
       600   304.44716     -44853.03      -13944.892     -5449.1935      4001.5336    
       700   300.61802     -44858.944      4986.9357     -5693.6879      4001.5336    
       800   276.00957     -44841.205      12218.757     -3519.9866      4001.5336    
       900   277.38953     -44840.567     -2174.9941     -3467.8467      4001.5336    
      1000   302.40951     -44840.164      5003.5542     -7588.1137      4001.5336    
      1100   304.62605     -44830.075      2164.463      -6694.9471      4001.5336    
      1200   305.11344     -44837.596      44.396527     -10211.518      4001.5336    
      1300   297.20065     -44854.663     -5030.0062     -3709.5814      4001.5336    
      1400   290.79882     -44870.439      9120.2639     -816.95106      4001.5336    
      1500   282.13013     -44857.285      9040.1218     -8110.6438      4001.5336    
      1600   287.72656     -44822.441     -6503.378      -6296.3902      4001.5336    
      1700   302.59299     -44827.374      5610.0168     -4480.6081      4001.5336    
      1800   306.81177     -44829.014      4820.6045     -265.96573      4001.5336    
      1900   311.82003     -44851.283     -4056.8721     -6093.1765      4001.5336    
      2000   279.51831     -44836.686      4871.2298     -2836.2227      4001.5336    
Loop time of 98.5501 on 8 procs for 2000 steps with 386 atoms

Performance: 0.877 ns/day, 27.375 hours/ns, 20.294 timesteps/s, 7.834 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.886     | 66.434     | 83.002     | 123.8 | 67.41
Bond    | 0.00054951 | 0.00073633 | 0.00095096 |   0.0 |  0.00
Neigh   | 4.7626     | 5.3583     | 6.7628     |  34.3 |  5.44
Comm    | 1.1376     | 17.709     | 26.259     | 239.8 | 17.97
Output  | 0.0040126  | 0.0048406  | 0.0053522  |   0.7 |  0.00
Modify  | 7.5905     | 9.0071     | 9.6007     |  26.6 |  9.14
Other   |            | 0.0363     |            |       |  0.04

Nlocal:          48.25 ave          62 max          41 min
Histogram: 2 1 0 2 2 0 0 0 0 1
Nghost:        3462.38 ave        3497 max        3424 min
Histogram: 1 1 2 0 0 0 0 1 1 2
Neighs:        32509.5 ave       41038 max       28025 min
Histogram: 2 1 0 2 2 0 0 0 0 1

Total # of neighbors = 260076
Ave neighs/atom = 673.77202
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.1 | 134.6 | 136.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.51831     -44836.687      4871.1974      0              4001.5336    
       100   296.62479     -44843.677      2322.289      -2624.4888      4001.5336    
       200   302.19091     -44818.391      4750.3648     -3957.5167      4001.5336    
       300   305.59704     -44816.612     -3857.0159     -5575.5258      4001.5336    
       400   321.2673      -44846.908      5387.2941     -4050.3141      4001.5336    
       500   311.4046      -44849.71       5031.8226     -5633.2343      4001.5336    
       600   299.88732     -44855.312      5527.8299     -6252.4936      4001.5336    
       700   298.48857     -44861.809      2671.4398     -1555.2065      4001.5336    
       800   296.60366     -44834.189      1688.2602     -1447.6921      4001.5336    
       900   308.69381     -44819.965      12705.491      957.93067      4001.5336    
      1000   321.55986     -44849.782      3762.0192     -5679.4325      4001.5336    
      1100   290.82518     -44834.238     -721.24742     -8443.7052      4001.5336    
      1200   290.90821     -44847.721      4358.2347      144.28479      4001.5336    
      1300   294.80411     -44855.21      -2472.3123     -5025.2531      4001.5336    
      1400   293.21908     -44837.739      1561.8063     -4454.3269      4001.5336    
      1500   313.06994     -44819.45       4560.7684     -5299.5158      4001.5336    
      1600   314.67769     -44833.972      10050.751     -4951.5375      4001.5336    
      1700   301.37162     -44855.15       8539.491      -1188.746       4001.5336    
      1800   295.1806      -44864.104     -1196.9176     -5595.5308      4001.5336    
      1900   310.19486     -44875.488      3368.4358     -6626.6709      4001.5336    
      2000   322.06866     -44865.805      4111.3054     -7033.33        4001.5336    
Loop time of 100.781 on 8 procs for 2000 steps with 386 atoms

Performance: 0.857 ns/day, 27.995 hours/ns, 19.845 timesteps/s, 7.660 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.143     | 68.944     | 83.427     | 102.5 | 68.41
Bond    | 0.00056145 | 0.00073271 | 0.00097043 |   0.0 |  0.00
Neigh   | 4.9841     | 5.6802     | 7.0163     |  29.8 |  5.64
Comm    | 1.8868     | 16.353     | 26.167     | 210.4 | 16.23
Output  | 0.00087533 | 0.00095941 | 0.0013224  |   0.0 |  0.00
Modify  | 8.4081     | 9.765      | 10.451     |  23.0 |  9.69
Other   |            | 0.03722    |            |       |  0.04

Nlocal:          48.25 ave          60 max          43 min
Histogram: 2 1 2 2 0 0 0 0 0 1
Nghost:        3437.12 ave        3459 max        3402 min
Histogram: 1 0 1 0 0 1 2 0 2 1
Neighs:        32526.1 ave       39829 max       28943 min
Histogram: 2 1 0 4 0 0 0 0 0 1

Total # of neighbors = 260209
Ave neighs/atom = 674.11658
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 76.1989339366697
variable C2pos equal ${d2}
variable C2pos equal 13.9075625962157
variable C3pos equal ${d3}
variable C3pos equal 27.0507840895508
variable C4pos equal ${d4}
variable C4pos equal -0.331065883102053
variable C5pos equal ${d5}
variable C5pos equal -21.6917880737072
variable C6pos equal ${d6}
variable C6pos equal 5.34278216696618

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(90.0362820517363+${C1pos})
variable C11 equal 0.5*(90.0362820517363+76.1989339366697)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(36.679816443794+${C2pos})
variable C21 equal 0.5*(36.679816443794+13.9075625962157)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(48.1588494755944+${C3pos})
variable C31 equal 0.5*(48.1588494755944+27.0507840895508)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(7.42008923299004+${C4pos})
variable C41 equal 0.5*(7.42008923299004+-0.331065883102053)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(15.410982678602+${C5pos})
variable C51 equal 0.5*(15.410982678602+-21.6917880737072)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-35.352351558741+${C6pos})
variable C61 equal 0.5*(-35.352351558741+5.34278216696618)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.1238923442901
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.1238923442901
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.131238923442901 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.131238923442901 yz delta 0.00897551734451828 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.225207 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.225207 17.510153) with tilt (-7.4860089 0.020638725 -0.88857622)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135.8 | 137.3 | 139.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44863.374      42434.82       0              3922.2954    
       100   307.79078     -44869.048     -6040.8094      6711.4587      3922.2954    
       200   313.87628     -44841.779      13772.44       909.18038      3922.2954    
       300   314.5039      -44836.067      2680.0674      5857.0232      3922.2954    
       400   319.98329     -44852.757      23029.748      2873.2691      3922.2954    
       500   301.00619     -44846.654      202.28051      1372.4663      3922.2954    
       600   306.45531     -44864.74      -9203.1992      4997.2051      3922.2954    
       700   313.46627     -44878.83       413.05861      8519.2572      3922.2954    
       800   299.43096     -44853.674      7974.7624      5510.7335      3922.2954    
       900   303.1836      -44836.982      5054.024       1353.9881      3922.2954    
      1000   318.45405     -44834.173      3035.1295      3056.9265      3922.2954    
      1100   333.66425     -44864.36       967.2693       4051.9695      3922.2954    
      1200   293.41684     -44851.701     -1404.2206      2706.6424      3922.2954    
      1300   314.20302     -44886.144      15012.312      6003.625       3922.2954    
      1400   282.34238     -44859.157      12621.446      2168.5445      3922.2954    
      1500   308.12713     -44868.889      9001.1551      3368.4853      3922.2954    
      1600   318.6916      -44850.107      1958.6205      1596.2537      3922.2954    
      1700   293.89836     -44834.364      1145.5324      4840.4203      3922.2954    
      1800   304.54039     -44859.875      4670.7724      2626.9155      3922.2954    
      1900   284.55511     -44845.441      8830.7215      64.654297      3922.2954    
      2000   291.18218     -44859.017      5984.3083      2347.0879      3922.2954    
Loop time of 105.786 on 8 procs for 2000 steps with 386 atoms

Performance: 0.817 ns/day, 29.385 hours/ns, 18.906 timesteps/s, 7.298 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.908     | 78.675     | 89.516     | 133.8 | 74.37
Bond    | 0.00056941 | 0.00076438 | 0.0010255  |   0.0 |  0.00
Neigh   | 4.848      | 6.296      | 7.3111     |  38.5 |  5.95
Comm    | 0.76858    | 11.6       | 30.377     | 348.3 | 10.97
Output  | 0.0041999  | 0.005136   | 0.0057749  |   0.8 |  0.00
Modify  | 8.1296     | 9.1685     | 10.61      |  32.3 |  8.67
Other   |            | 0.0406     |            |       |  0.04

Nlocal:          48.25 ave          62 max          42 min
Histogram: 1 1 2 3 0 0 0 0 0 1
Nghost:        3522.38 ave        3559 max        3489 min
Histogram: 1 1 1 0 2 1 0 0 0 2
Neighs:          33184 ave       41878 max       29231 min
Histogram: 2 0 4 1 0 0 0 0 0 1

Total # of neighbors = 265472
Ave neighs/atom = 687.7513
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135.8 | 137.3 | 139.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.18218     -44859.016      5984.3698      0              3922.2954    
       100   302.91043     -44865.632     -4702.3257      1421.1357      3922.2954    
       200   298.0686      -44832.008      5539.6734      8834.7715      3922.2954    
       300   318.92632     -44828.512      15852.988      5037.567       3922.2954    
       400   308.09913     -44824.245     -6872.0284      968.07295      3922.2954    
       500   316.79866     -44855.917      11897.567      6027.9232      3922.2954    
       600   294.03369     -44840.935      6323.1463      3329.2801      3922.2954    
       700   284.63555     -44841.039      11849.564      1315.9112      3922.2954    
       800   299.37845     -44854.217      16034.128      7038.4973      3922.2954    
       900   319.64557     -44845.957      16566.951      2651.4809      3922.2954    
      1000   324.04714     -44837.628      3769.6893      1255.8422      3922.2954    
      1100   316.99129     -44854.166      3887.5701      451.85984      3922.2954    
      1200   316.53223     -44875.951      12910.374      2589.9062      3922.2954    
      1300   294.60042     -44861.505      5527.9497      5475.2569      3922.2954    
      1400   305.30562     -44875.054     -3326.1945     -1678.6308      3922.2954    
      1500   300.07615     -44848.881     -3572.1865      3194.0113      3922.2954    
      1600   304.29093     -44836.002      1272.7703      1744.971       3922.2954    
      1700   311.88834     -44849.778      4127.4216      4790.2684      3922.2954    
      1800   301.12146     -44873.343      444.1589       2155.663       3922.2954    
      1900   287.56767     -44866.918      1559.6903     -331.65174      3922.2954    
      2000   298.64544     -44862.289      10356.339      722.39652      3922.2954    
Loop time of 105.207 on 8 procs for 2000 steps with 386 atoms

Performance: 0.821 ns/day, 29.224 hours/ns, 19.010 timesteps/s, 7.338 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.487     | 77.153     | 88.849     | 147.9 | 73.33
Bond    | 0.00060475 | 0.00077494 | 0.00099302 |   0.0 |  0.00
Neigh   | 4.8555     | 6.2421     | 7.3373     |  42.3 |  5.93
Comm    | 0.83908    | 12.527     | 30.206     | 366.8 | 11.91
Output  | 0.00083043 | 0.00093251 | 0.0012971  |   0.0 |  0.00
Modify  | 8.1264     | 9.2426     | 10.62      |  35.1 |  8.79
Other   |            | 0.04053    |            |       |  0.04

Nlocal:          48.25 ave          60 max          42 min
Histogram: 2 1 0 3 0 1 0 0 0 1
Nghost:         3512.5 ave        3561 max        3464 min
Histogram: 1 1 1 0 1 1 1 0 1 1
Neighs:        33187.6 ave       40649 max       29100 min
Histogram: 3 0 0 1 2 1 0 0 0 1

Total # of neighbors = 265501
Ave neighs/atom = 687.82642
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 2.3859653259879
variable C2neg equal ${d2}
variable C2neg equal 88.6248258977727
variable C3neg equal ${d3}
variable C3neg equal 32.6667466399943
variable C4neg equal ${d4}
variable C4neg equal 7.29923927557398
variable C5neg equal ${d5}
variable C5neg equal 9.01462561946428
variable C6neg equal ${d6}
variable C6neg equal -22.6441157417182

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.1238923442901
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.131238923442901 yz delta ${deltayz} remap units box
change_box all y delta 0 0.131238923442901 yz delta -0.00897551734451828 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.487685 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.487685 17.510153) with tilt (-7.4860089 0.020638725 -0.90652725)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.8 | 134.2 | 136.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44857.657     -41691.287      0              4001.5336    
       100   307.29792     -44863.107     -5035.7514      2734.7453      4001.5336    
       200   300.36571     -44821.911      4188.2393     -2574.1832      4001.5336    
       300   306.94475     -44812.363      2489.3056      845.57813      4001.5336    
       400   324.2063      -44843.325     -3132.0993     -3482.0982      4001.5336    
       500   290.04246     -44824.013     -9226.0419      1673.1494      4001.5336    
       600   300.01511     -44851.09      -6790.2975     -1781.3525      4001.5336    
       700   288.22123     -44845.21       1518.9782      539.87321      4001.5336    
       800   304.155       -44849.676      1768.2456      551.71299      4001.5336    
       900   316.82106     -44825.129      10173.24       4117.0175      4001.5336    
      1000   302.297       -44815.879      607.42676      2171.6925      4001.5336    
      1100   302.36715     -44839.159      290.6821      -3568.0104      4001.5336    
      1200   296.92968     -44845.269      528.70832     -4494.05        4001.5336    
      1300   288.54868     -44836.537      7032.5553      866.82728      4001.5336    
      1400   307.63949     -44850.26      -16762.593      532.92702      4001.5336    
      1500   297.90481     -44837.737      150.30173     -1280.0419      4001.5336    
      1600   314.30929     -44856.625     -4590.4691     -4205.0515      4001.5336    
      1700   301.75531     -44853.534      3639.9719     -2382.6769      4001.5336    
      1800   276.6275      -44842.286     -9697.1797     -4480.0129      4001.5336    
      1900   296.94919     -44883.541     -11633.14      -4283.6998      4001.5336    
      2000   287.68686     -44865.512      5164.0668      5609.13        4001.5336    
Loop time of 102.264 on 8 procs for 2000 steps with 386 atoms

Performance: 0.845 ns/day, 28.407 hours/ns, 19.557 timesteps/s, 7.549 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.211     | 74.36      | 86.281     | 145.3 | 72.71
Bond    | 0.00058632 | 0.00073782 | 0.00088925 |   0.0 |  0.00
Neigh   | 4.7383     | 6.0624     | 7.1324     |  41.5 |  5.93
Comm    | 0.65983    | 12.578     | 29.74      | 353.1 | 12.30
Output  | 0.004139   | 0.0049269  | 0.0054854  |   0.7 |  0.00
Modify  | 8.1325     | 9.2196     | 10.539     |  34.0 |  9.02
Other   |            | 0.03928    |            |       |  0.04

Nlocal:          48.25 ave          60 max          41 min
Histogram: 2 1 0 1 2 0 1 0 0 1
Nghost:        3445.75 ave        3464 max        3421 min
Histogram: 2 0 1 0 0 1 0 0 1 3
Neighs:          32513 ave       39753 max       27638 min
Histogram: 2 1 0 1 1 1 1 0 0 1

Total # of neighbors = 260104
Ave neighs/atom = 673.84456
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.2 | 136.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.68686     -44865.512      5164.0565      0              4001.5336    
       100   293.84635     -44851.761     -1250.1949     -1892.6756      4001.5336    
       200   306.07133     -44843.344      4334.6801     -3291.9645      4001.5336    
       300   301.10992     -44835.673     -2050.9996      1525.9708      4001.5336    
       400   305.78498     -44847.804     -3368.2895      334.70651      4001.5336    
       500   291.86431     -44847.706     -7064.0289     -5982.5607      4001.5336    
       600   276.23805     -44856.615      11179.579      1065.4066      4001.5336    
       700   286.21038     -44862.131     -2615.6075     -2670.9818      4001.5336    
       800   290.90917     -44826.694      7122.2633     -5207.433       4001.5336    
       900   298.78656     -44829.453     -12280.574     -3494.8286      4001.5336    
      1000   295.8016      -44831.403      8158.249      -2863.6696      4001.5336    
      1100   292.86635     -44852.519      2358.538      -6795.491       4001.5336    
      1200   289.49988     -44857.406     -1662.3511     -10641.734      4001.5336    
      1300   301.1821      -44851.433      14867.173     -2193.9227      4001.5336    
      1400   315.59821     -44841.95      -3861.2257     -7603.2556      4001.5336    
      1500   321.70543     -44807.974     -5107.1504     -1536.8667      4001.5336    
      1600   317.07258     -44822.735      4004.9294      709.03081      4001.5336    
      1700   308.85133     -44847.856      2247.2119      2024.7293      4001.5336    
      1800   294.72302     -44847.157     -4666.695      -1725.4926      4001.5336    
      1900   282.26028     -44852.006     -4016.3542     -971.08614      4001.5336    
      2000   300.06366     -44883.848     -6593.258      -6705.4865      4001.5336    
Loop time of 102.738 on 8 procs for 2000 steps with 386 atoms

Performance: 0.841 ns/day, 28.538 hours/ns, 19.467 timesteps/s, 7.514 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.022     | 74.315     | 86.681     | 145.7 | 72.33
Bond    | 0.00057128 | 0.00074843 | 0.00094796 |   0.0 |  0.00
Neigh   | 4.7295     | 6.0608     | 7.1651     |  41.7 |  5.90
Comm    | 0.60346    | 12.966     | 30.271     | 348.7 | 12.62
Output  | 0.00087433 | 0.00094305 | 0.0012869  |   0.0 |  0.00
Modify  | 8.2347     | 9.3544     | 10.697     |  33.9 |  9.11
Other   |            | 0.03917    |            |       |  0.04

Nlocal:          48.25 ave          63 max          41 min
Histogram: 2 0 2 2 1 0 0 0 0 1
Nghost:        3431.62 ave        3452 max        3412 min
Histogram: 2 1 0 1 0 0 1 1 0 2
Neighs:        32501.5 ave       41658 max       27662 min
Histogram: 2 0 2 2 1 0 0 0 0 1

Total # of neighbors = 260012
Ave neighs/atom = 673.60622
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 72.8770593542109
variable C2pos equal ${d2}
variable C2pos equal 53.6740351571686
variable C3pos equal ${d3}
variable C3pos equal 18.3003394201503
variable C4pos equal ${d4}
variable C4pos equal -3.44130459780592
variable C5pos equal ${d5}
variable C5pos equal 1.54408865202638
variable C6pos equal ${d6}
variable C6pos equal 9.93753312122208

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(2.3859653259879+${C1pos})
variable C12 equal 0.5*(2.3859653259879+72.8770593542109)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(88.6248258977727+${C2pos})
variable C22 equal 0.5*(88.6248258977727+53.6740351571686)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(32.6667466399943+${C3pos})
variable C32 equal 0.5*(32.6667466399943+18.3003394201503)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(7.29923927557398+${C4pos})
variable C42 equal 0.5*(7.29923927557398+-3.44130459780592)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(9.01462561946428+${C5pos})
variable C52 equal 0.5*(9.01462561946428+1.54408865202638)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-22.6441157417182+${C6pos})
variable C62 equal 0.5*(-22.6441157417182+9.93753312122208)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.7042063635054
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.7042063635054
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.177042063635054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.333111) with tilt (-7.4860089 0.020638725 -0.89755173)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.4 | 136.5 | 138.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44865.263      40954.727      0              3922.2954    
       100   305.85211     -44868.175     -3805.053       8430.6014      3922.2954    
       200   314.86169     -44844.679      4598.8838      2608.5911      3922.2954    
       300   318.85227     -44839.484     -3053.3046      3558.6777      3922.2954    
       400   328.59032     -44862.567      21296.053      98.355702      3922.2954    
       500   302.53536     -44854.742     -12664.336      1530.6926      3922.2954    
       600   298.52824     -44858.956     -7531.2701      5707.8343      3922.2954    
       700   296.09274     -44855.728      6755.2922      2325.3694      3922.2954    
       800   297.05793     -44840.471      8854.7585      6473.2497      3922.2954    
       900   308.05231     -44816.88      -5046.4363      5861.1545      3922.2954    
      1000   307.38572     -44824.371      15102.534      7495.7743      3922.2954    
      1100   310.57845     -44855.322     -6532.27       -3039.7265      3922.2954    
      1200   317.11436     -44873.21      -1856.1206     -2080.8699      3922.2954    
      1300   286.03785     -44848.586      6960.9809      5119.7701      3922.2954    
      1400   300.58098     -44860.109      2398.9154      1197.4043      3922.2954    
      1500   302.54108     -44837.212      10068.804      1058.6721      3922.2954    
      1600   322.62476     -44842.195      11586.089      5677.7865      3922.2954    
      1700   298.90982     -44833.968      5467.3895      3934.23        3922.2954    
      1800   283.1563      -44846.967      2714.5208      10706.329      3922.2954    
      1900   274.21947     -44837.28      -11124.372     -3209.5119      3922.2954    
      2000   301.55172     -44847.007     -1803.5477     -3801.1526      3922.2954    
Loop time of 105.335 on 8 procs for 2000 steps with 386 atoms

Performance: 0.820 ns/day, 29.260 hours/ns, 18.987 timesteps/s, 7.329 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.243     | 77.302     | 89.246     | 148.1 | 73.39
Bond    | 0.00053903 | 0.0007498  | 0.00095885 |   0.0 |  0.00
Neigh   | 4.818      | 6.1854     | 7.2075     |  41.0 |  5.87
Comm    | 0.66943    | 12.603     | 30.677     | 366.6 | 11.97
Output  | 0.0042099  | 0.0049342  | 0.0054515  |   0.6 |  0.00
Modify  | 8.1547     | 9.1981     | 10.554     |  34.0 |  8.73
Other   |            | 0.04036    |            |       |  0.04

Nlocal:          48.25 ave          62 max          40 min
Histogram: 1 0 3 1 2 0 0 0 0 1
Nghost:           3511 ave        3557 max        3462 min
Histogram: 1 0 1 1 1 1 1 0 0 2
Neighs:        33145.5 ave       41835 max       27926 min
Histogram: 1 0 3 1 2 0 0 0 0 1

Total # of neighbors = 265164
Ave neighs/atom = 686.95337
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.6 | 136.5 | 138.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.55172     -44847.007     -1803.5795      0              3922.2954    
       100   309.74691     -44859.717     -2871.7821      3053.5793      3922.2954    
       200   294.75841     -44844.885      2808.8667      4091.6864      3922.2954    
       300   282.66854     -44840.559      7095.4776      5303.1797      3922.2954    
       400   303.57359     -44874.968     -843.34984     -1295.0097      3922.2954    
       500   281.65004     -44852.738     -1506.0875     -3216.293       3922.2954    
       600   304.81912     -44858.64       10194.525      2724.6185      3922.2954    
       700   292.9833      -44817.027     -708.27012      180.57074      3922.2954    
       800   299.58264     -44819.125     -804.07575      6248.1506      3922.2954    
       900   299.19763     -44835.817     -5639.561       5468.0183      3922.2954    
      1000   289.57172     -44848.648      9794.7487      4761.1802      3922.2954    
      1100   289.13285     -44887.333      13382.018      4326.1433      3922.2954    
      1200   278.84911     -44895.311      9745.6646     -2537.374       3922.2954    
      1300   294.77445     -44884.749      1139.7604      3678.5782      3922.2954    
      1400   296.19625     -44854.95       4768.4185      8396.3341      3922.2954    
      1500   302.61111     -44838.646      1276.9237      1793.8443      3922.2954    
      1600   293.15907     -44820.47       82.722911      1713.4452      3922.2954    
      1700   299.65815     -44844.423      7976.727      -1685.3204      3922.2954    
      1800   290.15734     -44863.667      1703.0979      600.29937      3922.2954    
      1900   294.49618     -44868.832      9963.0934      5028.8765      3922.2954    
      2000   309.61248     -44872.563      10518.403      6346.5258      3922.2954    
Loop time of 105.296 on 8 procs for 2000 steps with 386 atoms

Performance: 0.821 ns/day, 29.249 hours/ns, 18.994 timesteps/s, 7.332 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.157     | 78.495     | 89.08      | 133.8 | 74.55
Bond    | 0.00057254 | 0.00075884 | 0.00094119 |   0.0 |  0.00
Neigh   | 4.8312     | 6.2884     | 7.2563     |  37.5 |  5.97
Comm    | 0.7878     | 11.362     | 30.715     | 351.5 | 10.79
Output  | 0.00086204 | 0.00096201 | 0.0013333  |   0.0 |  0.00
Modify  | 8.1174     | 9.1081     | 10.554     |  31.5 |  8.65
Other   |            | 0.04124    |            |       |  0.04

Nlocal:          48.25 ave          57 max          43 min
Histogram: 2 0 1 2 1 1 0 0 0 1
Nghost:        3496.38 ave        3534 max        3457 min
Histogram: 1 1 0 0 1 2 0 2 0 1
Neighs:        33198.1 ave       38755 max       29529 min
Histogram: 2 0 0 3 1 0 1 0 0 1

Total # of neighbors = 265585
Ave neighs/atom = 688.04404
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 59.3724554950523
variable C2neg equal ${d2}
variable C2neg equal 37.0204708767315
variable C3neg equal ${d3}
variable C3neg equal 46.6381327989995
variable C4neg equal ${d4}
variable C4neg equal 18.9799240214377
variable C5neg equal ${d5}
variable C5neg equal 7.36269468203201
variable C6neg equal ${d6}
variable C6neg equal -20.7730700745475

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.7042063635054
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.177042063635054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.687195) with tilt (-7.4860089 0.020638725 -0.89755173)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.1 | 133.7 | 136 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44854.545     -44081.209      0              4001.5336    
       100   303.3349      -44856.344     -10458.606      336.62275      4001.5336    
       200   315.373       -44837.589      1309.3861     -2959.1121      4001.5336    
       300   320.87956     -44825.889      2707.3611      2519.2138      4001.5336    
       400   309.64046     -44825.604      5146.485      -2247.2988      4001.5336    
       500   302.78311     -44837.32      -12659.404     -2497.5718      4001.5336    
       600   297.21437     -44849.479      1251.4336     -1276.1144      4001.5336    
       700   301.48197     -44865.481      1321.8198      1065.5043      4001.5336    
       800   297.35549     -44868.867      6482.9037     -1314.4471      4001.5336    
       900   297.33761     -44851.739      2239.7472     -2554.6512      4001.5336    
      1000   304.15399     -44831.021     -7878.9439     -922.9375       4001.5336    
      1100   307.1174      -44829.031     -18807.524     -5117.5521      4001.5336    
      1200   308.13963     -44845.603     -2076.5955     -4613.1827      4001.5336    
      1300   285.77877     -44858.234     -8416.8563     -2697.4747      4001.5336    
      1400   291.0841      -44862.981     -2145.925      -2181.5543      4001.5336    
      1500   290.47124     -44842.136     -6905.5543      541.25679      4001.5336    
      1600   305.35517     -44839.714      12731.933     -3274.2859      4001.5336    
      1700   305.29248     -44838.232     -5712.1145     -2551.3041      4001.5336    
      1800   282.29747     -44857.648      8147.5819     -2002.1463      4001.5336    
      1900   286.9139      -44877.204     -3801.1734     -4158.4984      4001.5336    
      2000   292.30316     -44871.339      9474.7151     -5013.1807      4001.5336    
Loop time of 102.91 on 8 procs for 2000 steps with 386 atoms

Performance: 0.840 ns/day, 28.586 hours/ns, 19.434 timesteps/s, 7.502 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.328     | 78.305     | 86.829     | 129.3 | 76.09
Bond    | 0.00059321 | 0.00077493 | 0.00094165 |   0.0 |  0.00
Neigh   | 4.7475     | 6.3135     | 7.0753     |  35.6 |  6.14
Comm    | 0.73304    | 9.2515     | 30.236     | 376.3 |  8.99
Output  | 0.0042691  | 0.0052438  | 0.0059878  |   0.8 |  0.01
Modify  | 8.2133     | 8.993      | 10.555     |  30.0 |  8.74
Other   |            | 0.04147    |            |       |  0.04

Nlocal:          48.25 ave          60 max          40 min
Histogram: 1 0 3 0 1 1 1 0 0 1
Nghost:        3443.12 ave        3457 max        3423 min
Histogram: 1 0 0 1 0 2 1 1 0 2
Neighs:        32526.1 ave       39721 max       27342 min
Histogram: 1 0 3 0 1 1 1 0 0 1

Total # of neighbors = 260209
Ave neighs/atom = 674.11658
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.1 | 133.7 | 136 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.30316     -44871.339      9474.6633      0              4001.5336    
       100   291.83115     -44869.154     -3200.5242     -808.92981      4001.5336    
       200   293.45897     -44840.121     -5107.9736      1208.8328      4001.5336    
       300   317.90473     -44844.738     -3519.7757     -2396.4247      4001.5336    
       400   302.09442     -44834.958      5445.9237     -3254.1551      4001.5336    
       500   309.55341     -44868.606      800.40139     -3619.594       4001.5336    
       600   283.82746     -44852.29      -11262.437     -5184.8604      4001.5336    
       700   282.19931     -44848.841      4648.0073     -1794.8151      4001.5336    
       800   302.27986     -44857.879     -12427.823     -6626.141       4001.5336    
       900   313.26933     -44855.819     -4560.5969     -942.15965      4001.5336    
      1000   296.99338     -44840.564     -10898.913     -2392.4994      4001.5336    
      1100   296.31032     -44845.874     -10350.573     -1048.4507      4001.5336    
      1200   288.67472     -44835.594     -2537.3284     -3133.881       4001.5336    
      1300   320.42116     -44866.832     -4700.3383      1639.6451      4001.5336    
      1400   310.15571     -44855.762     -1787.2812     -2893.6368      4001.5336    
      1500   304.19492     -44863.306     -2453.3294     -462.7491       4001.5336    
      1600   304.25154     -44886.181     -4712.0463     -5406.9033      4001.5336    
      1700   297.16421     -44878.405     -11084.609     -5048.7932      4001.5336    
      1800   313.39574     -44867.422      6516.6012      476.94079      4001.5336    
      1900   321.66646     -44859.032      6855.4499     -2823.158       4001.5336    
      2000   291.83888     -44834.52       8823.8378     -2619.4452      4001.5336    
Loop time of 102.261 on 8 procs for 2000 steps with 386 atoms

Performance: 0.845 ns/day, 28.406 hours/ns, 19.558 timesteps/s, 7.549 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.136     | 77.937     | 86.325     | 128.8 | 76.21
Bond    | 0.00057588 | 0.00076556 | 0.00095907 |   0.0 |  0.00
Neigh   | 4.7415     | 6.3136     | 7.1043     |  36.1 |  6.17
Comm    | 0.74852    | 9.1309     | 29.942     | 376.3 |  8.93
Output  | 0.00081949 | 0.00097243 | 0.0014727  |   0.0 |  0.00
Modify  | 8.0281     | 8.8365     | 10.403     |  30.7 |  8.64
Other   |            | 0.0414     |            |       |  0.04

Nlocal:          48.25 ave          61 max          43 min
Histogram: 1 2 3 1 0 0 0 0 0 1
Nghost:        3443.25 ave        3473 max        3417 min
Histogram: 1 0 2 1 0 1 1 1 0 1
Neighs:        32503.6 ave       40476 max       28963 min
Histogram: 1 2 2 2 0 0 0 0 0 1

Total # of neighbors = 260029
Ave neighs/atom = 673.65026
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 31.475245430264
variable C2pos equal ${d2}
variable C2pos equal -26.4299428758229
variable C3pos equal ${d3}
variable C3pos equal -15.1969866114532
variable C4pos equal ${d4}
variable C4pos equal -8.39812858221657
variable C5pos equal ${d5}
variable C5pos equal -19.2146951560596
variable C6pos equal ${d6}
variable C6pos equal 24.2032696447448

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(59.3724554950523+${C1pos})
variable C13 equal 0.5*(59.3724554950523+31.475245430264)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(37.0204708767315+${C2pos})
variable C23 equal 0.5*(37.0204708767315+-26.4299428758229)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(46.6381327989995+${C3pos})
variable C33 equal 0.5*(46.6381327989995+-15.1969866114532)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(18.9799240214377+${C4pos})
variable C43 equal 0.5*(18.9799240214377+-8.39812858221657)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(7.36269468203201+${C5pos})
variable C53 equal 0.5*(7.36269468203201+-19.2146951560596)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-20.7730700745475+${C6pos})
variable C63 equal 0.5*(-20.7730700745475+24.2032696447448)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.7042063635054
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.7042063635054
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.177042063635054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -1.0745938)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.8 | 135.3 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44875.343     -3345.8532      0              3961.9145    
       100   310.5342      -44878.708     -4320.468       3185.6765      3961.9145    
       200   301.28702     -44839.298      8334.0248      754.24069      3961.9145    
       300   311.63975     -44846.565     -5203.4009      3850.0914      3961.9145    
       400   321.11336     -44864.402      9913.1029      1556.1014      3961.9145    
       500   298.62123     -44858.951     -7580.0343      2683.5351      3961.9145    
       600   270.15142     -44852.38       2321.4457      1855.4804      3961.9145    
       700   309.04892     -44888.671      2136.6174     -1637.4739      3961.9145    
       800   299.5086      -44831.575      8055.4292      3251.8143      3961.9145    
       900   319.05744     -44849.671      2163.5695      324.34334      3961.9145    
      1000   292.7452      -44830.36       5253.3315     -5819.4681      3961.9145    
      1100   313.48079     -44871.98       9684.9912     -1394.9304      3961.9145    
      1200   289.59441     -44852.508     -2072.0509     -1031.3169      3961.9145    
      1300   308.83719     -44852.922      5585.4138      3727.812       3961.9145    
      1400   331.37168     -44852.663     -1958.2949      3763.2396      3961.9145    
      1500   302.22363     -44838.662     -6216.0836     -4410.0814      3961.9145    
      1600   292.52719     -44859.058      6195.4166     -3952.1791      3961.9145    
      1700   287.62096     -44851.078     -3868.9836     -1883.2748      3961.9145    
      1800   311.80935     -44871.674     -2332.7043     -712.07354      3961.9145    
      1900   308.27972     -44854.731     -5128.2783      298.5352       3961.9145    
      2000   336.5544      -44855.873      805.09901      3894.1347      3961.9145    
Loop time of 105.57 on 8 procs for 2000 steps with 386 atoms

Performance: 0.818 ns/day, 29.325 hours/ns, 18.945 timesteps/s, 7.313 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.889     | 80.337     | 89.174     | 131.1 | 76.10
Bond    | 0.00056455 | 0.00075701 | 0.0010374  |   0.0 |  0.00
Neigh   | 4.8337     | 6.4848     | 7.4273     |  37.3 |  6.14
Comm    | 0.70402    | 9.5314     | 30.991     | 380.8 |  9.03
Output  | 0.004334   | 0.0052057  | 0.0059126  |   0.8 |  0.00
Modify  | 8.2056     | 9.1695     | 10.813     |  31.5 |  8.69
Other   |            | 0.04158    |            |       |  0.04

Nlocal:          48.25 ave          58 max          44 min
Histogram: 2 1 3 0 0 1 0 0 0 1
Nghost:        3474.88 ave        3514 max        3444 min
Histogram: 2 2 0 0 0 1 0 1 0 2
Neighs:        32833.1 ave       38896 max       30051 min
Histogram: 2 2 1 1 0 1 0 0 0 1

Total # of neighbors = 262665
Ave neighs/atom = 680.47927
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.2 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   336.5544      -44855.873      805.11717      0              3961.9145    
       100   301.67072     -44836.436      1505.2212      382.41575      3961.9145    
       200   296.62753     -44853.457      6616.2852      3267.338       3961.9145    
       300   304.29196     -44867.326     -52.070291     -1450.5558      3961.9145    
       400   292.74823     -44847.296      5313.879      -4438.069       3961.9145    
       500   316.3776      -44859.754     -8780.4634     -1220.7993      3961.9145    
       600   298.56125     -44812.97       6115.7322     -2797.6898      3961.9145    
       700   312.69473     -44802.934      5196.6606      7564.6112      3961.9145    
       800   292.47282     -44811.616      4375.5493     -3643.8219      3961.9145    
       900   286.9324      -44839.684     -5387.1067      4836.9464      3961.9145    
      1000   298.26683     -44866.19       3636.6392      162.80824      3961.9145    
      1100   299.34061     -44872.975     -3617.3484     -1852.004       3961.9145    
      1200   292.51074     -44841.442      14959.713      1387.5306      3961.9145    
      1300   287.1498      -44813.748      7253.6348     -1322.3876      3961.9145    
      1400   303.30179     -44827.567      1394.3621     -3168.1791      3961.9145    
      1500   291.78537     -44840.499      13551.941      7427.812       3961.9145    
      1600   288.38633     -44869.446      8314.2427      3361.0487      3961.9145    
      1700   295.18951     -44861.742     -2080.7927      1786.3564      3961.9145    
      1800   302.75803     -44848.698     -7519.493      -164.75147      3961.9145    
      1900   307.95615     -44849.947      4567.5992      3017.804       3961.9145    
      2000   309.5231      -44854.769     -4865.8203     -999.91598      3961.9145    
Loop time of 105.489 on 8 procs for 2000 steps with 386 atoms

Performance: 0.819 ns/day, 29.303 hours/ns, 18.959 timesteps/s, 7.318 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.752     | 80.048     | 89.099     | 131.6 | 75.88
Bond    | 0.00058901 | 0.00076409 | 0.0010143  |   0.0 |  0.00
Neigh   | 4.8537     | 6.45       | 7.2888     |  36.4 |  6.11
Comm    | 0.70209    | 9.745      | 31.051     | 377.3 |  9.24
Output  | 0.00096029 | 0.0010564  | 0.0015458  |   0.6 |  0.00
Modify  | 8.3424     | 9.2028     | 10.793     |  30.6 |  8.72
Other   |            | 0.04167    |            |       |  0.04

Nlocal:          48.25 ave          58 max          42 min
Histogram: 1 1 1 2 0 2 0 0 0 1
Nghost:           3484 ave        3511 max        3450 min
Histogram: 2 0 0 2 0 0 0 0 1 3
Neighs:        32842.2 ave       38934 max       28943 min
Histogram: 2 0 1 2 0 2 0 0 0 1

Total # of neighbors = 262738
Ave neighs/atom = 680.66839
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -15.0653660644497
variable C2neg equal ${d2}
variable C2neg equal 24.9531560367358
variable C3neg equal ${d3}
variable C3neg equal -3.41934933916959
variable C4neg equal ${d4}
variable C4neg equal 24.7949288177519
variable C5neg equal ${d5}
variable C5neg equal 4.10857344724211
variable C6neg equal ${d6}
variable C6neg equal -18.1352319231876

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.7042063635054
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.177042063635054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.72050967)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44869.984     -1886.4271      0              3961.9145    
       100   300.198       -44863.559     -4353.5861      5153.2842      3961.9145    
       200   300.82073     -44833.905      8393.8361      335.4235       3961.9145    
       300   303.10263     -44831.295     -2854.4226      1772.8849      3961.9145    
       400   316.34661     -44856.209      11072.541     -891.06898      3961.9145    
       500   301.25095     -44861.248     -10788.27      -2671.8114      3961.9145    
       600   296.22025     -44866.92       6279.7729      1912.7855      3961.9145    
       700   288.72767     -44860.136     -2194.4132     -1929.6323      3961.9145    
       800   302.68584     -44870.707      7054.8302      4957.8283      3961.9145    
       900   305.36865     -44849.736     -2290.6189     -2489.1476      3961.9145    
      1000   312.73242     -44831.22      -4150.1655      145.92044      3961.9145    
      1100   293.75767     -44820.263     -4474.0338      276.90394      3961.9145    
      1200   319.12738     -44877.972      1526.9314     -734.67891      3961.9145    
      1300   310.50153     -44886.944      15788.999      4338.7865      3961.9145    
      1400   293.59971     -44869.562      4709.1949      2405.346       3961.9145    
      1500   313.37866     -44883.527     -1990.0259      2516.4465      3961.9145    
      1600   306.0572      -44867.51      -6921.441      -4520.0623      3961.9145    
      1700   313.70669     -44855.919     -7442.6146      4666.9415      3961.9145    
      1800   304.04368     -44818.917     -2817.3911     -3505.386       3961.9145    
      1900   303.24112     -44829.442      2468.9571     -4741.247       3961.9145    
      2000   296.15432     -44850.887     -723.63678      710.21711      3961.9145    
Loop time of 104.357 on 8 procs for 2000 steps with 386 atoms

Performance: 0.828 ns/day, 28.988 hours/ns, 19.165 timesteps/s, 7.398 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.31      | 79.321     | 88.206     | 129.8 | 76.01
Bond    | 0.00062196 | 0.0007393  | 0.00088636 |   0.0 |  0.00
Neigh   | 4.7734     | 6.3528     | 7.083      |  36.0 |  6.09
Comm    | 0.714      | 9.5952     | 30.613     | 373.3 |  9.19
Output  | 0.0042539  | 0.0052224  | 0.0059477  |   0.8 |  0.01
Modify  | 8.2884     | 9.0405     | 10.617     |  30.4 |  8.66
Other   |            | 0.04137    |            |       |  0.04

Nlocal:          48.25 ave          62 max          42 min
Histogram: 1 2 0 4 0 0 0 0 0 1
Nghost:        3486.88 ave        3531 max        3442 min
Histogram: 1 0 2 0 1 1 1 0 0 2
Neighs:        32857.6 ave       41466 max       29016 min
Histogram: 2 1 2 2 0 0 0 0 0 1

Total # of neighbors = 262861
Ave neighs/atom = 680.98705
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.2 | 137.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.15432     -44850.887     -723.63725      0              3961.9145    
       100   311.29376     -44867.438     -3296.9296      1666.5573      3961.9145    
       200   310.34341     -44877.463      5656.8101      1880.0617      3961.9145    
       300   287.05695     -44882.187      6670.2278      1191.5726      3961.9145    
       400   288.73829     -44887.139      7649.768      -3845.785       3961.9145    
       500   292.61615     -44860.976     -15106.541     -4293.2272      3961.9145    
       600   297.79773     -44850.388      2463.1132      4901.6501      3961.9145    
       700   315.96562     -44866.415     -2994.2884      1216.3901      3961.9145    
       800   283.23417     -44837.982     -2548.1991     -1468.6679      3961.9145    
       900   297.21753     -44877.161      8701.5477      2653.6401      3961.9145    
      1000   301.4087      -44901.706      1987.2807      14.511087      3961.9145    
      1100   288.9         -44881.826      13752.188      3466.5163      3961.9145    
      1200   310.69291     -44861.096     -2901.3882     -1204.2102      3961.9145    
      1300   340.93109     -44885.018      3201.3531      354.84667      3961.9145    
      1400   284.87076     -44843.193      5290.3885     -5565.7618      3961.9145    
      1500   288.5462      -44865.886      2708.2583     -718.08267      3961.9145    
      1600   298.15286     -44875.905     -4624.7818      1446.2684      3961.9145    
      1700   301.94921     -44845.188     -5807.9574      717.93044      3961.9145    
      1800   313.8761      -44850.714      4799.4479     -357.20799      3961.9145    
      1900   295.60189     -44839.054      14584.829      2061.4895      3961.9145    
      2000   291.24053     -44850.81       1184.292      -4820.064       3961.9145    
Loop time of 103.429 on 8 procs for 2000 steps with 386 atoms

Performance: 0.835 ns/day, 28.730 hours/ns, 19.337 timesteps/s, 7.464 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.26      | 78.969     | 87.221     | 127.8 | 76.35
Bond    | 0.00060385 | 0.00073764 | 0.00088099 |   0.0 |  0.00
Neigh   | 4.7793     | 6.3558     | 7.0992     |  36.0 |  6.15
Comm    | 0.84948    | 9.0924     | 29.812     | 376.7 |  8.79
Output  | 0.00086879 | 0.00097559 | 0.0014342  |   0.0 |  0.00
Modify  | 8.2015     | 8.9683     | 10.538     |  30.5 |  8.67
Other   |            | 0.04158    |            |       |  0.04

Nlocal:          48.25 ave          59 max          44 min
Histogram: 1 1 5 0 0 0 0 0 0 1
Nghost:        3469.75 ave        3526 max        3415 min
Histogram: 1 0 1 2 0 1 1 1 0 1
Neighs:          32873 ave       39609 max       29989 min
Histogram: 1 1 5 0 0 0 0 0 0 1

Total # of neighbors = 262984
Ave neighs/atom = 681.3057
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 53.7730159451447
variable C2pos equal ${d2}
variable C2pos equal 16.8230266387268
variable C3pos equal ${d3}
variable C3pos equal 22.8483063899751
variable C4pos equal ${d4}
variable C4pos equal 6.47947120882303
variable C5pos equal ${d5}
variable C5pos equal -23.2214117921281
variable C6pos equal ${d6}
variable C6pos equal 5.11451056341412

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-15.0653660644497+${C1pos})
variable C14 equal 0.5*(-15.0653660644497+53.7730159451447)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(24.9531560367358+${C2pos})
variable C24 equal 0.5*(24.9531560367358+16.8230266387268)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-3.41934933916959+${C3pos})
variable C34 equal 0.5*(-3.41934933916959+22.8483063899751)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(24.7949288177519+${C4pos})
variable C44 equal 0.5*(24.7949288177519+6.47947120882303)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(4.10857344724211+${C5pos})
variable C54 equal 0.5*(4.10857344724211+-23.2214117921281)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-18.1352319231876+${C6pos})
variable C64 equal 0.5*(-18.1352319231876+5.11451056341412)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.7042063635054
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.7042063635054
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.177042063635054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 -0.15640334 -0.89755173)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.3 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44872.337     -3159.7155      0              3961.9145    
       100   311.82259     -44878.804     -8654.106       4942.0255      3961.9145    
       200   314.96887     -44852.241      10635.176     -1010.3384      3961.9145    
       300   305.37163     -44836.227      1073.8124      4925.2913      3961.9145    
       400   322.2897      -44861.249      6989.8702      822.47909      3961.9145    
       500   303.19912     -44857.48      -864.31599      6458.4601      3961.9145    
       600   286.40295     -44860.203      14706.373      4481.6403      3961.9145    
       700   291.49864     -44862.351      6880.8691      1151.7463      3961.9145    
       800   298.58043     -44822.359      755.30782      77.504524      3961.9145    
       900   329.24981     -44848.16       13349.348      4590.1132      3961.9145    
      1000   314.24845     -44848.447      13478.017      1214.7171      3961.9145    
      1100   288.69867     -44846.686      5101.061      -769.02576      3961.9145    
      1200   294.43767     -44854.07      -4824.9175      1466.9874      3961.9145    
      1300   291.52158     -44840.2        3575.3718      2135.2531      3961.9145    
      1400   306.352       -44838.647     -2942.8305      4716.8471      3961.9145    
      1500   322.69875     -44824.491     -6754.7799     -2694.9351      3961.9145    
      1600   335.52203     -44848.208      1615.7823     -6657.4182      3961.9145    
      1700   310.48824     -44851.422     -1632.122      -291.91636      3961.9145    
      1800   300.47571     -44845.728      5372.7834      7042.398       3961.9145    
      1900   316.81046     -44861.73       8998.164       7990.6061      3961.9145    
      2000   295.35317     -44836.58       2547.8668     -2596.6053      3961.9145    
Loop time of 104.282 on 8 procs for 2000 steps with 386 atoms

Performance: 0.829 ns/day, 28.967 hours/ns, 19.179 timesteps/s, 7.403 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.091     | 79.483     | 88         | 130.6 | 76.22
Bond    | 0.00058624 | 0.000788   | 0.00095802 |   0.0 |  0.00
Neigh   | 4.8245     | 6.3988     | 7.1816     |  35.8 |  6.14
Comm    | 0.82844    | 9.3411     | 30.738     | 381.0 |  8.96
Output  | 0.0042982  | 0.0052531  | 0.0059138  |   0.8 |  0.01
Modify  | 8.2032     | 9.0122     | 10.585     |  30.4 |  8.64
Other   |            | 0.04127    |            |       |  0.04

Nlocal:          48.25 ave          58 max          44 min
Histogram: 3 0 1 3 0 0 0 0 0 1
Nghost:         3498.5 ave        3548 max        3452 min
Histogram: 1 1 0 1 2 1 0 0 1 1
Neighs:        32850.5 ave       38895 max       30082 min
Histogram: 3 0 0 4 0 0 0 0 0 1

Total # of neighbors = 262804
Ave neighs/atom = 680.83938
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.4 | 137.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.35317     -44836.58       2547.8335      0              3961.9145    
       100   293.25166     -44841.99      -22738.621     -3653.8571      3961.9145    
       200   294.34746     -44869.173     -8975.6448     -6981.7185      3961.9145    
       300   286.22705     -44886.57       12213.906      5802.3397      3961.9145    
       400   283.70148     -44871.248      3443.5933      1866.3751      3961.9145    
       500   288.10774     -44858.625     -9429.211       1224.17        3961.9145    
       600   290.26986     -44844.311     -10646.448     -907.69602      3961.9145    
       700   302.88243     -44839.988     -8232.6117      4080.826       3961.9145    
       800   328.65493     -44863.757      9394.7213      3147.1688      3961.9145    
       900   298.29876     -44873.315      8.8967605      128.89533      3961.9145    
      1000   301.09738     -44882.72      -11052.797     -802.4088       3961.9145    
      1100   282.99402     -44852.379      5238.4499      1241.6529      3961.9145    
      1200   321.55921     -44871.372      7360.6577     -4343.4975      3961.9145    
      1300   314.43978     -44850.553      6316.3663     -3687.1286      3961.9145    
      1400   309.0504      -44858.015      5591.9883      13.6813        3961.9145    
      1500   287.32553     -44874.339      4114.602      -2753.1976      3961.9145    
      1600   277.55738     -44858.239      10787.659      7410.375       3961.9145    
      1700   302.45846     -44861.485      7059.1926      2315.5414      3961.9145    
      1800   298.32656     -44841.595     -3848.6878     -438.98809      3961.9145    
      1900   305.64465     -44849.24       6548.0317      638.39082      3961.9145    
      2000   287.81391     -44847.321      2066.3538     -1121.0055      3961.9145    
Loop time of 103.733 on 8 procs for 2000 steps with 386 atoms

Performance: 0.833 ns/day, 28.815 hours/ns, 19.280 timesteps/s, 7.442 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.207     | 76.682     | 87.43      | 135.1 | 73.92
Bond    | 0.00057746 | 0.00077159 | 0.00093411 |   0.0 |  0.00
Neigh   | 4.8326     | 6.2434     | 7.3277     |  38.7 |  6.02
Comm    | 0.84936    | 11.594     | 30.074     | 347.4 | 11.18
Output  | 0.00090253 | 0.00098353 | 0.0013274  |   0.0 |  0.00
Modify  | 8.0612     | 9.1715     | 10.58      |  32.3 |  8.84
Other   |            | 0.0403     |            |       |  0.04

Nlocal:          48.25 ave          59 max          44 min
Histogram: 2 1 3 0 1 0 0 0 0 1
Nghost:        3489.75 ave        3518 max        3465 min
Histogram: 1 2 0 0 0 2 1 1 0 1
Neighs:        32858.1 ave       39599 max       30215 min
Histogram: 2 2 2 0 1 0 0 0 0 1

Total # of neighbors = 262865
Ave neighs/atom = 680.99741
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -16.2923053764029
variable C2neg equal ${d2}
variable C2neg equal -27.1716007151567
variable C3neg equal ${d3}
variable C3neg equal -61.4466666429286
variable C4neg equal ${d4}
variable C4neg equal 14.7543198973013
variable C5neg equal ${d5}
variable C5neg equal 26.9175323540329
variable C6neg equal ${d6}
variable C6neg equal 1.8113504622715

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.7042063635054
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.177042063635054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.19768079 -0.89755173)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44871.891     -1550.1141      0              3961.9145    
       100   311.0295      -44876.467     -2084.0913      3161.1318      3961.9145    
       200   314.63696     -44850.414      7193.4994     -556.04492      3961.9145    
       300   312.79636     -44843.644      8070.9471      2861.0138      3961.9145    
       400   311.00347     -44852.267      2271.4809      853.75129      3961.9145    
       500   303.68719     -44863.261     -16557.783     -422.77066      3961.9145    
       600   303.33682     -44867.127      3906.5461      4776.5117      3961.9145    
       700   311.39642     -44860.155      6238.9928      3412.0411      3961.9145    
       800   317.02035     -44829.115      7727.7149      416.49772      3961.9145    
       900   325.67569     -44844.787     -5939.2348     -1072.0011      3961.9145    
      1000   305.22427     -44851.406      1697.3821      17.375499      3961.9145    
      1100   295.28836     -44855.252     -906.26876     -3535.1351      3961.9145    
      1200   302.38414     -44864.457      3651.8818     -5292.0335      3961.9145    
      1300   281.20245     -44830.019     -1207.9705     -647.61586      3961.9145    
      1400   309.98528     -44826.021     -8625.4501      1533.5134      3961.9145    
      1500   308.48697     -44815.242      6824.9532      7447.8936      3961.9145    
      1600   303.56871     -44832.731     -7898.2119     -1954.0439      3961.9145    
      1700   297.5747      -44840.739      7859.1693      1865.5436      3961.9145    
      1800   305.60784     -44861.785      5862.4691     -90.257767      3961.9145    
      1900   299.55519     -44857.124      11434.142     -254.38458      3961.9145    
      2000   305.11455     -44835.823     -6433.4611     -5265.8041      3961.9145    
Loop time of 103.822 on 8 procs for 2000 steps with 386 atoms

Performance: 0.832 ns/day, 28.839 hours/ns, 19.264 timesteps/s, 7.436 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.099     | 75.776     | 87.601     | 146.9 | 72.99
Bond    | 0.00056764 | 0.00072947 | 0.00097624 |   0.0 |  0.00
Neigh   | 4.8072     | 6.2079     | 7.2832     |  42.2 |  5.98
Comm    | 0.71277    | 12.534     | 30.218     | 361.0 | 12.07
Output  | 0.0040544  | 0.0049135  | 0.0055109  |   0.7 |  0.00
Modify  | 8.1647     | 9.2581     | 10.654     |  35.0 |  8.92
Other   |            | 0.04047    |            |       |  0.04

Nlocal:          48.25 ave          60 max          42 min
Histogram: 2 1 1 2 0 0 1 0 0 1
Nghost:        3496.12 ave        3547 max        3448 min
Histogram: 1 1 1 1 0 2 0 0 0 2
Neighs:        32832.4 ave       40253 max       28943 min
Histogram: 2 1 1 2 0 0 1 0 0 1

Total # of neighbors = 262659
Ave neighs/atom = 680.46373
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.6 | 135.4 | 137.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.11455     -44835.823     -6433.3995      0              3961.9145    
       100   309.57493     -44849.217     -8796.2996     -1399.1558      3961.9145    
       200   287.10169     -44856.233      12699.891      4118.1373      3961.9145    
       300   275.75171     -44860.133      2051.3684      3698.2229      3961.9145    
       400   296.73695     -44871.808     -11374.461     -4851.6704      3961.9145    
       500   273.65503     -44829.994     -9658.9999      1343.0419      3961.9145    
       600   306.16608     -44856.577      8431.3168      2317.9203      3961.9145    
       700   285.46816     -44831.783      1172.504      -816.73556      3961.9145    
       800   305.99153     -44861.244     -4034.5709     -1863.9909      3961.9145    
       900   282.11277     -44859.815     -2188.612      -899.97947      3961.9145    
      1000   273.49703     -44859.595     -1658.7146     -2238.5558      3961.9145    
      1100   297.05229     -44873.274     -6787.3774      1655.0931      3961.9145    
      1200   306.84457     -44852.525      412.39948     -6452.5118      3961.9145    
      1300   309.97482     -44837.293      12690.277     -1106.5537      3961.9145    
      1400   331.18087     -44864.344      13783.026     -698.39127      3961.9145    
      1500   292.56404     -44839.896     -400.99423     -4153.7274      3961.9145    
      1600   296.74467     -44852.963     -3584.9158     -7872.5765      3961.9145    
      1700   318.65922     -44869.939     -4655.5951      446.5163       3961.9145    
      1800   304.423       -44856.857      5928.7087      1720.4385      3961.9145    
      1900   309.57227     -44874.668     -12197.302     -1473.7633      3961.9145    
      2000   294.74861     -44879.436      4225.2101      1416.132       3961.9145    
Loop time of 103.895 on 8 procs for 2000 steps with 386 atoms

Performance: 0.832 ns/day, 28.860 hours/ns, 19.250 timesteps/s, 7.431 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.501     | 76.58      | 87.515     | 126.0 | 73.71
Bond    | 0.00059165 | 0.00073858 | 0.00099724 |   0.0 |  0.00
Neigh   | 4.834      | 6.2627     | 7.3013     |  36.6 |  6.03
Comm    | 0.8763     | 11.809     | 29.893     | 320.7 | 11.37
Output  | 0.00083445 | 0.0009328  | 0.0013221  |   0.0 |  0.00
Modify  | 8.1487     | 9.2008     | 10.627     |  30.4 |  8.86
Other   |            | 0.04186    |            |       |  0.04

Nlocal:          48.25 ave          58 max          42 min
Histogram: 2 0 1 1 1 2 0 0 0 1
Nghost:        3482.62 ave        3513 max        3455 min
Histogram: 2 0 1 1 0 0 2 0 1 1
Neighs:        32841.5 ave       38985 max       28925 min
Histogram: 2 0 1 1 1 2 0 0 0 1

Total # of neighbors = 262732
Ave neighs/atom = 680.65285
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -9.41524023683988
variable C2pos equal ${d2}
variable C2pos equal -36.1955015290442
variable C3pos equal ${d3}
variable C3pos equal -10.2074558004769
variable C4pos equal ${d4}
variable C4pos equal -1.59372527196615
variable C5pos equal ${d5}
variable C5pos equal 4.04447032155877
variable C6pos equal ${d6}
variable C6pos equal 3.39885797939282

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-16.2923053764029+${C1pos})
variable C15 equal 0.5*(-16.2923053764029+-9.41524023683988)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-27.1716007151567+${C2pos})
variable C25 equal 0.5*(-27.1716007151567+-36.1955015290442)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-61.4466666429286+${C3pos})
variable C35 equal 0.5*(-61.4466666429286+-10.2074558004769)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(14.7543198973013+${C4pos})
variable C45 equal 0.5*(14.7543198973013+-1.59372527196615)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(26.9175323540329+${C5pos})
variable C55 equal 0.5*(26.9175323540329+4.04447032155877)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(1.8113504622715+${C6pos})
variable C65 equal 0.5*(1.8113504622715+3.39885797939282)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.1238923442901

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.1238923442901
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.131238923442901 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.6172478 0.020638725 -0.89755173)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.4 | 136.1 | 138.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44869.333     -109.40479      0              3961.9145    
       100   305.67908     -44869.627     -4023.4739      4207.2337      3961.9145    
       200   312.77948     -44845.251     -160.85603     -299.42274      3961.9145    
       300   309.68355     -44835.739     -4718.0122      4246.7329      3961.9145    
       400   319.02033     -44854.864      10428.488      3764.7768      3961.9145    
       500   286.98622     -44839.277     -243.50311      5194.1285      3961.9145    
       600   298.37201     -44859.727     -2306.6041      1377.6         3961.9145    
       700   289.5578      -44842.441      4335.2778      3356.1876      3961.9145    
       800   308.79987     -44857.241      9807.0054      4583.1593      3961.9145    
       900   297.82673     -44845.335     -4411.4009      387.17446      3961.9145    
      1000   308.75849     -44858.436      5251.8564      4147.8223      3961.9145    
      1100   317.72071     -44866.016     -4253.276      -1542.6784      3961.9145    
      1200   300.69166     -44837.42       9436.9366      1337.3185      3961.9145    
      1300   307.65266     -44818.889      4404.1084      3934.5261      3961.9145    
      1400   323.09651     -44837.397     -5923.3407      6352.6921      3961.9145    
      1500   304.35634     -44850.508      13049.311      3148.9073      3961.9145    
      1600   289.25973     -44838.17       1235.4239      2402.3733      3961.9145    
      1700   296.98491     -44846.437      5640.2608      5132.4742      3961.9145    
      1800   307.41437     -44846.933      3770.8336      9490.7503      3961.9145    
      1900   318.00214     -44826.909     -2230.715      -2609.2143      3961.9145    
      2000   322.16475     -44823.612     -3807.7242     -1916.531       3961.9145    
Loop time of 103.682 on 8 procs for 2000 steps with 386 atoms

Performance: 0.833 ns/day, 28.800 hours/ns, 19.290 timesteps/s, 7.446 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.32      | 74.847     | 87.42      | 143.4 | 72.19
Bond    | 0.0005711  | 0.00074096 | 0.00096241 |   0.0 |  0.00
Neigh   | 4.8246     | 6.1247     | 7.2715     |  40.7 |  5.91
Comm    | 0.75928    | 13.329     | 29.869     | 339.7 | 12.86
Output  | 0.0043482  | 0.005233   | 0.0059203  |   0.8 |  0.01
Modify  | 8.1633     | 9.335      | 10.624     |  33.3 |  9.00
Other   |            | 0.04059    |            |       |  0.04

Nlocal:          48.25 ave          58 max          44 min
Histogram: 2 1 2 2 0 0 0 0 0 1
Nghost:        3501.12 ave        3539 max        3465 min
Histogram: 1 1 0 2 1 1 0 0 0 2
Neighs:          32858 ave       38948 max       29883 min
Histogram: 2 1 1 3 0 0 0 0 0 1

Total # of neighbors = 262864
Ave neighs/atom = 680.99482
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.3 | 135.9 | 138.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   322.16475     -44823.612     -3807.7398      0              3961.9145    
       100   318.32914     -44844.304      6381.3211     -2488.3225      3961.9145    
       200   289.47777     -44832.573      5497.4544     -612.19967      3961.9145    
       300   284.94287     -44828.82      -8763.6392     -1852.0399      3961.9145    
       400   304.92587     -44842.704      5154.2115      1726.1254      3961.9145    
       500   306.80728     -44841.286     -8045.0475     -279.89316      3961.9145    
       600   279.06499     -44818.165      3572.9966      7730.5608      3961.9145    
       700   292.54979     -44844.296      6692.4924      5524.5122      3961.9145    
       800   308.01761     -44857.028      13969.164      1833.9833      3961.9145    
       900   308.80033     -44836.215     -1088.0657     -1236.2829      3961.9145    
      1000   301.59268     -44817.39      -14064.731      368.94424      3961.9145    
      1100   313.01008     -44845.986      10199.964      6521.3103      3961.9145    
      1200   320.08939     -44882.169      9390.3751      1583.9581      3961.9145    
      1300   286.56576     -44852.584      1183.9221      969.78318      3961.9145    
      1400   288.44119     -44830.764      3421.84        1331.6433      3961.9145    
      1500   288.75632     -44804.774      7712.4659      6993.1799      3961.9145    
      1600   307.74607     -44833.296      15671.317      8975.7936      3961.9145    
      1700   288.09469     -44824.174      17524.536      7372.3998      3961.9145    
      1800   290.18514     -44835.239      219.49798      5851.1465      3961.9145    
      1900   292.55291     -44855.606     -4980.837       260.44945      3961.9145    
      2000   276.89911     -44862.553     -2186.203       6858.5745      3961.9145    
Loop time of 94.7609 on 8 procs for 2000 steps with 386 atoms

Performance: 0.912 ns/day, 26.322 hours/ns, 21.106 timesteps/s, 8.147 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.338     | 68.358     | 79.448     | 118.6 | 72.14
Bond    | 0.00055598 | 0.00070082 | 0.00093777 |   0.0 |  0.00
Neigh   | 4.808      | 5.7068     | 6.7615     |  35.1 |  6.02
Comm    | 0.82131    | 11.907     | 22.94      | 284.0 | 12.56
Output  | 0.00086091 | 0.00095487 | 0.0012829  |   0.0 |  0.00
Modify  | 7.6755     | 8.7488     | 9.6378     |  28.7 |  9.23
Other   |            | 0.03905    |            |       |  0.04

Nlocal:          48.25 ave          59 max          40 min
Histogram: 1 0 1 1 3 1 0 0 0 1
Nghost:           3481 ave        3526 max        3449 min
Histogram: 3 1 0 0 0 1 0 0 2 1
Neighs:        32838.1 ave       39618 max       27224 min
Histogram: 1 0 0 2 2 2 0 0 0 1

Total # of neighbors = 262705
Ave neighs/atom = 680.5829
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 64.5607882986982
variable C2neg equal ${d2}
variable C2neg equal -17.1646057275433
variable C3neg equal ${d3}
variable C3neg equal 4.35077118969439
variable C4neg equal ${d4}
variable C4neg equal -7.61696927390675
variable C5neg equal ${d5}
variable C5neg equal 18.4642568017304
variable C6neg equal ${d6}
variable C6neg equal 9.3156182009896

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.1238923442901
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.131238923442901 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.3547699 0.020638725 -0.89755173)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.9 | 137 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44876.543     -4816.5596      0              3961.9145    
       100   305.03699     -44872.524     -3983.0414      3751.4239      3961.9145    
       200   312.70034     -44853.787      10414.558     -883.76815      3961.9145    
       300   300.70078     -44835.907      4512.7962      2651.6818      3961.9145    
       400   298.34843     -44842.299      15889.913     -54.369174      3961.9145    
       500   285.84274     -44848.631     -5485.8021      84.394562      3961.9145    
       600   292.55179     -44876.026      3270.6642      3623.1088      3961.9145    
       700   280.29766     -44877.937      6042.5725     -1006.281       3961.9145    
       800   292.75318     -44875.847      20516.206      3741.6242      3961.9145    
       900   282.22518     -44831.727      1099.1886      862.382        3961.9145    
      1000   310.57904     -44844.75      -6035.687      -2814.3305      3961.9145    
      1100   301.4604      -44836.595      10288.577     -2019.0376      3961.9145    
      1200   313.99079     -44869.61      -8069.6358     -5579.3133      3961.9145    
      1300   276.17962     -44856.836      1641.1808     -3338.0381      3961.9145    
      1400   259.6667      -44839.08       5585.6153      5101.6597      3961.9145    
      1500   286.91971     -44847.385      8269.6293     -3259.1784      3961.9145    
      1600   306.28416     -44859.962     -5107.442      -4130.2467      3961.9145    
      1700   292.3104      -44843.102     -6480.9013      1598.3463      3961.9145    
      1800   313.11859     -44861.57      -876.92906     -509.4954       3961.9145    
      1900   312.84096     -44862.052      8128.3488      3377.6017      3961.9145    
      2000   295.31493     -44863.673     -4370.3568      2822.1827      3961.9145    
Loop time of 65.0027 on 8 procs for 2000 steps with 386 atoms

Performance: 1.329 ns/day, 18.056 hours/ns, 30.768 timesteps/s, 11.876 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.721     | 52.223     | 53.176     |  11.1 | 80.34
Bond    | 0.00048265 | 0.00067291 | 0.00095047 |   0.0 |  0.00
Neigh   | 4.7718     | 4.818      | 4.867      |   1.6 |  7.41
Comm    | 0.60205    | 1.5488     | 3.0445     |  64.5 |  2.38
Output  | 0.0030785  | 0.0039428  | 0.0044794  |   0.8 |  0.01
Modify  | 6.321      | 6.3716     | 6.4162     |   1.3 |  9.80
Other   |            | 0.03621    |            |       |  0.06

Nlocal:          48.25 ave          58 max          42 min
Histogram: 1 1 2 1 0 1 1 0 0 1
Nghost:        3477.12 ave        3519 max        3433 min
Histogram: 1 1 0 0 2 1 0 2 0 1
Neighs:        32833.4 ave       38932 max       28614 min
Histogram: 1 1 2 1 0 1 0 1 0 1

Total # of neighbors = 262667
Ave neighs/atom = 680.48446
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.6 | 134.9 | 136.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.31493     -44863.673     -4370.3462      0              3961.9145    
       100   286.24836     -44840.626      2242.9145      3429.2176      3961.9145    
       200   312.12716     -44841.857      13184.534     -1139.981       3961.9145    
       300   311.69646     -44851.849      3931.4713     -487.95681      3961.9145    
       400   308.80163     -44859.897     -6699.3172     -1623.0473      3961.9145    
       500   302.93345     -44859.568      10912.324      127.88472      3961.9145    
       600   293.56544     -44858.182      3477.5519     -887.9021       3961.9145    
       700   277.2189      -44862.577     -2377.044      -5485.3206      3961.9145    
       800   280.02579     -44876.334     -1330.0901      267.30281      3961.9145    
       900   305.54224     -44868.716      4687.9484      3922.0609      3961.9145    
      1000   294.6686      -44838.504      3849.7963      1122.5663      3961.9145    
      1100   302.91865     -44838.938     -5814.6401     -5388.1215      3961.9145    
      1200   299.65681     -44838.71       182.32485     -3408.4058      3961.9145    
      1300   288.801       -44857.983      7951.6901     -533.67458      3961.9145    
      1400   281.48227     -44871.375      2013.1772      1105.769       3961.9145    
      1500   285.87969     -44863.421      6599.0034      1136.5401      3961.9145    
      1600   292.75317     -44853.124      5420.6036      3835.8603      3961.9145    
      1700   295.70741     -44841.526     -1271.9852     -700.82812      3961.9145    
      1800   329.02375     -44873.656      35.598286     -2993.5237      3961.9145    
      1900   298.89827     -44852.118     -3697.202      -3881.0498      3961.9145    
      2000   301.03843     -44862.215     -592.2573      -688.9332       3961.9145    
Loop time of 63.1349 on 8 procs for 2000 steps with 386 atoms

Performance: 1.368 ns/day, 17.537 hours/ns, 31.678 timesteps/s, 12.228 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.953     | 50.344     | 51.396     |  12.0 | 79.74
Bond    | 0.00044965 | 0.00064694 | 0.00090117 |   0.0 |  0.00
Neigh   | 4.7624     | 4.8189     | 4.8981     |   1.9 |  7.63
Comm    | 0.52978    | 1.5778     | 2.9622     |  67.7 |  2.50
Output  | 0.00088322 | 0.00095393 | 0.0012212  |   0.0 |  0.00
Modify  | 6.2841     | 6.3582     | 6.4122     |   1.6 | 10.07
Other   |            | 0.03481    |            |       |  0.06

Nlocal:          48.25 ave          58 max          43 min
Histogram: 2 1 0 2 2 0 0 0 0 1
Nghost:        3461.75 ave        3497 max        3428 min
Histogram: 1 0 2 0 1 2 0 0 1 1
Neighs:        32852.8 ave       39071 max       29654 min
Histogram: 3 0 0 2 2 0 0 0 0 1

Total # of neighbors = 262822
Ave neighs/atom = 680.88601
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 11.9143330840622
variable C2pos equal ${d2}
variable C2pos equal -22.9563439701689
variable C3pos equal ${d3}
variable C3pos equal 7.59234793972288
variable C4pos equal ${d4}
variable C4pos equal 10.1086560114452
variable C5pos equal ${d5}
variable C5pos equal 0.93767352965627
variable C6pos equal ${d6}
variable C6pos equal -3.70367684141355

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(64.5607882986982+${C1pos})
variable C16 equal 0.5*(64.5607882986982+11.9143330840622)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-17.1646057275433+${C2pos})
variable C26 equal 0.5*(-17.1646057275433+-22.9563439701689)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(4.35077118969439+${C3pos})
variable C36 equal 0.5*(4.35077118969439+7.59234793972288)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-7.61696927390675+${C4pos})
variable C46 equal 0.5*(-7.61696927390675+10.1086560114452)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(18.4642568017304+${C5pos})
variable C56 equal 0.5*(18.4642568017304+0.93767352965627)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(9.3156182009896+${C6pos})
variable C66 equal 0.5*(9.3156182009896+-3.70367684141355)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 83.117607994203
variable C22all equal ${C22}
variable C22all equal 71.1494305274707
variable C33all equal ${C33}
variable C33all equal 15.7205730937732

variable C44all equal ${C44}
variable C44all equal 15.6372000132875
variable C55all equal ${C55}
variable C55all equal 15.4810013377958
variable C66all equal ${C66}
variable C66all equal 2.80597067978803

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(37.6315123400994+${C21})
variable C12all equal 0.5*(37.6315123400994+25.2936895200049)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(45.4238504626582+${C31})
variable C13all equal 0.5*(45.4238504626582+37.6048167825726)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(5.2952640004543+${C32})
variable C23all equal 0.5*(5.2952640004543+25.4835430300723)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(19.3538249403475+${C41})
variable C14all equal 0.5*(19.3538249403475+3.54451167494399)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-12.8537728066214+${C51})
variable C15all equal 0.5*(-12.8537728066214+-3.1404026975526)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(38.2375606913802+${C61})
variable C16all equal 0.5*(38.2375606913802+-15.0047846958874)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(20.8880913377313+${C42})
variable C24all equal 0.5*(20.8880913377313+1.92896733888403)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-31.6835511221005+${C52})
variable C25all equal 0.5*(-31.6835511221005+5.27935713574533)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-20.0604748488561+${C62})
variable C26all equal 0.5*(-20.0604748488561+-6.35329131024806)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(9.71447852540276+${C43})
variable C34all equal 0.5*(9.71447852540276+5.29089771961057)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-35.8270612217027+${C53})
variable C35all equal 0.5*(-35.8270612217027+-5.9260002370138)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(5.97155956470863+${C63})
variable C36all equal 0.5*(5.97155956470863+1.71509978509865)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(6.58029731266758+${C54})
variable C45all equal 0.5*(6.58029731266758+-9.556419172443)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(1.24584336876923+${C64})
variable C46all equal 0.5*(1.24584336876923+-6.51036067988674)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(9.70096516569333+${C65})
variable C56all equal 0.5*(9.70096516569333+2.60510422083216)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:41:41
