LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-20-vasp-an
read_data       ${structure}.data
read_data       333U-50C-20-vasp-an.data
Reading data file ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  350 atoms
  reading velocities ...
  350 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              312.09081      3848.238     
         1   300            0              0              312.09081      3848.238     
Loop time of 4.52693e-05 on 8 procs for 1 steps with 350 atoms

49.4% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.34e-07   | 1.7538e-07 | 2.3e-07    |   0.0 |  0.39
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.477e-06  | 1.606e-06  | 1.709e-06  |   0.0 |  3.55
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.349e-05  |            |       | 96.06

Nlocal:          43.75 ave          58 max          35 min
Histogram: 2 0 1 1 3 0 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 126.6 | 127.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -41311.099      4640.9413      0              1.7519016      3707.2503    
       100   308.12151     -41307.121     -1044.6248      4454.6724      1.7519016      3707.2503    
       200   312.22755     -41283.727     -6552.9956     -2336.9744      1.7519016      3707.2503    
       300   304.46078     -41263.15       465.32692      1657.3916      1.7519016      3707.2503    
       400   295.79637     -41290.872     -3018.2998     -441.13986      1.7519016      3707.2503    
       500   301.39179     -41312.753      4584.9861      206.86802      1.7519016      3707.2503    
       600   297.09112     -41304.038      4119.3468      4789.0834      1.7519016      3707.2503    
       700   307.66329     -41285.825     -2584.119       270.99928      1.7519016      3707.2503    
       800   310.53438     -41281.767     -15358.523      566.76219      1.7519016      3707.2503    
       900   311.44627     -41291.342      1589.6126     -6736.1788      1.7519016      3707.2503    
      1000   296.71276     -41289.235      11630.067      10179.179      1.7519016      3707.2503    
      1100   273.62412     -41292.367      1040.3907     -3222.6557      1.7519016      3707.2503    
      1200   282.18292     -41328.752     -1030.1812     -978.58488      1.7519016      3707.2503    
      1300   277.91649     -41308.372     -2405.8567     -6088.8464      1.7519016      3707.2503    
      1400   308.01484     -41320.198     -3809.4255     -3171.1248      1.7519016      3707.2503    
      1500   306.3817      -41313.031      1077.8864      1571.2765      1.7519016      3707.2503    
      1600   291.41833     -41287.786     -8126.6754      512.17982      1.7519016      3707.2503    
      1700   294.51521     -41273.115     -4900.8267     -1611.8831      1.7519016      3707.2503    
      1800   322.60401     -41286.568     -7502.0701      1355.325       1.7519016      3707.2503    
      1900   289.24026     -41269.585      930.72044      890.15737      1.7519016      3707.2503    
      2000   280.35332     -41287.214      2479.646      -301.67183      1.7519016      3707.2503    
Loop time of 103.737 on 8 procs for 2000 steps with 350 atoms

Performance: 0.833 ns/day, 28.816 hours/ns, 19.279 timesteps/s, 6.748 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 82.572     | 84.607     | 87.732     |  14.9 | 81.56
Bond    | 0.00072541 | 0.00087534 | 0.0011457  |   0.0 |  0.00
Neigh   | 6.6721     | 6.801      | 6.9467     |   3.9 |  6.56
Comm    | 0.85426    | 3.9909     | 6.0356     |  68.7 |  3.85
Output  | 0.0013717  | 0.0014798  | 0.0020698  |   0.6 |  0.00
Modify  | 8.1455     | 8.2954     | 8.4296     |   3.6 |  8.00
Other   |            | 0.04017    |            |       |  0.04

Nlocal:          43.75 ave          57 max          37 min
Histogram: 2 1 2 0 0 2 0 0 0 1
Nghost:        3251.25 ave        3308 max        3212 min
Histogram: 1 1 1 1 2 0 0 1 0 1
Neighs:        28899.6 ave       37106 max       24556 min
Histogram: 2 1 2 0 0 2 0 0 0 1

Total # of neighbors = 231197
Ave neighs/atom = 660.56286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-20-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.2327391715384
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.9543995646043
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.4406533464764

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--301.671828312068)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--301.671828312068)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--34.9756190009851)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--34.9756190009851)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-1165.99130694546)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-1165.99130694546)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2010.96675104456)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2010.96675104456)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--972.644438149298)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--972.644438149298)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1709.57819777912)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1709.57819777912)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.2327391715384
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.2327391715384
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.152327391715384 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.152327391715384 xy delta 0.0678598602577393 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.152327391715384 xy delta 0.0678598602577393 xz delta 9.90330916854881e-05 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.083142 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.083142 14.2286 17.224577) with tilt (-6.7181262 -0.0099033092 -1.1965688)
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.083142 14.2286 17.224577) with tilt (-6.7181262 -0.0098042761 -1.1965688)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 127.4 | 129 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41265.387      56997.116      0              3670.1778    
       100   295.43557     -41289.553      23524.268      13547.625      3670.1778    
       200   312.71873     -41313.825     -4999.9399      1301.188       3670.1778    
       300   273.99573     -41307.682     -9095.3569      909.11123      3670.1778    
       400   291.56991     -41332.531      1212.7722      9827.1722      3670.1778    
       500   309.58869     -41330.365      9275.2083      5957.1526      3670.1778    
       600   297.34752     -41307.336      10946.981      3136.4608      3670.1778    
       700   301.46653     -41298.803      4359.0601      5198.6764      3670.1778    
       800   310.62185     -41297.462      9518.4758      2259.7115      3670.1778    
       900   313.63978     -41301.222     -4996.2019      24.793866      3670.1778    
      1000   303.00815     -41304.958      3794.6915      9985.4286      3670.1778    
      1100   280.32634     -41298.399      4348.2878      4412.155       3670.1778    
      1200   291.93017     -41316.527     -374.6256       7015.0423      3670.1778    
      1300   303.66408     -41316.183      3075.6637      1693.7508      3670.1778    
      1400   295.39572     -41276.88       1791.7847      3618.9166      3670.1778    
      1500   322.18791     -41299.338      1250.8068      10885.056      3670.1778    
      1600   305.10678     -41297.033     -11881.534      5594.6507      3670.1778    
      1700   292.38257     -41304.867      11245.738      9568.4116      3670.1778    
      1800   270.96028     -41317.916     -2695.0319      2120.7354      3670.1778    
      1900   293.97349     -41328.628     -3954.8632      2276.7504      3670.1778    
      2000   299.82208     -41312.469      6186.6687      8087.3136      3670.1778    
Loop time of 104.678 on 8 procs for 2000 steps with 350 atoms

Performance: 0.825 ns/day, 29.077 hours/ns, 19.106 timesteps/s, 6.687 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.048     | 85.211     | 88.1       |  35.9 | 81.40
Bond    | 0.00069785 | 0.0008727  | 0.0011094  |   0.0 |  0.00
Neigh   | 6.1548     | 6.8392     | 7.1616     |  10.7 |  6.53
Comm    | 1.3475     | 4.2453     | 12.404     | 160.7 |  4.06
Output  | 0.0053634  | 0.0064036  | 0.0072342  |   0.8 |  0.01
Modify  | 8.008      | 8.3351     | 9.0243     |   9.8 |  7.96
Other   |            | 0.04013    |            |       |  0.04

Nlocal:          43.75 ave          61 max          34 min
Histogram: 1 0 4 1 1 0 0 0 0 1
Nghost:        3261.62 ave        3309 max        3227 min
Histogram: 1 1 2 1 1 0 0 0 0 2
Neighs:        29172.1 ave       40052 max       22827 min
Histogram: 1 0 3 2 1 0 0 0 0 1

Total # of neighbors = 233377
Ave neighs/atom = 666.79143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.9 | 127.4 | 129 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.82208     -41312.469      6186.6415      0              3670.1778    
       100   299.29185     -41309.642      8272.4217      8146.2823      3670.1778    
       200   304.42711     -41308.84       10188.793      6762.2306      3670.1778    
       300   310.26529     -41288.197      9363.2396      7143.6726      3670.1778    
       400   314.7583      -41290.278      8364.2312      11378.488      3670.1778    
       500   309.57573     -41318.972      16169.578      10805.264      3670.1778    
       600   287.67002     -41308.98       2880.0107      6800.1102      3670.1778    
       700   286.51868     -41302.344      7681.5841      3203.759       3670.1778    
       800   312.7898      -41311.579     -5376.4662      4913.7075      3670.1778    
       900   315.1352      -41300.221     -631.16631      8208.0987      3670.1778    
      1000   302.64317     -41269.302      4079.9828      6014.0022      3670.1778    
      1100   295.86127     -41273.995      11085.722      9668.7544      3670.1778    
      1200   296.84545     -41304.612      9276.6548      5895.2987      3670.1778    
      1300   289.75516     -41306.46       10355.991     -1470.5839      3670.1778    
      1400   300.65679     -41313.051     -84.252629      6179.9586      3670.1778    
      1500   311.5501      -41299.761      4170.7935      7976.0048      3670.1778    
      1600   324.19922     -41286.077      2501.9632      2887.4688      3670.1778    
      1700   322.47158     -41288.245      22245.518      9238.5839      3670.1778    
      1800   288.62165     -41295.379      20763.797      5832.0232      3670.1778    
      1900   295.55618     -41313.251      10342.376      11387.321      3670.1778    
      2000   306.01904     -41327.025      7003.1219      10773.078      3670.1778    
Loop time of 105.024 on 8 procs for 2000 steps with 350 atoms

Performance: 0.823 ns/day, 29.173 hours/ns, 19.043 timesteps/s, 6.665 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.706     | 84.018     | 88.492     |  69.4 | 80.00
Bond    | 0.00068741 | 0.00086696 | 0.0010626  |   0.0 |  0.00
Neigh   | 5.5646     | 6.8315     | 7.1483     |  18.6 |  6.50
Comm    | 1.1139     | 5.5972     | 21.905     | 268.8 |  5.33
Output  | 0.00091174 | 0.0011115  | 0.0021052  |   1.1 |  0.00
Modify  | 8.2179     | 8.5365     | 9.8053     |  16.7 |  8.13
Other   |            | 0.03904    |            |       |  0.04

Nlocal:          43.75 ave          57 max          35 min
Histogram: 1 1 2 1 0 1 0 1 0 1
Nghost:        3281.38 ave        3322 max        3249 min
Histogram: 1 1 2 1 0 0 1 0 1 1
Neighs:        29195.5 ave       37595 max       23559 min
Histogram: 1 0 3 1 1 0 0 1 0 1

Total # of neighbors = 233564
Ave neighs/atom = 667.32571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 112.214904862
variable C2neg equal ${d2}
variable C2neg equal 37.859018771555
variable C3neg equal ${d3}
variable C3neg equal 67.4108671692712
variable C4neg equal ${d4}
variable C4neg equal -0.224591223165409
variable C5neg equal ${d5}
variable C5neg equal -23.8644157168966
variable C6neg equal ${d6}
variable C6neg equal -4.7904260483055

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.2327391715384
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.152327391715384 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.152327391715384 xy delta -0.0678598602577393 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.152327391715384 xy delta -0.0678598602577393 xz delta -9.90330916854881e-05 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.387797 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.387797 14.2286 17.224577) with tilt (-6.8538459 -0.0099033092 -1.1965688)
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.387797 14.2286 17.224577) with tilt (-6.8538459 -0.010002342 -1.1965688)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124 | 126 | 127.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41271.37      -43583.361      0              3744.3228    
       100   290.92607     -41286.068      7713.933      -6142.0565      3744.3228    
       200   326.38268     -41312.133     -11454.431     -9019.4893      3744.3228    
       300   294.90004     -41271.165      729.21783     -8290.4846      3744.3228    
       400   332.54016     -41307.285      1962.8346     -6537.963       3744.3228    
       500   301.80429     -41292.283      3465.4745     -4991.1708      3744.3228    
       600   299.47703     -41306.916     -8737.8555     -6260.6559      3744.3228    
       700   295.61565     -41291.238      5510.5435     -4904.1253      3744.3228    
       800   300.68797     -41264.33       2300.6984     -5009.3291      3744.3228    
       900   301.87076     -41270.563      2357.5099     -3873.7986      3744.3228    
      1000   311.49267     -41296.471      7822.1673      793.17123      3744.3228    
      1100   287.90808     -41284.325     -1050.5019     -1654.3983      3744.3228    
      1200   304.74758     -41295.967      3772.7282     -5448.9372      3744.3228    
      1300   298.79578     -41258.099     -2612.1915     -5342.4638      3744.3228    
      1400   298.89472     -41248.242     -10345.519     -2398.8055      3744.3228    
      1500   303.42841     -41262.107     -2609.8158     -4341.7505      3744.3228    
      1600   303.38997     -41295.468      2646.9865      1373.2588      3744.3228    
      1700   305.42338     -41305.186      3854.395      -579.01584      3744.3228    
      1800   305.85704     -41296.933      3509.2432     -12018.997      3744.3228    
      1900   295.5173      -41283.8       -4823.3602     -3266.0071      3744.3228    
      2000   294.85309     -41304.959     -2522.2381     -1655.7779      3744.3228    
Loop time of 101.427 on 8 procs for 2000 steps with 350 atoms

Performance: 0.852 ns/day, 28.174 hours/ns, 19.719 timesteps/s, 6.902 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.809     | 77.706     | 85.098     | 122.0 | 76.61
Bond    | 0.00067049 | 0.00089584 | 0.0011188  |   0.0 |  0.00
Neigh   | 5.0101     | 6.4546     | 7.1549     |  32.1 |  6.36
Comm    | 1.0831     | 8.4641     | 27.345     | 369.2 |  8.35
Output  | 0.0046439  | 0.0056005  | 0.0064223  |   0.8 |  0.01
Modify  | 8.0318     | 8.7535     | 10.223     |  28.1 |  8.63
Other   |            | 0.04188    |            |       |  0.04

Nlocal:          43.75 ave          55 max          39 min
Histogram: 2 2 0 3 0 0 0 0 0 1
Nghost:         3227.5 ave        3260 max        3203 min
Histogram: 1 0 3 1 0 1 0 1 0 1
Neighs:        28600.5 ave       35599 max       25772 min
Histogram: 2 2 2 1 0 0 0 0 0 1

Total # of neighbors = 228804
Ave neighs/atom = 653.72571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124 | 126.1 | 127.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.85309     -41304.959     -2522.231       0              3744.3228    
       100   294.81664     -41291.171      768.18378     -7585.385       3744.3228    
       200   296.71905     -41269.397      234.05883     -4321.0562      3744.3228    
       300   309.24912     -41271.128     -5177.0139     -5287.3145      3744.3228    
       400   297.93595     -41284.231     -15753.076     -7384.5138      3744.3228    
       500   299.26051     -41312.468     -4438.7414     -8368.5438      3744.3228    
       600   295.61548     -41313.545     -10381.642     -7314.5204      3744.3228    
       700   309.68353     -41311.378     -10151.553     -9901.8466      3744.3228    
       800   291.938       -41267.83      -257.48013     -5964.7988      3744.3228    
       900   307.90358     -41266.216     -2148.7276      647.30547      3744.3228    
      1000   306.8914      -41268.854     -9120.2824     -3096.0855      3744.3228    
      1100   306.75353     -41283.453     -4984.9275     -8968.3411      3744.3228    
      1200   279.5781      -41276.624     -671.35405     -7756.1267      3744.3228    
      1300   293.3605      -41299.822      1444.8538      2648.2677      3744.3228    
      1400   311.68753     -41313.748     -821.29417     -2618.6414      3744.3228    
      1500   303.30754     -41277.342     -6707.1091     -7498.1956      3744.3228    
      1600   322.71607     -41264.719     -13638.039     -4380.4741      3744.3228    
      1700   285.34771     -41248.675     -6681.7063     -3479.762       3744.3228    
      1800   290.8655      -41288.501     -3228.7251     -5914.2143      3744.3228    
      1900   299.41043     -41305.955     -2415.7397     -9305.4552      3744.3228    
      2000   282.21505     -41280.473      358.63253     -6644.7441      3744.3228    
Loop time of 101.34 on 8 procs for 2000 steps with 350 atoms

Performance: 0.853 ns/day, 28.150 hours/ns, 19.736 timesteps/s, 6.907 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.645     | 77.22      | 84.981     | 137.1 | 76.20
Bond    | 0.00067435 | 0.00089988 | 0.0011184  |   0.0 |  0.00
Neigh   | 4.8368     | 6.4043     | 7.1143     |  35.1 |  6.32
Comm    | 1.3045     | 9.056      | 30.614     | 399.9 |  8.94
Output  | 0.00099333 | 0.0011047  | 0.0016179  |   0.6 |  0.00
Modify  | 7.8848     | 8.6155     | 10.211     |  30.8 |  8.50
Other   |            | 0.04153    |            |       |  0.04

Nlocal:          43.75 ave          57 max          40 min
Histogram: 4 2 0 1 0 0 0 0 0 1
Nghost:        3216.38 ave        3276 max        3167 min
Histogram: 1 1 1 0 2 0 2 0 0 1
Neighs:        28596.5 ave       36648 max       26197 min
Histogram: 4 2 0 1 0 0 0 0 0 1

Total # of neighbors = 228772
Ave neighs/atom = 653.63429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 64.2711796061726
variable C2pos equal ${d2}
variable C2pos equal -26.5761974782318
variable C3pos equal ${d3}
variable C3pos equal 44.4623801267883
variable C4pos equal ${d4}
variable C4pos equal -3.99661481091081
variable C5pos equal ${d5}
variable C5pos equal -14.6639819378901
variable C6pos equal ${d6}
variable C6pos equal 1.7112842473625

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(112.214904862+${C1pos})
variable C11 equal 0.5*(112.214904862+64.2711796061726)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(37.859018771555+${C2pos})
variable C21 equal 0.5*(37.859018771555+-26.5761974782318)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(67.4108671692712+${C3pos})
variable C31 equal 0.5*(67.4108671692712+44.4623801267883)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-0.224591223165409+${C4pos})
variable C41 equal 0.5*(-0.224591223165409+-3.99661481091081)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-23.8644157168966+${C5pos})
variable C51 equal 0.5*(-23.8644157168966+-14.6639819378901)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-4.7904260483055+${C6pos})
variable C61 equal 0.5*(-4.7904260483055+1.7112842473625)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.9543995646043
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.9543995646043
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.139543995646043 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.139543995646043 yz delta 0.0119656875307777 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.089056 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.089056 17.224577) with tilt (-6.785986 -0.0099033092 -1.1846031)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.9 | 128.1 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41268.94       61619.426      0              3670.1778    
       100   298.98401     -41295.077      16281.167      4582.9455      3670.1778    
       200   313.33705     -41309.191     -166.78778     -418.56129      3670.1778    
       300   295.80053     -41318.551      1988.4185     -1164.3759      3670.1778    
       400   294.45191     -41330.502     -1158.5138      4095.7462      3670.1778    
       500   304.18122     -41314.829      10480.254      1217.218       3670.1778    
       600   295.59415     -41292.416     -5085.4616      101.5149       3670.1778    
       700   288.21496     -41279.644      2961.0142      828.26054      3670.1778    
       800   297.25239     -41281.87       6689.06        1796.2353      3670.1778    
       900   294.38143     -41285.02       8979.1956      2120.0521      3670.1778    
      1000   290.24241     -41303.811      4553.5079      5115.8124      3670.1778    
      1100   296.02924     -41316.99       8198.3566      6823.3182      3670.1778    
      1200   300.30479     -41301.424     -12000.659      7089.8041      3670.1778    
      1300   299.73915     -41278.098     -3227.4099      7443.353       3670.1778    
      1400   300.05366     -41275.337      5014.4314      7035.2283      3670.1778    
      1500   303.56051     -41279.801     -3859.5713      4135.5273      3670.1778    
      1600   314.38241     -41297.459      6464.4033      2921.5479      3670.1778    
      1700   320.66259     -41307.068      5137.6707      11084.377      3670.1778    
      1800   302.56601     -41300.772      3052.705       3053.602       3670.1778    
      1900   293.06365     -41293.868      7644.0565      7192.7666      3670.1778    
      2000   294.61022     -41283.277      4818.2499      5862.4227      3670.1778    
Loop time of 104.711 on 8 procs for 2000 steps with 350 atoms

Performance: 0.825 ns/day, 29.086 hours/ns, 19.100 timesteps/s, 6.685 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.612     | 79.759     | 87.979     | 139.5 | 76.17
Bond    | 0.00065419 | 0.00087927 | 0.0011068  |   0.0 |  0.00
Neigh   | 4.8988     | 6.5289     | 7.2964     |  36.4 |  6.24
Comm    | 1.2368     | 9.445      | 31.576     | 405.1 |  9.02
Output  | 0.004848   | 0.0057947  | 0.006579   |   0.8 |  0.01
Modify  | 8.1434     | 8.9311     | 10.586     |  31.7 |  8.53
Other   |            | 0.04065    |            |       |  0.04

Nlocal:          43.75 ave          55 max          36 min
Histogram: 1 0 4 0 0 1 0 1 0 1
Nghost:        3272.38 ave        3315 max        3230 min
Histogram: 2 0 0 1 0 2 1 1 0 1
Neighs:        29187.5 ave       36217 max       24127 min
Histogram: 1 0 4 0 0 1 0 1 0 1

Total # of neighbors = 233500
Ave neighs/atom = 667.14286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.9 | 128.1 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.61022     -41283.277      4818.2579      0              3670.1778    
       100   304.31751     -41287.265      10652.159      3911.2465      3670.1778    
       200   297.93568     -41297.746     -8235.2789     -354.26329      3670.1778    
       300   274.46207     -41302.265      231.80329      2942.29        3670.1778    
       400   284.29402     -41301.737     -2634.3037      2848.1466      3670.1778    
       500   301.00192     -41301.949      7162.0065      4620.5038      3670.1778    
       600   304.30965     -41299.92      -7009.9263      25.115977      3670.1778    
       700   275.39115     -41296.946     -1450.4133     -1661.6584      3670.1778    
       800   283.83427     -41327.314      14655.053      8845.1918      3670.1778    
       900   275.49903     -41300.677      344.62882      3872.3856      3670.1778    
      1000   307.65285     -41310.512      13647.009      8782.1548      3670.1778    
      1100   295.94899     -41296.473      2134.469       438.28813      3670.1778    
      1200   299.59556     -41306.15      -5567.8761      1075.1369      3670.1778    
      1300   311.10163     -41318.978      16799.265     -5031.346       3670.1778    
      1400   288.19413     -41308.912      3015.5116      1877.1775      3670.1778    
      1500   298.9383      -41335.291      3791.7251     -7043.0394      3670.1778    
      1600   291.0146      -41333.927      177.49055      3230.5522      3670.1778    
      1700   310.2127      -41334.528      5906.9742      1780.6831      3670.1778    
      1800   314.20687     -41310.941      9323.0578     -230.31344      3670.1778    
      1900   301.94105     -41294.733      9797.8818      3735.5516      3670.1778    
      2000   292.63766     -41306.693     -3965.7168      2157.6325      3670.1778    
Loop time of 104.525 on 8 procs for 2000 steps with 350 atoms

Performance: 0.827 ns/day, 29.035 hours/ns, 19.134 timesteps/s, 6.697 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.958     | 79.807     | 87.906     | 136.6 | 76.35
Bond    | 0.00063832 | 0.00087247 | 0.0010804  |   0.0 |  0.00
Neigh   | 4.9104     | 6.5088     | 7.2681     |  36.0 |  6.23
Comm    | 1.2371     | 9.3281     | 31.16      | 399.3 |  8.92
Output  | 0.00088848 | 0.0010078  | 0.0014782  |   0.6 |  0.00
Modify  | 8.0584     | 8.8379     | 10.465     |  31.4 |  8.46
Other   |            | 0.04109    |            |       |  0.04

Nlocal:          43.75 ave          56 max          35 min
Histogram: 1 1 1 1 1 1 1 0 0 1
Nghost:        3275.38 ave        3307 max        3256 min
Histogram: 3 0 2 0 0 0 1 0 1 1
Neighs:        29222.9 ave       37001 max       23574 min
Histogram: 1 0 2 1 1 1 1 0 0 1

Total # of neighbors = 233783
Ave neighs/atom = 667.95143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 24.9189015543691
variable C2neg equal ${d2}
variable C2neg equal 52.4739639351088
variable C3neg equal ${d3}
variable C3neg equal 32.0648162140556
variable C4neg equal ${d4}
variable C4neg equal -0.897203204263848
variable C5neg equal ${d5}
variable C5neg equal 15.7247407148175
variable C6neg equal ${d6}
variable C6neg equal 0.149162407667971

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.9543995646043
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.139543995646043 yz delta ${deltayz} remap units box
change_box all y delta 0 0.139543995646043 yz delta -0.0119656875307777 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.368144 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.368144 17.224577) with tilt (-6.785986 -0.0099033092 -1.2085344)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.2 | 126.1 | 127.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41263.996     -44195.622      0              3744.3228    
       100   296.79489     -41287.728      3101.9818     -2107.6013      3744.3228    
       200   316.42463     -41309.47      -15980.368     -5573.4442      3744.3228    
       300   279.87387     -41299.648     -4467.4133     -4249.7391      3744.3228    
       400   279.6749      -41308.151     -9189.033      -5611.1068      3744.3228    
       500   304.39766     -41304.635     -995.39942     -3937.2542      3744.3228    
       600   303.12052     -41292.824     -10254.64      -8940.8578      3744.3228    
       700   308.18191     -41295.729     -6972.5179      268.11687      3744.3228    
       800   298.76164     -41287.56      -5411.2315     -4206.7696      3744.3228    
       900   285.44389     -41282.898     -11283.538     -3789.1073      3744.3228    
      1000   297.97545     -41312.269      7325.0693     -2238.4121      3744.3228    
      1100   273.63852     -41289.069      7678.3344      1223.4252      3744.3228    
      1200   310.77353     -41296.844      1296.7954     -438.87387      3744.3228    
      1300   328.25876     -41303.477      5693.6678     -5445.2149      3744.3228    
      1400   306.54758     -41287.948      4261.716       121.24755      3744.3228    
      1500   307.91758     -41295.597      2363.4452      1300.0733      3744.3228    
      1600   279.63788     -41307.176     -5588.2772      4959.8212      3744.3228    
      1700   286.07383     -41317.364     -4632.8825     -5986.4122      3744.3228    
      1800   291.24015     -41301.886     -1648.5897      685.57456      3744.3228    
      1900   297.04491     -41290.695      890.33076     -2717.4711      3744.3228    
      2000   328.69046     -41313.262      8023.972       1009.9409      3744.3228    
Loop time of 102.038 on 8 procs for 2000 steps with 350 atoms

Performance: 0.847 ns/day, 28.344 hours/ns, 19.600 timesteps/s, 6.860 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.898     | 82.596     | 84.607     |  17.9 | 80.95
Bond    | 0.00072072 | 0.00086642 | 0.0010891  |   0.0 |  0.00
Neigh   | 6.547      | 6.6708     | 6.8425     |   3.1 |  6.54
Comm    | 2.0926     | 4.2369     | 6.8595     |  78.2 |  4.15
Output  | 0.0063005  | 0.007522   | 0.0083439  |   0.8 |  0.01
Modify  | 8.3455     | 8.4854     | 8.7684     |   4.6 |  8.32
Other   |            | 0.0409     |            |       |  0.04

Nlocal:          43.75 ave          56 max          36 min
Histogram: 1 0 4 0 0 1 1 0 0 1
Nghost:        3239.12 ave        3287 max        3197 min
Histogram: 1 1 0 0 3 1 1 0 0 1
Neighs:        28625.9 ave       36185 max       23741 min
Histogram: 1 0 4 0 1 0 1 0 0 1

Total # of neighbors = 229007
Ave neighs/atom = 654.30571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.2 | 126.2 | 127.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   328.69046     -41313.262      8023.9288      0              3744.3228    
       100   294.75325     -41283.826     -9651.9345     -4616.6491      3744.3228    
       200   298.83545     -41318.394      628.99089     -2868.6999      3744.3228    
       300   285.47088     -41318.646     -3145.3104     -2197.1181      3744.3228    
       400   292.58869     -41310.578     -1051.8459     -985.64944      3744.3228    
       500   296.22133     -41298.805     -4780.8728     -8572.8373      3744.3228    
       600   301.8461      -41297.729      9628.7207     -3322.1394      3744.3228    
       700   299.27622     -41290.988     -5803.7342     -6610.3905      3744.3228    
       800   300.50605     -41307.43      -10317.936     -2639.4577      3744.3228    
       900   293.2763      -41337.03       1381.0807     -5985.6726      3744.3228    
      1000   283.6657      -41314.661     -4701.1502     -1723.0075      3744.3228    
      1100   295.14663     -41303.663     -19441.346     -2778.3334      3744.3228    
      1200   303.14991     -41293.635     -4042.1329     -4964.8334      3744.3228    
      1300   306.83648     -41292.88      -3930.3004     -801.50628      3744.3228    
      1400   293.59935     -41290.74      -1430.1671     -3384.0605      3744.3228    
      1500   298.49212     -41321.813      3757.9727      2160.1557      3744.3228    
      1600   268.51725     -41297.978     -12254.204     -1532.1433      3744.3228    
      1700   286.6951      -41285.784      1326.6578      5761.1712      3744.3228    
      1800   302.11685     -41287.784      10316.665     -1187.6959      3744.3228    
      1900   315.93633     -41300.273      3614.0681     -2172.6228      3744.3228    
      2000   303.2108      -41301.983     -1753.711       1936.0725      3744.3228    
Loop time of 100.625 on 8 procs for 2000 steps with 350 atoms

Performance: 0.859 ns/day, 27.951 hours/ns, 19.876 timesteps/s, 6.957 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 80.513     | 82.659     | 84.913     |  14.9 | 82.15
Bond    | 0.00073942 | 0.00089618 | 0.0011214  |   0.0 |  0.00
Neigh   | 6.3743     | 6.6656     | 6.7997     |   4.8 |  6.62
Comm    | 1.0515     | 3.3138     | 5.463      |  74.5 |  3.29
Output  | 0.00097727 | 0.0010868  | 0.0015751  |   0.6 |  0.00
Modify  | 7.808      | 7.9437     | 8.2333     |   4.4 |  7.89
Other   |            | 0.04081    |            |       |  0.04

Nlocal:          43.75 ave          56 max          36 min
Histogram: 1 0 4 0 0 0 2 0 0 1
Nghost:           3194 ave        3212 max        3176 min
Histogram: 1 2 0 0 1 1 0 0 1 2
Neighs:        28608.6 ave       36151 max       23739 min
Histogram: 1 1 3 0 0 0 2 0 0 1

Total # of neighbors = 228869
Ave neighs/atom = 653.91143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -22.673944381966
variable C2pos equal ${d2}
variable C2pos equal 37.9348134579989
variable C3pos equal ${d3}
variable C3pos equal -2.09909918471323
variable C4pos equal ${d4}
variable C4pos equal -3.9526258635933
variable C5pos equal ${d5}
variable C5pos equal 4.4379866725396
variable C6pos equal ${d6}
variable C6pos equal -9.7246582305745

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(24.9189015543691+${C1pos})
variable C12 equal 0.5*(24.9189015543691+-22.673944381966)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(52.4739639351088+${C2pos})
variable C22 equal 0.5*(52.4739639351088+37.9348134579989)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(32.0648162140556+${C3pos})
variable C32 equal 0.5*(32.0648162140556+-2.09909918471323)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-0.897203204263848+${C4pos})
variable C42 equal 0.5*(-0.897203204263848+-3.9526258635933)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(15.7247407148175+${C5pos})
variable C52 equal 0.5*(15.7247407148175+4.4379866725396)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(0.149162407667971+${C6pos})
variable C62 equal 0.5*(0.149162407667971+-9.7246582305745)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.4406533464764
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4406533464764
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.174406533464764 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.05017) with tilt (-6.785986 -0.0099033092 -1.1965688)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.3 | 127.7 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41270.194      56712.929      0              3670.1778    
       100   301.29596     -41298.598      8533.781       5841.1255      3670.1778    
       200   303.09727     -41301.399      3045.9313     -2823.606       3670.1778    
       300   274.41976     -41300.719     -2870.9489     -2181.1854      3670.1778    
       400   290.3997      -41324.863      455.71284      2365.1447      3670.1778    
       500   297.47617     -41302.451      5273.0926      100.98324      3670.1778    
       600   301.14232     -41292.734      6750.2842     -161.08846      3670.1778    
       700   307.42186     -41295.797      904.49429      2768.0017      3670.1778    
       800   295.3255      -41285.128      5649.0213      2493.8831      3670.1778    
       900   294.86601     -41292.272      476.44482      1092.1001      3670.1778    
      1000   289.03525     -41304.555      10050.574      6087.5866      3670.1778    
      1100   279.28787     -41304.824      17415.753      3208.4569      3670.1778    
      1200   300.3395      -41301.937      14440.362      1221.1851      3670.1778    
      1300   287.48167     -41267.209      2033.9447      7523.744       3670.1778    
      1400   320.45074     -41296.39       5279.5207      1299.1983      3670.1778    
      1500   305.03563     -41286.198      707.38964      1953.5746      3670.1778    
      1600   289.01818     -41287.94      -105.63786     -2193.7273      3670.1778    
      1700   289.48788     -41322.961     -2281.168       4133.3366      3670.1778    
      1800   256.9701      -41284.46      -4583.3864      7171.3564      3670.1778    
      1900   274.97322     -41279.833      3643.3742     -1233.5973      3670.1778    
      2000   292.37687     -41285.867      4424.0053      4842.1328      3670.1778    
Loop time of 104.675 on 8 procs for 2000 steps with 350 atoms

Performance: 0.825 ns/day, 29.076 hours/ns, 19.107 timesteps/s, 6.687 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.637     | 85.182     | 87.817     |  30.5 | 81.38
Bond    | 0.00067297 | 0.00084163 | 0.0010512  |   0.0 |  0.00
Neigh   | 6.4125     | 6.8819     | 7.1328     |   7.5 |  6.57
Comm    | 1.5548     | 4.1987     | 10.752     | 137.5 |  4.01
Output  | 0.0050372  | 0.0060403  | 0.006808   |   0.8 |  0.01
Modify  | 8.1081     | 8.3645     | 8.8193     |   6.7 |  7.99
Other   |            | 0.04129    |            |       |  0.04

Nlocal:          43.75 ave          55 max          37 min
Histogram: 2 0 1 2 0 2 0 0 0 1
Nghost:        3276.88 ave        3304 max        3256 min
Histogram: 2 0 3 0 0 0 1 0 0 2
Neighs:        29202.1 ave       36302 max       24813 min
Histogram: 2 0 1 2 0 2 0 0 0 1

Total # of neighbors = 233617
Ave neighs/atom = 667.47714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.3 | 127.7 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.37687     -41285.867      4424.0333      0              3670.1778    
       100   306.96569     -41301.251      9750.4668      4520.6194      3670.1778    
       200   289.93134     -41295.192     -9661.3327      2622.416       3670.1778    
       300   285.34919     -41311.68      -5846.5495     -4812.3719      3670.1778    
       400   291.62958     -41319.732      3730.9391      4551.5242      3670.1778    
       500   291.93095     -41294.816      9811.6675      4191.8832      3670.1778    
       600   311.66801     -41290.585      5160.3304     -1683.7363      3670.1778    
       700   311.08238     -41295.022      2751.9103      7984.7591      3670.1778    
       800   308.65153     -41310.794      7461.2456      9798.8291      3670.1778    
       900   282.92692     -41302.003     -12442.081     -1664.5565      3670.1778    
      1000   290.11757     -41315.526      1057.9972      1253.4783      3670.1778    
      1100   294.39736     -41325.623     -6304.762      -4631.6057      3670.1778    
      1200   289.06185     -41308.25      -13811.573     -4572.7798      3670.1778    
      1300   308.3432      -41298.983     -2986.7326      1508.0856      3670.1778    
      1400   314.41645     -41295.465     -7586.3396      2997.7643      3670.1778    
      1500   306.27258     -41306.262      7737.2641     -171.56674      3670.1778    
      1600   308.79249     -41330.399      429.07946      96.129295      3670.1778    
      1700   305.18291     -41333.025      5121.2401      6210.9527      3670.1778    
      1800   296.71632     -41318.919      3930.8757      1138.1247      3670.1778    
      1900   284.28809     -41295.648      13996.41       5064.57        3670.1778    
      2000   298.75004     -41297.477      19159.074      4388.6319      3670.1778    
Loop time of 104.455 on 8 procs for 2000 steps with 350 atoms

Performance: 0.827 ns/day, 29.015 hours/ns, 19.147 timesteps/s, 6.701 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.883     | 84.486     | 87.7       |  37.4 | 80.88
Bond    | 0.00067522 | 0.00085785 | 0.0010599  |   0.0 |  0.00
Neigh   | 6.1881     | 6.8141     | 6.9634     |   9.2 |  6.52
Comm    | 1.4833     | 4.707      | 13.317     | 158.6 |  4.51
Output  | 0.0009289  | 0.0010213  | 0.0014569  |   0.5 |  0.00
Modify  | 8.254      | 8.4042     | 9.0184     |   8.2 |  8.05
Other   |            | 0.04126    |            |       |  0.04

Nlocal:          43.75 ave          58 max          33 min
Histogram: 1 0 2 2 0 1 1 0 0 1
Nghost:         3292.5 ave        3311 max        3260 min
Histogram: 1 0 0 1 0 1 2 0 1 2
Neighs:        29178.2 ave       38164 max       22209 min
Histogram: 1 0 2 2 0 1 1 0 0 1

Total # of neighbors = 233426
Ave neighs/atom = 666.93143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 47.5245023322307
variable C2neg equal ${d2}
variable C2neg equal 56.6366261806098
variable C3neg equal ${d3}
variable C3neg equal 78.7614964503258
variable C4neg equal ${d4}
variable C4neg equal 12.2150953831921
variable C5neg equal ${d5}
variable C5neg equal -9.7958898637129
variable C6neg equal ${d6}
variable C6neg equal -11.0680266559052

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4406533464764
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.174406533464764 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.398983) with tilt (-6.785986 -0.0099033092 -1.1965688)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.5 | 125.4 | 127.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41268.989     -42768.557      0              3744.3228    
       100   290.77326     -41284.544      8118.3216     -1060.5387      3744.3228    
       200   325.59192     -41313.047     -7713.4971     -3392.197       3744.3228    
       300   294.3465      -41291.684      1144.0545     -2894.0554      3744.3228    
       400   302.44745     -41312.408      4388.6162     -3734.8883      3744.3228    
       500   287.70291     -41288.95      -1323.4955     -3535.8887      3744.3228    
       600   304.89046     -41281.587     -5685.535      -4167.5274      3744.3228    
       700   318.18545     -41277.797     -20245.004     -2700.974       3744.3228    
       800   313.0785      -41276.487     -2082.9637     -5302.8848      3744.3228    
       900   304.83716     -41290.695      4997.836      -3139.3406      3744.3228    
      1000   294.84145     -41315.633      5757.6132     -3810.1466      3744.3228    
      1100   285.3519      -41301.384     -2984.7591     -1768.3493      3744.3228    
      1200   291.54829     -41281.528     -18362.867     -2069.3031      3744.3228    
      1300   279.82887     -41252.008     -4947.779      -6014.449       3744.3228    
      1400   319.09572     -41280.478     -6799.4267     -8282.3652      3744.3228    
      1500   303.95286     -41280.83       3204.0892      3612.5579      3744.3228    
      1600   301.52076     -41310.293      3429.079      -2158.3605      3744.3228    
      1700   288.10294     -41298.553     -8019.6316     -4544.5408      3744.3228    
      1800   304.79657     -41303.086     -6459.4414     -6684.6812      3744.3228    
      1900   302.57485     -41277.849     -6072.8231     -1757.3484      3744.3228    
      2000   316.70158     -41274.926      1603.1926     -341.3043       3744.3228    
Loop time of 99.9581 on 8 procs for 2000 steps with 350 atoms

Performance: 0.864 ns/day, 27.766 hours/ns, 20.008 timesteps/s, 7.003 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.269     | 75.14      | 84.346     | 121.5 | 75.17
Bond    | 0.00067969 | 0.00089316 | 0.0010308  |   0.0 |  0.00
Neigh   | 4.7281     | 6.1521     | 6.7618     |  32.5 |  6.15
Comm    | 1.0611     | 10.273     | 28.146     | 328.5 | 10.28
Output  | 0.0045314  | 0.0055303  | 0.0062778  |   0.8 |  0.01
Modify  | 7.7263     | 8.3495     | 9.7858     |  28.0 |  8.35
Other   |            | 0.03751    |            |       |  0.04

Nlocal:          43.75 ave          59 max          34 min
Histogram: 1 0 2 1 2 1 0 0 0 1
Nghost:        3229.38 ave        3281 max        3196 min
Histogram: 1 0 4 0 1 0 0 0 1 1
Neighs:        28586.8 ave       38119 max       22378 min
Histogram: 1 0 2 1 2 1 0 0 0 1

Total # of neighbors = 228694
Ave neighs/atom = 653.41143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.4 | 125.3 | 127.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   316.70158     -41274.926      1603.1511      0              3744.3228    
       100   301.41477     -41278.728      1243.5001     -3906.9916      3744.3228    
       200   313.91504     -41315.773     -9297.5749      158.48949      3744.3228    
       300   300.59873     -41305.505     -964.46953     -3856.9482      3744.3228    
       400   295.11773     -41296.932     -22004.455     -2918.7278      3744.3228    
       500   310.66842     -41294.577     -19636.007     -4214.4707      3744.3228    
       600   312.67479     -41271.625      7286.3015     -5223.0145      3744.3228    
       700   321.40237     -41290.302      10358.281      1032.4886      3744.3228    
       800   306.21653     -41308.984      2524.0753     -6138.7191      3744.3228    
       900   282.58318     -41293.851     -6450.5336     -460.55693      3744.3228    
      1000   289.29661     -41298.626      3806.5852     -4624.8566      3744.3228    
      1100   292.31506     -41287.471     -7956.983       1589.5959      3744.3228    
      1200   313.09838     -41282.066     -964.81103      535.7481       3744.3228    
      1300   309.35491     -41270.996     -517.70989     -1004.7815      3744.3228    
      1400   295.14016     -41291.062     -6656.5836      1460.8259      3744.3228    
      1500   292.7123      -41309.278      2766.1229      873.58917      3744.3228    
      1600   305.11548     -41312.351      2292.0525      1523.4162      3744.3228    
      1700   317.64189     -41306.636     -4427.1812      26.955512      3744.3228    
      1800   308.55866     -41284.37      -7332.9151     -5894.266       3744.3228    
      1900   326.05261     -41280.307     -977.25605     -49.715075      3744.3228    
      2000   329.47169     -41267.575     -7982.1023      4096.4127      3744.3228    
Loop time of 100.48 on 8 procs for 2000 steps with 350 atoms

Performance: 0.860 ns/day, 27.911 hours/ns, 19.904 timesteps/s, 6.967 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.931     | 74.659     | 84.534     | 127.5 | 74.30
Bond    | 0.00067919 | 0.00088779 | 0.0010627  |   0.0 |  0.00
Neigh   | 4.7282     | 6.12       | 6.8568     |  34.0 |  6.09
Comm    | 1.1413     | 11.016     | 28.75      | 331.9 | 10.96
Output  | 0.00087269 | 0.0009784  | 0.0013545  |   0.0 |  0.00
Modify  | 7.9025     | 8.6459     | 10.056     |  28.7 |  8.60
Other   |            | 0.03755    |            |       |  0.04

Nlocal:          43.75 ave          58 max          38 min
Histogram: 3 1 1 0 1 1 0 0 0 1
Nghost:        3219.75 ave        3250 max        3189 min
Histogram: 1 0 1 1 1 2 0 0 1 1
Neighs:        28598.2 ave       37448 max       24942 min
Histogram: 4 0 1 1 1 0 0 0 0 1

Total # of neighbors = 228786
Ave neighs/atom = 653.67429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -44.5635916376644
variable C2pos equal ${d2}
variable C2pos equal 12.584753628687
variable C3pos equal ${d3}
variable C3pos equal 4.10623082506274
variable C4pos equal ${d4}
variable C4pos equal 4.05495804729929
variable C5pos equal ${d5}
variable C5pos equal -0.0332640679988615
variable C6pos equal ${d6}
variable C6pos equal 5.56364948744489

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(47.5245023322307+${C1pos})
variable C13 equal 0.5*(47.5245023322307+-44.5635916376644)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(56.6366261806098+${C2pos})
variable C23 equal 0.5*(56.6366261806098+12.584753628687)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(78.7614964503258+${C3pos})
variable C33 equal 0.5*(78.7614964503258+4.10623082506274)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(12.2150953831921+${C4pos})
variable C43 equal 0.5*(12.2150953831921+4.05495804729929)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-9.7958898637129+${C5pos})
variable C53 equal 0.5*(-9.7958898637129+-0.0332640679988615)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-11.0680266559052+${C6pos})
variable C63 equal 0.5*(-11.0680266559052+5.56364948744489)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.4406533464764
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4406533464764
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.174406533464764 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.3709753)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.4 | 126.9 | 128.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41283.489      2605.5319      0              3707.2503    
       100   291.89853     -41296.469      7941.9787      2239.4416      3707.2503    
       200   315.42817     -41305.298     -4695.6481     -3858.723       3707.2503    
       300   308.95935     -41269.597     -2021.6806     -3011.997       3707.2503    
       400   339.48122     -41277.613      2746.9426     -7.8455709      3707.2503    
       500   321.78761     -41283.442      2729.5778      912.79479      3707.2503    
       600   313.01501     -41294.618      2754.7576     -4040.0896      3707.2503    
       700   296.96314     -41289.756     -2271.553      -4671.8273      3707.2503    
       800   283.00877     -41286.732      6196.1588     -1311.6527      3707.2503    
       900   279.67519     -41286.282     -3842.8214     -3443.2008      3707.2503    
      1000   316.11087     -41305.496     -6231.9215      977.71094      3707.2503    
      1100   321.32497     -41289.468      2184.1127      2661.8366      3707.2503    
      1200   328.91131     -41282.982      1853.022       961.65888      3707.2503    
      1300   309.70519     -41298.29       3650.4878     -2450.1063      3707.2503    
      1400   303.40608     -41304.976     -12545.182     -4715.1155      3707.2503    
      1500   310.01697     -41306.663      326.83707     -209.27062      3707.2503    
      1600   301.56687     -41291.833      12062.675      1228.9957      3707.2503    
      1700   293.1104      -41283.598     -14213.144     -4535.6466      3707.2503    
      1800   297.57162     -41287.763     -4435.3256     -6959.3024      3707.2503    
      1900   290.06191     -41284.489      6440.2417     -1253.0889      3707.2503    
      2000   296.09471     -41294.863     -4649.7968      7352.5051      3707.2503    
Loop time of 102.355 on 8 procs for 2000 steps with 350 atoms

Performance: 0.844 ns/day, 28.432 hours/ns, 19.540 timesteps/s, 6.839 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.76      | 74.988     | 86.508     | 143.4 | 73.26
Bond    | 0.00068236 | 0.0008955  | 0.0010267  |   0.0 |  0.00
Neigh   | 4.8237     | 6.1064     | 6.9718     |  38.6 |  5.97
Comm    | 0.91092    | 12.435     | 29.662     | 352.1 | 12.15
Output  | 0.0044174  | 0.0054698  | 0.0062231  |   0.8 |  0.01
Modify  | 7.899      | 8.7837     | 10.079     |  32.4 |  8.58
Other   |            | 0.03615    |            |       |  0.04

Nlocal:          43.75 ave          57 max          37 min
Histogram: 1 1 3 0 0 2 0 0 0 1
Nghost:        3242.38 ave        3290 max        3208 min
Histogram: 2 0 1 1 2 0 0 1 0 1
Neighs:        28902.4 ave       37144 max       24547 min
Histogram: 2 0 3 0 1 1 0 0 0 1

Total # of neighbors = 231219
Ave neighs/atom = 660.62571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.4 | 126.9 | 128.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.09471     -41294.863     -4649.7996      0              3707.2503    
       100   286.48024     -41286.465     -17783.346     -3879.2633      3707.2503    
       200   293.64688     -41276.317      12441.137      4077.066       3707.2503    
       300   331.05127     -41283.029     -5029.1593      3473.6888      3707.2503    
       400   299.39845     -41259.119     -5633.6472      2566.192       3707.2503    
       500   312.84102     -41299.139     -1998.6158      223.49662      3707.2503    
       600   301.10004     -41299.699     -4719.2491      4846.804       3707.2503    
       700   295.12289     -41295.79       107.23015     -2742.2224      3707.2503    
       800   310.43951     -41308.88       3169.7359     -218.18758      3707.2503    
       900   297.0645      -41292.071      8205.0012     -1065.873       3707.2503    
      1000   307.7539      -41290.897      1774.1741     -2669.0237      3707.2503    
      1100   315.03044     -41290.439     -348.47408      625.8824       3707.2503    
      1200   317.77134     -41308.958     -8425.7049     -2336.2637      3707.2503    
      1300   316.67528     -41336.091      10266.314      1365.8988      3707.2503    
      1400   281.20519     -41310.037     -1747.8107     -4485.6897      3707.2503    
      1500   283.30074     -41304.136     -922.52681      917.01106      3707.2503    
      1600   302.16684     -41303.775     -116.88031     -2522.0061      3707.2503    
      1700   285.47988     -41283.367     -5902.8143     -1158.4676      3707.2503    
      1800   325.41872     -41330.768      4396.4441     -1363.9285      3707.2503    
      1900   293.65967     -41302.377     -1690.1357     -2011.0256      3707.2503    
      2000   293.08567     -41296.678      701.33579      823.52684      3707.2503    
Loop time of 101.134 on 8 procs for 2000 steps with 350 atoms

Performance: 0.854 ns/day, 28.093 hours/ns, 19.776 timesteps/s, 6.922 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.52      | 74.386     | 85.604     | 139.8 | 73.55
Bond    | 0.00070883 | 0.00089855 | 0.0010219  |   0.0 |  0.00
Neigh   | 4.8275     | 6.1105     | 6.9762     |  38.3 |  6.04
Comm    | 0.82285    | 12.046     | 28.911     | 347.4 | 11.91
Output  | 0.00088432 | 0.0010466  | 0.0014829  |   0.5 |  0.00
Modify  | 7.6707     | 8.5526     | 9.8475     |  32.6 |  8.46
Other   |            | 0.03745    |            |       |  0.04

Nlocal:          43.75 ave          59 max          37 min
Histogram: 1 4 1 0 0 0 1 0 0 1
Nghost:        3277.38 ave        3296 max        3260 min
Histogram: 2 0 1 0 1 0 1 2 0 1
Neighs:        28886.1 ave       38361 max       24623 min
Histogram: 1 4 1 0 0 0 1 0 0 1

Total # of neighbors = 231089
Ave neighs/atom = 660.25429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 11.4010754956779
variable C2neg equal ${d2}
variable C2neg equal 4.88235541210741
variable C3neg equal ${d3}
variable C3neg equal -14.1102407257907
variable C4neg equal ${d4}
variable C4neg equal 10.7549461678096
variable C5neg equal ${d5}
variable C5neg equal 1.34545831420346
variable C6neg equal ${d6}
variable C6neg equal -3.50397165740402

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4406533464764
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.174406533464764 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.0221622)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.4 | 126.9 | 128.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41281.285      3991.5343      0              3707.2503    
       100   291.5808      -41295.37       10985.376      2393.6031      3707.2503    
       200   313.17635     -41303.597     -12651.691     -4485.5416      3707.2503    
       300   301.19217     -41276.075     -9833.0565     -2698.301       3707.2503    
       400   314.27443     -41267.368     -7376.4474      25.472502      3707.2503    
       500   322.42328     -41288.117      654.07721      2077.2229      3707.2503    
       600   305.70499     -41304.605     -14490.783     -6601.9899      3707.2503    
       700   290.22965     -41295.733     -3054.8056      1531.827       3707.2503    
       800   289.56818     -41290.443      7466.256      -2725.8178      3707.2503    
       900   313.89287     -41294.563     -9194.3324     -1381.13        3707.2503    
      1000   309.42582     -41266.233      4897.9848     -1630.3392      3707.2503    
      1100   314.52625     -41278.738      11897.783      2087.0306      3707.2503    
      1200   303.73718     -41312.14      -8775.2379     -3241.5969      3707.2503    
      1300   296.06615     -41311.087     -4186.3779     -1879.3958      3707.2503    
      1400   297.87036     -41299.703     -1253.4639     -379.43363      3707.2503    
      1500   316.33125     -41292.55      -5588.4835     -5337.5097      3707.2503    
      1600   316.70547     -41287.444     -6798.6458     -594.78118      3707.2503    
      1700   305.94447     -41290.982     -10399.348      2110.9236      3707.2503    
      1800   305.06893     -41300.23       7042.9492      465.10441      3707.2503    
      1900   294.05956     -41291.945     -2521.849      -1788.8832      3707.2503    
      2000   291.35318     -41294.913      5993.0974     -8.7599276      3707.2503    
Loop time of 101.868 on 8 procs for 2000 steps with 350 atoms

Performance: 0.848 ns/day, 28.297 hours/ns, 19.633 timesteps/s, 6.872 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.874     | 74.423     | 86.008     | 132.4 | 73.06
Bond    | 0.00071107 | 0.00090387 | 0.0010838  |   0.0 |  0.00
Neigh   | 4.7576     | 6.0197     | 6.8574     |  34.9 |  5.91
Comm    | 1.0196     | 12.607     | 29.163     | 321.6 | 12.38
Output  | 0.0046475  | 0.0058066  | 0.006546   |   0.9 |  0.01
Modify  | 7.946      | 8.7749     | 10.054     |  29.0 |  8.61
Other   |            | 0.03686    |            |       |  0.04

Nlocal:          43.75 ave          58 max          36 min
Histogram: 1 2 2 0 1 1 0 0 0 1
Nghost:        3256.12 ave        3289 max        3234 min
Histogram: 2 0 1 1 2 0 0 1 0 1
Neighs:        28898.9 ave       37787 max       23907 min
Histogram: 1 1 3 0 1 1 0 0 0 1

Total # of neighbors = 231191
Ave neighs/atom = 660.54571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.4 | 126.9 | 128.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.35318     -41294.913      5993.1135      0              3707.2503    
       100   281.11193     -41283.106     -6120.4075     -440.42219      3707.2503    
       200   316.78311     -41296.827      2659.5364     -5703.4092      3707.2503    
       300   321.24781     -41274.963     -4226.2524      300.84848      3707.2503    
       400   308.66407     -41268.59      -671.67824      4425.4364      3707.2503    
       500   310.79863     -41309.958     -2428.8863     -4616.1958      3707.2503    
       600   314.79594     -41329.43      -2654.234      -858.20605      3707.2503    
       700   300.18011     -41314.12       4653.7641     -3481.0793      3707.2503    
       800   300.74178     -41298.821     -7169.0852     -3793.9746      3707.2503    
       900   298.43385     -41274.403     -5697.8214     -7532.2147      3707.2503    
      1000   324.18081     -41289.224      6213.0572     -1119.4584      3707.2503    
      1100   289.99343     -41287.782     -8434.2843      744.9861       3707.2503    
      1200   271.18876     -41289.046     -4390.875      -3781.9438      3707.2503    
      1300   291.10456     -41301.294      6828.7089     -4796.2495      3707.2503    
      1400   302.16126     -41292.604     -5285.6243      1970.0363      3707.2503    
      1500   323.51637     -41294.682     -9273.1668      953.98035      3707.2503    
      1600   314.8261      -41293.962     -655.65674     -4246.3632      3707.2503    
      1700   300.40872     -41315.712     -5356.1567      3236.1413      3707.2503    
      1800   287.65596     -41304.052      2266.5788     -338.53761      3707.2503    
      1900   301.9045      -41296.336     -3630.185       2861.6241      3707.2503    
      2000   316.95264     -41299.732      911.03518     -2173.2848      3707.2503    
Loop time of 102.59 on 8 procs for 2000 steps with 350 atoms

Performance: 0.842 ns/day, 28.497 hours/ns, 19.495 timesteps/s, 6.823 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.72      | 75.706     | 86.121     | 141.5 | 73.80
Bond    | 0.00071275 | 0.00092563 | 0.0011198  |   0.0 |  0.00
Neigh   | 4.7705     | 6.1621     | 7.0566     |  38.5 |  6.01
Comm    | 1.3471     | 11.749     | 28.748     | 359.2 | 11.45
Output  | 0.00082169 | 0.0010243  | 0.0018746  |   1.0 |  0.00
Modify  | 8.0173     | 8.9317     | 10.342     |  32.2 |  8.71
Other   |            | 0.03844    |            |       |  0.04

Nlocal:          43.75 ave          60 max          35 min
Histogram: 2 0 3 0 0 2 0 0 0 1
Nghost:           3265 ave        3283 max        3246 min
Histogram: 1 1 1 1 0 0 1 0 2 1
Neighs:        28878.2 ave       38959 max       23268 min
Histogram: 2 0 3 0 0 2 0 0 0 1

Total # of neighbors = 231026
Ave neighs/atom = 660.07429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 18.9641184836268
variable C2pos equal ${d2}
variable C2pos equal -38.8366521560171
variable C3pos equal ${d3}
variable C3pos equal 26.458349409552
variable C4pos equal ${d4}
variable C4pos equal 11.6500528460115
variable C5pos equal ${d5}
variable C5pos equal 9.71412442153656
variable C6pos equal ${d6}
variable C6pos equal 9.3796677253028

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(11.4010754956779+${C1pos})
variable C14 equal 0.5*(11.4010754956779+18.9641184836268)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(4.88235541210741+${C2pos})
variable C24 equal 0.5*(4.88235541210741+-38.8366521560171)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-14.1102407257907+${C3pos})
variable C34 equal 0.5*(-14.1102407257907+26.458349409552)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(10.7549461678096+${C4pos})
variable C44 equal 0.5*(10.7549461678096+11.6500528460115)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(1.34545831420346+${C5pos})
variable C54 equal 0.5*(1.34545831420346+9.71412442153656)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-3.50397165740402+${C6pos})
variable C64 equal 0.5*(-3.50397165740402+9.3796677253028)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.4406533464764
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4406533464764
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.174406533464764 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.18430984 -1.1965688)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.4 | 126.9 | 128.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41283.782      1427.9081      0              3707.2503    
       100   292.55029     -41297.45       7698.7668      1818.0203      3707.2503    
       200   314.64989     -41306.656     -844.5391      -3958.8234      3707.2503    
       300   301.36927     -41268.728     -11139.162     -3242.2233      3707.2503    
       400   340.61972     -41285.503     -13810.97      -1348.921       3707.2503    
       500   345.63196     -41313.972      9800.5728     -1543.0661      3707.2503    
       600   301.89506     -41296.002     -4959.7709     -3817.1701      3707.2503    
       700   309.54977     -41311.328      264.88828      3612.5926      3707.2503    
       800   313.31202     -41320.235      7038.2936      1820.3422      3707.2503    
       900   282.58313     -41290.881     -5582.1613     -2686.1385      3707.2503    
      1000   294.21292     -41284.467      3938.8794      390.26997      3707.2503    
      1100   293.6325      -41266.552     -4895.7858      6028.1376      3707.2503    
      1200   309.29005     -41280.603     -14111.204      4655.2215      3707.2503    
      1300   288.41783     -41297.068      9595.2562      54.495509      3707.2503    
      1400   288.10099     -41304.246      6510.1719      3970.9354      3707.2503    
      1500   304.60872     -41319.112      15761.981      7340.3645      3707.2503    
      1600   317.49647     -41309.984      14451.141      1853.538       3707.2503    
      1700   329.01462     -41298.354     -1008.3155      6227.9572      3707.2503    
      1800   326.57691     -41305.062      5136.8873     -1468.815       3707.2503    
      1900   298.41907     -41308.067     -718.56868      5166.7551      3707.2503    
      2000   306.84528     -41320.186      7231.9146      2603.1557      3707.2503    
Loop time of 103.314 on 8 procs for 2000 steps with 350 atoms

Performance: 0.836 ns/day, 28.698 hours/ns, 19.358 timesteps/s, 6.775 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.707     | 78.604     | 86.89      | 133.2 | 76.08
Bond    | 0.00071077 | 0.00089838 | 0.001064   |   0.0 |  0.00
Neigh   | 4.809      | 6.4634     | 7.148      |  36.5 |  6.26
Comm    | 1.186      | 9.461      | 30.37      | 384.0 |  9.16
Output  | 0.0055728  | 0.0065533  | 0.0073451  |   0.7 |  0.01
Modify  | 8.0309     | 8.7391     | 10.416     |  31.5 |  8.46
Other   |            | 0.03941    |            |       |  0.04

Nlocal:          43.75 ave          59 max          38 min
Histogram: 2 3 0 2 0 0 0 0 0 1
Nghost:         3261.5 ave        3287 max        3233 min
Histogram: 1 0 0 3 1 0 0 1 0 2
Neighs:        28895.9 ave       38397 max       25234 min
Histogram: 2 3 0 2 0 0 0 0 0 1

Total # of neighbors = 231167
Ave neighs/atom = 660.47714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.4 | 126.9 | 128.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   306.84528     -41320.186      7231.8849      0              3707.2503    
       100   317.85863     -41329.317     -4581.7463      1350.7641      3707.2503    
       200   302.92811     -41324.222      6886.0943      1724.3819      3707.2503    
       300   300.7999      -41342.62       12692.042      5155.893       3707.2503    
       400   287.43288     -41325.419      4401.7181      1542.9446      3707.2503    
       500   288.00317     -41294.92      -5193.5252     -725.24615      3707.2503    
       600   298.45987     -41291.308     -2275.9497      3555.3126      3707.2503    
       700   297.69614     -41295.587     -1739.3296     -3492.1665      3707.2503    
       800   291.70226     -41306.855      11112.171      2778.3765      3707.2503    
       900   284.33933     -41313.027     -9644.4439     -5599.4273      3707.2503    
      1000   291.47931     -41325.035     -8915.4311     -328.86014      3707.2503    
      1100   293.32823     -41321.914     -11250.992      3749.105       3707.2503    
      1200   315.28401     -41325.869     -2397.1822      1886.6648      3707.2503    
      1300   308.63055     -41306.02      -4140.726      -1809.0958      3707.2503    
      1400   281.04478     -41283.133      6898.0737     -2184.2985      3707.2503    
      1500   282.85996     -41316.514     -7932.2546     -3774.1227      3707.2503    
      1600   295.9452      -41342.625     -4054.8654     -3199.4399      3707.2503    
      1700   301.53849     -41335.386      11128.513      6443.7522      3707.2503    
      1800   293.08117     -41310.5        201.07231      3310.3548      3707.2503    
      1900   286.02115     -41297.035     -7882.3959     -599.4952       3707.2503    
      2000   311.50423     -41322.807      3783.3014      4787.9115      3707.2503    
Loop time of 102.408 on 8 procs for 2000 steps with 350 atoms

Performance: 0.844 ns/day, 28.447 hours/ns, 19.530 timesteps/s, 6.835 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.487     | 77.89      | 85.859     | 132.0 | 76.06
Bond    | 0.00072916 | 0.00090294 | 0.0010692  |   0.0 |  0.00
Neigh   | 4.8127     | 6.4523     | 7.16       |  36.0 |  6.30
Comm    | 1.3377     | 9.2952     | 29.712     | 382.0 |  9.08
Output  | 0.000837   | 0.0010443  | 0.0017585  |   0.8 |  0.00
Modify  | 7.9978     | 8.728      | 10.389     |  31.1 |  8.52
Other   |            | 0.04016    |            |       |  0.04

Nlocal:          43.75 ave          57 max          37 min
Histogram: 1 2 2 0 0 2 0 0 0 1
Nghost:        3251.75 ave        3274 max        3231 min
Histogram: 1 0 2 1 1 1 0 0 0 2
Neighs:        28902.4 ave       37168 max       24601 min
Histogram: 1 3 1 0 1 1 0 0 0 1

Total # of neighbors = 231219
Ave neighs/atom = 660.62571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 51.5702025926435
variable C2neg equal ${d2}
variable C2neg equal 44.7378721997381
variable C3neg equal ${d3}
variable C3neg equal 57.3477298121399
variable C4neg equal ${d4}
variable C4neg equal 20.5184754891318
variable C5neg equal ${d5}
variable C5neg equal 13.21545958437
variable C6neg equal ${d6}
variable C6neg equal -6.65876127922882

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4406533464764
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.174406533464764 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 0.16450322 -1.1965688)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.4 | 126.9 | 128.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41281.412      3966.5267      0              3707.2503    
       100   293.54673     -41296.863      12101.711      2410.7221      3707.2503    
       200   318.61268     -41306.798     -289.65721     -2556.0097      3707.2503    
       300   297.54497     -41265.519      13184.701      482.48639      3707.2503    
       400   308.77454     -41250.652     -768.64353      1741.745       3707.2503    
       500   306.48322     -41266.131      5851.4166      752.82687      3707.2503    
       600   289.43476     -41279.573     -9713.165      -3473.4965      3707.2503    
       700   296.31532     -41293.325      5071.9437      2592.6287      3707.2503    
       800   303.26745     -41309.976      5145.6011     -955.47697      3707.2503    
       900   309.04865     -41325.126     -5905.4471     -2382.5456      3707.2503    
      1000   301.19502     -41314.122     -639.82487     -789.94636      3707.2503    
      1100   307.85594     -41297.26      -5116.843       2777.8734      3707.2503    
      1200   305.36223     -41281.146     -3792.4234     -5662.2548      3707.2503    
      1300   311.70366     -41308.814      17144.339      1058.2613      3707.2503    
      1400   292.42029     -41313.397      923.99536     -4650.138       3707.2503    
      1500   306.07774     -41327.182      13326.489      797.65072      3707.2503    
      1600   292.66566     -41299.828      6572.9909     -1214.0964      3707.2503    
      1700   300.09748     -41301.297     -13667.419      51.963888      3707.2503    
      1800   300.49445     -41315.654     -15081.378     -4578.415       3707.2503    
      1900   290.63012     -41326.135     -14121.683     -7292.6309      3707.2503    
      2000   283.40181     -41314.994     -2563.4777      2759.4169      3707.2503    
Loop time of 102.316 on 8 procs for 2000 steps with 350 atoms

Performance: 0.844 ns/day, 28.421 hours/ns, 19.547 timesteps/s, 6.842 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.841     | 75.798     | 86.003     | 124.8 | 74.08
Bond    | 0.00068871 | 0.00088329 | 0.0010718  |   0.0 |  0.00
Neigh   | 4.7907     | 6.2126     | 7.0073     |  33.9 |  6.07
Comm    | 1.2467     | 11.448     | 29.412     | 321.2 | 11.19
Output  | 0.00476    | 0.0058021  | 0.0065657  |   0.8 |  0.01
Modify  | 8.0073     | 8.8126     | 10.254     |  28.6 |  8.61
Other   |            | 0.03803    |            |       |  0.04

Nlocal:          43.75 ave          52 max          37 min
Histogram: 1 1 0 1 2 1 0 0 1 1
Nghost:        3224.75 ave        3264 max        3193 min
Histogram: 2 1 1 0 0 1 1 0 0 2
Neighs:        28906.1 ave       33951 max       24649 min
Histogram: 1 1 0 2 1 1 0 1 0 1

Total # of neighbors = 231249
Ave neighs/atom = 660.71143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.7 | 126.8 | 128.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   283.40181     -41314.994     -2563.4276      0              3707.2503    
       100   307.19902     -41334.683      5246.4345     -5412.9928      3707.2503    
       200   299.04715     -41293.299     -2372.3902      1297.4209      3707.2503    
       300   313.56742     -41288.196     -3994.5479     -4262.0692      3707.2503    
       400   312.01783     -41295.921      4679.1621     -981.40963      3707.2503    
       500   289.54411     -41297.341     -6338.7252     -4698.2479      3707.2503    
       600   295.36167     -41311.457     -6500.1103     -2906.406       3707.2503    
       700   306.32178     -41318.705      3446.1159     -3481.0367      3707.2503    
       800   299.09646     -41304.485     -15678.59      -942.00955      3707.2503    
       900   307.37569     -41292.488     -1985.1393      698.82682      3707.2503    
      1000   324.821       -41279.759     -2914.8343     -2896.0556      3707.2503    
      1100   293.60899     -41270.423     -6502.3213      2573.3332      3707.2503    
      1200   294.25182     -41296.727      8242.929      -3407.0077      3707.2503    
      1300   298.74083     -41314.97      -12732.264     -6682.9209      3707.2503    
      1400   302.20698     -41326.823     -3162.1606      894.15342      3707.2503    
      1500   288.82549     -41302.075     -8441.2233     -3187.483       3707.2503    
      1600   307.40814     -41285.894      3708.1388      771.23504      3707.2503    
      1700   311.79791     -41285.192     -7373.4885     -5059.656       3707.2503    
      1800   297.5855      -41282.296     -5856.2481      1591.4866      3707.2503    
      1900   296.71691     -41314.035      4060.3993      724.05167      3707.2503    
      2000   277.02372     -41299.777     -836.4722       3277.9263      3707.2503    
Loop time of 102.031 on 8 procs for 2000 steps with 350 atoms

Performance: 0.847 ns/day, 28.342 hours/ns, 19.602 timesteps/s, 6.861 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.282     | 71.923     | 86.365     | 151.4 | 70.49
Bond    | 0.00068509 | 0.00089951 | 0.0011769  |   0.0 |  0.00
Neigh   | 4.8124     | 5.8568     | 6.9202     |  40.5 |  5.74
Comm    | 0.75381    | 15.205     | 28.864     | 329.4 | 14.90
Output  | 0.00081502 | 0.00095754 | 0.0014211  |   0.0 |  0.00
Modify  | 7.9572     | 9.0093     | 10.072     |  32.6 |  8.83
Other   |            | 0.03528    |            |       |  0.03

Nlocal:          43.75 ave          58 max          34 min
Histogram: 1 1 2 1 0 0 2 0 0 1
Nghost:        3254.75 ave        3291 max        3231 min
Histogram: 2 1 0 1 1 1 1 0 0 1
Neighs:        28899.2 ave       37806 max       22659 min
Histogram: 1 1 2 1 0 0 2 0 0 1

Total # of neighbors = 231194
Ave neighs/atom = 660.55429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -36.2702780222739
variable C2pos equal ${d2}
variable C2pos equal -24.69348712376
variable C3pos equal ${d3}
variable C3pos equal -24.5052457686866
variable C4pos equal ${d4}
variable C4pos equal -8.32147200341904
variable C5pos equal ${d5}
variable C5pos equal 24.8745240893335
variable C6pos equal ${d6}
variable C6pos equal 5.77138515210763

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(51.5702025926435+${C1pos})
variable C15 equal 0.5*(51.5702025926435+-36.2702780222739)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(44.7378721997381+${C2pos})
variable C25 equal 0.5*(44.7378721997381+-24.69348712376)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(57.3477298121399+${C3pos})
variable C35 equal 0.5*(57.3477298121399+-24.5052457686866)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(20.5184754891318+${C4pos})
variable C45 equal 0.5*(20.5184754891318+-8.32147200341904)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(13.21545958437+${C5pos})
variable C55 equal 0.5*(13.21545958437+24.8745240893335)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-6.65876127922882+${C6pos})
variable C65 equal 0.5*(-6.65876127922882+5.77138515210763)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.9543995646043

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.9543995646043
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.139543995646043 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.92553 -0.0099033092 -1.1965688)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.5 | 127.1 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41284.372      2237.6919      0              3707.2503    
       100   288.73561     -41293.648      15352.912      3841.6885      3707.2503    
       200   309.32455     -41298.781     -6883.7664     -4802.9587      3707.2503    
       300   313.37504     -41287.95      -3349.7785     -2322.5378      3707.2503    
       400   316.99457     -41267.639     -8084.9968      745.29698      3707.2503    
       500   316.18474     -41283.587      10986.336      948.87702      3707.2503    
       600   302.99332     -41301.927     -18653.533     -4792.0672      3707.2503    
       700   306.69465     -41313.908     -18068.916      1176.0263      3707.2503    
       800   286.57714     -41297.61      -57.862095     -989.1343       3707.2503    
       900   316.09727     -41318.216     -1983.9392     -6690.8611      3707.2503    
      1000   290.39953     -41273.937      7276.0459     -900.22299      3707.2503    
      1100   295.57808     -41272.8        6776.8436     -83.907648      3707.2503    
      1200   317.50254     -41291.607     -6252.6219      1231.3261      3707.2503    
      1300   289.25758     -41289.36       7926.4456      5776.6775      3707.2503    
      1400   284.22667     -41304.161     -1307.8309     -1078.209       3707.2503    
      1500   283.16429     -41295.63       9724.5069     -227.93788      3707.2503    
      1600   304.64509     -41299.155      2104.6093      8470.9593      3707.2503    
      1700   315.94472     -41298.155     -7742.6356     -3738.8277      3707.2503    
      1800   294.97576     -41290.267     -457.15105      2335.4396      3707.2503    
      1900   278.10153     -41298.034      7879.8074      1384.7987      3707.2503    
      2000   283.81728     -41315.244     -1539.9572     -605.72323      3707.2503    
Loop time of 101.605 on 8 procs for 2000 steps with 350 atoms

Performance: 0.850 ns/day, 28.223 hours/ns, 19.684 timesteps/s, 6.889 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.318     | 71.552     | 85.932     | 149.6 | 70.42
Bond    | 0.00069194 | 0.00090929 | 0.0011399  |   0.0 |  0.00
Neigh   | 4.8103     | 5.8315     | 6.9292     |  39.2 |  5.74
Comm    | 0.91395    | 15.304     | 28.559     | 323.7 | 15.06
Output  | 0.0042131  | 0.0052216  | 0.0059409  |   0.8 |  0.01
Modify  | 7.7912     | 8.8745     | 9.9143     |  31.7 |  8.73
Other   |            | 0.03641    |            |       |  0.04

Nlocal:          43.75 ave          54 max          38 min
Histogram: 2 2 0 1 0 1 0 1 0 1
Nghost:        3254.25 ave        3288 max        3236 min
Histogram: 2 2 0 2 0 0 0 0 1 1
Neighs:        28888.4 ave       35276 max       25200 min
Histogram: 2 2 0 0 2 0 0 1 0 1

Total # of neighbors = 231107
Ave neighs/atom = 660.30571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.5 | 127.1 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   283.81728     -41315.244     -1539.9475      0              3707.2503    
       100   292.64036     -41310.209     -6733.5504      642.53816      3707.2503    
       200   289.81775     -41280.005     -3710.4335     -2849.243       3707.2503    
       300   302.43504     -41289.145      439.32194     -1388.787       3707.2503    
       400   321.37734     -41316.064      4386.459      -1444.6419      3707.2503    
       500   306.67141     -41315.634     -2016.4947      410.06409      3707.2503    
       600   295.06859     -41310.102      182.31314     -1313.7532      3707.2503    
       700   308.64636     -41315.199     -539.69691     -3965.1031      3707.2503    
       800   296.00405     -41267.599      11401.317      6258.161       3707.2503    
       900   322.06346     -41284.139     -8972.4936      368.02074      3707.2503    
      1000   304.22914     -41299.505      2929.8078      1273.5288      3707.2503    
      1100   280.40363     -41287.616      17228.204      747.05465      3707.2503    
      1200   301.57891     -41306.273      6568.175       5343.1191      3707.2503    
      1300   306.43248     -41314.981     -2676.852      -469.57556      3707.2503    
      1400   287.91976     -41303.956      725.33524     -3172.7767      3707.2503    
      1500   299.84136     -41311.768      3538.5667      1779.0745      3707.2503    
      1600   296.78296     -41285.425      12835.897     -1276.2409      3707.2503    
      1700   304.12934     -41288.216     -8602.8808     -1383.9829      3707.2503    
      1800   290.92312     -41302.161      9035.2914     -2359.8617      3707.2503    
      1900   280.3158      -41309.208     -9830.7238     -1763.7569      3707.2503    
      2000   297.38221     -41323.511      8088.2125      2018.0146      3707.2503    
Loop time of 102.02 on 8 procs for 2000 steps with 350 atoms

Performance: 0.847 ns/day, 28.339 hours/ns, 19.604 timesteps/s, 6.861 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.681     | 73.499     | 86.415     | 138.0 | 72.04
Bond    | 0.00066941 | 0.00088878 | 0.0011814  |   0.0 |  0.00
Neigh   | 4.8368     | 6.0432     | 6.9479     |  37.8 |  5.92
Comm    | 0.78475    | 13.71      | 29.543     | 319.7 | 13.44
Output  | 0.00087534 | 0.0010488  | 0.002031   |   1.2 |  0.00
Modify  | 7.8357     | 8.7294     | 9.9538     |  31.5 |  8.56
Other   |            | 0.03682    |            |       |  0.04

Nlocal:          43.75 ave          54 max          36 min
Histogram: 1 0 0 4 0 2 0 0 0 1
Nghost:        3271.88 ave        3329 max        3224 min
Histogram: 1 1 1 0 0 3 0 1 0 1
Neighs:        28908.5 ave       35211 max       23933 min
Histogram: 1 0 0 3 2 1 0 0 0 1

Total # of neighbors = 231268
Ave neighs/atom = 660.76571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 23.5042224794764
variable C2neg equal ${d2}
variable C2neg equal 5.2626949701638
variable C3neg equal ${d3}
variable C3neg equal 6.06007334394497
variable C4neg equal ${d4}
variable C4neg equal 1.91026939368331
variable C5neg equal ${d5}
variable C5neg equal -5.57919478754008
variable C6neg equal ${d6}
variable C6neg equal -10.0865430856394

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.785986 -0.0099033092 -1.1965688)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.9543995646043
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.139543995646043 remap units box
Changing box ...
  triclinic box = (0.0027304142 0.27420022 -0.21607667) to (15.23547 14.2286 17.224577) with tilt (-6.646442 -0.0099033092 -1.1965688)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.2 | 126.7 | 128.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   280.35332     -41282.363      3235.1632      0              3707.2503    
       100   290.7009      -41294.96       17390.411      3453.2131      3707.2503    
       200   313.22825     -41301.722      6139.1986     -3184.5942      3707.2503    
       300   308.03566     -41269.489      14643.771      890.72311      3707.2503    
       400   332.0028      -41270.102      1253.0278     -983.17616      3707.2503    
       500   327.36678     -41286.271      1092.4019     -3796.4705      3707.2503    
       600   298.74844     -41287.229      5520.7841      668.49038      3707.2503    
       700   294.05505     -41285.638      3747.1107     -1642.0743      3707.2503    
       800   304.20717     -41282.222      7050.3202      2564.7234      3707.2503    
       900   301.35415     -41262.125     -8316.5081     -2527.0172      3707.2503    
      1000   303.25289     -41255.379     -5127.5218     -2683.0457      3707.2503    
      1100   291.6027      -41268.14      -7129.598      -349.83136      3707.2503    
      1200   308.5156      -41312.934     -10229.051     -4952.0094      3707.2503    
      1300   289.05512     -41293.77       944.42713     -3587.8759      3707.2503    
      1400   307.80707     -41292.678     -11545.589      155.50354      3707.2503    
      1500   323.55964     -41286.579     -6219.9596      5778.479       3707.2503    
      1600   296.30687     -41263.364     -12815.193     -4199.9588      3707.2503    
      1700   298.09803     -41274.635      1125.6276     -108.05125      3707.2503    
      1800   294.48355     -41281.663      11327.422     -947.12406      3707.2503    
      1900   308.56979     -41307.802      5104.1484     -1768.9383      3707.2503    
      2000   285.14343     -41293.958      3064.7036      1920.8837      3707.2503    
Loop time of 99.4462 on 8 procs for 2000 steps with 350 atoms

Performance: 0.869 ns/day, 27.624 hours/ns, 20.111 timesteps/s, 7.039 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.627     | 76.699     | 83.692     |  91.3 | 77.13
Bond    | 0.00065795 | 0.00082599 | 0.00098768 |   0.0 |  0.00
Neigh   | 4.8254     | 6.3486     | 6.9622     |  27.2 |  6.38
Comm    | 1.2202     | 8.2269     | 27.304     | 278.9 |  8.27
Output  | 0.0040372  | 0.0050216  | 0.0057386  |   0.8 |  0.01
Modify  | 7.5112     | 8.1278     | 9.6494     |  24.1 |  8.17
Other   |            | 0.038      |            |       |  0.04

Nlocal:          43.75 ave          57 max          38 min
Histogram: 1 3 2 0 0 1 0 0 0 1
Nghost:         3247.5 ave        3279 max        3226 min
Histogram: 2 1 2 0 0 0 1 0 0 2
Neighs:        28883.1 ave       37071 max       25187 min
Histogram: 1 3 2 0 0 1 0 0 0 1

Total # of neighbors = 231065
Ave neighs/atom = 660.18571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.2 | 126.7 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   285.14343     -41293.958      3064.7482      0              3707.2503    
       100   304.03734     -41302.348      15316.371     -932.13815      3707.2503    
       200   313.78885     -41282.528      1750.7935     -1610.7672      3707.2503    
       300   320.19295     -41274.421     -7150.7971     -1831.5788      3707.2503    
       400   319.21108     -41283.11       7059.1291     -1089.215       3707.2503    
       500   316.93027     -41292.531     -157.95684     -4302.6787      3707.2503    
       600   308.14711     -41295.037      2797.4541      601.61405      3707.2503    
       700   287.89867     -41287.148      5129.6167     -1095.7616      3707.2503    
       800   301.28007     -41303.726     -1777.4184     -802.1015       3707.2503    
       900   301.27485     -41293.134     -6249.9301     -3802.2896      3707.2503    
      1000   307.91403     -41274.005     -12521.527     -4178.68        3707.2503    
      1100   305.71361     -41275.757      2234.8801     -6791.1116      3707.2503    
      1200   319.17334     -41323.882      6898.4593     -158.13821      3707.2503    
      1300   270.69446     -41282.352     -3657.3116     -3032.8825      3707.2503    
      1400   298.47993     -41297.2        7619.8007     -5933.0017      3707.2503    
      1500   298.48639     -41285.287     -8195.3293      858.15993      3707.2503    
      1600   316.22034     -41300.783     -839.9437       1472.7063      3707.2503    
      1700   280.51937     -41298.851      5386.5363      1637.5195      3707.2503    
      1800   282.76511     -41306.283     -3716.6626     -1447.5262      3707.2503    
      1900   308.76811     -41310.66       3885.0997     -5760.6692      3707.2503    
      2000   314.69794     -41306.925      789.13425      2506.9752      3707.2503    
Loop time of 90.4264 on 8 procs for 2000 steps with 350 atoms

Performance: 0.955 ns/day, 25.118 hours/ns, 22.117 timesteps/s, 7.741 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.836     | 64.809     | 74.782     | 104.7 | 71.67
Bond    | 0.00059807 | 0.00072876 | 0.00088251 |   0.0 |  0.00
Neigh   | 4.7661     | 5.788      | 6.7461     |  32.7 |  6.40
Comm    | 2.0008     | 11.968     | 22.942     | 243.5 | 13.23
Output  | 0.00096259 | 0.0010468  | 0.0013624  |   0.4 |  0.00
Modify  | 6.8601     | 7.8242     | 8.8522     |  28.3 |  8.65
Other   |            | 0.03507    |            |       |  0.04

Nlocal:          43.75 ave          54 max          39 min
Histogram: 3 0 2 0 1 0 1 0 0 1
Nghost:           3245 ave        3281 max        3217 min
Histogram: 1 1 1 2 0 1 0 0 1 1
Neighs:        28907.5 ave       35245 max       25931 min
Histogram: 3 0 2 1 0 1 0 0 0 1

Total # of neighbors = 231260
Ave neighs/atom = 660.74286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -28.4586156202256
variable C2pos equal ${d2}
variable C2pos equal -45.5798630713663
variable C3pos equal ${d3}
variable C3pos equal -66.0376957009694
variable C4pos equal ${d4}
variable C4pos equal -8.68007491403442
variable C5pos equal ${d5}
variable C5pos equal 6.57679345067997
variable C6pos equal ${d6}
variable C6pos equal 10.8509726339204

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(23.5042224794764+${C1pos})
variable C16 equal 0.5*(23.5042224794764+-28.4586156202256)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(5.2626949701638+${C2pos})
variable C26 equal 0.5*(5.2626949701638+-45.5798630713663)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(6.06007334394497+${C3pos})
variable C36 equal 0.5*(6.06007334394497+-66.0376957009694)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(1.91026939368331+${C4pos})
variable C46 equal 0.5*(1.91026939368331+-8.68007491403442)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-5.57919478754008+${C5pos})
variable C56 equal 0.5*(-5.57919478754008+6.57679345067997)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-10.0865430856394+${C6pos})
variable C66 equal 0.5*(-10.0865430856394+10.8509726339204)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 88.2430422340863
variable C22all equal ${C22}
variable C22all equal 45.2043886965538
variable C33all equal ${C33}
variable C33all equal 41.4338636376943

variable C44all equal ${C44}
variable C44all equal 11.2024995069105
variable C55all equal ${C55}
variable C55all equal 19.0449918368518
variable C66all equal ${C66}
variable C66all equal 0.3822147741405

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(1.12247858620155+${C21})
variable C12all equal 0.5*(1.12247858620155+5.6414106466616)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(1.48045534728315+${C31})
variable C13all equal 0.5*(1.48045534728315+55.9366236480298)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(34.6106899046484+${C32})
variable C23all equal 0.5*(34.6106899046484+14.9828585146712)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(15.1825969896523+${C41})
variable C14all equal 0.5*(15.1825969896523+-2.11060301703811)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(7.6499622851848+${C51})
variable C15all equal 0.5*(7.6499622851848+-19.2641988273934)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-2.4771965703746+${C61})
variable C16all equal 0.5*(-2.4771965703746+-1.5395709004715)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-16.9771483719548+${C42})
variable C24all equal 0.5*(-16.9771483719548+-2.42491453392857)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(10.022192537989+${C52})
variable C25all equal 0.5*(10.022192537989+10.0813636936786)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-20.1585840506012+${C62})
variable C26all equal 0.5*(-20.1585840506012+-4.78774791145326)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(6.17405434188065+${C43})
variable C34all equal 0.5*(6.17405434188065+8.1350267152457)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(16.4212420217267+${C53})
variable C35all equal 0.5*(16.4212420217267+-4.91457696585588)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-29.9888111785122+${C63})
variable C36all equal 0.5*(-29.9888111785122+-2.75218858423016)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(6.09850174285638+${C54})
variable C45all equal 0.5*(6.09850174285638+5.52979136787001)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-3.38490276017556+${C64})
variable C46all equal 0.5*(-3.38490276017556+2.93784803394939)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(0.498799331569945+${C65})
variable C56all equal 0.5*(0.498799331569945+-0.443688063560595)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:42:32
