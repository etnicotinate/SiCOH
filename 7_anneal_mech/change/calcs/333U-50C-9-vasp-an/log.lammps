LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-9-vasp-an
read_data       ${structure}.data
read_data       333U-50C-9-vasp-an.data
Reading data file ...
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
  reading velocities ...
  386 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              344.28356      4055.9468    
         1   300            0              0              344.28356      4055.9468    
Loop time of 4.63111e-05 on 8 procs for 1 steps with 386 atoms

101.8% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.22e-07   | 1.6025e-07 | 2.07e-07   |   0.0 |  0.35
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.083e-06  | 1.3602e-06 | 1.478e-06  |   0.0 |  2.94
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.479e-05  |            |       | 96.72

Nlocal:          48.25 ave          57 max          42 min
Histogram: 2 0 1 0 1 3 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139.8 | 141 | 142 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -44862.711     -1795.2708      0              1.7458365      3880.2248    
       100   289.93349     -44844.377      4034.9053      2855.8623      1.7458365      3880.2248    
       200   342.54957     -44876.713      5688.9275      772.232        1.7458365      3880.2248    
       300   333.82184     -44854.489      8584.3496      4533.5336      1.7458365      3880.2248    
       400   304.00093     -44853.801     -4013.8882     -7837.1817      1.7458365      3880.2248    
       500   291.76344     -44862.636      1038.3204      843.41035      1.7458365      3880.2248    
       600   286.38737     -44852.383     -6787.2744      2422.3298      1.7458365      3880.2248    
       700   307.96828     -44862.15      -3798.8332      5187.7429      1.7458365      3880.2248    
       800   325.69238     -44861.327      5942.8919      498.53597      1.7458365      3880.2248    
       900   333.94027     -44846.782      5805.2543     -2490.3175      1.7458365      3880.2248    
      1000   321.50174     -44828.125     -10946.77      -1992.1778      1.7458365      3880.2248    
      1100   299.00793     -44844.339      5179.5574      4779.5497      1.7458365      3880.2248    
      1200   309.29106     -44874.19       5059.6664     -1152.0073      1.7458365      3880.2248    
      1300   293.5651      -44867.753     -438.882       -1867.0604      1.7458365      3880.2248    
      1400   287.14625     -44850.771     -4284.9384     -3876.5017      1.7458365      3880.2248    
      1500   314.15863     -44848.163      5650.8542      5226.8137      1.7458365      3880.2248    
      1600   299.62298     -44832.857      14502.42       2548.8428      1.7458365      3880.2248    
      1700   296.30201     -44845.316      4801.7818      855.267        1.7458365      3880.2248    
      1800   290.14646     -44846.295      6905.903      -331.85037      1.7458365      3880.2248    
      1900   297.48532     -44859.492      10171.056     -2849.094       1.7458365      3880.2248    
      2000   308.11166     -44877.098     -4825.7698     -257.13829      1.7458365      3880.2248    
Loop time of 110.677 on 8 procs for 2000 steps with 386 atoms

Performance: 0.781 ns/day, 30.744 hours/ns, 18.071 timesteps/s, 6.975 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.981     | 92.063     | 92.725     |   6.2 | 83.18
Bond    | 0.00068332 | 0.00085957 | 0.00099141 |   0.0 |  0.00
Neigh   | 7.1245     | 7.2262     | 7.3919     |   3.0 |  6.53
Comm    | 1.787      | 2.4518     | 3.5111     |  38.0 |  2.22
Output  | 0.0012171  | 0.0013151  | 0.001828   |   0.5 |  0.00
Modify  | 8.7281     | 8.8915     | 8.9802     |   2.5 |  8.03
Other   |            | 0.04275    |            |       |  0.04

Nlocal:          48.25 ave          58 max          43 min
Histogram: 2 2 0 0 2 0 1 0 0 1
Nghost:        3644.62 ave        3680 max        3608 min
Histogram: 1 0 3 0 1 0 0 0 1 2
Neighs:        33573.8 ave       39889 max       29937 min
Histogram: 2 2 0 0 2 0 1 0 0 1

Total # of neighbors = 268590
Ave neighs/atom = 695.82902
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-9-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.377419478448
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.6621734586495
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.341697875269

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--257.138292071045)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--257.138292071045)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-1413.11775598701)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-1413.11775598701)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2118.83257511826)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2118.83257511826)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2636.18161857493)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2636.18161857493)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--229.546794169065)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--229.546794169065)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-273.916222318999)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-273.916222318999)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 16.377419478448
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.377419478448
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.16377419478448 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.16377419478448 xy delta 0.0859440458065048 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.16377419478448 xy delta 0.0859440458065048 xz delta 0.0134254858441281 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.328836 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.328836 13.556187 17.345949) with tilt (-8.5084605 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.328836 13.556187 17.345949) with tilt (-8.5084605 -1.3291231 0.16346323)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.8 | 142 | 143.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44855.251      56779.976      0              3841.4225    
       100   295.7697      -44878.122      3875.315       3803.2628      3841.4225    
       200   286.43235     -44877.849     -505.13561      4813.266       3841.4225    
       300   295.48968     -44867.907      10339.28       3735.799       3841.4225    
       400   290.36417     -44845.878      2088.3437      4017.8007      3841.4225    
       500   309.80123     -44858.03       12554.188      5655.2649      3841.4225    
       600   320.03839     -44859.806      7878.4226      3492.7567      3841.4225    
       700   318.73643     -44845.313      15681.337      8094.3677      3841.4225    
       800   311.93387     -44852.743      7070.0724      7362.914       3841.4225    
       900   294.49722     -44862.558     -4915.0632     -605.05031      3841.4225    
      1000   299.86301     -44877.503     -8814.6539      4959.0091      3841.4225    
      1100   287.54901     -44863.499      12614.354      5913.4316      3841.4225    
      1200   294.75182     -44839.817      8543.7413      4204.5244      3841.4225    
      1300   303.99417     -44829.111      1355.0019      5106.4808      3841.4225    
      1400   297.96603     -44832.994      12332.103      6823.8907      3841.4225    
      1500   291.10116     -44845.615      6691.517       5074.1477      3841.4225    
      1600   299.98116     -44879.41       7634.6175      3737.2005      3841.4225    
      1700   273.27623     -44856.587     -921.53582      4792.2643      3841.4225    
      1800   299.17076     -44875.492      5745.2817      2810.5589      3841.4225    
      1900   315.79945     -44872.993     -5264.9895      4613.4969      3841.4225    
      2000   303.51062     -44843.026      8001.2512      1282.6274      3841.4225    
Loop time of 112.243 on 8 procs for 2000 steps with 386 atoms

Performance: 0.770 ns/day, 31.178 hours/ns, 17.819 timesteps/s, 6.878 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.011     | 93.339     | 94.188     |   7.3 | 83.16
Bond    | 0.00067093 | 0.00079484 | 0.00096977 |   0.0 |  0.00
Neigh   | 7.2102     | 7.3635     | 7.5249     |   3.7 |  6.56
Comm    | 1.5907     | 2.4444     | 3.7512     |  44.5 |  2.18
Output  | 0.0047895  | 0.0057267  | 0.0064521  |   0.8 |  0.01
Modify  | 8.8622     | 9.046      | 9.1819     |   3.3 |  8.06
Other   |            | 0.04297    |            |       |  0.04

Nlocal:          48.25 ave          56 max          41 min
Histogram: 1 0 0 2 3 0 0 0 1 1
Nghost:        3670.12 ave        3714 max        3635 min
Histogram: 3 1 0 0 0 0 1 1 1 1
Neighs:        33911.4 ave       38998 max       29044 min
Histogram: 1 0 0 2 3 0 0 0 1 1

Total # of neighbors = 271291
Ave neighs/atom = 702.82642
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.7 | 142 | 143.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.51062     -44843.026      8001.2793      0              3841.4225    
       100   305.44179     -44843.066      2390.012       8647.32        3841.4225    
       200   300.85292     -44860.298     -1277.5762     -2274.2186      3841.4225    
       300   301.40141     -44887.27       10249.416     -79.005165      3841.4225    
       400   290.29087     -44863.099     -6463.5625      6968.8123      3841.4225    
       500   300.99519     -44854.348     -2487.5866      3279.1604      3841.4225    
       600   304.28772     -44842.12       9485.0531      8401.1416      3841.4225    
       700   303.61343     -44842.835     -6419.1479      4182.0861      3841.4225    
       800   308.28058     -44860.003      7084.8469      8762.43        3841.4225    
       900   301.98956     -44871.498      14122.248      1433.706       3841.4225    
      1000   296.716       -44874.179      7572.4459      13296.252      3841.4225    
      1100   299.1241      -44879.354      7074.5673      4168.3128      3841.4225    
      1200   292.0243      -44874.984      1115.7235      5692.007       3841.4225    
      1300   300.34977     -44871.309      7542.3576      2897.5861      3841.4225    
      1400   311.82864     -44865.131      10453.146      8254.2157      3841.4225    
      1500   298.45568     -44846.997     -5427.3306      1557.5067      3841.4225    
      1600   293.49493     -44868.575     -6426.6929      1248.2356      3841.4225    
      1700   286.01065     -44882.222      11867.119      5575.9604      3841.4225    
      1800   298.48877     -44891.927     -1816.3505      6470.6287      3841.4225    
      1900   303.37224     -44877.176      2539.1178      10624.71       3841.4225    
      2000   303.9327      -44865.752      19436.118      10733.323      3841.4225    
Loop time of 112.034 on 8 procs for 2000 steps with 386 atoms

Performance: 0.771 ns/day, 31.120 hours/ns, 17.852 timesteps/s, 6.891 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.779     | 93.124     | 94.106     |   8.2 | 83.12
Bond    | 0.00064861 | 0.0007944  | 0.00091334 |   0.0 |  0.00
Neigh   | 7.1915     | 7.3264     | 7.5236     |   3.6 |  6.54
Comm    | 1.5196     | 2.5075     | 3.8327     |  50.0 |  2.24
Output  | 0.00090924 | 0.0010065  | 0.0014473  |   0.5 |  0.00
Modify  | 8.8378     | 9.0308     | 9.1496     |   3.0 |  8.06
Other   |            | 0.04284    |            |       |  0.04

Nlocal:          48.25 ave          56 max          43 min
Histogram: 3 0 0 3 0 0 0 0 0 2
Nghost:         3665.5 ave        3698 max        3634 min
Histogram: 1 3 0 0 0 0 1 0 1 2
Neighs:        33913.6 ave       39132 max       30380 min
Histogram: 3 0 0 2 1 0 0 0 0 2

Total # of neighbors = 271309
Ave neighs/atom = 702.87306
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 111.360847389569
variable C2neg equal ${d2}
variable C2neg equal 81.4688915936247
variable C3neg equal ${d3}
variable C3neg equal 44.7342646663624
variable C4neg equal ${d4}
variable C4neg equal 1.84202727574221
variable C5neg equal ${d5}
variable C5neg equal 13.4679267928025
variable C6neg equal ${d6}
variable C6neg equal 8.4942790368764

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.377419478448
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.16377419478448 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.16377419478448 xy delta -0.0859440458065048 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.16377419478448 xy delta -0.0859440458065048 xz delta -0.0134254858441281 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.656384 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.656384 13.556187 17.345949) with tilt (-8.6803486 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.656384 13.556187 17.345949) with tilt (-8.6803486 -1.3559741 0.16346323)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139.7 | 141.1 | 142.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44850.615     -57899.221      0              3919.027     
       100   303.83728     -44881.768     -2823.2416     -11481.504      3919.027     
       200   275.04486     -44862.519      6892.7513     -2590.4387      3919.027     
       300   290.20906     -44860.109      8982.0557     -4683.8452      3919.027     
       400   303.80711     -44860.147      11642.503      1372.8157      3919.027     
       500   317.33442     -44866.527      3723.9679     -5553.5286      3919.027     
       600   313.58489     -44863.28       10823.093     -294.70682      3919.027     
       700   280.38547     -44860.844      6875.9149     -566.75779      3919.027     
       800   276.65243     -44864.661     -10778.892     -1314.9708      3919.027     
       900   271.97229     -44832.787      1004.8638     -5220.9501      3919.027     
      1000   304.44126     -44851.792     -3583.33       -908.45861      3919.027     
      1100   291.75123     -44837.574     -1792.1303     -7533.1976      3919.027     
      1200   309.52602     -44874.969      6995.177      -1758.7928      3919.027     
      1300   281.38624     -44884.059     -1644.119       639.01685      3919.027     
      1400   287.28332     -44890.91      -12726.049     -3019.1225      3919.027     
      1500   277.22416     -44857.547      23900.768     -764.1203       3919.027     
      1600   314.37183     -44876.464     -10318.174     -2266.0934      3919.027     
      1700   291.55779     -44840.654      8362.8568     -5798.4652      3919.027     
      1800   318.57061     -44859.921      2249.1513     -1521.1287      3919.027     
      1900   309.59362     -44848.773      1668.6396     -5501.904       3919.027     
      2000   285.89539     -44843.369      8566.8931     -2056.4458      3919.027     
Loop time of 109.133 on 8 procs for 2000 steps with 386 atoms

Performance: 0.792 ns/day, 30.315 hours/ns, 18.326 timesteps/s, 7.074 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.389     | 90.649     | 91.921     |   8.1 | 83.06
Bond    | 0.00062356 | 0.00080884 | 0.0009557  |   0.0 |  0.00
Neigh   | 7.1086     | 7.2002     | 7.4182     |   3.7 |  6.60
Comm    | 1.0349     | 2.3135     | 3.5512     |  50.4 |  2.12
Output  | 0.0046949  | 0.0056846  | 0.0064445  |   0.8 |  0.01
Modify  | 8.7076     | 8.9204     | 9.0063     |   3.1 |  8.17
Other   |            | 0.04305    |            |       |  0.04

Nlocal:          48.25 ave          55 max          44 min
Histogram: 2 1 2 0 1 0 0 0 1 1
Nghost:        3627.62 ave        3670 max        3589 min
Histogram: 2 0 0 2 1 1 0 0 0 2
Neighs:        33197.5 ave       37568 max       30397 min
Histogram: 2 1 1 1 1 0 0 0 1 1

Total # of neighbors = 265580
Ave neighs/atom = 688.03109
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139.6 | 141.1 | 142.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   285.89539     -44843.369      8566.8931      0              3919.027     
       100   306.44715     -44867.616     -1358.8739     -1807.129       3919.027     
       200   297.63521     -44864.269      1374.182      -2614.7353      3919.027     
       300   297.3013      -44876.066      650.27828     -3574.5183      3919.027     
       400   286.82525     -44870.051     -4237.3768     -6270.9605      3919.027     
       500   298.28671     -44865.215      9040.2814      1086.303       3919.027     
       600   301.2938      -44840.87       6462.7144     -2330.7391      3919.027     
       700   306.03292     -44845.212     -988.53214     -7674.2919      3919.027     
       800   296.88594     -44853.978     -6853.5242     -1995.8874      3919.027     
       900   308.3325      -44877.473      6521.505      -1571.711       3919.027     
      1000   303.27277     -44870.608     -4883.8029     -10740.659      3919.027     
      1100   313.72017     -44870.476     -6537.3645     -9194.7991      3919.027     
      1200   303.75437     -44848.512      10324.543     -6138.8403      3919.027     
      1300   313.02545     -44859.962     -3047.6968     -4462.4644      3919.027     
      1400   305.60736     -44872.238      9060.7894     -1927.4983      3919.027     
      1500   292.06046     -44876.652      10037.431     -2342.6635      3919.027     
      1600   301.85653     -44887.763     -637.65716      246.35757      3919.027     
      1700   300.65821     -44853.749     -6691.6633     -7198.6981      3919.027     
      1800   314.67043     -44850.045     -2448.6635     -4165.1322      3919.027     
      1900   310.17197     -44851.211     -4111.6723     -3186.4335      3919.027     
      2000   321.23144     -44878.728      1690.3446      5449.3146      3919.027     
Loop time of 109.088 on 8 procs for 2000 steps with 386 atoms

Performance: 0.792 ns/day, 30.302 hours/ns, 18.334 timesteps/s, 7.077 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.604     | 78.928     | 90.302     |  91.8 | 72.35
Bond    | 0.00065014 | 0.00077273 | 0.00093021 |   0.0 |  0.00
Neigh   | 5.726      | 6.3449     | 7.2842     |  26.3 |  5.82
Comm    | 2.1674     | 13.5       | 21.837     | 222.0 | 12.38
Output  | 0.00079292 | 0.0008916  | 0.0012483  |   0.0 |  0.00
Modify  | 9.37       | 10.274     | 10.883     |  20.8 |  9.42
Other   |            | 0.03899    |            |       |  0.04

Nlocal:          48.25 ave          55 max          42 min
Histogram: 1 0 2 1 1 0 1 0 0 2
Nghost:        3621.12 ave        3659 max        3580 min
Histogram: 2 1 1 0 0 0 0 1 0 3
Neighs:        33211.8 ave       37664 max       29150 min
Histogram: 1 0 2 1 1 0 1 0 0 2

Total # of neighbors = 265694
Ave neighs/atom = 688.32642
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -57.8206340252648
variable C2pos equal ${d2}
variable C2pos equal -21.5278589194656
variable C3pos equal ${d3}
variable C3pos equal -29.9101850381506
variable C4pos equal ${d4}
variable C4pos equal -11.5787794189506
variable C5pos equal ${d5}
variable C5pos equal -12.3228035204985
variable C6pos equal ${d6}
variable C6pos equal -3.01643551766232

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(111.360847389569+${C1pos})
variable C11 equal 0.5*(111.360847389569+-57.8206340252648)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(81.4688915936247+${C2pos})
variable C21 equal 0.5*(81.4688915936247+-21.5278589194656)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(44.7342646663624+${C3pos})
variable C31 equal 0.5*(44.7342646663624+-29.9101850381506)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(1.84202727574221+${C4pos})
variable C41 equal 0.5*(1.84202727574221+-11.5787794189506)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(13.4679267928025+${C5pos})
variable C51 equal 0.5*(13.4679267928025+-12.3228035204985)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(8.4942790368764+${C6pos})
variable C61 equal 0.5*(8.4942790368764+-3.01643551766232)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.6621734586495
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.6621734586495
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.136621734586495 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.136621734586495 yz delta -0.00163463227494675 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.419565 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.419565 17.345949) with tilt (-8.5944046 -1.3425486 0.1618286)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 141.1 | 142.2 | 143.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44860.804      51593.105      0              3841.4225    
       100   293.85432     -44878.942      3466.2984      1792.412       3841.4225    
       200   281.12439     -44877.116      9360.0269      3006.091       3841.4225    
       300   289.14009     -44865.814      11533.563     -640.37132      3841.4225    
       400   299.23571     -44862.045      10819.013      3238.7793      3841.4225    
       500   301.4695      -44853.639      12917.386      705.00964      3841.4225    
       600   318.2433      -44867.271      3780.2411      4076.2252      3841.4225    
       700   291.51903     -44859.554      7832.8536      3356.2995      3841.4225    
       800   271.97258     -44862.549     -1643.1214     -32.267662      3841.4225    
       900   289.45798     -44874.071      251.69809     -1114.3494      3841.4225    
      1000   303.01318     -44859.975      3324.1642     -4259.4649      3841.4225    
      1100   290.18144     -44834.495      7913.022       1172.8149      3841.4225    
      1200   309.19674     -44857.14       18556.584      683.32528      3841.4225    
      1300   301.66198     -44856.267     -7739.5114      3921.2523      3841.4225    
      1400   297.04074     -44858.284      5057.045       6671.0548      3841.4225    
      1500   300.98325     -44879.102      7282.7699      8618.8055      3841.4225    
      1600   298.24664     -44885.61      -7730.2959     -1772.9388      3841.4225    
      1700   279.78422     -44853.302      4206.3256      1144.9937      3841.4225    
      1800   312.2331      -44857.647      2532.1125     -5688.501       3841.4225    
      1900   312.10483     -44854.025     -6557.1317      2603.9217      3841.4225    
      2000   312.73191     -44865.751      452.58977      4351.273       3841.4225    
Loop time of 109.594 on 8 procs for 2000 steps with 386 atoms

Performance: 0.788 ns/day, 30.443 hours/ns, 18.249 timesteps/s, 7.044 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.502     | 75.208     | 92.263     | 147.1 | 68.62
Bond    | 0.00057475 | 0.00075818 | 0.00091448 |   0.0 |  0.00
Neigh   | 5.197      | 6.0574     | 7.5545     |  41.3 |  5.53
Comm    | 1.0693     | 18.099     | 29.813     | 299.8 | 16.51
Output  | 0.00444    | 0.0052891  | 0.0058613  |   0.7 |  0.00
Modify  | 8.702      | 10.186     | 11.043     |  32.1 |  9.29
Other   |            | 0.03778    |            |       |  0.03

Nlocal:          48.25 ave          61 max          40 min
Histogram: 2 1 0 1 1 2 0 0 0 1
Nghost:        3671.12 ave        3703 max        3641 min
Histogram: 1 1 1 0 2 0 0 1 0 2
Neighs:        33897.8 ave       42388 max       28311 min
Histogram: 2 1 0 1 1 2 0 0 0 1

Total # of neighbors = 271182
Ave neighs/atom = 702.54404
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 141.1 | 142.2 | 143.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.73191     -44865.751      452.6775       0              3841.4225    
       100   323.90628     -44895.665      7737.9248     -3750.4344      3841.4225    
       200   276.28827     -44864.827      11511.33      -561.6894       3841.4225    
       300   280.99739     -44866.147      23211.794      5215.4692      3841.4225    
       400   287.75732     -44866.818      3030.1207     -473.39276      3841.4225    
       500   303.25165     -44871.423      7867.4295      6216.4514      3841.4225    
       600   295.42968     -44848.34      -244.91114     -348.92876      3841.4225    
       700   316.69831     -44857.204      8063.7401      5548.9364      3841.4225    
       800   320.59284     -44856.182      3961.414       3720.7641      3841.4225    
       900   316.65913     -44880.524      16297.152      3229.309       3841.4225    
      1000   304.94667     -44891.768     -4214.9536      1880.767       3841.4225    
      1100   304.32933     -44893.351      495.27734      8263.63        3841.4225    
      1200   306.53219     -44874.461      20264.829      3023.7817      3841.4225    
      1300   297.52553     -44831.886      18560.825      6757.3722      3841.4225    
      1400   301.89282     -44842.219      12252.356      2341.431       3841.4225    
      1500   288.41501     -44843.315      3666.7589     -2354.0431      3841.4225    
      1600   289.82253     -44859.09       15876.724      6496.645       3841.4225    
      1700   287.04008     -44863.233      4818.7896      4453.8287      3841.4225    
      1800   296.37385     -44871.492     -1786.332       3051.6022      3841.4225    
      1900   296.865       -44848.897      10850.587      3416.2327      3841.4225    
      2000   322.62022     -44859.224      8927.2949      1382.9888      3841.4225    
Loop time of 109.497 on 8 procs for 2000 steps with 386 atoms

Performance: 0.789 ns/day, 30.416 hours/ns, 18.265 timesteps/s, 7.050 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.495     | 75.04      | 92.43      | 147.2 | 68.53
Bond    | 0.00057692 | 0.00077031 | 0.00092374 |   0.0 |  0.00
Neigh   | 5.1907     | 6.0365     | 7.4413     |  40.2 |  5.51
Comm    | 0.90817    | 18.272     | 29.828     | 298.2 | 16.69
Output  | 0.00080258 | 0.00089153 | 0.0012546  |   0.0 |  0.00
Modify  | 8.7166     | 10.109     | 10.949     |  31.3 |  9.23
Other   |            | 0.03767    |            |       |  0.03

Nlocal:          48.25 ave          61 max          40 min
Histogram: 1 1 2 0 2 1 0 0 0 1
Nghost:        3673.62 ave        3719 max        3622 min
Histogram: 1 0 0 3 0 1 0 0 2 1
Neighs:        33911.2 ave       42373 max       28151 min
Histogram: 1 1 1 1 2 1 0 0 0 1

Total # of neighbors = 271290
Ave neighs/atom = 702.82383
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 16.6185878549615
variable C2neg equal ${d2}
variable C2neg equal 70.0794197331625
variable C3neg equal ${d3}
variable C3neg equal 51.2826345427264
variable C4neg equal ${d4}
variable C4neg equal -8.48888622227252
variable C5neg equal ${d5}
variable C5neg equal 16.5449259221048
variable C6neg equal ${d6}
variable C6neg equal 15.3148390438846

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.6621734586495
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.136621734586495 yz delta ${deltayz} remap units box
change_box all y delta 0 0.136621734586495 yz delta 0.00163463227494675 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.692808 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.692808 17.345949) with tilt (-8.5944046 -1.3425486 0.16509786)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.2 | 141.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44853.964     -48550.328      0              3919.027     
       100   303.10829     -44885.372     -9159.5015     -6701.1483      3919.027     
       200   277.1202      -44870.142     -1672.7005     -1428.107       3919.027     
       300   291.93437     -44866.071      27784.061     -806.75838      3919.027     
       400   297.66452     -44858.034     -906.03032      1429.2153      3919.027     
       500   317.65875     -44866.065      3264.1913     -2557.0634      3919.027     
       600   309.4249      -44849.133      6460.2466      48.745999      3919.027     
       700   292.08817     -44859.583     -4486.6176     -935.00045      3919.027     
       800   282.00802     -44872.988     -15303.306     -1447.5331      3919.027     
       900   290.8569      -44877.213     -6108.6219     -6140.3674      3919.027     
      1000   280.07976     -44836.823      14898.454      2590.1247      3919.027     
      1100   309.58113     -44855.462     -6613.6345     -4818.2586      3919.027     
      1200   308.5928      -44856.174     -45.047436     -1600.6179      3919.027     
      1300   310.78017     -44871.703     -5099.1247      3774.0367      3919.027     
      1400   308.22081     -44877.077     -6060.8133     -1295.3476      3919.027     
      1500   293.80156     -44862.896      84.447012     -1107.2841      3919.027     
      1600   307.89296     -44872.071     -2948.4834     -4425.0813      3919.027     
      1700   310.92314     -44864.203     -5156.6087      251.03233      3919.027     
      1800   294.55934     -44854.203     -3860.8263      759.08635      3919.027     
      1900   288.07054     -44866.139     -5352.1436      28.881965      3919.027     
      2000   294.33641     -44879.204     -3948.7928     -4629.2         3919.027     
Loop time of 106.633 on 8 procs for 2000 steps with 386 atoms

Performance: 0.810 ns/day, 29.620 hours/ns, 18.756 timesteps/s, 7.240 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.596     | 72.8       | 89.963     | 146.4 | 68.27
Bond    | 0.00059395 | 0.00078662 | 0.0010045  |   0.0 |  0.00
Neigh   | 5.0601     | 5.9127     | 7.3183     |  41.0 |  5.54
Comm    | 0.84037    | 17.982     | 29.192     | 294.5 | 16.86
Output  | 0.0042732  | 0.0052034  | 0.0058009  |   0.7 |  0.00
Modify  | 8.5014     | 9.8949     | 10.746     |  31.9 |  9.28
Other   |            | 0.03744    |            |       |  0.04

Nlocal:          48.25 ave          59 max          42 min
Histogram: 2 1 1 2 0 0 0 1 0 1
Nghost:           3610 ave        3653 max        3572 min
Histogram: 2 1 1 0 0 1 0 0 2 1
Neighs:        33192.2 ave       40120 max       29036 min
Histogram: 2 1 1 2 0 0 0 1 0 1

Total # of neighbors = 265538
Ave neighs/atom = 687.92228
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.2 | 141.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.33641     -44879.204     -3948.7555      0              3919.027     
       100   293.43274     -44871.577      809.29442      17.324469      3919.027     
       200   313.71451     -44863.83       4880.4521      3454.9417      3919.027     
       300   300.0087      -44825.304      11442.562     -1016.4149      3919.027     
       400   329.24826     -44872.836      2272.3299      1021.2396      3919.027     
       500   308.3536      -44868.431     -6935.1815     -5820.9966      3919.027     
       600   304.57221     -44873.36       7828.0094     -370.48319      3919.027     
       700   299.65001     -44875.833      12195.66       2542.8657      3919.027     
       800   295.64053     -44901.199      5202.6316     -3192.7453      3919.027     
       900   284.62661     -44903.449     -6701.4075      1411.8299      3919.027     
      1000   288.55191     -44887.111      619.44702      2888.9036      3919.027     
      1100   297.74977     -44883.523      2736.7047     -514.44601      3919.027     
      1200   298.66452     -44873.623     -7663.3181      233.74764      3919.027     
      1300   310.92517     -44870.594     -1999.6582     -488.94015      3919.027     
      1400   323.72766     -44869.646     -5281.9755     -3596.5428      3919.027     
      1500   299.11246     -44864.87       2925.7873     -5317.2196      3919.027     
      1600   293.19305     -44888.417      9464.2478     -1817.045       3919.027     
      1700   278.71367     -44871.916     -1092.3995      1788.693       3919.027     
      1800   302.62238     -44881.241      6355.4491      430.74997      3919.027     
      1900   305.72032     -44858.402     -5555.4204      2880.8063      3919.027     
      2000   304.17062     -44858.726      9129.0648      716.17291      3919.027     
Loop time of 106.828 on 8 procs for 2000 steps with 386 atoms

Performance: 0.809 ns/day, 29.674 hours/ns, 18.722 timesteps/s, 7.227 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.909     | 72.893     | 90.001     | 145.0 | 68.23
Bond    | 0.00058504 | 0.00076707 | 0.0010005  |   0.0 |  0.00
Neigh   | 5.0799     | 5.9443     | 7.3814     |  42.3 |  5.56
Comm    | 0.79634    | 17.881     | 28.875     | 292.6 | 16.74
Output  | 0.00080578 | 0.00091134 | 0.0012524  |   0.0 |  0.00
Modify  | 8.6465     | 10.07      | 10.93      |  32.7 |  9.43
Other   |            | 0.03719    |            |       |  0.03

Nlocal:          48.25 ave          57 max          40 min
Histogram: 1 0 2 1 1 0 0 1 1 1
Nghost:        3617.25 ave        3663 max        3584 min
Histogram: 2 0 2 1 0 0 1 1 0 1
Neighs:        33218.2 ave       38851 max       27771 min
Histogram: 1 0 2 1 0 1 0 1 1 1

Total # of neighbors = 265746
Ave neighs/atom = 688.46114
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -9.8620757239087
variable C2pos equal ${d2}
variable C2pos equal -63.0394338318561
variable C3pos equal ${d3}
variable C3pos equal -16.3474409177048
variable C4pos equal ${d4}
variable C4pos equal 4.52420242967006
variable C5pos equal ${d5}
variable C5pos equal -8.68227539490614
variable C6pos equal ${d6}
variable C6pos equal -5.06173914102253

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(16.6185878549615+${C1pos})
variable C12 equal 0.5*(16.6185878549615+-9.8620757239087)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(70.0794197331625+${C2pos})
variable C22 equal 0.5*(70.0794197331625+-63.0394338318561)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(51.2826345427264+${C3pos})
variable C32 equal 0.5*(51.2826345427264+-16.3474409177048)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-8.48888622227252+${C4pos})
variable C42 equal 0.5*(-8.48888622227252+4.52420242967006)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(16.5449259221048+${C5pos})
variable C52 equal 0.5*(16.5449259221048+-8.68227539490614)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(15.3148390438846+${C6pos})
variable C62 equal 0.5*(15.3148390438846+-5.06173914102253)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.341697875269
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.341697875269
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.17341697875269 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.172532) with tilt (-8.5944046 -1.3425486 0.16346323)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.7 | 142.3 | 143.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44863.408      54201.84       0              3841.4225    
       100   290.50628     -44876.265      7669.7813     -578.48281      3841.4225    
       200   281.15163     -44877.192      130.15546      3044.1601      3841.4225    
       300   297.71454     -44874.079      2117.8732     -2011.8668      3841.4225    
       400   293.23723     -44855.158     -3558.3981      1220.924       3841.4225    
       500   308.89513     -44859.671      5562.2673      4705.8547      3841.4225    
       600   313.00882     -44850.05       24873.545      6179.4437      3841.4225    
       700   304.79034     -44840.547      7997.0693      5286.866       3841.4225    
       800   282.87334     -44847.63       11358.582      6210.1665      3841.4225    
       900   276.89874     -44859.211      6868.1781      1257.2412      3841.4225    
      1000   293.91828     -44864.19       2633.205       1433.5507      3841.4225    
      1100   303.68309     -44853.13      -9742.755      -1137.6704      3841.4225    
      1200   339.91166     -44874.953      15793.101      8498.007       3841.4225    
      1300   305.39736     -44831.021      12079.668      5800.499       3841.4225    
      1400   298.23449     -44843.343     -5940.8232      2539.7278      3841.4225    
      1500   279.35443     -44848.777     -6184.5221      1537.3388      3841.4225    
      1600   292.82057     -44870.826      9968.4593      2208.754       3841.4225    
      1700   297.16272     -44862.433      13118.762      1215.4921      3841.4225    
      1800   321.35164     -44858.4        18026.962      10412.313      3841.4225    
      1900   330.7145      -44859.462      8407.7972      5902.1089      3841.4225    
      2000   310.74643     -44854.603      9415.1394      4289.1362      3841.4225    
Loop time of 109.632 on 8 procs for 2000 steps with 386 atoms

Performance: 0.788 ns/day, 30.453 hours/ns, 18.243 timesteps/s, 7.042 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.481     | 75.09      | 92.554     | 146.7 | 68.49
Bond    | 0.00063183 | 0.00079121 | 0.00092904 |   0.0 |  0.00
Neigh   | 5.1886     | 6.0663     | 7.4755     |  42.0 |  5.53
Comm    | 0.93262    | 18.375     | 29.991     | 296.5 | 16.76
Output  | 0.0043577  | 0.0052096  | 0.0057822  |   0.7 |  0.00
Modify  | 8.6218     | 10.057     | 10.932     |  32.9 |  9.17
Other   |            | 0.03808    |            |       |  0.03

Nlocal:          48.25 ave          57 max          39 min
Histogram: 1 0 1 0 3 0 1 0 1 1
Nghost:           3675 ave        3696 max        3660 min
Histogram: 1 3 0 1 0 0 1 1 0 1
Neighs:        33900.5 ave       39777 max       27619 min
Histogram: 1 0 1 0 3 0 1 0 1 1

Total # of neighbors = 271204
Ave neighs/atom = 702.60104
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.6 | 142.3 | 143.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   310.74643     -44854.603      9415.1745      0              3841.4225    
       100   303.64741     -44847.903      13669.069     -93.95461       3841.4225    
       200   303.9308      -44854.295      3631.3979     -973.1183       3841.4225    
       300   288.83227     -44858.835      3892.2058      3256.0113      3841.4225    
       400   291.15819     -44875.392      3468.3065      1448.3957      3841.4225    
       500   280.28089     -44850.035      6734.9072      182.9646       3841.4225    
       600   296.7518      -44833.166     -5969.874       2170.6911      3841.4225    
       700   315.83846     -44852.023      10955.894     -2201.7531      3841.4225    
       800   310.00343     -44851.067      4771.0309      6082.2417      3841.4225    
       900   289.03835     -44857.335     -9287.0089     -792.45279      3841.4225    
      1000   290.9521      -44871.961      11571.028      2828.9361      3841.4225    
      1100   294.95357     -44868.79       3857.0367      110.94328      3841.4225    
      1200   294.30194     -44857.54       9541.0916      2093.7789      3841.4225    
      1300   303.66608     -44852.391      5219.7757      1603.9774      3841.4225    
      1400   313.57245     -44858.044      4759.5744      7046.0886      3841.4225    
      1500   287.42836     -44856.381      2210.5004      281.54978      3841.4225    
      1600   293.57108     -44886.953      11293.683      6293.8         3841.4225    
      1700   287.80225     -44867.011      10672.095      4685.2109      3841.4225    
      1800   310.22852     -44865.807      3241.9481      1387.5642      3841.4225    
      1900   307.71532     -44851.477      8697.8318      2844.2828      3841.4225    
      2000   288.8864      -44833.342      9481.9971     -360.41317      3841.4225    
Loop time of 109.627 on 8 procs for 2000 steps with 386 atoms

Performance: 0.788 ns/day, 30.452 hours/ns, 18.244 timesteps/s, 7.042 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.833     | 73.336     | 92.563     | 131.4 | 66.90
Bond    | 0.00057905 | 0.00081251 | 0.0010909  |   0.0 |  0.00
Neigh   | 5.2033     | 5.8669     | 7.2901     |  35.2 |  5.35
Comm    | 1.0093     | 20.216     | 29.732     | 250.0 | 18.44
Output  | 0.000818   | 0.00094635 | 0.0013284  |   0.0 |  0.00
Modify  | 8.7221     | 10.168     | 10.823     |  27.1 |  9.27
Other   |            | 0.03807    |            |       |  0.03

Nlocal:          48.25 ave          61 max          40 min
Histogram: 2 1 0 3 0 0 0 1 0 1
Nghost:         3669.5 ave        3710 max        3634 min
Histogram: 2 0 1 0 1 0 3 0 0 1
Neighs:        33920.9 ave       42316 max       28465 min
Histogram: 2 1 0 3 0 0 0 1 0 1

Total # of neighbors = 271367
Ave neighs/atom = 703.02332
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -1.04643270087651
variable C2neg equal ${d2}
variable C2neg equal 4.29510565307713
variable C3neg equal ${d3}
variable C3neg equal 44.2212372770261
variable C4neg equal ${d4}
variable C4neg equal 2.54870552441262
variable C5neg equal ${d5}
variable C5neg equal 7.9768270174484
variable C6neg equal ${d6}
variable C6neg equal 16.918722381831

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.341697875269
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.17341697875269 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.519366) with tilt (-8.5944046 -1.3425486 0.16346323)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139.1 | 140.3 | 141.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44850.561     -51873.705      0              3919.027     
       100   304.74512     -44883.624     -9080.3968     -7584.1979      3919.027     
       200   275.33854     -44864.789     -6242.8496      796.6489       3919.027     
       300   300.05497     -44873.788      14769.731     -2709.9434      3919.027     
       400   312.76906     -44872.401      698.35283     -3077.6303      3919.027     
       500   292.88157     -44841.698     -15464.103     -4389.6561      3919.027     
       600   298.53869     -44827.004     -1004.9007     -4381.6913      3919.027     
       700   335.61939     -44838.502     -4167.354      -796.41133      3919.027     
       800   317.194       -44841.161      10399.427      218.00258      3919.027     
       900   285.00427     -44826.5       -905.9518      -3584.7289      3919.027     
      1000   316.5881      -44870.508     -5685.4873     -5689.1485      3919.027     
      1100   285.65829     -44850.962     -3983.8247     -5170.7908      3919.027     
      1200   295.48955     -44870.487      16411.1        527.63498      3919.027     
      1300   310.28942     -44878.525     -6144.3046     -409.49071      3919.027     
      1400   315.12644     -44857.966     -7785.9595      3.4909095      3919.027     
      1500   303.8764      -44836.76      -5971.115       484.3121       3919.027     
      1600   297.0406      -44836.339      1807.7088      275.1175       3919.027     
      1700   299.45145     -44869.683     -2321.8362      5413.0856      3919.027     
      1800   285.46629     -44873.058     -759.99142     -1772.7575      3919.027     
      1900   285.12615     -44870.724      381.61671     -1961.173       3919.027     
      2000   286.52499     -44845.117     -3509.3799     -1249.1394      3919.027     
Loop time of 106.817 on 8 procs for 2000 steps with 386 atoms

Performance: 0.809 ns/day, 29.671 hours/ns, 18.724 timesteps/s, 7.227 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.727     | 72.73      | 89.788     | 149.4 | 68.09
Bond    | 0.00055177 | 0.00077851 | 0.00091068 |   0.0 |  0.00
Neigh   | 5.0743     | 5.9056     | 7.2944     |  40.1 |  5.53
Comm    | 1.1731     | 18.207     | 29.225     | 298.4 | 17.04
Output  | 0.0043425  | 0.0052238  | 0.005835   |   0.7 |  0.00
Modify  | 8.5456     | 9.9321     | 10.752     |  31.2 |  9.30
Other   |            | 0.03704    |            |       |  0.03

Nlocal:          48.25 ave          57 max          43 min
Histogram: 1 1 2 2 0 0 0 1 0 1
Nghost:         3618.5 ave        3679 max        3569 min
Histogram: 1 1 1 1 1 0 1 1 0 1
Neighs:        33240.5 ave       38893 max       29791 min
Histogram: 1 1 2 2 0 0 0 1 0 1

Total # of neighbors = 265924
Ave neighs/atom = 688.92228
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139 | 140.3 | 141.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   286.52499     -44845.117     -3509.3654      0              3919.027     
       100   300.28023     -44858.199      2645.6944      2203.2003      3919.027     
       200   297.82198     -44843.114     -12233.438     -3619.2681      3919.027     
       300   297.1477      -44820.479      6721.8395      2438.8246      3919.027     
       400   310.05309     -44848.162      3075.4642     -1455.1889      3919.027     
       500   299.50866     -44867.186     -6974.7889     -3783.4636      3919.027     
       600   296.80623     -44873.101      4771.8063     -1991.8532      3919.027     
       700   308.16276     -44877.93      -5737.1079      636.3489       3919.027     
       800   301.33247     -44855.115     -817.31664     -2220.7504      3919.027     
       900   324.5937      -44854.097     -1613.647       634.4215       3919.027     
      1000   336.14554     -44836.146     -10637.833     -1246.2142      3919.027     
      1100   322.04723     -44839.552     -2711.931      -998.77576      3919.027     
      1200   299.50463     -44834.829     -16147.551      3105.4129      3919.027     
      1300   286.19441     -44837.933      6946.3033     -2273.0456      3919.027     
      1400   299.15466     -44858.402     -4219.0333      722.52403      3919.027     
      1500   314.33124     -44880.431     -6249.5445      2388.3597      3919.027     
      1600   285.92181     -44860.809     -6911.032      -2064.5164      3919.027     
      1700   295.87758     -44860.626     -11259.078     -3786.6628      3919.027     
      1800   293.33486     -44841.274      7820.5815     -4015.9183      3919.027     
      1900   298.03462     -44823.459     -9154.1175     -6538.599       3919.027     
      2000   319.79        -44846.609     -2751.4123     -3977.1193      3919.027     
Loop time of 106.363 on 8 procs for 2000 steps with 386 atoms

Performance: 0.812 ns/day, 29.545 hours/ns, 18.803 timesteps/s, 7.258 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.577     | 72.697     | 89.304     | 146.1 | 68.35
Bond    | 0.00055558 | 0.00076223 | 0.00088862 |   0.0 |  0.00
Neigh   | 5.044      | 5.9016     | 7.3059     |  41.4 |  5.55
Comm    | 1.1559     | 17.772     | 28.907     | 295.3 | 16.71
Output  | 0.00080519 | 0.00094572 | 0.0012707  |   0.0 |  0.00
Modify  | 8.5347     | 9.9539     | 10.8       |  32.2 |  9.36
Other   |            | 0.03694    |            |       |  0.03

Nlocal:          48.25 ave          59 max          41 min
Histogram: 1 2 0 2 1 0 0 1 0 1
Nghost:        3585.12 ave        3612 max        3560 min
Histogram: 2 1 0 1 1 0 0 0 1 2
Neighs:        33199.8 ave       40167 max       28367 min
Histogram: 1 2 0 1 2 0 0 1 0 1

Total # of neighbors = 265598
Ave neighs/atom = 688.07772
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 37.6927079492721
variable C2pos equal ${d2}
variable C2pos equal 50.3456484859621
variable C3pos equal ${d3}
variable C3pos equal 58.7571247657217
variable C4pos equal ${d4}
variable C4pos equal 11.6182833586713
variable C5pos equal ${d5}
variable C5pos equal 8.13045535641118
variable C6pos equal ${d6}
variable C6pos equal 1.73974395124446

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-1.04643270087651+${C1pos})
variable C13 equal 0.5*(-1.04643270087651+37.6927079492721)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(4.29510565307713+${C2pos})
variable C23 equal 0.5*(4.29510565307713+50.3456484859621)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(44.2212372770261+${C3pos})
variable C33 equal 0.5*(44.2212372770261+58.7571247657217)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(2.54870552441262+${C4pos})
variable C43 equal 0.5*(2.54870552441262+11.6182833586713)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(7.9768270174484+${C5pos})
variable C53 equal 0.5*(7.9768270174484+8.13045535641118)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(16.918722381831+${C6pos})
variable C63 equal 0.5*(16.918722381831+1.73974395124446)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.341697875269
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.341697875269
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.17341697875269 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 -0.0099537513)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.2 | 141.5 | 142.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44876.731     -5832.6491      0              3880.2248    
       100   296.16433     -44890.326      2530.1217     -1303.5306      3880.2248    
       200   272.16186     -44878.686      5141.1103      368.16344      3880.2248    
       300   296.97041     -44878.037      19063.393      1516.3191      3880.2248    
       400   297.90022     -44864.32       17021.736     -1515.6318      3880.2248    
       500   313.38271     -44868.165     -12356.876      2374.2465      3880.2248    
       600   304.23499     -44848.567      778.02715      4793.9858      3880.2248    
       700   301.0636      -44856.41       4266.8221     -352.57429      3880.2248    
       800   282.19092     -44866.632     -540.37228     -1368.0391      3880.2248    
       900   279.48069     -44869.368     -2046.3718      278.01232      3880.2248    
      1000   302.8265      -44875.092      9684.5627      1218.4335      3880.2248    
      1100   308.69311     -44860.059     -798.05549     -2409.9602      3880.2248    
      1200   312.83899     -44858.995     -7534.5003     -689.34487      3880.2248    
      1300   306.547       -44869.399     -6598.4294      6501.7171      3880.2248    
      1400   287.17587     -44860.45      -3395.6393      1312.1717      3880.2248    
      1500   284.46507     -44850.479      14567.012      2329.5243      3880.2248    
      1600   316.92345     -44848.693      14796.881      4353.7973      3880.2248    
      1700   309.85718     -44837.952     -1787.3929      3667.6988      3880.2248    
      1800   304.07656     -44854.723      6093.8665     -660.95254      3880.2248    
      1900   310.79992     -44870.948     -8809.5063     -2976.903       3880.2248    
      2000   295.2323      -44862.774     -379.43262      1428.9005      3880.2248    
Loop time of 108.614 on 8 procs for 2000 steps with 386 atoms

Performance: 0.795 ns/day, 30.171 hours/ns, 18.414 timesteps/s, 7.108 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.446     | 76.404     | 91.276     | 134.8 | 70.34
Bond    | 0.00057461 | 0.00082749 | 0.00096566 |   0.0 |  0.00
Neigh   | 5.1041     | 6.1863     | 7.3812     |  37.0 |  5.70
Comm    | 1.356      | 16.207     | 30.175     | 292.6 | 14.92
Output  | 0.0044006  | 0.005323   | 0.0059782  |   0.7 |  0.00
Modify  | 8.5601     | 9.7717     | 10.847     |  29.7 |  9.00
Other   |            | 0.03967    |            |       |  0.04

Nlocal:          48.25 ave          57 max          44 min
Histogram: 3 1 1 1 0 0 1 0 0 1
Nghost:        3636.25 ave        3673 max        3607 min
Histogram: 1 1 0 3 0 1 0 0 1 1
Neighs:        33548.6 ave       39263 max       30648 min
Histogram: 3 1 1 0 1 0 1 0 0 1

Total # of neighbors = 268389
Ave neighs/atom = 695.30829
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.2 | 141.5 | 142.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.2323      -44862.774     -379.46967      0              3880.2248    
       100   309.03921     -44873.748      13157.117      701.59152      3880.2248    
       200   307.85975     -44853.985     -1540.1877     -473.11374      3880.2248    
       300   311.56845     -44831.743     -10711.123     -3062.8052      3880.2248    
       400   309.74146     -44850.123     -14528.43       2914.3508      3880.2248    
       500   311.6668      -44878.911      3619.9011     -2068.1842      3880.2248    
       600   293.41151     -44868.113      10287.048      3686.2929      3880.2248    
       700   284.22644     -44857.973      5530.9061      1160.9832      3880.2248    
       800   309.19851     -44870.848      7028.4809     -2076.2208      3880.2248    
       900   297.86662     -44827.615      11782.011      1240.2771      3880.2248    
      1000   312.62473     -44838.116      10315.354      1781.8194      3880.2248    
      1100   290.88165     -44840.985      15107.536     -2660.7485      3880.2248    
      1200   306.31341     -44864.287      2850.176       346.9613       3880.2248    
      1300   283.22307     -44842.494     -4722.579      -785.03484      3880.2248    
      1400   288.5255      -44860.108      5807.8458     -561.24059      3880.2248    
      1500   279.84351     -44873.623      3723.9634      5701.1363      3880.2248    
      1600   283.78404     -44879.291     -2476.3181      4622.9997      3880.2248    
      1700   302.88535     -44862.383      21507.119      2054.9327      3880.2248    
      1800   303.29276     -44850.005     -7828.7503     -2027.5718      3880.2248    
      1900   296.02625     -44848.674      3064.3493      2273.2075      3880.2248    
      2000   277.76871     -44854.574      15976.626      72.562134      3880.2248    
Loop time of 109.887 on 8 procs for 2000 steps with 386 atoms

Performance: 0.786 ns/day, 30.524 hours/ns, 18.201 timesteps/s, 7.025 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.318     | 79.425     | 92.632     | 144.5 | 72.28
Bond    | 0.0005431  | 0.0008215  | 0.0010022  |   0.0 |  0.00
Neigh   | 5.1113     | 6.4202     | 7.7007     |  41.7 |  5.84
Comm    | 1.0207     | 14.237     | 30.355     | 341.3 | 12.96
Output  | 0.00081391 | 0.000938   | 0.0013074  |   0.0 |  0.00
Modify  | 8.4757     | 9.7605     | 11.063     |  34.1 |  8.88
Other   |            | 0.04268    |            |       |  0.04

Nlocal:          48.25 ave          57 max          42 min
Histogram: 2 0 1 1 0 2 0 1 0 1
Nghost:         3629.5 ave        3649 max        3611 min
Histogram: 2 1 0 1 0 1 0 0 1 2
Neighs:        33558.8 ave       39207 max       29314 min
Histogram: 2 1 0 1 0 2 0 1 0 1

Total # of neighbors = 268470
Ave neighs/atom = 695.51813
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 3.3406895679678
variable C2neg equal ${d2}
variable C2neg equal 52.234487832673
variable C3neg equal ${d3}
variable C3neg equal 80.5033333825023
variable C4neg equal ${d4}
variable C4neg equal 15.3291974709198
variable C5neg equal ${d5}
variable C5neg equal 18.3521802093906
variable C6neg equal ${d6}
variable C6neg equal -8.43125175120571

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.341697875269
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.17341697875269 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.33688021)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.2 | 141.5 | 142.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44868.49      -3436.4328      0              3880.2248    
       100   291.81925     -44881.274      1357.6277     -2425.8645      3880.2248    
       200   271.51088     -44873.719      1658.4148      1203.3651      3880.2248    
       300   290.93695     -44875.016      6833.6574     -1623.6211      3880.2248    
       400   298.43106     -44866.47      -883.38395      1501.9917      3880.2248    
       500   307.35745     -44859.28       7903.4217      975.55753      3880.2248    
       600   308.76503     -44845.034     -3286.651       5153.2034      3880.2248    
       700   305.48298     -44852.347     -4825.7858     -1681.4637      3880.2248    
       800   294.31915     -44878.469      5181.1745      1384.1502      3880.2248    
       900   298.01768     -44884.001     -4621.4798     -4366.9888      3880.2248    
      1000   298.87841     -44869.931      819.96402      482.6009       3880.2248    
      1100   304.09763     -44857.342      485.96556     -425.15852      3880.2248    
      1200   322.3608      -44858.79       8385.3268      4110.9075      3880.2248    
      1300   308.6242      -44848.408      836.85765      2327.5079      3880.2248    
      1400   285.38803     -44867.697      5879.734      -3723.3446      3880.2248    
      1500   301.44569     -44880.038      1563.2688     -2138.0786      3880.2248    
      1600   298.89317     -44861.1        11079.024      2661.522       3880.2248    
      1700   306.45915     -44848.051      14407.259     -603.83231      3880.2248    
      1800   313.41343     -44840.537      3834.6739      2075.8771      3880.2248    
      1900   322.61006     -44837.171     -8754.8229     -564.94318      3880.2248    
      2000   311.31585     -44834.986      3433.5625     -5407.6439      3880.2248    
Loop time of 109.211 on 8 procs for 2000 steps with 386 atoms

Performance: 0.791 ns/day, 30.337 hours/ns, 18.313 timesteps/s, 7.069 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.43      | 76.141     | 91.887     | 144.5 | 69.72
Bond    | 0.00058602 | 0.00078309 | 0.00096906 |   0.0 |  0.00
Neigh   | 5.1575     | 6.2488     | 7.6571     |  42.7 |  5.72
Comm    | 1.1696     | 16.928     | 29.621     | 306.5 | 15.50
Output  | 0.0040793  | 0.0048718  | 0.0054035  |   0.7 |  0.00
Modify  | 8.4386     | 9.8472     | 10.934     |  34.2 |  9.02
Other   |            | 0.04075    |            |       |  0.04

Nlocal:          48.25 ave          55 max          43 min
Histogram: 1 1 1 1 1 1 0 1 0 1
Nghost:        3650.38 ave        3698 max        3606 min
Histogram: 1 1 0 2 0 0 2 1 0 1
Neighs:        33570.8 ave       37951 max       30084 min
Histogram: 1 1 1 1 1 1 0 1 0 1

Total # of neighbors = 268566
Ave neighs/atom = 695.76684
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.2 | 141.5 | 142.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.31585     -44834.986      3433.6223      0              3880.2248    
       100   298.13102     -44832.265     -328.3777       6451.5744      3880.2248    
       200   307.08171     -44872.975      10861.079      7948.9218      3880.2248    
       300   297.2616      -44885.837      5422.0211     -241.41165      3880.2248    
       400   280.89701     -44857.966      455.7488      -5769.8152      3880.2248    
       500   301.83776     -44856.542      135.82723     -2672.5807      3880.2248    
       600   313.81088     -44856.319     -9298.0476      2231.3661      3880.2248    
       700   312.62641     -44864.577     -8415.1364     -160.46538      3880.2248    
       800   298.09622     -44866.994     -2356.9081      4506.2651      3880.2248    
       900   301.00842     -44885.101      2854.0526     -434.92761      3880.2248    
      1000   287.86962     -44889.141      11173.61       420.28948      3880.2248    
      1100   291.08038     -44881.453      2985.4148     -1705.1866      3880.2248    
      1200   309.42657     -44870.064      11422.98      -1667.6564      3880.2248    
      1300   317.34196     -44868.255      5860.3634     -3709.3864      3880.2248    
      1400   299.41837     -44847.991      19419.176      1492.2852      3880.2248    
      1500   295.03304     -44861.552      12336.601     -1612.882       3880.2248    
      1600   266.31687     -44856.413     -2689.1535     -1783.8825      3880.2248    
      1700   279.00176     -44860.792     -4715.2952      2253.6653      3880.2248    
      1800   292.18421     -44852.845      4359.7155      2638.2819      3880.2248    
      1900   301.81067     -44860.074      8350.0474      4211.1087      3880.2248    
      2000   295.51954     -44852.989      6639.7466     -2618.958       3880.2248    
Loop time of 108.665 on 8 procs for 2000 steps with 386 atoms

Performance: 0.795 ns/day, 30.185 hours/ns, 18.405 timesteps/s, 7.104 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.984     | 74.041     | 91.33      | 152.3 | 68.14
Bond    | 0.00060282 | 0.00078368 | 0.00095667 |   0.0 |  0.00
Neigh   | 5.1756     | 6.0816     | 7.5275     |  44.0 |  5.60
Comm    | 1.3378     | 18.597     | 29.629     | 303.7 | 17.11
Output  | 0.00085106 | 0.00095892 | 0.0013559  |   0.0 |  0.00
Modify  | 8.4521     | 9.9067     | 10.807     |  34.7 |  9.12
Other   |            | 0.0371     |            |       |  0.03

Nlocal:          48.25 ave          57 max          41 min
Histogram: 1 0 1 3 0 1 0 0 1 1
Nghost:        3648.62 ave        3687 max        3619 min
Histogram: 1 2 1 0 0 1 1 0 1 1
Neighs:        33585.2 ave       39329 max       28808 min
Histogram: 1 0 2 2 0 1 0 0 1 1

Total # of neighbors = 268682
Ave neighs/atom = 696.06736
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 23.9311384163532
variable C2pos equal ${d2}
variable C2pos equal -30.072699131174
variable C3pos equal ${d3}
variable C3pos equal 13.7792976884204
variable C4pos equal ${d4}
variable C4pos equal -5.91613712423
variable C5pos equal ${d5}
variable C5pos equal -10.4240066474091
variable C6pos equal ${d6}
variable C6pos equal 4.45114593919075

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(3.3406895679678+${C1pos})
variable C14 equal 0.5*(3.3406895679678+23.9311384163532)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(52.234487832673+${C2pos})
variable C24 equal 0.5*(52.234487832673+-30.072699131174)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(80.5033333825023+${C3pos})
variable C34 equal 0.5*(80.5033333825023+13.7792976884204)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(15.3291974709198+${C4pos})
variable C44 equal 0.5*(15.3291974709198+-5.91613712423)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(18.3521802093906+${C5pos})
variable C54 equal 0.5*(18.3521802093906+-10.4240066474091)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-8.43125175120571+${C6pos})
variable C64 equal 0.5*(-8.43125175120571+4.45114593919075)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.341697875269
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.341697875269
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.17341697875269 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.5159656 0.16346323)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.2 | 141.5 | 142.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44872.794     -4520.7596      0              3880.2248    
       100   293.86964     -44886.295     -147.26295     -1741.7783      3880.2248    
       200   263.22647     -44866.379      379.42309      647.18547      3880.2248    
       300   282.69558     -44863.855      18899.462     -2144.3018      3880.2248    
       400   304.19841     -44876.485      5628.9662     -3197.2906      3880.2248    
       500   302.29035     -44862.265     -3479.4767      1861.1716      3880.2248    
       600   305.31785     -44851.509      1023.6396      2455.1427      3880.2248    
       700   325.49347     -44862.756      875.52652     -96.033329      3880.2248    
       800   298.55037     -44845.636      9665.9927      1897.1799      3880.2248    
       900   287.55503     -44866.823      7520.7166     -1916.8316      3880.2248    
      1000   296.4227      -44882.711      5496.8809      743.70551      3880.2248    
      1100   280.90469     -44854.513      3162.6705      3081.6759      3880.2248    
      1200   305.67923     -44847.339      3349.5906      1375.3548      3880.2248    
      1300   312.62917     -44846.424     -1186.9023     -205.90047      3880.2248    
      1400   301.6662      -44847.066      13306.161      7187.2562      3880.2248    
      1500   302.08309     -44863.214      1055.3393     -2306.42        3880.2248    
      1600   300.4316      -44866.866     -3561.8032      279.35793      3880.2248    
      1700   297.57453     -44863.351      4363.3949      1470.9698      3880.2248    
      1800   319.60265     -44861.718      6658.8344      2464.1874      3880.2248    
      1900   315.92451     -44834.69       6578.3165     -1272.6631      3880.2248    
      2000   297.92639     -44829.601     -330.67741      2061.2563      3880.2248    
Loop time of 108.2 on 8 procs for 2000 steps with 386 atoms

Performance: 0.799 ns/day, 30.056 hours/ns, 18.484 timesteps/s, 7.135 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.669     | 73.806     | 91.154     | 150.7 | 68.21
Bond    | 0.00067651 | 0.00078378 | 0.00090308 |   0.0 |  0.00
Neigh   | 5.1349     | 6.0182     | 7.4002     |  43.1 |  5.56
Comm    | 1.1096     | 18.433     | 29.543     | 301.5 | 17.04
Output  | 0.0041783  | 0.0050732  | 0.0056687  |   0.7 |  0.00
Modify  | 8.4895     | 9.9008     | 10.773     |  33.8 |  9.15
Other   |            | 0.0371     |            |       |  0.03

Nlocal:          48.25 ave          57 max          43 min
Histogram: 1 2 1 1 1 0 1 0 0 1
Nghost:        3657.12 ave        3704 max        3620 min
Histogram: 1 1 1 0 3 0 0 1 0 1
Neighs:        33547.6 ave       39321 max       30080 min
Histogram: 1 2 0 2 1 0 1 0 0 1

Total # of neighbors = 268381
Ave neighs/atom = 695.28756
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.2 | 141.5 | 142.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   297.92639     -44829.601     -330.69065      0              3880.2248    
       100   297.84391     -44839.207      19137.701      1514.1351      3880.2248    
       200   284.87574     -44857.208     -5678.2753     -4966.0457      3880.2248    
       300   275.63946     -44851.499      9198.2038      3006.0499      3880.2248    
       400   302.65065     -44869.347     -1412.4325      316.22211      3880.2248    
       500   298.71309     -44853.479     -9712.2386      6924.4628      3880.2248    
       600   293.59521     -44830.93      -10870.325      3836.8174      3880.2248    
       700   294.10636     -44822.415      4843.9633     -1885.3211      3880.2248    
       800   291.38876     -44838.971      20365.041      1204.8339      3880.2248    
       900   287.25612     -44872.695     -1320.4237      64.292704      3880.2248    
      1000   284.26526     -44859.251     -183.42896      4665.5813      3880.2248    
      1100   296.00377     -44841.754     -7491.674       2998.3458      3880.2248    
      1200   301.8045      -44832.741     -8352.1152     -6447.7264      3880.2248    
      1300   324.24681     -44862.881     -4202.2687      1947.8207      3880.2248    
      1400   295.47004     -44859.496      5097.707       849.42239      3880.2248    
      1500   288.12663     -44855.993      4590.8485      4045.8346      3880.2248    
      1600   310.69172     -44873.776     -12519.797      1529.6759      3880.2248    
      1700   294.97657     -44847.115      1003.8369      2017.6576      3880.2248    
      1800   311.45677     -44848.82       22246.173     -1195.4921      3880.2248    
      1900   323.7742      -44844.772      17034.512     -4210.2311      3880.2248    
      2000   298.70918     -44833.835      2995.4677     -1456.241       3880.2248    
Loop time of 108.402 on 8 procs for 2000 steps with 386 atoms

Performance: 0.797 ns/day, 30.112 hours/ns, 18.450 timesteps/s, 7.122 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.583     | 73.932     | 91.228     | 151.8 | 68.20
Bond    | 0.00066419 | 0.00078029 | 0.00089141 |   0.0 |  0.00
Neigh   | 5.1819     | 6.0458     | 7.4799     |  42.9 |  5.58
Comm    | 1.1571     | 18.425     | 29.746     | 304.1 | 17.00
Output  | 0.00079035 | 0.00089445 | 0.0012716  |   0.0 |  0.00
Modify  | 8.5228     | 9.9605     | 10.823     |  33.6 |  9.19
Other   |            | 0.03715    |            |       |  0.03

Nlocal:          48.25 ave          57 max          39 min
Histogram: 1 1 0 1 0 2 1 0 1 1
Nghost:        3630.12 ave        3687 max        3570 min
Histogram: 1 1 1 1 1 0 0 1 0 2
Neighs:        33556.6 ave       39314 max       27320 min
Histogram: 1 1 0 1 0 2 1 0 1 1

Total # of neighbors = 268453
Ave neighs/atom = 695.47409
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -12.1499085130565
variable C2neg equal ${d2}
variable C2neg equal 30.0414903446041
variable C3neg equal ${d3}
variable C3neg equal 29.6466915972479
variable C4neg equal ${d4}
variable C4neg equal 13.6072144337558
variable C5neg equal ${d5}
variable C5neg equal 1.62919862552425
variable C6neg equal ${d6}
variable C6neg equal 10.0247702578236

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.341697875269
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.17341697875269 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.1691316 0.16346323)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.2 | 141.5 | 142.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44872.166     -3950.4863      0              3880.2248    
       100   289.69646     -44880.295      2967.5875     -1934.3727      3880.2248    
       200   277.10923     -44882.044      4329.2309      2043.9112      3880.2248    
       300   283.17179     -44864.673      9987.2945     -4582.5956      3880.2248    
       400   308.41358     -44880.286      9192.7576      1466.6891      3880.2248    
       500   299.76835     -44856.75       4180.4535      4385.8086      3880.2248    
       600   301.87294     -44842.763      5589.9625      4227.7978      3880.2248    
       700   295.8952      -44834.779      5863.0143     -1314.3798      3880.2248    
       800   296.75497     -44865.712      4245.5064      4001.8027      3880.2248    
       900   286.72799     -44873.161     -2883.9897     -4093.0884      3880.2248    
      1000   310.77653     -44888.532     -713.97902     -3555.8419      3880.2248    
      1100   288.39013     -44847.14       17313.342     -263.08793      3880.2248    
      1200   326.34107     -44859.417      10907.798      3218.4669      3880.2248    
      1300   318.64154     -44835.823      14504.811      1865.9624      3880.2248    
      1400   303.72622     -44848.533     -6604.4506      1809.5415      3880.2248    
      1500   298.48662     -44874.064      12816.184      393.65974      3880.2248    
      1600   295.75914     -44874.211      4782.3686     -3367.5167      3880.2248    
      1700   290.91964     -44856.079      1632.1666     -1280.53        3880.2248    
      1800   307.76702     -44845.242      16914.734     -1067.9555      3880.2248    
      1900   316.60079     -44850.376      9235.844      -489.28983      3880.2248    
      2000   289.01735     -44837.118      5309.5502     -1052.5442      3880.2248    
Loop time of 108.774 on 8 procs for 2000 steps with 386 atoms

Performance: 0.794 ns/day, 30.215 hours/ns, 18.387 timesteps/s, 7.097 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.658     | 74.192     | 91.588     | 145.2 | 68.21
Bond    | 0.00066649 | 0.00078197 | 0.00097005 |   0.0 |  0.00
Neigh   | 5.1137     | 5.9743     | 7.3545     |  39.4 |  5.49
Comm    | 1.3434     | 18.714     | 30.22      | 289.0 | 17.20
Output  | 0.0045038  | 0.0054327  | 0.0061447  |   0.8 |  0.00
Modify  | 8.4837     | 9.8488     | 10.706     |  30.8 |  9.05
Other   |            | 0.03801    |            |       |  0.03

Nlocal:          48.25 ave          61 max          43 min
Histogram: 2 1 3 0 0 1 0 0 0 1
Nghost:           3653 ave        3688 max        3618 min
Histogram: 1 0 1 2 1 0 0 1 0 2
Neighs:        33548.9 ave       41875 max       29875 min
Histogram: 2 1 3 0 0 1 0 0 0 1

Total # of neighbors = 268391
Ave neighs/atom = 695.31347
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.2 | 141.5 | 142.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.01735     -44837.118      5309.5249      0              3880.2248    
       100   295.42925     -44841.558      5976.5902      1291.8151      3880.2248    
       200   288.03533     -44846.609      105.14431      1332.5842      3880.2248    
       300   286.89356     -44867.139     -12150.245     -1183.5784      3880.2248    
       400   280.96028     -44867.038      12216.195      4759.0716      3880.2248    
       500   317.50431     -44875.692     -4156.6425     -2265.6892      3880.2248    
       600   300.14076     -44837.796     -5126.7983     -2728.3035      3880.2248    
       700   300.4904      -44835.553     -4562.4997      118.99073      3880.2248    
       800   322.54603     -44876.359      3.5730145      4771.4851      3880.2248    
       900   285.67444     -44865.632     -4552.3439      4538.4719      3880.2248    
      1000   309.40275     -44888.963     -6918.7083      969.89688      3880.2248    
      1100   281.93459     -44848.482      10961.594      3047.9619      3880.2248    
      1200   305.52831     -44852.571     -3695.81       -2157.6709      3880.2248    
      1300   301.69474     -44845.969      10135.775     -1403.9851      3880.2248    
      1400   318.36115     -44869.431      5383.8774     -2951.2453      3880.2248    
      1500   284.62318     -44846.643     -8000.8365      2744.3067      3880.2248    
      1600   301.91857     -44867.906     -5532.6198      1824.9464      3880.2248    
      1700   282.15968     -44845.246      292.18017      3741.9271      3880.2248    
      1800   319.46973     -44857.925      7202.8531      621.87752      3880.2248    
      1900   328.16194     -44841.912      1661.9568     -1504.567       3880.2248    
      2000   312.89721     -44852.34       8231.3046     -127.98132      3880.2248    
Loop time of 105.486 on 8 procs for 2000 steps with 386 atoms

Performance: 0.819 ns/day, 29.302 hours/ns, 18.960 timesteps/s, 7.318 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.336     | 70.997     | 80.923     |  90.4 | 67.30
Bond    | 0.00063439 | 0.00074348 | 0.00094274 |   0.0 |  0.00
Neigh   | 5.1032     | 5.7917     | 6.69       |  25.3 |  5.49
Comm    | 9.1968     | 19.101     | 26.763     | 174.5 | 18.11
Output  | 0.00087448 | 0.00095823 | 0.0012793  |   0.0 |  0.00
Modify  | 8.6797     | 9.5579     | 10.247     |  19.5 |  9.06
Other   |            | 0.03691    |            |       |  0.03

Nlocal:          48.25 ave          62 max          40 min
Histogram: 2 0 1 1 2 1 0 0 0 1
Nghost:        3643.75 ave        3688 max        3609 min
Histogram: 2 1 1 0 0 1 1 0 1 1
Neighs:        33544.1 ave       42571 max       27983 min
Histogram: 2 0 1 1 2 1 0 0 0 1

Total # of neighbors = 268353
Ave neighs/atom = 695.21503
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -1.30868304466836
variable C2pos equal ${d2}
variable C2pos equal -37.3852879316208
variable C3pos equal ${d3}
variable C3pos equal -2.16752237869304
variable C4pos equal ${d4}
variable C4pos equal -6.71195248557546
variable C5pos equal ${d5}
variable C5pos equal 1.25506745285728
variable C6pos equal ${d6}
variable C6pos equal 2.00132396443603

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-12.1499085130565+${C1pos})
variable C15 equal 0.5*(-12.1499085130565+-1.30868304466836)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(30.0414903446041+${C2pos})
variable C25 equal 0.5*(30.0414903446041+-37.3852879316208)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(29.6466915972479+${C3pos})
variable C35 equal 0.5*(29.6466915972479+-2.16752237869304)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(13.6072144337558+${C4pos})
variable C45 equal 0.5*(13.6072144337558+-6.71195248557546)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(1.62919862552425+${C5pos})
variable C55 equal 0.5*(1.62919862552425+1.25506745285728)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(10.0247702578236+${C6pos})
variable C65 equal 0.5*(10.0247702578236+2.00132396443603)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.6621734586495

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.6621734586495
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.136621734586495 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.7310263 -1.3425486 0.16346323)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.5 | 141.8 | 143 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44871.99      -5286.9746      0              3880.2248    
       100   293.62734     -44884.956      218.378       -2965.6009      3880.2248    
       200   273.5         -44878.561     -1810.8989     -101.77965      3880.2248    
       300   285.21568     -44869.019     -2518.4646     -2188.2472      3880.2248    
       400   307.48704     -44882.396      2269.7253      2160.572       3880.2248    
       500   300.51741     -44862.117     -2986.083      -1854.3174      3880.2248    
       600   296.06715     -44842.056      16058.471      3772.2896      3880.2248    
       700   306.78072     -44854.027      10894.141      2488.2136      3880.2248    
       800   293.86383     -44877.77       6651.5854      1957.7157      3880.2248    
       900   287.50926     -44883.888     -3238.5328     -8658.5846      3880.2248    
      1000   303.45013     -44885.084     -1513.6882     -4414.5523      3880.2248    
      1100   274.4204      -44832.496      1177.8755      2792.5617      3880.2248    
      1200   316.89387     -44870.249      4494.0138      2374.0355      3880.2248    
      1300   286.47526     -44844.623      8028.8226      5359.5115      3880.2248    
      1400   287.62166     -44848         -1152.171      -847.49693      3880.2248    
      1500   319.31242     -44880.156      22336.747      4131.8138      3880.2248    
      1600   299.65558     -44870.797     -4088.822      -2951.2939      3880.2248    
      1700   279.41817     -44873.921     -8574.7653      922.6914       3880.2248    
      1800   303.52352     -44887.65       8659.9783      4630.5396      3880.2248    
      1900   306.05513     -44863.14       22411.62       1900.5168      3880.2248    
      2000   308.04637     -44862.276      908.56668     -2488.1068      3880.2248    
Loop time of 92.6946 on 8 procs for 2000 steps with 386 atoms

Performance: 0.932 ns/day, 25.749 hours/ns, 21.576 timesteps/s, 8.328 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.94      | 64.475     | 77.957     |  63.6 | 69.56
Bond    | 0.00059335 | 0.00072468 | 0.00083986 |   0.0 |  0.00
Neigh   | 5.1557     | 5.4285     | 6.6416     |  20.1 |  5.86
Comm    | 0.89214    | 14.392     | 16.93      | 134.9 | 15.53
Output  | 0.0034143  | 0.0041988  | 0.0047024  |   0.7 |  0.00
Modify  | 7.158      | 8.3574     | 8.6299     |  16.0 |  9.02
Other   |            | 0.03685    |            |       |  0.04

Nlocal:          48.25 ave          56 max          42 min
Histogram: 2 0 0 1 1 2 0 1 0 1
Nghost:        3649.25 ave        3700 max        3605 min
Histogram: 1 1 0 2 0 1 2 0 0 1
Neighs:        33561.8 ave       38591 max       29439 min
Histogram: 2 0 0 1 2 1 0 1 0 1

Total # of neighbors = 268494
Ave neighs/atom = 695.58031
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.5 | 141.8 | 143 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.04637     -44862.276      908.55056      0              3880.2248    
       100   299.68541     -44859.308     -10824.593     -7079.3293      3880.2248    
       200   293.20703     -44874.921      9171.106       3796.4971      3880.2248    
       300   292.24706     -44900.368      2676.3956      7327.4355      3880.2248    
       400   283.75449     -44886.454      62.477861      4445.9493      3880.2248    
       500   297.22946     -44860.421      6707.3081     -831.00563      3880.2248    
       600   297.53311     -44857.96       674.16649     -1909.2308      3880.2248    
       700   301.73433     -44860.095      6044.769       2500.3598      3880.2248    
       800   291.85137     -44851.586      7138.8372     -6032.8445      3880.2248    
       900   301.38733     -44865.818      4688.6431     -524.21609      3880.2248    
      1000   301.9968      -44870.786      7128.6509     -1296.4443      3880.2248    
      1100   285.47651     -44856.699      4903.091      -3777.9296      3880.2248    
      1200   280.87235     -44844.572      7059.3735      2489.3834      3880.2248    
      1300   318.35853     -44853.499      11154.539      4273.666       3880.2248    
      1400   294.72378     -44820.521     -2370.1753      2790.1796      3880.2248    
      1500   299.69863     -44848.127     -6739.7702      2807.5479      3880.2248    
      1600   290.37742     -44855.609      2241.6862     -2208.2609      3880.2248    
      1700   281.45968     -44842.971     -16434.009     -1103.8464      3880.2248    
      1800   311.32654     -44875.506     -14882.744     -2636.64        3880.2248    
      1900   283.63394     -44839.956      3142.1286     -2191.057       3880.2248    
      2000   312.24255     -44849.047     -5070.0388      4154.4439      3880.2248    
Loop time of 68.7543 on 8 procs for 2000 steps with 386 atoms

Performance: 1.257 ns/day, 19.098 hours/ns, 29.089 timesteps/s, 11.228 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.468     | 55.574     | 56.307     |   7.9 | 80.83
Bond    | 0.00048977 | 0.00064769 | 0.000767   |   0.0 |  0.00
Neigh   | 5.1618     | 5.2293     | 5.3176     |   2.2 |  7.61
Comm    | 0.58821    | 1.3303     | 2.4445     |  51.1 |  1.93
Output  | 0.00088931 | 0.00096441 | 0.0012602  |   0.0 |  0.00
Modify  | 6.4961     | 6.5819     | 6.6391     |   1.8 |  9.57
Other   |            | 0.03689    |            |       |  0.05

Nlocal:          48.25 ave          58 max          41 min
Histogram: 1 0 2 1 1 2 0 0 0 1
Nghost:        3667.75 ave        3690 max        3642 min
Histogram: 2 0 1 0 0 1 1 0 2 1
Neighs:        33539.2 ave       39844 max       28734 min
Histogram: 1 0 2 1 1 2 0 0 0 1

Total # of neighbors = 268314
Ave neighs/atom = 695.11399
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 44.7003567033656
variable C2neg equal ${d2}
variable C2neg equal 57.2640670430991
variable C3neg equal ${d3}
variable C3neg equal 18.2390582442942
variable C4neg equal ${d4}
variable C4neg equal 7.15923599676537
variable C5neg equal ${d5}
variable C5neg equal 11.8360218588738
variable C6neg equal ${d6}
variable C6neg equal -17.3960143848028

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.5944046 -1.3425486 0.16346323)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.6621734586495
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.136621734586495 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.11519026 -0.10598673 0.0042510624) to (16.49261 13.556187 17.345949) with tilt (-8.4577828 -1.3425486 0.16346323)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139.7 | 141.1 | 142.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.11166     -44872.676     -4378.3932      0              3880.2248    
       100   296.19565     -44888.97       1355.9457     -1218.1359      3880.2248    
       200   269.54454     -44873.337      7647.6348     -266.44358      3880.2248    
       300   295.75671     -44879.605     -4701.8223     -4258.5897      3880.2248    
       400   299.85844     -44870.238      21568.517      4369.9775      3880.2248    
       500   302.27622     -44857.401      353.8956      -1068.0748      3880.2248    
       600   296.91068     -44834.944     -7867.5644      305.59065      3880.2248    
       700   327.79132     -44865.429     -3613.3832      1886.8644      3880.2248    
       800   284.57559     -44852.753      8113.2924      1400.8269      3880.2248    
       900   288.0667      -44869.945      10010.995     -4918.5157      3880.2248    
      1000   296.24454     -44867.01      -490.91627     -1890.2866      3880.2248    
      1100   305.40909     -44848.733     -1610.1246     -1191.0236      3880.2248    
      1200   303.86882     -44838.928      2050.1706      2225.502       3880.2248    
      1300   311.79038     -44856.882     -997.73533      888.93243      3880.2248    
      1400   294.13784     -44854.536      13381.107      6073.4447      3880.2248    
      1500   298.49113     -44871.95       5987.8572     -1655.8778      3880.2248    
      1600   301.76679     -44870.162     -9217.5749     -5162.3242      3880.2248    
      1700   313.32906     -44838.543      15380.288      3423.9189      3880.2248    
      1800   312.1206      -44833.642      6227.5806      4509.9633      3880.2248    
      1900   298.80141     -44841.921      9259.6259      1182.8325      3880.2248    
      2000   296.66744     -44857.642      1716.4345      666.95589      3880.2248    
Loop time of 65.6174 on 8 procs for 2000 steps with 386 atoms

Performance: 1.317 ns/day, 18.227 hours/ns, 30.480 timesteps/s, 11.765 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.301     | 52.483     | 53.302     |   8.5 | 79.98
Bond    | 0.0004811  | 0.0005912  | 0.00070712 |   0.0 |  0.00
Neigh   | 5.0929     | 5.1655     | 5.2585     |   2.3 |  7.87
Comm    | 0.60739    | 1.4296     | 2.6186     |  51.6 |  2.18
Output  | 0.0030898  | 0.0038949  | 0.0044137  |   0.8 |  0.01
Modify  | 6.4092     | 6.4985     | 6.5644     |   1.9 |  9.90
Other   |            | 0.03586    |            |       |  0.05

Nlocal:          48.25 ave          54 max          37 min
Histogram: 1 0 0 0 1 1 0 2 2 1
Nghost:        3636.25 ave        3671 max        3589 min
Histogram: 1 0 1 1 0 1 0 1 2 1
Neighs:        33537.8 ave       37238 max       26030 min
Histogram: 1 0 0 0 1 1 1 1 1 2

Total # of neighbors = 268302
Ave neighs/atom = 695.0829
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139.6 | 141.1 | 142.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.66744     -44857.642      1716.4084      0              3880.2248    
       100   299.25811     -44852.026     -590.50965      2689.8947      3880.2248    
       200   297.02171     -44827.777     -2718.905       374.40235      3880.2248    
       300   329.79592     -44859.488      12897.098      2896.296       3880.2248    
       400   298.64651     -44859.37      -5680.2919      2326.8649      3880.2248    
       500   303.50388     -44873.747     -2895.6263     -2393.0845      3880.2248    
       600   291.10011     -44855.403      4012.3275     -2465.3882      3880.2248    
       700   309.96209     -44855.265     -6891.9433     -1788.1356      3880.2248    
       800   315.03824     -44837.126      7355.3401     -5356.833       3880.2248    
       900   311.17564     -44831.768      3167.3078      3363.5083      3880.2248    
      1000   292.04667     -44854.975      69.052532      2720.7137      3880.2248    
      1100   302.60224     -44876.149      17141.037      4384.2623      3880.2248    
      1200   291.16016     -44858.402     -15171.702     -503.6067       3880.2248    
      1300   314.0366      -44867.904     -9893.4323     -4669.5447      3880.2248    
      1400   307.53127     -44851.884      16848.147      2099.5378      3880.2248    
      1500   313.3901      -44860.957      4446.0388      1154.8963      3880.2248    
      1600   296.21618     -44866.022     -9296.488       7015.9821      3880.2248    
      1700   299.69687     -44870.25       638.83928     -1056.5769      3880.2248    
      1800   302.54395     -44857.498      5125.9979     -2227.5143      3880.2248    
      1900   297.82761     -44821.423      901.57177      110.90074      3880.2248    
      2000   312.67069     -44839.188      1284.5734     -3457.7773      3880.2248    
Loop time of 61.1195 on 8 procs for 2000 steps with 386 atoms

Performance: 1.414 ns/day, 16.978 hours/ns, 32.723 timesteps/s, 12.631 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.155     | 47.582     | 49.018     |  11.9 | 77.85
Bond    | 0.00029768 | 0.00046383 | 0.00055452 |   0.0 |  0.00
Neigh   | 5.0388     | 5.1078     | 5.2475     |   2.7 |  8.36
Comm    | 0.43806    | 1.8809     | 3.3153     |  60.3 |  3.08
Output  | 0.00053363 | 0.00057627 | 0.00083762 |   0.0 |  0.00
Modify  | 6.3546     | 6.5125     | 6.5743     |   2.6 | 10.66
Other   |            | 0.03471    |            |       |  0.06

Nlocal:          48.25 ave          57 max          44 min
Histogram: 3 1 0 2 0 0 1 0 0 1
Nghost:        3630.38 ave        3679 max        3593 min
Histogram: 2 1 1 0 0 0 3 0 0 1
Neighs:          33570 ave       39285 max       30581 min
Histogram: 3 1 0 1 1 0 0 1 0 1

Total # of neighbors = 268560
Ave neighs/atom = 695.7513
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 32.4304745854685
variable C2pos equal ${d2}
variable C2pos equal -37.0259099036459
variable C3pos equal ${d3}
variable C3pos equal -21.9411919614983
variable C4pos equal ${d4}
variable C4pos equal -14.0366142076485
variable C5pos equal ${d5}
variable C5pos equal -13.2267187983294
variable C6pos equal ${d6}
variable C6pos equal 3.96225404527382

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(44.7003567033656+${C1pos})
variable C16 equal 0.5*(44.7003567033656+32.4304745854685)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(57.2640670430991+${C2pos})
variable C26 equal 0.5*(57.2640670430991+-37.0259099036459)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(18.2390582442942+${C3pos})
variable C36 equal 0.5*(18.2390582442942+-21.9411919614983)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(7.15923599676537+${C4pos})
variable C46 equal 0.5*(7.15923599676537+-14.0366142076485)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(11.8360218588738+${C5pos})
variable C56 equal 0.5*(11.8360218588738+-13.2267187983294)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-17.3960143848028+${C6pos})
variable C66 equal 0.5*(-17.3960143848028+3.96225404527382)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 26.7701066821521
variable C22all equal ${C22}
variable C22all equal 3.5199929506532
variable C33all equal ${C33}
variable C33all equal 51.4891810213739

variable C44all equal ${C44}
variable C44all equal 4.7065301733449
variable C55all equal ${C55}
variable C55all equal 1.44213303919076
variable C66all equal ${C66}
variable C66all equal -6.71688016976449

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(3.3782560655264+${C21})
variable C12all equal 0.5*(3.3782560655264+29.9705163370796)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(18.3231376241978+${C31})
variable C13all equal 0.5*(18.3231376241978+7.4120398141059)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(27.3203770695196+${C32})
variable C23all equal 0.5*(27.3203770695196+17.4675968125108)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(13.6359139921605+${C41})
variable C14all equal 0.5*(13.6359139921605+-4.8683760716042)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-6.72929577886243+${C51})
variable C15all equal 0.5*(-6.72929577886243+0.572561636152)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(38.5654156444171+${C61})
variable C16all equal 0.5*(38.5654156444171+2.73892175960704)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(11.0808943507495+${C42})
variable C24all equal 0.5*(11.0808943507495+-1.98234189630123)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-3.67189879350835+${C52})
variable C25all equal 0.5*(-3.67189879350835+3.93132526359933)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(10.1190785697266+${C62})
variable C26all equal 0.5*(10.1190785697266+5.12654995143104)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(47.1413155354614+${C43})
variable C34all equal 0.5*(47.1413155354614+7.08349444154196)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(13.7395846092774+${C53})
variable C35all equal 0.5*(13.7395846092774+8.05364118692979)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-1.85106685860205+${C63})
variable C36all equal 0.5*(-1.85106685860205+9.32923316653773)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(3.44763097409017+${C54})
variable C45all equal 0.5*(3.44763097409017+3.96408678099075)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-3.43868910544156+${C64})
variable C46all equal 0.5*(-3.43868910544156+-1.99005290600748)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-0.695348469727801+${C65})
variable C56all equal 0.5*(-0.695348469727801+6.01304711112981)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:42:56
