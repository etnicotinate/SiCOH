LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-20-VASP-an
read_data       ${structure}.data
read_data       333-HD-100C-20-VASP-an.data
Reading data file ...
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
  reading velocities ...
  366 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              326.3987       4075.8264    
         1   300            0              0              326.3987       4075.8264    
Loop time of 5.82067e-05 on 8 procs for 1 steps with 366 atoms

53.0% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.36e-07   | 2.7362e-07 | 3.14e-07   |   0.0 |  0.47
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.384e-06  | 1.5902e-06 | 1.858e-06  |   0.0 |  2.73
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.634e-05  |            |       | 96.80

Nlocal:          45.75 ave          55 max          38 min
Histogram: 1 2 0 0 1 2 0 0 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137 | 139.1 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -44421.616     -3829.1497      0              1.9519943      3660.7123    
       100   303.2988      -44414.806     -5106.354      -8646.2021      1.9519943      3660.7123    
       200   315.94888     -44405.139     -2306.3483     -2834.4445      1.9519943      3660.7123    
       300   296.63446     -44376.269     -5399.5211     -1880.3549      1.9519943      3660.7123    
       400   299.01035     -44417.584      3665.7381     -3829.2561      1.9519943      3660.7123    
       500   303.99433     -44444.27       2316.088       681.27106      1.9519943      3660.7123    
       600   284.9745      -44421.969     -2125.3134      85.928837      1.9519943      3660.7123    
       700   293.13679     -44417.454     -12060.061     -4257.1628      1.9519943      3660.7123    
       800   313.79714     -44428.633     -9597.4703     -8194.1453      1.9519943      3660.7123    
       900   316.62708     -44412.893     -375.55459     -4460.7598      1.9519943      3660.7123    
      1000   316.68345     -44409.501      2095.2743      3865.8602      1.9519943      3660.7123    
      1100   301.83837     -44430.099      2157.9661     -2778.4821      1.9519943      3660.7123    
      1200   302.3653      -44440.251     -507.9371      -6447.5029      1.9519943      3660.7123    
      1300   289.30522     -44417.784      1465.9281     -1521.8493      1.9519943      3660.7123    
      1400   305.52339     -44416.719     -1980.9824     -2067.0745      1.9519943      3660.7123    
      1500   322.13045     -44422.522     -404.4868      -2550.7405      1.9519943      3660.7123    
      1600   303.4143      -44422.426      231.94464     -1839.9904      1.9519943      3660.7123    
      1700   288.90323     -44432.635     -5685.9205     -5204.1356      1.9519943      3660.7123    
      1800   293.09861     -44438.347     -10519.762     -7839.9586      1.9519943      3660.7123    
      1900   302.66951     -44443.268     -317.07286     -4769.4813      1.9519943      3660.7123    
      2000   299.50471     -44440.091      5097.6084      275.56522      1.9519943      3660.7123    
Loop time of 118.174 on 8 procs for 2000 steps with 366 atoms

Performance: 0.731 ns/day, 32.826 hours/ns, 16.924 timesteps/s, 6.194 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.786     | 93.339     | 100.68     |  78.2 | 78.98
Bond    | 0.00073195 | 0.00085769 | 0.0010152  |   0.0 |  0.00
Neigh   | 5.4912     | 6.6118     | 7.0279     |  20.3 |  5.59
Comm    | 1.8869     | 9.2198     | 25.751     | 248.7 |  7.80
Output  | 0.0011835  | 0.0013011  | 0.001787   |   0.5 |  0.00
Modify  | 8.5323     | 8.9589     | 10.105     |  17.8 |  7.58
Other   |            | 0.04218    |            |       |  0.04

Nlocal:          45.75 ave          59 max          37 min
Histogram: 3 0 0 0 3 0 0 1 0 1
Nghost:        3579.88 ave        3655 max        3522 min
Histogram: 2 0 1 2 0 0 1 1 0 1
Neighs:          32015 ave       40667 max       26139 min
Histogram: 2 1 0 0 3 0 0 1 0 1

Total # of neighbors = 256120
Ave neighs/atom = 699.78142
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-20-VASP-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.923905603898
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4672714795699
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.0701126080387

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-275.565222856733)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-275.565222856733)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-8509.80202981556)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-8509.80202981556)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-5105.3069685499)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-5105.3069685499)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-2573.43810131014)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-2573.43810131014)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--4216.30819283366)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--4216.30819283366)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-887.408722783476)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-887.408722783476)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.923905603898
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.923905603898
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.15923905603898 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.15923905603898 xy delta 0.084375460746531 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.15923905603898 xy delta 0.084375460746531 xz delta -0.00830448823212902 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (15.865164 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (15.865164 13.444836 16.989556) with tilt (-8.3531706 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (15.865164 13.444836 16.989556) with tilt (-8.3531706 0.82214433 -0.31796496)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.2 | 139.9 | 142.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44428.343      42836.94       0              3624.1052    
       100   299.05127     -44435.74      -691.22981      6426.2799      3624.1052    
       200   304.1674      -44459.019      13731.73       5588.836       3624.1052    
       300   298.98067     -44469.193      6257.9524      2452.659       3624.1052    
       400   282.85175     -44453.974      6483.6258      5405.7044      3624.1052    
       500   305.24804     -44439.662      10462.976      4419.5905      3624.1052    
       600   309.95755     -44435.485      21291.187      2565.2875      3624.1052    
       700   300.2067      -44433.968      7607.1043      987.92855      3624.1052    
       800   284.35303     -44434.789      493.78682      2011.3686      3624.1052    
       900   288.57294     -44457.247     -1665.6791      1578.5236      3624.1052    
      1000   284.47951     -44467.167      4415.7949      6202.9646      3624.1052    
      1100   293.56365     -44460.238      9115.7296      5617.853       3624.1052    
      1200   290.25422     -44428.14       15626.708      3316.1905      3624.1052    
      1300   309.83417     -44441.453      967.83741     -989.02375      3624.1052    
      1400   296.06543     -44435.543     -2993.6521      2878.8578      3624.1052    
      1500   294.01666     -44457.569      1907.0144      3596.3945      3624.1052    
      1600   300.03684     -44485.746      3579.5621      1713.1607      3624.1052    
      1700   289.6359      -44459.07       2036.5814      1343.7265      3624.1052    
      1800   308.57276     -44445.471     -8001.1897      3951.7503      3624.1052    
      1900   317.7995      -44458.646      1086.3023      1827.1827      3624.1052    
      2000   295.88683     -44450.012     -5364.9526      6266.5435      3624.1052    
Loop time of 122.064 on 8 procs for 2000 steps with 366 atoms

Performance: 0.708 ns/day, 33.907 hours/ns, 16.385 timesteps/s, 5.997 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 82.541     | 98.1       | 104.85     |  73.8 | 80.37
Bond    | 0.00062085 | 0.00083407 | 0.0010572  |   0.0 |  0.00
Neigh   | 5.8556     | 6.8959     | 7.4789     |  19.8 |  5.65
Comm    | 0.95925    | 7.7163     | 23.278     | 263.3 |  6.32
Output  | 0.0049189  | 0.0059826  | 0.0067214  |   0.8 |  0.00
Modify  | 8.7175     | 9.3013     | 10.345     |  17.1 |  7.62
Other   |            | 0.04303    |            |       |  0.04

Nlocal:          45.75 ave          55 max          36 min
Histogram: 2 0 0 1 1 1 0 0 2 1
Nghost:        3590.88 ave        3663 max        3531 min
Histogram: 1 1 0 3 0 0 1 1 0 1
Neighs:        32356.1 ave       38406 max       26009 min
Histogram: 2 0 0 1 1 1 0 0 2 1

Total # of neighbors = 258849
Ave neighs/atom = 707.2377
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.3 | 139.9 | 142.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.88683     -44450.012     -5364.9249      0              3624.1052    
       100   313.30957     -44474.621     -3349.4557      3914.4689      3624.1052    
       200   269.33955     -44455.633      2554.3667      7651.8257      3624.1052    
       300   276.07884     -44473.104      10061.477      6063.824       3624.1052    
       400   298.0842      -44456.89       6924.217       1347.813       3624.1052    
       500   308.1302      -44461.029      4941.7182     -3224.0692      3624.1052    
       600   311.93931     -44474.605     -142.64001     -3101.5947      3624.1052    
       700   295.85424     -44477.903      4861.0058      2251.0652      3624.1052    
       800   305.34554     -44499.167      6012.5955      7396.2945      3624.1052    
       900   305.8958      -44469.198     -947.53466     -120.38834      3624.1052    
      1000   318.97104     -44461.784     -639.9802       2405.1937      3624.1052    
      1100   295.50372     -44441.683      4203.7931      6064.8663      3624.1052    
      1200   310.0738      -44471.906     -3419.4139      1785.1124      3624.1052    
      1300   284.70946     -44463.823      3342.0917      2564.282       3624.1052    
      1400   298.03282     -44472.86       218.64564      4242.6516      3624.1052    
      1500   314.72036     -44449.571      1037.5686     -904.88607      3624.1052    
      1600   317.67001     -44445.272      9002.4544     -897.40358      3624.1052    
      1700   293.8714      -44445.92       10779.242      3332.3631      3624.1052    
      1800   284.13481     -44454.582     -4094.3932      1411.1445      3624.1052    
      1900   290.8229      -44458.626     -15303.944     -3352.4771      3624.1052    
      2000   310.06213     -44471.673     -7906.2493     -1108.8981      3624.1052    
Loop time of 121.304 on 8 procs for 2000 steps with 366 atoms

Performance: 0.712 ns/day, 33.696 hours/ns, 16.487 timesteps/s, 6.034 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.047     | 98.71      | 103.82     |  76.4 | 81.37
Bond    | 0.00060878 | 0.00084105 | 0.0010736  |   0.0 |  0.00
Neigh   | 5.7264     | 6.9953     | 7.491      |  19.5 |  5.77
Comm    | 1.2236     | 6.3362     | 26.004     | 301.9 |  5.22
Output  | 0.00092408 | 0.0010625  | 0.0018322  |   0.9 |  0.00
Modify  | 8.7156     | 9.2167     | 10.487     |  17.0 |  7.60
Other   |            | 0.04422    |            |       |  0.04

Nlocal:          45.75 ave          54 max          37 min
Histogram: 1 1 0 0 2 2 0 0 0 2
Nghost:        3594.88 ave        3657 max        3540 min
Histogram: 1 1 1 1 1 0 1 0 1 1
Neighs:        32331.5 ave       38030 max       26396 min
Histogram: 1 1 0 0 2 2 0 0 1 1

Total # of neighbors = 258652
Ave neighs/atom = 706.69945
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -14.0280749386903
variable C2neg equal ${d2}
variable C2neg equal -19.3304750462067
variable C3neg equal ${d3}
variable C3neg equal -18.3505244802999
variable C4neg equal ${d4}
variable C4neg equal 10.9905835142853
variable C5neg equal ${d5}
variable C5neg equal -13.0028197874732
variable C6neg equal ${d6}
variable C6neg equal -16.1470088940187

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.923905603898
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.15923905603898 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.15923905603898 xy delta -0.084375460746531 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.15923905603898 xy delta -0.084375460746531 xz delta 0.00830448823212902 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.183642 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.183642 13.444836 16.989556) with tilt (-8.5219215 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.183642 13.444836 16.989556) with tilt (-8.5219215 0.83875331 -0.31796496)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.6 | 138.5 | 140.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44422.649     -30990.676      0              3697.3194    
       100   301.7992      -44429.123     -12903.129     -15980.988      3697.3194    
       200   304.77093     -44439.805      12071.804     -8450.788       3697.3194    
       300   276.02575     -44423.319     -13013.622     -13167.514      3697.3194    
       400   289.45538     -44436.043     -4489.5529     -11172.96       3697.3194    
       500   284.76389     -44398.211     -2749.7686     -12711.616      3697.3194    
       600   317.9381      -44422.924     -6937.8251     -14645.646      3697.3194    
       700   323.52162     -44439.21      -2249.2343     -13526.593      3697.3194    
       800   290.36849     -44424.324     -3359.3069     -17393.586      3697.3194    
       900   294.95869     -44446.149     -474.512       -13213.561      3697.3194    
      1000   299.37033     -44446.952     -7863          -15540.464      3697.3194    
      1100   308.19232     -44444.251     -903.62582     -9696.1471      3697.3194    
      1200   310.5053      -44434.682     -5246.4046     -17450.671      3697.3194    
      1300   300.84746     -44420.393     -6349.6458     -17195.668      3697.3194    
      1400   315.12893     -44430.031     -4609.2109     -14857.842      3697.3194    
      1500   302.99757     -44418.67      -13671.786     -11982.899      3697.3194    
      1600   299.64375     -44428.849     -4967.7966     -13096.212      3697.3194    
      1700   296.47833     -44445.181     -282.77549     -16217.55       3697.3194    
      1800   270.48924     -44425.75      -6167.3816     -11504.489      3697.3194    
      1900   296.62446     -44428.876     -8657.9622     -10404.136      3697.3194    
      2000   308.3202      -44414.709     -6814.697      -14776.759      3697.3194    
Loop time of 118.692 on 8 procs for 2000 steps with 366 atoms

Performance: 0.728 ns/day, 32.970 hours/ns, 16.850 timesteps/s, 6.167 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.984     | 96.692     | 101.46     |  73.8 | 81.46
Bond    | 0.00061682 | 0.00084248 | 0.0010452  |   0.0 |  0.00
Neigh   | 5.746      | 6.9541     | 7.3989     |  18.6 |  5.86
Comm    | 1.215      | 5.9698     | 24.68      | 297.0 |  5.03
Output  | 0.004349   | 0.0053611  | 0.0061058  |   0.8 |  0.00
Modify  | 8.5737     | 9.0263     | 10.236     |  16.3 |  7.60
Other   |            | 0.04319    |            |       |  0.04

Nlocal:          45.75 ave          56 max          38 min
Histogram: 2 1 1 0 0 1 1 1 0 1
Nghost:        3569.62 ave        3630 max        3522 min
Histogram: 2 1 0 1 0 1 0 2 0 1
Neighs:        31715.9 ave       38616 max       26542 min
Histogram: 2 1 0 1 0 1 1 1 0 1

Total # of neighbors = 253727
Ave neighs/atom = 693.24317
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.7 | 138.5 | 140.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.3202      -44414.709     -6814.68        0              3697.3194    
       100   309.83849     -44423.943      4944.8731     -15961.394      3697.3194    
       200   278.40346     -44421.677     -2779.9242     -17893.176      3697.3194    
       300   284.07344     -44441.833     -982.98057     -13188.782      3697.3194    
       400   288.03424     -44436.253     -1716.8924     -17647.465      3697.3194    
       500   302.82141     -44435.963     -3755.5774     -11764.092      3697.3194    
       600   291.95874     -44417.71      -347.33334     -11797.952      3697.3194    
       700   287.71454     -44409.057     -2729.6026     -12748.738      3697.3194    
       800   327.42691     -44436.377     -1183.2405     -8108.0909      3697.3194    
       900   310.35058     -44397.943      1968.967      -8185.799       3697.3194    
      1000   319.32678     -44413.12      -4081.6442     -10448.204      3697.3194    
      1100   309.67681     -44438.151     -10246.817     -10362.488      3697.3194    
      1200   283.3497      -44414.765     -7574.9136     -19103.922      3697.3194    
      1300   289.04706     -44419.656     -6193.1966     -13369.213      3697.3194    
      1400   305.39554     -44429.48      -9587.8309     -13114.642      3697.3194    
      1500   306.19584     -44407.875     -17947.436     -12677.024      3697.3194    
      1600   298.34947     -44383.624     -10096.404     -12421.729      3697.3194    
      1700   296.50737     -44410.366     -14033.406     -16704.508      3697.3194    
      1800   298.27157     -44436.506     -10237.747     -13051.484      3697.3194    
      1900   287.61611     -44423.401     -4529.2636     -13861.69       3697.3194    
      2000   309.23371     -44433.12      -6825.9141     -13660.732      3697.3194    
Loop time of 117.88 on 8 procs for 2000 steps with 366 atoms

Performance: 0.733 ns/day, 32.744 hours/ns, 16.966 timesteps/s, 6.210 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.921     | 94.898     | 100.68     | 109.4 | 80.50
Bond    | 0.00064769 | 0.0008549  | 0.0010533  |   0.0 |  0.00
Neigh   | 4.9562     | 6.8389     | 7.4043     |  28.0 |  5.80
Comm    | 1.2093     | 6.9942     | 34.971     | 403.2 |  5.93
Output  | 0.00087612 | 0.00098118 | 0.0014679  |   0.0 |  0.00
Modify  | 8.5284     | 9.1029     | 10.993     |  24.4 |  7.72
Other   |            | 0.04348    |            |       |  0.04

Nlocal:          45.75 ave          55 max          36 min
Histogram: 2 0 0 1 0 2 0 2 0 1
Nghost:        3576.38 ave        3650 max        3514 min
Histogram: 1 1 1 0 1 2 1 0 0 1
Neighs:        31705.6 ave       37987 max       25266 min
Histogram: 2 0 0 1 0 2 0 2 0 1

Total # of neighbors = 253645
Ave neighs/atom = 693.01913
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 141.209529979723
variable C2pos equal ${d2}
variable C2pos equal 114.760695564639
variable C3pos equal ${d3}
variable C3pos equal 106.822271706182
variable C4pos equal ${d4}
variable C4pos equal 4.58626820127617
variable C5pos equal ${d5}
variable C5pos equal -2.27611679392942
variable C6pos equal ${d6}
variable C6pos equal 3.92819493580312

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-14.0280749386903+${C1pos})
variable C11 equal 0.5*(-14.0280749386903+141.209529979723)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-19.3304750462067+${C2pos})
variable C21 equal 0.5*(-19.3304750462067+114.760695564639)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-18.3505244802999+${C3pos})
variable C31 equal 0.5*(-18.3505244802999+106.822271706182)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(10.9905835142853+${C4pos})
variable C41 equal 0.5*(10.9905835142853+4.58626820127617)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-13.0028197874732+${C5pos})
variable C51 equal 0.5*(-13.0028197874732+-2.27611679392942)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-16.1470088940187+${C6pos})
variable C61 equal 0.5*(-16.1470088940187+3.92819493580312)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4672714795699
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4672714795699
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134672714795699 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134672714795699 yz delta 0.00317964958553157 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.310163 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.310163 16.989556) with tilt (-8.4375461 0.83044882 -0.31478531)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 140.2 | 142.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44426.303      40996.687      0              3624.1052    
       100   294.19729     -44427.897     -3886.5982      82.798085      3624.1052    
       200   306.71853     -44457.807      9335.8981     -623.294        3624.1052    
       300   287.32091     -44453.084      4518.8987     -2175.1313      3624.1052    
       400   279.27133     -44447.553      4681.9901     -828.13271      3624.1052    
       500   297.21279     -44430.577      12526.969      3754.1638      3624.1052    
       600   317.13985     -44438.065      7021.0116     -2213.5363      3624.1052    
       700   310.18381     -44443.935      7617.9139     -7482.5529      3624.1052    
       800   306.01513     -44456.667      5495.405      -3967.9702      3624.1052    
       900   298.96223     -44458.366      1510.0117     -4872.52        3624.1052    
      1000   285.46684     -44455.741      6809.141      -5820.0862      3624.1052    
      1100   288.70403     -44463.797     -2316.8672     -3861.2549      3624.1052    
      1200   310.96025     -44462.459      13625.721     -450.41183      3624.1052    
      1300   318.46266     -44446.186      8749.6389     -4424.3411      3624.1052    
      1400   295.78385     -44423.117     -843.61553     -6092.2671      3624.1052    
      1500   302.45036     -44457.105     -1485.7006     -5956.6307      3624.1052    
      1600   301.04957     -44464.593      5209.5641     -973.61252      3624.1052    
      1700   286.03744     -44447.062      9828.2492     -5608.5329      3624.1052    
      1800   294.40988     -44452.909      1959.5748     -7444.0407      3624.1052    
      1900   291.94998     -44448.369      10016.233     -9596.8735      3624.1052    
      2000   309.27961     -44451.648      1790.8697     -8077.7103      3624.1052    
Loop time of 121.951 on 8 procs for 2000 steps with 366 atoms

Performance: 0.708 ns/day, 33.875 hours/ns, 16.400 timesteps/s, 6.002 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.597     | 98.379     | 104.71     | 110.8 | 80.67
Bond    | 0.00062327 | 0.00084919 | 0.0010383  |   0.0 |  0.00
Neigh   | 5.0663     | 6.9633     | 7.5669     |  28.2 |  5.71
Comm    | 1.0348     | 7.3758     | 36.157     | 404.8 |  6.05
Output  | 0.0048654  | 0.0058919  | 0.0065911  |   0.8 |  0.00
Modify  | 8.5787     | 9.1824     | 11.086     |  24.6 |  7.53
Other   |            | 0.04378    |            |       |  0.04

Nlocal:          45.75 ave          58 max          35 min
Histogram: 2 0 1 0 0 2 1 1 0 1
Nghost:         3608.5 ave        3681 max        3553 min
Histogram: 1 1 2 1 0 0 1 1 0 1
Neighs:          32306 ave       40285 max       25076 min
Histogram: 2 0 1 0 0 2 1 1 0 1

Total # of neighbors = 258448
Ave neighs/atom = 706.14208
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 140.2 | 142.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.27961     -44451.648      1790.9602      0              3624.1052    
       100   313.79234     -44461.276      13359.58      -4494.3091      3624.1052    
       200   266.2159      -44440.297      3881.5817     -6527.8396      3624.1052    
       300   279.1732      -44467.122      5497.4154     -4817.3568      3624.1052    
       400   292.53132     -44464.987      8951.0622     -3635.3927      3624.1052    
       500   298.19818     -44459.328      4946.5938     -6853.451       3624.1052    
       600   303.38852     -44457.968      11215.29      -9455.6008      3624.1052    
       700   316.90296     -44467.256      9140.8636     -6306.5995      3624.1052    
       800   297.10899     -44442.973     -9704.3411     -7104.7389      3624.1052    
       900   303.69192     -44442.014      6146.5806     -4707.4929      3624.1052    
      1000   296.7189      -44425.719      15500.741     -3706.8782      3624.1052    
      1100   306.22345     -44427.975     -6781.5095     -12222.831      3624.1052    
      1200   302.59088     -44448.861      112.66429     -7673.7479      3624.1052    
      1300   278.37881     -44446.975     -790.44876     -5766.3804      3624.1052    
      1400   273.79456     -44434.437      3196.7077     -8230.4473      3624.1052    
      1500   289.38093     -44440.557      6883.9087     -3533.0427      3624.1052    
      1600   317.89585     -44471.031      16660.277      1334.4811      3624.1052    
      1700   294.61639     -44450.202     -10743.329     -7093.5897      3624.1052    
      1800   308.73325     -44475.552      3827.5742     -3016.7842      3624.1052    
      1900   289.06395     -44494.463      1815.8039     -5126.2068      3624.1052    
      2000   284.76431     -44479.84      -5012.3432     -9604.263       3624.1052    
Loop time of 123.702 on 8 procs for 2000 steps with 366 atoms

Performance: 0.698 ns/day, 34.362 hours/ns, 16.168 timesteps/s, 5.917 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.619     | 97.121     | 104.91     |  61.6 | 78.51
Bond    | 0.00077077 | 0.00085723 | 0.0010045  |   0.0 |  0.00
Neigh   | 6.2112     | 6.9651     | 7.4942     |  16.3 |  5.63
Comm    | 1.8462     | 9.6403     | 20.107     | 195.8 |  7.79
Output  | 0.00090785 | 0.0011591  | 0.00256    |   1.6 |  0.00
Modify  | 9.3949     | 9.9274     | 10.721     |  13.8 |  8.03
Other   |            | 0.04713    |            |       |  0.04

Nlocal:          45.75 ave          56 max          33 min
Histogram: 1 0 0 1 1 2 0 1 1 1
Nghost:        3605.38 ave        3661 max        3560 min
Histogram: 1 0 3 0 1 1 0 0 1 1
Neighs:        32324.2 ave       39411 max       23644 min
Histogram: 1 0 0 1 1 2 0 1 1 1

Total # of neighbors = 258594
Ave neighs/atom = 706.54098
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -100.107359377123
variable C2neg equal ${d2}
variable C2neg equal -32.3177516674395
variable C3neg equal ${d3}
variable C3neg equal -24.6116208220666
variable C4neg equal ${d4}
variable C4neg equal -14.5103065063399
variable C5neg equal ${d5}
variable C5neg equal -9.91388206391112
variable C6neg equal ${d6}
variable C6neg equal -20.4595660781856

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4672714795699
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.134672714795699 yz delta ${deltayz} remap units box
change_box all y delta 0 0.134672714795699 yz delta -0.00317964958553157 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.579508 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.579508 16.989556) with tilt (-8.4375461 0.83044882 -0.32114461)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.3 | 138.4 | 140.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44424.382     -32477.684      0              3697.3194    
       100   315.19222     -44447.321     -12603.77      -9626.6675      3697.3194    
       200   309.76589     -44450.52       11688.586     -4937.8237      3697.3194    
       300   294.26577     -44445.7       -5935.113      -6968.6599      3697.3194    
       400   296.82577     -44451.517     -3155.0543     -6830.2462      3697.3194    
       500   291.90114     -44425.764     -2897.974      -5667.8445      3697.3194    
       600   301.0229      -44412.703     -4324.9297     -9969.3886      3697.3194    
       700   310.7674      -44425.718     -2889.1105     -10321.967      3697.3194    
       800   307.38265     -44450.512     -17357.301     -11431.057      3697.3194    
       900   295.94746     -44470.62      -9279.5242     -8765.2195      3697.3194    
      1000   285.0704      -44452.707     -8168.8513     -8112.0253      3697.3194    
      1100   308.61762     -44456.953     -4316.7333     -5438.3361      3697.3194    
      1200   301.01788     -44436.41      -792.28339     -4922.0566      3697.3194    
      1300   314.44597     -44443.195     -6691.9744     -11849.772      3697.3194    
      1400   302.88108     -44426.123     -10599.743     -8588.2183      3697.3194    
      1500   304.06411     -44424.607      10594.944     -7563.5456      3697.3194    
      1600   291.88487     -44436.272      3944.9939     -376.35745      3697.3194    
      1700   288.60194     -44448.543     -6309.2011     -5977.228       3697.3194    
      1800   302.00221     -44454.771      3088.9362     -8419.9406      3697.3194    
      1900   303.13869     -44428.828     -11802.286     -7822.602       3697.3194    
      2000   307.43547     -44410.397     -5417.5484     -6337.0039      3697.3194    
Loop time of 116.502 on 8 procs for 2000 steps with 366 atoms

Performance: 0.742 ns/day, 32.362 hours/ns, 17.167 timesteps/s, 6.283 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.023     | 89.681     | 99.292     | 112.6 | 76.98
Bond    | 0.00072435 | 0.00084753 | 0.0010325  |   0.0 |  0.00
Neigh   | 5.0512     | 6.4017     | 7.0082     |  27.8 |  5.49
Comm    | 1.567      | 11.187     | 31.822     | 318.5 |  9.60
Output  | 0.0054548  | 0.0064812  | 0.0072423  |   0.8 |  0.01
Modify  | 8.5779     | 9.1825     | 10.561     |  23.5 |  7.88
Other   |            | 0.04229    |            |       |  0.04

Nlocal:          45.75 ave          56 max          38 min
Histogram: 2 0 1 2 0 1 0 0 0 2
Nghost:        3578.38 ave        3631 max        3535 min
Histogram: 1 0 2 1 1 0 1 1 0 1
Neighs:        31666.6 ave       38288 max       26487 min
Histogram: 2 0 0 3 0 1 0 0 0 2

Total # of neighbors = 253333
Ave neighs/atom = 692.16667
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.4 | 138.4 | 140.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.43547     -44410.397     -5417.7199      0              3697.3194    
       100   314.83732     -44433.718     -12428.093     -4435.7635      3697.3194    
       200   283.36789     -44431.234     -14962.141     -9579.9251      3697.3194    
       300   302.18831     -44455.113      2162.9088     -12965.846      3697.3194    
       400   306.91999     -44456.609     -1612.2456     -7775.0913      3697.3194    
       500   300.15236     -44435.414     -9448.3161     -9749.4444      3697.3194    
       600   333.84836     -44444.925      226.42076     -1856.4254      3697.3194    
       700   315.95093     -44421.081     -6462.8779     -7817.0282      3697.3194    
       800   293.97554     -44439.111      124.39422     -4559.9966      3697.3194    
       900   287.18891     -44443.946     -1679.2972     -7296.0547      3697.3194    
      1000   288.99695     -44434.436     -272.78227     -4583.7345      3697.3194    
      1100   321.70638     -44448.663     -12312.902     -11467.705      3697.3194    
      1200   293.68762     -44414.341     -6569.8817     -4136.77        3697.3194    
      1300   308.18804     -44438.802     -14005.456     -7579.2627      3697.3194    
      1400   300.92663     -44459.89      -9626.6592     -1826.9718      3697.3194    
      1500   279.59601     -44444.123     -3987.8233     -4884.0591      3697.3194    
      1600   307.43148     -44453.703     -51.214157     -8516.1111      3697.3194    
      1700   307.46934     -44428.607     -7770.1982     -8562.3491      3697.3194    
      1800   322.13451     -44432.748     -351.94631     -1423.0357      3697.3194    
      1900   308.1195      -44447.645      3690.6673     -6710.7576      3697.3194    
      2000   292.34126     -44460.472     -7648.0926     -8714.7844      3697.3194    
Loop time of 116.095 on 8 procs for 2000 steps with 366 atoms

Performance: 0.744 ns/day, 32.249 hours/ns, 17.227 timesteps/s, 6.305 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.372     | 86.428     | 99.335     | 134.0 | 74.45
Bond    | 0.00073851 | 0.00089029 | 0.0011198  |   0.0 |  0.00
Neigh   | 4.9996     | 6.1948     | 7.0511     |  33.4 |  5.34
Comm    | 1.2592     | 14.174     | 31.231     | 331.0 | 12.21
Output  | 0.00082782 | 0.00097818 | 0.001726   |   0.0 |  0.00
Modify  | 8.3831     | 9.2546     | 10.458     |  27.4 |  7.97
Other   |            | 0.04157    |            |       |  0.04

Nlocal:          45.75 ave          55 max          38 min
Histogram: 2 0 1 0 2 1 0 0 1 1
Nghost:         3561.5 ave        3630 max        3515 min
Histogram: 1 1 2 1 0 0 2 0 0 1
Neighs:        31695.8 ave       37577 max       26557 min
Histogram: 2 0 1 0 2 1 0 0 0 2

Total # of neighbors = 253566
Ave neighs/atom = 692.80328
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 91.0947174955841
variable C2pos equal ${d2}
variable C2pos equal 91.4375416466097
variable C3pos equal ${d3}
variable C3pos equal 98.0086425035045
variable C4pos equal ${d4}
variable C4pos equal 5.25108959973115
variable C5pos equal ${d5}
variable C5pos equal -5.73224031157924
variable C6pos equal ${d6}
variable C6pos equal 1.02960274936312

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-100.107359377123+${C1pos})
variable C12 equal 0.5*(-100.107359377123+91.0947174955841)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-32.3177516674395+${C2pos})
variable C22 equal 0.5*(-32.3177516674395+91.4375416466097)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-24.6116208220666+${C3pos})
variable C32 equal 0.5*(-24.6116208220666+98.0086425035045)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-14.5103065063399+${C4pos})
variable C42 equal 0.5*(-14.5103065063399+5.25108959973115)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-9.91388206391112+${C5pos})
variable C52 equal 0.5*(-9.91388206391112+-5.73224031157924)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-20.4595660781856+${C6pos})
variable C62 equal 0.5*(-20.4595660781856+1.02960274936312)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0701126080387
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0701126080387
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.170701126080387 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.818855) with tilt (-8.4375461 0.83044882 -0.31796496)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 140.2 | 142.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44420.897      42289.453      0              3624.1052    
       100   300.82308     -44432.799      2361.5891      37.621637      3624.1052    
       200   302.15253     -44457.301      14296.857      700.08782      3624.1052    
       300   295.89939     -44461.938      10321.353     -903.91473      3624.1052    
       400   304.02862     -44447.99       15102.543      3329.1191      3624.1052    
       500   309.09134     -44424.683      6602.454       3207.7531      3624.1052    
       600   307.91184     -44424.608      13121.047     -600.97737      3624.1052    
       700   291.46821     -44423.621     -2659.1222     -1582.5671      3624.1052    
       800   296.83862     -44449.106      3966.3834      2677.6002      3624.1052    
       900   291.12664     -44446.737      3006.8777     -686.65419      3624.1052    
      1000   309.8584      -44429.42       4967.388      -4956.871       3624.1052    
      1100   290.08097     -44396.987      3111.4876     -1265.3135      3624.1052    
      1200   303.04758     -44414.746      11636.895      889.95251      3624.1052    
      1300   289.4862      -44433.737      16137.247      2731.5473      3624.1052    
      1400   297.82365     -44450.514     -6737.6131     -1167.5642      3624.1052    
      1500   300.51598     -44446.539      6035.798      -1452.7145      3624.1052    
      1600   297.96918     -44430.043      13634.274      3918.2656      3624.1052    
      1700   309.75048     -44415.094      6381.7699     -3547.5731      3624.1052    
      1800   318.3016      -44394.522      2783.5377     -238.72421      3624.1052    
      1900   329.53863     -44423.999      13089.929      2782.0733      3624.1052    
      2000   312.4535      -44429.163      19781.132     -1227.3478      3624.1052    
Loop time of 119.951 on 8 procs for 2000 steps with 366 atoms

Performance: 0.720 ns/day, 33.320 hours/ns, 16.674 timesteps/s, 6.103 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.482     | 93.437     | 102.2      | 114.9 | 77.90
Bond    | 0.00077275 | 0.00084943 | 0.00099236 |   0.0 |  0.00
Neigh   | 4.95       | 6.5869     | 7.2559     |  29.9 |  5.49
Comm    | 1.8742     | 10.643     | 34.605     | 340.5 |  8.87
Output  | 0.0044081  | 0.0055146  | 0.006296   |   0.9 |  0.00
Modify  | 8.5564     | 9.2334     | 10.869     |  25.2 |  7.70
Other   |            | 0.0436     |            |       |  0.04

Nlocal:          45.75 ave          53 max          38 min
Histogram: 2 0 0 1 0 1 1 0 2 1
Nghost:        3604.88 ave        3655 max        3563 min
Histogram: 2 0 0 2 1 0 1 0 1 1
Neighs:          32373 ave       36985 max       27317 min
Histogram: 2 0 0 1 0 1 1 1 1 1

Total # of neighbors = 258984
Ave neighs/atom = 707.60656
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.9 | 140.2 | 142.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.4535      -44429.163      19781.016      0              3624.1052    
       100   297.33936     -44423.193      7097.0415      2757.3713      3624.1052    
       200   286.02572     -44433.475      7808.4228      1635.0382      3624.1052    
       300   282.13619     -44450.388      8622.2486      4390.4341      3624.1052    
       400   292.0108      -44440.624      7458.3305     -313.9827       3624.1052    
       500   306.48986     -44424.201      367.12925     -3843.7764      3624.1052    
       600   300.91117     -44418.562      15032.669      183.07221      3624.1052    
       700   304.46011     -44433.17       9608.0561     -808.76024      3624.1052    
       800   293.18956     -44447.036      5134.3396     -455.77267      3624.1052    
       900   293.87624     -44453.602      1164.7161      21.530159      3624.1052    
      1000   289.67565     -44427.873      6685.331       874.48832      3624.1052    
      1100   314.80109     -44425.627      13785.024     -208.56513      3624.1052    
      1200   306.43635     -44423.292      7678.5085      2474.2192      3624.1052    
      1300   295.98784     -44434.879      12047.801      1881.9996      3624.1052    
      1400   292.51959     -44446.455     -398.33214     -84.713236      3624.1052    
      1500   296.01919     -44445.251      3447.2532     -1473.8841      3624.1052    
      1600   303.78073     -44410.29       351.61387     -3304.0995      3624.1052    
      1700   300.90021     -44401.233      8819.7931      2418.9684      3624.1052    
      1800   298.40991     -44418.807      8966.0213      3441.5838      3624.1052    
      1900   295.03149     -44435.797      4437.9689     -786.71905      3624.1052    
      2000   298.51924     -44435.666      7441.3672     -1745.0564      3624.1052    
Loop time of 122.361 on 8 procs for 2000 steps with 366 atoms

Performance: 0.706 ns/day, 33.989 hours/ns, 16.345 timesteps/s, 5.982 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.882     | 102.07     | 105.04     |  14.7 | 83.42
Bond    | 0.00076294 | 0.00085818 | 0.0010438  |   0.0 |  0.00
Neigh   | 6.9759     | 7.1547     | 7.5453     |   6.1 |  5.85
Comm    | 0.9626     | 3.9229     | 6.1362     |  74.9 |  3.21
Output  | 0.00095675 | 0.0010544  | 0.0015861  |   0.6 |  0.00
Modify  | 8.7558     | 9.1629     | 9.3457     |   5.7 |  7.49
Other   |            | 0.04402    |            |       |  0.04

Nlocal:          45.75 ave          56 max          35 min
Histogram: 1 0 1 1 2 0 1 0 0 2
Nghost:        3608.88 ave        3675 max        3561 min
Histogram: 1 2 0 0 2 1 1 0 0 1
Neighs:        32323.1 ave       38993 max       25087 min
Histogram: 1 0 0 2 2 0 1 0 0 2

Total # of neighbors = 258585
Ave neighs/atom = 706.51639
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -20.4739485399628
variable C2neg equal ${d2}
variable C2neg equal 22.6599906167645
variable C3neg equal ${d3}
variable C3neg equal 48.1684806936217
variable C4neg equal ${d4}
variable C4neg equal -4.07648327245954
variable C5neg equal ${d5}
variable C5neg equal -7.99894829376791
variable C6neg equal ${d6}
variable C6neg equal -24.1292743289421

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0701126080387
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.170701126080387 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 17.160257) with tilt (-8.4375461 0.83044882 -0.31796496)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136 | 138.4 | 140.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44429.152     -32374.6        0              3697.3194    
       100   308.26271     -44442.065     -10933.379     -8828.6707      3697.3194    
       200   310.4209      -44445.658      11933.512     -5738.1397      3697.3194    
       300   285.50521     -44432.583     -10399.118     -8555.3183      3697.3194    
       400   276.28778     -44432.853     -801.79729     -7716.9238      3697.3194    
       500   283.8746      -44425.591     -4965.1803     -8566.6596      3697.3194    
       600   305.60328     -44417.296     -12464.093     -11708.251      3697.3194    
       700   300.25077     -44409.53      -2566.2075     -8096.5978      3697.3194    
       800   314.49117     -44430.09       3712.9069     -8006.3028      3697.3194    
       900   294.55254     -44439.604     -4371.5071     -14700.305      3697.3194    
      1000   294.81025     -44458.673     -18379.47      -8480.4083      3697.3194    
      1100   284.19445     -44440.912     -10694.534     -639.50453      3697.3194    
      1200   291.78258     -44422.835     -4678.7187     -3374.179       3697.3194    
      1300   314.92764     -44440.54      -1885.4773     -9699.5517      3697.3194    
      1400   293.18448     -44419.827      582.30001     -5003.048       3697.3194    
      1500   293.77381     -44435.246      681.29964     -7430.8542      3697.3194    
      1600   300.28479     -44472.496     -5306.9133     -6888.4381      3697.3194    
      1700   283.0429      -44460.366     -8276.4777     -10313.739      3697.3194    
      1800   301.37389     -44460.292      7569.6751     -4188.9936      3697.3194    
      1900   308.60995     -44456.729      2760.1834     -3412.5193      3697.3194    
      2000   293.67472     -44433.717      7524.1786     -3747.5986      3697.3194    
Loop time of 119.881 on 8 procs for 2000 steps with 366 atoms

Performance: 0.721 ns/day, 33.300 hours/ns, 16.683 timesteps/s, 6.106 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.503     | 98.788     | 102.88     |  22.1 | 82.40
Bond    | 0.00076903 | 0.00086145 | 0.0010238  |   0.0 |  0.00
Neigh   | 6.8847     | 7.0072     | 7.4604     |   6.8 |  5.85
Comm    | 0.82351    | 4.9117     | 8.2256     |  99.5 |  4.10
Output  | 0.0046569  | 0.0058809  | 0.0066873  |   0.9 |  0.00
Modify  | 8.6615     | 9.1249     | 9.2446     |   6.0 |  7.61
Other   |            | 0.04301    |            |       |  0.04

Nlocal:          45.75 ave          56 max          36 min
Histogram: 1 0 1 2 0 2 0 0 0 2
Nghost:        3577.38 ave        3662 max        3508 min
Histogram: 2 0 0 2 1 1 0 0 1 1
Neighs:        31690.4 ave       38538 max       25092 min
Histogram: 1 0 2 1 1 1 0 0 0 2

Total # of neighbors = 253523
Ave neighs/atom = 692.68579
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.1 | 138.4 | 140.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.67472     -44433.717      7524.3858      0              3697.3194    
       100   293.28434     -44432.308     -12089.104     -3440.2683      3697.3194    
       200   310.72881     -44437.397     -9480.0108     -5634.2687      3697.3194    
       300   314.11562     -44417.934     -2207.7648     -8678.968       3697.3194    
       400   315.27204     -44425.433      1990.5712     -4583.5528      3697.3194    
       500   298.27881     -44445.003      886.6529      -6942.9879      3697.3194    
       600   293.85157     -44445.003     -4736.9735     -12346.273      3697.3194    
       700   297.88334     -44449.759     -2320.9508     -7422.8075      3697.3194    
       800   312.50011     -44469.701     -737.45047     -6961.0399      3697.3194    
       900   300.47113     -44467.202     -12307.093     -9414.9825      3697.3194    
      1000   290.95014     -44464.475      1721.54       -6041.0807      3697.3194    
      1100   289.30586     -44451.155      7280.4915     -6093.7912      3697.3194    
      1200   308.01508     -44439.761     -8601.1232     -5003.1225      3697.3194    
      1300   310.18957     -44436.062      5532.8334     -9837.1196      3697.3194    
      1400   304.0688      -44450.273      6222.7417     -3552.6886      3697.3194    
      1500   308.83136     -44470.334      4676.0651     -11124.963      3697.3194    
      1600   300.53772     -44460.962     -3017.59       -6987.8845      3697.3194    
      1700   287.1276      -44444.543     -540.72019     -6599.4359      3697.3194    
      1800   316.05808     -44451.291      1424.187      -6445.4692      3697.3194    
      1900   321.49353     -44429.639     -10244.316     -5015.2166      3697.3194    
      2000   329.15346     -44459.859     -3164.7457     -7969.3365      3697.3194    
Loop time of 117.942 on 8 procs for 2000 steps with 366 atoms

Performance: 0.733 ns/day, 32.762 hours/ns, 16.957 timesteps/s, 6.206 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.203     | 94.982     | 100.65     | 108.4 | 80.53
Bond    | 0.00074891 | 0.00085129 | 0.0010059  |   0.0 |  0.00
Neigh   | 4.8955     | 6.7457     | 7.1767     |  27.2 |  5.72
Comm    | 1.4909     | 7.1551     | 34.945     | 394.9 |  6.07
Output  | 0.00089852 | 0.0010606  | 0.001779   |   0.8 |  0.00
Modify  | 8.5715     | 9.0142     | 10.861     |  23.5 |  7.64
Other   |            | 0.04266    |            |       |  0.04

Nlocal:          45.75 ave          55 max          39 min
Histogram: 2 1 0 1 1 1 0 0 1 1
Nghost:        3592.12 ave        3648 max        3543 min
Histogram: 1 1 1 0 1 0 3 0 0 1
Neighs:        31684.1 ave       37571 max       27192 min
Histogram: 2 0 1 1 1 1 0 0 0 2

Total # of neighbors = 253473
Ave neighs/atom = 692.54918
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 83.5414662561291
variable C2pos equal ${d2}
variable C2pos equal 73.9626234790908
variable C3pos equal ${d3}
variable C3pos equal 87.8824888217681
variable C4pos equal ${d4}
variable C4pos equal 5.21845546175985
variable C5pos equal ${d5}
variable C5pos equal -23.4098914803064
variable C6pos equal ${d6}
variable C6pos equal -2.26326989172108

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-20.4739485399628+${C1pos})
variable C13 equal 0.5*(-20.4739485399628+83.5414662561291)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(22.6599906167645+${C2pos})
variable C23 equal 0.5*(22.6599906167645+73.9626234790908)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(48.1684806936217+${C3pos})
variable C33 equal 0.5*(48.1684806936217+87.8824888217681)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-4.07648327245954+${C4pos})
variable C43 equal 0.5*(-4.07648327245954+5.21845546175985)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-7.99894829376791+${C5pos})
variable C53 equal 0.5*(-7.99894829376791+-23.4098914803064)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-24.1292743289421+${C6pos})
variable C63 equal 0.5*(-24.1292743289421+-2.26326989172108)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0701126080387
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0701126080387
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.170701126080387 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.48866608)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44433.944      6012.9216      0              3660.7123    
       100   299.78863     -44435.678     -3753.3301     -4800.3607      3660.7123    
       200   310.96526     -44447.242      11485.487     -823.04601      3660.7123    
       300   280.05042     -44422.568     -712.20076     -3701.9493      3660.7123    
       400   285.46421     -44444.879     -6644.1664     -5083.5991      3660.7123    
       500   303.54443     -44464.091     -1728.9803     -1110.2528      3660.7123    
       600   299.0371      -44431.661     -1322.0109     -8796.9888      3660.7123    
       700   302.63677     -44420.332     -4030.0209     -9770.5446      3660.7123    
       800   309.91129     -44434.434      1788.1514     -3708.9321      3660.7123    
       900   292.74328     -44454.413     -1070.4623     -8336.6414      3660.7123    
      1000   271.24062     -44446.809      2091.0782     -3043.3467      3660.7123    
      1100   296.60947     -44463.119      853.30973     -5510.9096      3660.7123    
      1200   296.99894     -44438.79       5209.5399     -1311.3427      3660.7123    
      1300   301.08192     -44434.996      4281.343      -3081.2856      3660.7123    
      1400   304.87059     -44441.15      -9692.8709     -7600.5164      3660.7123    
      1500   294.46008     -44438.065     -58.28785      -6383.3867      3660.7123    
      1600   282.74755     -44433.962     -6217.051      -8052.2409      3660.7123    
      1700   285.19597     -44449.034      1641.5818     -5386.1619      3660.7123    
      1800   283.753       -44454.027     -1198.6777     -4229.652       3660.7123    
      1900   298.39608     -44453.04       4715.5898     -1003.8454      3660.7123    
      2000   295.19102     -44425.28       22864.998      2301.5548      3660.7123    
Loop time of 119.542 on 8 procs for 2000 steps with 366 atoms

Performance: 0.723 ns/day, 33.206 hours/ns, 16.731 timesteps/s, 6.123 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.649     | 97.206     | 102.21     |  83.5 | 81.32
Bond    | 0.00074614 | 0.00085537 | 0.00104    |   0.0 |  0.00
Neigh   | 5.4604     | 6.8634     | 7.1776     |  20.4 |  5.74
Comm    | 1.4218     | 6.4138     | 27.982     | 325.3 |  5.37
Output  | 0.0051544  | 0.0062172  | 0.0070067  |   0.8 |  0.01
Modify  | 8.6863     | 9.0083     | 10.405     |  17.8 |  7.54
Other   |            | 0.04285    |            |       |  0.04

Nlocal:          45.75 ave          56 max          39 min
Histogram: 2 2 0 0 2 0 0 0 0 2
Nghost:        3586.88 ave        3667 max        3516 min
Histogram: 2 0 1 1 0 1 1 0 1 1
Neighs:        32040.5 ave       38953 max       27768 min
Histogram: 2 2 0 1 1 0 0 0 0 2

Total # of neighbors = 256324
Ave neighs/atom = 700.3388
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.19102     -44425.28       22865.016      0              3660.7123    
       100   313.71219     -44447.408     -8981.7657     -3639.9484      3660.7123    
       200   302.66805     -44456.547     -6952.8144     -5587.1303      3660.7123    
       300   281.63363     -44455.4       -1624.0197     -6311.1034      3660.7123    
       400   285.8711      -44442.352      1523.1668     -3153.7065      3660.7123    
       500   296.37529     -44430.089     -3945.5089     -5615.8686      3660.7123    
       600   314.44267     -44449.259     -7123.3234     -3003.8706      3660.7123    
       700   298.86023     -44448.096     -5555.5281     -1665.7813      3660.7123    
       800   293.64236     -44464.101     -1643.308      -6380.8791      3660.7123    
       900   280.72414     -44455.643     -701.53416      138.82505      3660.7123    
      1000   309.23743     -44443.007     -2451.027      -4165.7672      3660.7123    
      1100   315.63376     -44442.758     -9748.66       -6732.639       3660.7123    
      1200   297.65624     -44437.141     -134.74852     -2487.7559      3660.7123    
      1300   303.7459      -44469.037     -10382.199     -8952.5527      3660.7123    
      1400   283.524       -44462.105      2927.7486     -8591.0667      3660.7123    
      1500   290.62325     -44457.295     -3812.6939     -3853.6447      3660.7123    
      1600   299.63422     -44452.94       4981.6506      1391.2986      3660.7123    
      1700   303.35142     -44448.199     -4921.2358      314.26764      3660.7123    
      1800   308.02212     -44452.003      1950.9659     -4565.3513      3660.7123    
      1900   287.86628     -44437.305      447.07448     -393.82136      3660.7123    
      2000   297.32295     -44478.358     -13600.338     -8560.487       3660.7123    
Loop time of 119.702 on 8 procs for 2000 steps with 366 atoms

Performance: 0.722 ns/day, 33.250 hours/ns, 16.708 timesteps/s, 6.115 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.487     | 96.96      | 102.33     |  75.3 | 81.00
Bond    | 0.00075408 | 0.00084739 | 0.00095992 |   0.0 |  0.00
Neigh   | 5.6446     | 6.8586     | 7.1682     |  18.3 |  5.73
Comm    | 1.4157     | 6.7794     | 25.264     | 285.1 |  5.66
Output  | 0.00094152 | 0.0010797  | 0.0018573  |   0.9 |  0.00
Modify  | 8.7389     | 9.0595     | 10.266     |  15.8 |  7.57
Other   |            | 0.04248    |            |       |  0.04

Nlocal:          45.75 ave          56 max          35 min
Histogram: 1 0 2 0 1 1 1 0 0 2
Nghost:        3574.75 ave        3634 max        3528 min
Histogram: 2 1 1 0 0 1 0 1 1 1
Neighs:        32003.6 ave       38898 max       25018 min
Histogram: 1 0 2 0 1 2 0 0 0 2

Total # of neighbors = 256029
Ave neighs/atom = 699.53279
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -89.5312996075428
variable C2neg equal ${d2}
variable C2neg equal -129.834745057135
variable C3neg equal ${d3}
variable C3neg equal -97.5294230027012
variable C4neg equal ${d4}
variable C4neg equal 16.7860032556571
variable C5neg equal ${d5}
variable C5neg equal -1.48632395178885
variable C6neg equal ${d6}
variable C6neg equal -3.03177721214091

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0701126080387
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.170701126080387 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.14726383)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44437.613      4298.5867      0              3660.7123    
       100   297.70921     -44437.105     -5463.6224     -4652.5872      3660.7123    
       200   313.97043     -44453.582      7834.3455     -4491.0793      3660.7123    
       300   294.28888     -44431.775      736.93984     -6810.8736      3660.7123    
       400   300.9962      -44436.043     -548.9745      -4036.5372      3660.7123    
       500   300.79213     -44419.198      5537.1413     -3133.5466      3660.7123    
       600   308.31047     -44418.549     -5999.5285     -8767.162       3660.7123    
       700   301.428       -44429.187     -9201.3428     -11708.519      3660.7123    
       800   301.62603     -44458.014      5134.3501     -8766.5876      3660.7123    
       900   288.92949     -44445.651      1460.3871     -11827.84       3660.7123    
      1000   301.08331     -44445.729     -2987.1434     -4374.823       3660.7123    
      1100   324.37277     -44436.817      3755.26       -5326.9921      3660.7123    
      1200   306.0655      -44400.28       1328.2796     -3382.2113      3660.7123    
      1300   316.05488     -44424.116     -6335.539      -4387.9199      3660.7123    
      1400   307.0785      -44432.948      621.29785     -6401.5056      3660.7123    
      1500   293.13815     -44438.801      5478.3863     -829.50959      3660.7123    
      1600   276.23452     -44427.574      4542.7213     -2484.9999      3660.7123    
      1700   301.01371     -44450.74      -5435.2642     -1444.5682      3660.7123    
      1800   290.84044     -44431.505     -13077.292     -3920.5095      3660.7123    
      1900   297.04268     -44417.296     -3785.3642     -5548.0535      3660.7123    
      2000   336.23992     -44452.964      595.89621      661.45613      3660.7123    
Loop time of 119.574 on 8 procs for 2000 steps with 366 atoms

Performance: 0.723 ns/day, 33.215 hours/ns, 16.726 timesteps/s, 6.122 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.124     | 96.347     | 102.14     |  72.6 | 80.57
Bond    | 0.00077315 | 0.00087316 | 0.0010601  |   0.0 |  0.00
Neigh   | 5.7687     | 6.7298     | 7.0855     |  18.5 |  5.63
Comm    | 1.5858     | 7.3772     | 20.604     | 262.5 |  6.17
Output  | 0.0048903  | 0.0059004  | 0.0066782  |   0.8 |  0.00
Modify  | 8.7299     | 9.0693     | 10.029     |  15.8 |  7.58
Other   |            | 0.04438    |            |       |  0.04

Nlocal:          45.75 ave          57 max          39 min
Histogram: 3 0 0 3 0 0 0 1 0 1
Nghost:           3573 ave        3631 max        3517 min
Histogram: 2 1 0 1 0 0 1 0 2 1
Neighs:        32005.4 ave       39524 max       27494 min
Histogram: 3 0 0 3 0 0 0 1 0 1

Total # of neighbors = 256043
Ave neighs/atom = 699.57104
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   336.23992     -44452.964      595.90616      0              3660.7123    
       100   296.71304     -44428.56       4207.8468     -7231.192       3660.7123    
       200   282.22998     -44435.327      3454.8235     -7496.7467      3660.7123    
       300   301.54958     -44455.802      3385.1267     -4925.8114      3660.7123    
       400   307.41389     -44452.676      1679.3684     -2362.6915      3660.7123    
       500   291.92457     -44432.941     -9802.69       -8486.0852      3660.7123    
       600   288.82617     -44439.415     -618.44082     -8634.8356      3660.7123    
       700   274.72047     -44425.118      7165.1339     -4459.0739      3660.7123    
       800   309.34789     -44457.064     -3143.8829     -1445.6787      3660.7123    
       900   304.04942     -44449.232      1853.3461     -4627.0426      3660.7123    
      1000   311.71049     -44442.748      8638.5525     -3166.9376      3660.7123    
      1100   314.01459     -44433.593      14063.517     -4095.4444      3660.7123    
      1200   303.40964     -44438.742      2623.7919     -618.33086      3660.7123    
      1300   307.14238     -44474.232     -3611.8068     -4291.4647      3660.7123    
      1400   309.39146     -44482.457     -7881.8894     -2233.3291      3660.7123    
      1500   310.11796     -44475.197      12822.354     -3483.6475      3660.7123    
      1600   309.194       -44444.64       451.02244     -6176.2101      3660.7123    
      1700   317.22006     -44425.684     -4943.3933     -7743.664       3660.7123    
      1800   308.03164     -44424.527     -3900.516       91.285035      3660.7123    
      1900   293.43756     -44429.886     -103.4759      -7846.3557      3660.7123    
      2000   306.88383     -44461.769      8587.9792     -4081.1619      3660.7123    
Loop time of 119.727 on 8 procs for 2000 steps with 366 atoms

Performance: 0.722 ns/day, 33.258 hours/ns, 16.705 timesteps/s, 6.114 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.081     | 96.877     | 102.37     |  75.5 | 80.91
Bond    | 0.0007578  | 0.0008443  | 0.00096903 |   0.0 |  0.00
Neigh   | 5.4691     | 6.7971     | 7.2278     |  19.8 |  5.68
Comm    | 1.3722     | 6.8764     | 25.666     | 283.5 |  5.74
Output  | 0.00091339 | 0.0010505  | 0.0016082  |   0.7 |  0.00
Modify  | 8.6708     | 9.1289     | 10.468     |  17.2 |  7.62
Other   |            | 0.04599    |            |       |  0.04

Nlocal:          45.75 ave          53 max          40 min
Histogram: 2 2 0 0 1 0 0 1 0 2
Nghost:        3574.62 ave        3632 max        3523 min
Histogram: 3 0 1 0 0 0 0 1 1 2
Neighs:        32027.4 ave       36976 max       28187 min
Histogram: 2 2 0 0 1 0 0 1 0 2

Total # of neighbors = 256219
Ave neighs/atom = 700.05191
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 44.1445377733546
variable C2pos equal ${d2}
variable C2pos equal 43.0291479966707
variable C3pos equal ${d3}
variable C3pos equal 6.97646188160039
variable C4pos equal ${d4}
variable C4pos equal -0.752747172111832
variable C5pos equal ${d5}
variable C5pos equal -7.73293865355578
variable C6pos equal ${d6}
variable C6pos equal 13.8259780306779

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-89.5312996075428+${C1pos})
variable C14 equal 0.5*(-89.5312996075428+44.1445377733546)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-129.834745057135+${C2pos})
variable C24 equal 0.5*(-129.834745057135+43.0291479966707)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-97.5294230027012+${C3pos})
variable C34 equal 0.5*(-97.5294230027012+6.97646188160039)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(16.7860032556571+${C4pos})
variable C44 equal 0.5*(16.7860032556571+-0.752747172111832)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-1.48632395178885+${C5pos})
variable C54 equal 0.5*(-1.48632395178885+-7.73293865355578)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-3.03177721214091+${C6pos})
variable C64 equal 0.5*(-3.03177721214091+13.8259780306779)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0701126080387
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.005 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0701126080387
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.170701126080387 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.6597477 -0.31796496)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.215      7016.0482      0              3660.7123    
       100   289.71129     -44430.424     -1869.5682     -4914.1331      3660.7123    
       200   305.62685     -44443.327      9560.0338     -1041.3415      3660.7123    
       300   302.99785     -44435.25       2039.9083     -182.88741      3660.7123    
       400   289.89122     -44416.657      10543.82      -1683.1527      3660.7123    
       500   314.30694     -44436.686     -1655.3313     -6845.9325      3660.7123    
       600   311.02324     -44443.701     -2101.5084     -7952.7966      3660.7123    
       700   296.09682     -44452.719     -12386.71      -8349.3449      3660.7123    
       800   287.40234     -44446.236      1760.6841     -7753.3833      3660.7123    
       900   316.50258     -44446.966     -8995.7647     -9960.0017      3660.7123    
      1000   302.45924     -44425.472      6597.325      -5624.4122      3660.7123    
      1100   284.26342     -44416.409      11004.833     -2670.1422      3660.7123    
      1200   302.37443     -44440.147      3825.3256     -3771.8908      3660.7123    
      1300   305.99284     -44445.181     -3502.6921     -2055.2113      3660.7123    
      1400   315.85312     -44435.785     -13144.318     -7258.053       3660.7123    
      1500   310.64318     -44417.364      6021.0317     -6605.8726      3660.7123    
      1600   304.74944     -44422.244      939.28934     -2195.9758      3660.7123    
      1700   312.65063     -44463.019      5619.6147     -639.38616      3660.7123    
      1800   294.23997     -44453.543      3517.7832     -7771.6552      3660.7123    
      1900   287.45886     -44451.415     -4283.8243     -9005.9597      3660.7123    
      2000   323.2954      -44471.44       5574.4151     -3313.3797      3660.7123    
Loop time of 119.917 on 8 procs for 2000 steps with 366 atoms

Performance: 0.720 ns/day, 33.310 hours/ns, 16.678 timesteps/s, 6.104 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.699     | 96.858     | 102.31     | 105.3 | 80.77
Bond    | 0.0007303  | 0.00083843 | 0.00098082 |   0.0 |  0.00
Neigh   | 4.9966     | 6.8431     | 7.3964     |  27.4 |  5.71
Comm    | 1.527      | 6.9769     | 34.124     | 392.2 |  5.82
Output  | 0.004428   | 0.0053786  | 0.0060528  |   0.8 |  0.00
Modify  | 8.6045     | 9.1866     | 11.052     |  24.0 |  7.66
Other   |            | 0.04674    |            |       |  0.04

Nlocal:          45.75 ave          56 max          33 min
Histogram: 1 1 0 0 1 1 2 0 0 2
Nghost:        3591.12 ave        3673 max        3531 min
Histogram: 1 1 0 3 0 1 1 0 0 1
Neighs:        32012.6 ave       38917 max       23417 min
Histogram: 1 1 0 0 1 1 2 0 1 1

Total # of neighbors = 256101
Ave neighs/atom = 699.72951
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137 | 139.3 | 141.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   323.2954      -44471.44       5574.3798      0              3660.7123    
       100   289.6633      -44436.518     -7863.9725     -4646.981       3660.7123    
       200   310.03987     -44454.985      5907.5135     -1709.1433      3660.7123    
       300   296.64761     -44434.393     -3918.7735      600.87494      3660.7123    
       400   307.79934     -44445.274      1356.0561     -2315.3191      3660.7123    
       500   305.76043     -44445.913      879.50803     -7992.3715      3660.7123    
       600   298.99698     -44457.794      8618.9145     -3195.5529      3660.7123    
       700   285.65882     -44459.173     -3508.5348     -720.5688       3660.7123    
       800   300.24897     -44461.895     -91.14411      -2009.7348      3660.7123    
       900   310.9243      -44438.905      1228.1241     -5434.0866      3660.7123    
      1000   309.87338     -44431.389      1605.7414     -8529.2278      3660.7123    
      1100   324.33879     -44452.863      47.750023     -5839.841       3660.7123    
      1200   295.57272     -44435.996     -9032.8481     -4175.537       3660.7123    
      1300   289.17038     -44441.906     -3599.2098     -669.99442      3660.7123    
      1400   312.89594     -44472.514      4620.9791     -2421.7857      3660.7123    
      1500   299.45701     -44456.932      561.84555     -7581.7457      3660.7123    
      1600   303.10857     -44440.652      4345.5127     -3763.5014      3660.7123    
      1700   320.03117     -44439.608      1405.3413     -2788.6446      3660.7123    
      1800   301.22194     -44420.022      6321.9352     -4653.8448      3660.7123    
      1900   301.30621     -44448.804      1688.8319     -6885.6773      3660.7123    
      2000   285.05322     -44449.884      872.6288      -9884.5882      3660.7123    
Loop time of 119.465 on 8 procs for 2000 steps with 366 atoms

Performance: 0.723 ns/day, 33.185 hours/ns, 16.741 timesteps/s, 6.127 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.049     | 96.082     | 102.02     |  94.8 | 80.43
Bond    | 0.00076545 | 0.00086346 | 0.00094136 |   0.0 |  0.00
Neigh   | 5.102      | 6.7654     | 7.3245     |  25.3 |  5.66
Comm    | 1.4263     | 7.3956     | 31.418     | 341.4 |  6.19
Output  | 0.0009513  | 0.0010867  | 0.0017493  |   0.8 |  0.00
Modify  | 8.5829     | 9.1738     | 10.854     |  22.0 |  7.68
Other   |            | 0.04633    |            |       |  0.04

Nlocal:          45.75 ave          54 max          36 min
Histogram: 1 1 0 1 1 0 1 0 2 1
Nghost:         3582.5 ave        3646 max        3534 min
Histogram: 1 1 1 2 0 0 2 0 0 1
Neighs:        32032.2 ave       37255 max       25516 min
Histogram: 1 1 0 1 1 0 1 0 1 2

Total # of neighbors = 256258
Ave neighs/atom = 700.15847
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -102.9477543087
variable C2neg equal ${d2}
variable C2neg equal -93.6741763361899
variable C3neg equal ${d3}
variable C3neg equal -77.3461394813552
variable C4neg equal ${d4}
variable C4neg equal 4.40642199872183
variable C5neg equal ${d5}
variable C5neg equal 7.12112277632138
variable C6neg equal ${d6}
variable C6neg equal -8.38899370347718

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0701126080387
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.170701126080387 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 1.0011499 -0.31796496)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44431.777      4002.8484      0              3660.7123    
       100   294.97453     -44428.919     -4639.8502     -5166.0799      3660.7123    
       200   316.44774     -44451.412      13423.246     -4228.5761      3660.7123    
       300   283.23133     -44423.509      2308.6171     -2338.7091      3660.7123    
       400   278.22556     -44432.175     -4843.102      -2963.7297      3660.7123    
       500   285.79448     -44436.827     -6228.1808     -2807.1724      3660.7123    
       600   304.29807     -44426.159     -5162.8925     -9871.3097      3660.7123    
       700   309.7879      -44417.12       6986.8308     -5108.0774      3660.7123    
       800   303.43176     -44418.41       988.3496       107.56164      3660.7123    
       900   290.83115     -44435.064      2236.5279     -9003.9671      3660.7123    
      1000   288.91759     -44444.217     -5533.2118     -3575.7176      3660.7123    
      1100   277.19461     -44425.633      4043.4287      1053.0992      3660.7123    
      1200   300.96953     -44431.319      6226.7484     -468.60818      3660.7123    
      1300   309.23149     -44428.984     -1630.9091     -2806.3103      3660.7123    
      1400   300.59615     -44418.715      5239.5609     -5628.0578      3660.7123    
      1500   315.27063     -44445.312      20665.251     -1214.0321      3660.7123    
      1600   297.00204     -44454.003     -12999.764     -3341.0238      3660.7123    
      1700   283.34799     -44445.961      5338.6417     -2839.2209      3660.7123    
      1800   290.81043     -44435.824     -2808.7661     -1426.756       3660.7123    
      1900   320.93308     -44439.778      2462.3813      504.89117      3660.7123    
      2000   317.94406     -44437.331      9287.3332      1842.8886      3660.7123    
Loop time of 118.546 on 8 procs for 2000 steps with 366 atoms

Performance: 0.729 ns/day, 32.929 hours/ns, 16.871 timesteps/s, 6.175 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.761     | 95.293     | 101.63     |  96.1 | 80.39
Bond    | 0.00076475 | 0.00086102 | 0.0010409  |   0.0 |  0.00
Neigh   | 5.0869     | 6.7327     | 7.1045     |  24.1 |  5.68
Comm    | 1.2385     | 7.5833     | 32.108     | 340.6 |  6.40
Output  | 0.0046455  | 0.00576    | 0.0065424  |   0.9 |  0.00
Modify  | 8.4968     | 8.8869     | 10.546     |  21.2 |  7.50
Other   |            | 0.04291    |            |       |  0.04

Nlocal:          45.75 ave          54 max          39 min
Histogram: 3 0 0 0 1 1 1 0 0 2
Nghost:        3587.38 ave        3661 max        3524 min
Histogram: 1 1 0 2 1 0 1 1 0 1
Neighs:        32034.9 ave       37657 max       27461 min
Histogram: 3 0 0 0 0 3 0 0 0 2

Total # of neighbors = 256279
Ave neighs/atom = 700.21585
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   317.94406     -44437.331      9287.3619      0              3660.7123    
       100   303.91648     -44433.857     -3230.0857     -1170.3793      3660.7123    
       200   288.66717     -44446.989     -6201.4695     -3869.1597      3660.7123    
       300   288.48419     -44449.839      6060.3634      211.03953      3660.7123    
       400   286.20764     -44436.241     -6194.4395     -465.01502      3660.7123    
       500   308.16314     -44444.175     -3621.9767     -6804.245       3660.7123    
       600   296.35202     -44422.702      2579.732      -3935.7698      3660.7123    
       700   305.41084     -44430.566      7823.9564     -4526.7502      3660.7123    
       800   272.57073     -44411.561      13955.161     -726.52253      3660.7123    
       900   292.36897     -44449.458      9292.5249      2451.9446      3660.7123    
      1000   285.17547     -44448.174     -2559.5757      5286.1016      3660.7123    
      1100   297.1681      -44426.252      1820.76       -2697.4915      3660.7123    
      1200   314.05221     -44429.414     -3383.2747     -8103.7365      3660.7123    
      1300   305.46645     -44426.027     -3024.3296     -5632.7925      3660.7123    
      1400   296.80052     -44437.854      4043.1999     -3581.3376      3660.7123    
      1500   290.42644     -44448.734     -439.74712     -7148.5719      3660.7123    
      1600   276.42259     -44452.532      953.41168     -6978.7355      3660.7123    
      1700   281.97607     -44470.934      1942.696      -2439.9332      3660.7123    
      1800   304.37346     -44466.094      1790.6363     -3557.8347      3660.7123    
      1900   301.5193      -44440.159     -908.48694     -7576.4128      3660.7123    
      2000   296.92929     -44428.902     -3784.811      -6416.8093      3660.7123    
Loop time of 113.308 on 8 procs for 2000 steps with 366 atoms

Performance: 0.763 ns/day, 31.474 hours/ns, 17.651 timesteps/s, 6.460 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.866     | 84.811     | 96.908     | 117.3 | 74.85
Bond    | 0.00071173 | 0.00076919 | 0.00082405 |   0.0 |  0.00
Neigh   | 5.0999     | 6.3117     | 7.0454     |  29.8 |  5.57
Comm    | 0.99279    | 13.096     | 30.037     | 298.3 | 11.56
Output  | 0.00082392 | 0.00094226 | 0.0013971  |   0.0 |  0.00
Modify  | 8.3173     | 9.0483     | 10.266     |  25.1 |  7.99
Other   |            | 0.03948    |            |       |  0.03

Nlocal:          45.75 ave          55 max          40 min
Histogram: 2 0 2 1 1 0 0 0 0 2
Nghost:        3582.75 ave        3644 max        3533 min
Histogram: 2 0 2 0 0 1 0 2 0 1
Neighs:        32026.5 ave       37952 max       28155 min
Histogram: 2 1 1 1 1 0 0 0 0 2

Total # of neighbors = 256212
Ave neighs/atom = 700.03279
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 67.8104848045832
variable C2pos equal ${d2}
variable C2pos equal 51.0756875188823
variable C3pos equal ${d3}
variable C3pos equal 43.6528122605624
variable C4pos equal ${d4}
variable C4pos equal -5.62816723542761
variable C5pos equal ${d5}
variable C5pos equal 16.6646086031606
variable C6pos equal ${d6}
variable C6pos equal 4.4126744608946

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-102.9477543087+${C1pos})
variable C15 equal 0.5*(-102.9477543087+67.8104848045832)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-93.6741763361899+${C2pos})
variable C25 equal 0.5*(-93.6741763361899+51.0756875188823)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-77.3461394813552+${C3pos})
variable C35 equal 0.5*(-77.3461394813552+43.6528122605624)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(4.40642199872183+${C4pos})
variable C45 equal 0.5*(4.40642199872183+-5.62816723542761)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(7.12112277632138+${C5pos})
variable C55 equal 0.5*(7.12112277632138+16.6646086031606)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-8.38899370347718+${C6pos})
variable C65 equal 0.5*(-8.38899370347718+4.4126744608946)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4672714795699

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4672714795699
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.134672714795699 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.5722188 0.83044882 -0.31796496)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.2 | 139.7 | 141.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44433.333      6252.969       0              3660.7123    
       100   295.97893     -44432.267     -9596.7387     -5904.8464      3660.7123    
       200   314.19542     -44456.317      5588.277      -3461.334       3660.7123    
       300   281.51031     -44428.903     -1320.0771     -5103.9416      3660.7123    
       400   299.21435     -44447.445     -971.04026     -3794.8602      3660.7123    
       500   304.38529     -44427.739     -2022.1588     -5159.7312      3660.7123    
       600   311.19986     -44422.067     -2755.0543     -9097.2337      3660.7123    
       700   304.02443     -44435.734      2886.941      -6450.8059      3660.7123    
       800   283.99857     -44439.694      1430.617      -4837.8692      3660.7123    
       900   282.43186     -44430.02       9851.8305     -7834.8254      3660.7123    
      1000   298.40147     -44435.243      3798.2287     -4169.9333      3660.7123    
      1100   296.22372     -44421.148      1771.5329     -849.81427      3660.7123    
      1200   309.41443     -44404.323      398.15505     -1106.2393      3660.7123    
      1300   304.8228      -44379.807      2669.709      -8053.2362      3660.7123    
      1400   314.30972     -44417.247     -7680.8489     -5351.6516      3660.7123    
      1500   321.83633     -44441.684      5887.392      -829.91457      3660.7123    
      1600   301.9891      -44437.793      5328.3568     -7886.6963      3660.7123    
      1700   301.40611     -44451.164     -394.9371      -5208.1693      3660.7123    
      1800   285.09756     -44436.256     -2411.917      -5543.9581      3660.7123    
      1900   318.02819     -44440.547     -2183.4408     -5939.4308      3660.7123    
      2000   324.25688     -44429.281      3941.3942     -2614.0601      3660.7123    
Loop time of 84.1404 on 8 procs for 2000 steps with 366 atoms

Performance: 1.027 ns/day, 23.372 hours/ns, 23.770 timesteps/s, 8.700 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.719     | 63.348     | 70.525     |  59.9 | 75.29
Bond    | 0.00051772 | 0.00059099 | 0.00067279 |   0.0 |  0.00
Neigh   | 4.9118     | 5.3725     | 5.8426     |  14.4 |  6.39
Comm    | 0.82032    | 8.0021     | 14.619     | 168.6 |  9.51
Output  | 0.0033016  | 0.0041833  | 0.0047159  |   0.8 |  0.00
Modify  | 6.91       | 7.3766     | 7.8361     |  12.4 |  8.77
Other   |            | 0.03604    |            |       |  0.04

Nlocal:          45.75 ave          56 max          37 min
Histogram: 1 1 0 0 3 1 1 0 0 1
Nghost:        3616.25 ave        3668 max        3575 min
Histogram: 2 0 1 1 1 0 1 1 0 1
Neighs:        32027.4 ave       38655 max       26324 min
Histogram: 1 1 0 0 3 1 0 1 0 1

Total # of neighbors = 256219
Ave neighs/atom = 700.05191
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.3 | 139.7 | 142 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   324.25688     -44429.281      3941.3623      0              3660.7123    
       100   298.08518     -44419.371      8891.3514     -978.02255      3660.7123    
       200   299.14877     -44444.665      6926.0946     -4693.8858      3660.7123    
       300   302.13357     -44454.569     -4644.8831     -10074.687      3660.7123    
       400   317.4293      -44464.884      14889.667     -4338.6436      3660.7123    
       500   304.43009     -44438.428     -918.82004     -7374.9231      3660.7123    
       600   298.63422     -44412.193     -13420.131     -6286.2329      3660.7123    
       700   318.66998     -44431.321      5115.0426     -422.90353      3660.7123    
       800   297.79353     -44451.207     -637.34441     -1638.6912      3660.7123    
       900   300.2217      -44469.183     -612.13961     -5039.4131      3660.7123    
      1000   307.21486     -44457.128     -2079.7426     -4742.9648      3660.7123    
      1100   313.83499     -44446.335      265.93849     -7444.5611      3660.7123    
      1200   301.19003     -44427.816      9005.7471     -2381.8262      3660.7123    
      1300   295.22701     -44424.046      12587.971     -2632.1923      3660.7123    
      1400   287.27333     -44443.237      519.06516     -4634.5984      3660.7123    
      1500   291.90387     -44467.865      12409.205     -4293.2333      3660.7123    
      1600   278.17133     -44447.741      913.10084     -6939.1427      3660.7123    
      1700   307.11763     -44449.418      451.90405     -5141.7956      3660.7123    
      1800   297.93699     -44426.828      1468.5236     -7147.1504      3660.7123    
      1900   298.5556      -44438.18      -12286.983     -6835.3671      3660.7123    
      2000   292.48577     -44444.67      -5386.8999     -10611.844      3660.7123    
Loop time of 65.1712 on 8 procs for 2000 steps with 366 atoms

Performance: 1.326 ns/day, 18.103 hours/ns, 30.688 timesteps/s, 11.232 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.448     | 52.051     | 53.62      |  14.2 | 79.87
Bond    | 0.000419   | 0.00049714 | 0.00060772 |   0.0 |  0.00
Neigh   | 4.8742     | 4.9766     | 5.0726     |   2.8 |  7.64
Comm    | 0.46593    | 2.0379     | 3.6289     |  71.6 |  3.13
Output  | 0.00072583 | 0.0007759  | 0.0010623  |   0.0 |  0.00
Modify  | 5.977      | 6.0699     | 6.1716     |   2.6 |  9.31
Other   |            | 0.03446    |            |       |  0.05

Nlocal:          45.75 ave          55 max          39 min
Histogram: 2 0 0 2 1 1 1 0 0 1
Nghost:        3586.38 ave        3645 max        3538 min
Histogram: 3 1 0 0 0 0 1 0 2 1
Neighs:        32030.9 ave       37943 max       27568 min
Histogram: 2 0 0 2 2 0 0 1 0 1

Total # of neighbors = 256247
Ave neighs/atom = 700.12842
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -110.316676614333
variable C2neg equal ${d2}
variable C2neg equal -74.7336415110325
variable C3neg equal ${d3}
variable C3neg equal 1.88652965169332
variable C4neg equal ${d4}
variable C4neg equal -5.48926445932912
variable C5neg equal ${d5}
variable C5neg equal 11.385329320345
variable C6neg equal ${d6}
variable C6neg equal 1.92923542078353

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4672714795699
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.134672714795699 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.3028734 0.83044882 -0.31796496)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.7 | 138.8 | 140.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44439.731      3988.1085      0              3660.7123    
       100   296.01733     -44435.933     -2571.2995     -3954.6295      3660.7123    
       200   319.57433     -44452.575      10753.684     -2907.07        3660.7123    
       300   301.93922     -44429.767      1117.4366     -5387.5119      3660.7123    
       400   308.37561     -44439.624      9836.7906     -3162.071       3660.7123    
       500   301.04151     -44436.043      1971.1858     -2237.2305      3660.7123    
       600   307.34702     -44446.57       6872.3219     -4522.4955      3660.7123    
       700   304.36772     -44445.43      -1894.5901     -2996.7361      3660.7123    
       800   290.06322     -44430.321     -4487.4841      170.34397      3660.7123    
       900   296.20911     -44429.17       1230.6587     -7271.1898      3660.7123    
      1000   317.23629     -44443.909      14235.972     -52.869896      3660.7123    
      1100   282.96037     -44409.271      6375.7992      5349.3815      3660.7123    
      1200   301.95581     -44446.627     -3238.1392     -3133.6034      3660.7123    
      1300   276.79108     -44441.125      5619.075      -5155.6979      3660.7123    
      1400   289.77205     -44456.93       8041.7996     -3684.7607      3660.7123    
      1500   304.03938     -44437.066      6124.8274      79.600035      3660.7123    
      1600   304.48004     -44420.478      13600.381     -1993.5663      3660.7123    
      1700   301.09568     -44423.763      3390.5561     -3163.468       3660.7123    
      1800   306.47808     -44447.83      -6191.139      -4134.9697      3660.7123    
      1900   275.8751      -44446.157      1012.3649     -5601.0151      3660.7123    
      2000   298.3452      -44463.791     -7544.5936      787.73163      3660.7123    
Loop time of 61.0375 on 8 procs for 2000 steps with 366 atoms

Performance: 1.416 ns/day, 16.955 hours/ns, 32.767 timesteps/s, 11.993 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.285     | 48.027     | 49.676     |  16.6 | 78.68
Bond    | 0.00032441 | 0.00042723 | 0.00046773 |   0.0 |  0.00
Neigh   | 4.7427     | 4.8724     | 4.9765     |   3.0 |  7.98
Comm    | 0.48757    | 2.1257     | 3.8541     |  78.7 |  3.48
Output  | 0.0029743  | 0.0037511  | 0.0042697  |   0.8 |  0.01
Modify  | 5.8735     | 5.9746     | 6.1045     |   2.6 |  9.79
Other   |            | 0.03377    |            |       |  0.06

Nlocal:          45.75 ave          55 max          39 min
Histogram: 1 1 2 1 1 0 0 0 0 2
Nghost:        3579.62 ave        3635 max        3533 min
Histogram: 2 0 1 1 0 1 1 0 1 1
Neighs:        32036.6 ave       38370 max       27764 min
Histogram: 1 1 2 1 1 0 0 0 1 1

Total # of neighbors = 256293
Ave neighs/atom = 700.2541
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 138.8 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   298.3452      -44463.791     -7544.4785      0              3660.7123    
       100   295.77081     -44450.489     -5984.1628     -6286.104       3660.7123    
       200   298.3305      -44422.263     -428.18934      5035.4074      3660.7123    
       300   322.26982     -44433.398     -6009.8892      710.55709      3660.7123    
       400   312.85249     -44430.408      5232.7723      5247.268       3660.7123    
       500   303.83922     -44437.419      1343.4216     -1902.0436      3660.7123    
       600   285.87063     -44437.929      5540.3597     -7284.2641      3660.7123    
       700   278.96891     -44432.656      4795.7959     -2622.8536      3660.7123    
       800   299.37984     -44446.909     -5196.4215      94.728334      3660.7123    
       900   319.08227     -44461.108     -13904.17      -6362.4368      3660.7123    
      1000   314.77638     -44458.749      5948.272      -1477.6634      3660.7123    
      1100   307.01061     -44444.29      -3702.3066     -3956.0268      3660.7123    
      1200   302.18915     -44420.95      -7998.5025     -7367.6539      3660.7123    
      1300   314.35281     -44405.616     -7085.8337     -3227.698       3660.7123    
      1400   310.39596     -44399.971     -269.08987      826.0256       3660.7123    
      1500   305.46263     -44430.908      7582.2556      379.28387      3660.7123    
      1600   296.80493     -44432.326     -12664.917      1955.0646      3660.7123    
      1700   285.68775     -44424.213     -8361.5161     -3091.2349      3660.7123    
      1800   301.71934     -44441.284      325.35508     -1371.5825      3660.7123    
      1900   284.62862     -44421.025      10973.281     -2178.1049      3660.7123    
      2000   300.63928     -44436.627     -3899.3106     -7670.393       3660.7123    
Loop time of 61.0198 on 8 procs for 2000 steps with 366 atoms

Performance: 1.416 ns/day, 16.950 hours/ns, 32.776 timesteps/s, 11.996 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.276     | 47.978     | 49.761     |  17.4 | 78.63
Bond    | 0.00032253 | 0.00042861 | 0.00048059 |   0.0 |  0.00
Neigh   | 4.751      | 4.8818     | 5.0008     |   3.2 |  8.00
Comm    | 0.44025    | 2.2124     | 3.9016     |  80.4 |  3.63
Output  | 0.00051365 | 0.00056041 | 0.00079859 |   0.0 |  0.00
Modify  | 5.7961     | 5.9129     | 6.0439     |   3.0 |  9.69
Other   |            | 0.03367    |            |       |  0.06

Nlocal:          45.75 ave          55 max          38 min
Histogram: 2 0 0 2 0 2 0 0 1 1
Nghost:        3569.62 ave        3631 max        3511 min
Histogram: 2 0 1 0 1 1 1 0 0 2
Neighs:        32016.8 ave       38316 max       27089 min
Histogram: 2 0 0 2 1 1 0 1 0 1

Total # of neighbors = 256134
Ave neighs/atom = 699.81967
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 80.5124217256552
variable C2pos equal ${d2}
variable C2pos equal 74.1700988555031
variable C3pos equal ${d3}
variable C3pos equal 21.5829704608549
variable C4pos equal ${d4}
variable C4pos equal -15.1584579551445
variable C5pos equal ${d5}
variable C5pos equal -5.31440695941265
variable C6pos equal ${d6}
variable C6pos equal 19.7720949255059

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-110.316676614333+${C1pos})
variable C16 equal 0.5*(-110.316676614333+80.5124217256552)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-74.7336415110325+${C2pos})
variable C26 equal 0.5*(-74.7336415110325+74.1700988555031)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(1.88652965169332+${C3pos})
variable C36 equal 0.5*(1.88652965169332+21.5829704608549)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-5.48926445932912+${C4pos})
variable C46 equal 0.5*(-5.48926445932912+-15.1584579551445)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(11.385329320345+${C5pos})
variable C56 equal 0.5*(11.385329320345+-5.31440695941265)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(1.92923542078353+${C6pos})
variable C66 equal 0.5*(1.92923542078353+19.7720949255059)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 63.5907275205163
variable C22all equal ${C22}
variable C22all equal 29.5598949895851
variable C33all equal ${C33}
variable C33all equal 68.0254847576949

variable C44all equal ${C44}
variable C44all equal 8.01662804177263
variable C55all equal ${C55}
variable C55all equal 11.892865689741
variable C66all equal ${C66}
variable C66all equal 10.8506651731447

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-4.50632094076945+${C21})
variable C12all equal 0.5*(-4.50632094076945+47.7151102592161)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(31.5337588580831+${C31})
variable C13all equal 0.5*(31.5337588580831+44.235873612941)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(48.3113070479276+${C32})
variable C23all equal 0.5*(48.3113070479276+36.698510840719)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-22.6933809170941+${C41})
variable C14all equal 0.5*(-22.6933809170941+7.78842585778074)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-17.5686347520584+${C51})
variable C15all equal 0.5*(-17.5686347520584+-7.63946829070131)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-14.9021274443389+${C61})
variable C16all equal 0.5*(-14.9021274443389+-6.10940697910779)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-43.4027985302321+${C42})
variable C24all equal 0.5*(-43.4027985302321+-4.62960845330437)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-21.2992444086538+${C52})
variable C25all equal 0.5*(-21.2992444086538+-7.82306118774518)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-0.281771327764702+${C62})
variable C26all equal 0.5*(-0.281771327764702+-9.71498166441124)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-45.2764805605504+${C43})
variable C34all equal 0.5*(-45.2764805605504+0.570986094650155)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-16.8466636103964+${C53})
variable C35all equal 0.5*(-16.8466636103964+-15.7044198870372)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(11.7347500562741+${C63})
variable C36all equal 0.5*(11.7347500562741+-13.1962721103316)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-0.61087261835289+${C54})
variable C45all equal 0.5*(-0.61087261835289+-4.60963130267232)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-10.3238612072368+${C64})
variable C46all equal 0.5*(-10.3238612072368+5.39710040926849)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(3.03546118046618+${C65})
variable C56all equal 0.5*(3.03546118046618+-1.98815962129129)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:46:20
