LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-RV-31-vasp-an
read_data       ${structure}.data
read_data       333-RV-31-vasp-an.data
Reading data file ...
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  310 atoms
  reading velocities ...
  310 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.012 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              276.32109      3826.5298    
         1   300            0              0              276.32109      3826.5298    
Loop time of 6.56981e-05 on 8 procs for 1 steps with 310 atoms

53.8% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.11e-07   | 2.3525e-07 | 3.4e-07    |   0.0 |  0.36
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.73e-07   | 1.4374e-06 | 1.769e-06  |   0.0 |  2.19
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.403e-05  |            |       | 97.45

Nlocal:          38.75 ave          45 max          31 min
Histogram: 1 0 0 1 0 3 1 1 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.2 | 127.5 | 129.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -34547.282      1953.4049      0              1.4789743      3300.9716    
       100   301.962       -34550.917     -11710.962      5499.4575      1.4789743      3300.9716    
       200   276.79876     -34545.379     -700.31155      1905.5742      1.4789743      3300.9716    
       300   294.06343     -34581.233     -1778.7849      2734.083       1.4789743      3300.9716    
       400   270.59575     -34550.326     -1999.843      -902.18907      1.4789743      3300.9716    
       500   301.36397     -34546.408      3256.3855      275.57201      1.4789743      3300.9716    
       600   299.96555     -34548.627     -10441.563     -1697.7154      1.4789743      3300.9716    
       700   281.45358     -34550.894     -4357.2122      1454.7871      1.4789743      3300.9716    
       800   293.99566     -34562.627      11176.126      2126.0088      1.4789743      3300.9716    
       900   317.76491     -34565.689      4401.0981      4291.4911      1.4789743      3300.9716    
      1000   331.02372     -34548.389      2192.9069      3801.0479      1.4789743      3300.9716    
      1100   312.2327      -34545.718     -41.341837      1177.6511      1.4789743      3300.9716    
      1200   319.23523     -34567.708     -2557.9533     -8707.4671      1.4789743      3300.9716    
      1300   300.18823     -34557.733     -3441.5115     -2734.8418      1.4789743      3300.9716    
      1400   302.76031     -34562.673     -4188.3448     -3313.025       1.4789743      3300.9716    
      1500   308.73944     -34568.228     -6137.7851     -1128.197       1.4789743      3300.9716    
      1600   289.04568     -34552.55      -8605.1063      633.2309       1.4789743      3300.9716    
      1700   295.04869     -34558.372     -9849.8701      7560.4371      1.4789743      3300.9716    
      1800   298.58833     -34559.051     -1038.2365     -620.88277      1.4789743      3300.9716    
      1900   305.70948     -34564.454     -1927.3327      1505.923       1.4789743      3300.9716    
      2000   302.12829     -34572.841      7891.6248     -547.38166      1.4789743      3300.9716    
Loop time of 94.7932 on 8 procs for 2000 steps with 310 atoms

Performance: 0.911 ns/day, 26.331 hours/ns, 21.099 timesteps/s, 6.541 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.622     | 70.676     | 79.592     | 119.8 | 74.56
Bond    | 0.00064813 | 0.00086801 | 0.0011319  |   0.0 |  0.00
Neigh   | 4.1513     | 5.295      | 6.007      |  32.1 |  5.59
Comm    | 1.6472     | 10.565     | 27.615     | 309.9 | 11.14
Output  | 0.0010686  | 0.0011614  | 0.0016631  |   0.6 |  0.00
Modify  | 7.5026     | 8.216      | 9.3628     |  25.8 |  8.67
Other   |            | 0.0398     |            |       |  0.04

Nlocal:          38.75 ave          47 max          30 min
Histogram: 1 0 0 1 2 1 1 1 0 1
Nghost:           3291 ave        3341 max        3247 min
Histogram: 2 0 1 1 1 0 1 0 1 1
Neighs:        25583.2 ave       30723 max       20034 min
Histogram: 1 0 0 1 2 1 2 0 0 1

Total # of neighbors = 204666
Ave neighs/atom = 660.2129
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-31-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.4586296523921
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.5434280440749
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.0237234147291

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--547.381660032164)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--547.381660032164)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3484.41126572593)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3484.41126572593)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2891.17264285038)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2891.17264285038)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--435.124411967102)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--435.124411967102)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--2433.85548209761)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--2433.85548209761)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-950.506743302348)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-950.506743302348)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.4586296523921
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.4586296523921
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.154586296523921 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.154586296523921 xy delta 0.0762654169564332 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.154586296523921 xy delta 0.0762654169564332 xz delta 0.0126876619114723 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.280429 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.280429 12.642264 17.263562) with tilt (-7.5502763 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.280429 12.642264 17.263562) with tilt (-7.5502763 -1.2560785 0.93829071)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.7 | 128.6 | 130 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34550.17       64621.196      0              3267.9619    
       100   294.94174     -34566.599     -8149.9575      7336.0439      3267.9619    
       200   276.83774     -34560.274      7715.0754     -2346.2983      3267.9619    
       300   309.65307     -34573.139     -3404.9364     -419.05954      3267.9619    
       400   336.5575      -34562.834      3014.0841      2546.3093      3267.9619    
       500   305.09653     -34533.82       5470.2598      4102.8113      3267.9619    
       600   293.46618     -34531.851     -7268.8467     -1175.02        3267.9619    
       700   316.25189     -34567.224      6144.6815     -3155.1627      3267.9619    
       800   289.57316     -34551.892     -7255.1984      7166.535       3267.9619    
       900   308.99073     -34567.95       5442.7307      3591.2399      3267.9619    
      1000   321.83112     -34566.288     -8671.3036      224.00004      3267.9619    
      1100   311.8023      -34545.696      2336.3332      6819.7513      3267.9619    
      1200   309.63721     -34549.647      2498.3389      3723.3252      3267.9619    
      1300   300.87893     -34570.578      1569.1045      8888.9643      3267.9619    
      1400   289.74284     -34572.37       4451.3585      3770.1462      3267.9619    
      1500   288.2244      -34565.184     -347.06813      7195.6637      3267.9619    
      1600   306.16478     -34567.263     -18435.81       2738.1219      3267.9619    
      1700   301.69652     -34532.077     -2340.4646      1088.0603      3267.9619    
      1800   326.31388     -34543.097     -9960.2366     -4600.3752      3267.9619    
      1900   314.01743     -34545.673     -6247.756      -2852.801       3267.9619    
      2000   298.35135     -34548.713     -7902.9871      2928.5053      3267.9619    
Loop time of 96.6493 on 8 procs for 2000 steps with 310 atoms

Performance: 0.894 ns/day, 26.847 hours/ns, 20.693 timesteps/s, 6.415 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.61      | 72.148     | 80.757     | 122.0 | 74.65
Bond    | 0.0006194  | 0.00085066 | 0.0010571  |   0.0 |  0.00
Neigh   | 4.3096     | 5.3814     | 6.0542     |  30.9 |  5.57
Comm    | 2.0257     | 10.634     | 27.173     | 317.8 | 11.00
Output  | 0.0042585  | 0.0052956  | 0.0062243  |   1.1 |  0.01
Modify  | 7.764      | 8.4405     | 9.5156     |  24.7 |  8.73
Other   |            | 0.03951    |            |       |  0.04

Nlocal:          38.75 ave          47 max          33 min
Histogram: 1 0 2 2 0 2 0 0 0 1
Nghost:        3297.88 ave        3358 max        3248 min
Histogram: 2 0 0 1 2 1 0 0 1 1
Neighs:        25825.1 ave       30940 max       22256 min
Histogram: 1 1 1 2 1 1 0 0 0 1

Total # of neighbors = 206601
Ave neighs/atom = 666.45484
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.7 | 128.6 | 130.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   298.35135     -34548.713     -7903.0167      0              3267.9619    
       100   316.84397     -34567.931     -8295.0353     -1352.7461      3267.9619    
       200   277.16263     -34556.397      1136.8242     -2281.3402      3267.9619    
       300   265.79268     -34563.298     -2546.1984      1570.9778      3267.9619    
       400   291.06509     -34578.777     -10030.183     -3505.7207      3267.9619    
       500   300.63386     -34547.074      2994.6106      1619.4938      3267.9619    
       600   321.60214     -34566.072     -2306.0723     -442.00379      3267.9619    
       700   293.93672     -34556.36      -1262.3486      6439.509       3267.9619    
       800   290.16135     -34565.024      2067.2436      4792.2179      3267.9619    
       900   308.74119     -34579.148     -1001.7209      2939.2678      3267.9619    
      1000   325.95176     -34566.258     -9294.5546     -847.27834      3267.9619    
      1100   302.44246     -34531.407      2367.014       9468.3742      3267.9619    
      1200   298.51455     -34535.604     -5257.9689      8024.0346      3267.9619    
      1300   279.54377     -34556.025      7271.0506      4613.6912      3267.9619    
      1400   282.74357     -34565.64      -3105.8012      6421.0431      3267.9619    
      1500   294.03921     -34559.442     -16278.904      4332.1159      3267.9619    
      1600   311.76196     -34555.551     -11734.119      1737.81        3267.9619    
      1700   317.76731     -34555.232     -1954.4076      3169.4653      3267.9619    
      1800   315.55952     -34565.33      -2269.693       2059.4868      3267.9619    
      1900   298.03145     -34583.901      19552.605      7384.452       3267.9619    
      2000   268.75615     -34569.897     -13034.298      2247.6343      3267.9619    
Loop time of 97.3627 on 8 procs for 2000 steps with 310 atoms

Performance: 0.887 ns/day, 27.045 hours/ns, 20.542 timesteps/s, 6.368 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.331     | 71.966     | 82.168     | 122.9 | 73.91
Bond    | 0.00068621 | 0.00086323 | 0.001043   |   0.0 |  0.00
Neigh   | 4.2674     | 5.3673     | 5.9992     |  29.7 |  5.51
Comm    | 0.90316    | 11.106     | 28.731     | 312.7 | 11.41
Output  | 0.00086226 | 0.0010622  | 0.0021658  |   1.3 |  0.00
Modify  | 8.248      | 8.8843     | 9.9996     |  23.3 |  9.12
Other   |            | 0.03733    |            |       |  0.04

Nlocal:          38.75 ave          47 max          31 min
Histogram: 1 0 0 3 1 0 1 0 1 1
Nghost:           3275 ave        3320 max        3230 min
Histogram: 3 1 0 0 0 0 0 0 1 3
Neighs:        25822.9 ave       31011 max       20849 min
Histogram: 1 0 0 3 1 0 1 0 1 1

Total # of neighbors = 206583
Ave neighs/atom = 666.39677
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 28.3204987497789
variable C2neg equal ${d2}
variable C2neg equal 56.5154691269491
variable C3neg equal ${d3}
variable C3neg equal -6.5899192125165
variable C4neg equal ${d4}
variable C4neg equal -1.13668954312309
variable C5neg equal ${d5}
variable C5neg equal -0.334062746030252
variable C6neg equal ${d6}
variable C6neg equal -4.30770320067385

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.4586296523921
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.154586296523921 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.154586296523921 xy delta -0.0762654169564332 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.154586296523921 xy delta -0.0762654169564332 xz delta -0.0126876619114723 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.589601 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.589601 12.642264 17.263562) with tilt (-7.7028071 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.589601 12.642264 17.263562) with tilt (-7.7028071 -1.2814539 0.93829071)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.6 | 126.8 | 128.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34554.292     -51187.488      0              3333.9813    
       100   297.56091     -34570.937     -4351.9303     -2605.4628      3333.9813    
       200   272.41994     -34558.214      6185.4235     -6278.8403      3333.9813    
       300   303.75591     -34561.083     -7783.761      -1387.9203      3333.9813    
       400   310.6973      -34544.174     -4204.9689     -2265.5305      3333.9813    
       500   294.39059     -34538.128     -6962.6583     -1453.4022      3333.9813    
       600   292.19102     -34550.946     -1126.7472      3265.157       3333.9813    
       700   296.98314     -34562.004     -13980.181     -4296.1618      3333.9813    
       800   301.71967     -34547.25       1666.9274     -3652.7061      3333.9813    
       900   295.01826     -34516.497      876.94714     -76.181782      3333.9813    
      1000   310.07296     -34533.491     -6332.0245     -669.6863       3333.9813    
      1100   292.29469     -34538.968     -1633.5289     -275.28633      3333.9813    
      1200   293.47784     -34555.953     -4660.4873      1002.9696      3333.9813    
      1300   283.488       -34549.923      7313.7326      6829.1521      3333.9813    
      1400   317.45188     -34543.766      1607.1708     -705.0053       3333.9813    
      1500   313.40102     -34530.962      1282.4611     -4097.2255      3333.9813    
      1600   311.77237     -34550.803     -10296.744     -137.66382      3333.9813    
      1700   299.33863     -34556.463     -1991.8812     -9203.7933      3333.9813    
      1800   284.30748     -34547.391     -12469.381      143.69885      3333.9813    
      1900   302.5013      -34550.595      15659.284      150.56061      3333.9813    
      2000   313.74948     -34527.639      9215.589      -2414.6667      3333.9813    
Loop time of 94.3387 on 8 procs for 2000 steps with 310 atoms

Performance: 0.916 ns/day, 26.205 hours/ns, 21.200 timesteps/s, 6.572 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.544     | 66.46      | 79.658     | 135.6 | 70.45
Bond    | 0.00063009 | 0.00085966 | 0.0011287  |   0.0 |  0.00
Neigh   | 4.058      | 5.0081     | 5.8786     |  35.7 |  5.31
Comm    | 0.67563    | 13.875     | 26.779     | 296.8 | 14.71
Output  | 0.0040624  | 0.0050903  | 0.0060938  |   1.1 |  0.01
Modify  | 8.078      | 8.9534     | 9.8971     |  26.8 |  9.49
Other   |            | 0.03593    |            |       |  0.04

Nlocal:          38.75 ave          49 max          32 min
Histogram: 1 1 2 1 0 2 0 0 0 1
Nghost:        3265.12 ave        3314 max        3227 min
Histogram: 2 2 0 0 0 1 0 1 1 1
Neighs:        25296.6 ave       31642 max       21034 min
Histogram: 1 1 2 1 0 1 1 0 0 1

Total # of neighbors = 202373
Ave neighs/atom = 652.81613
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.6 | 126.8 | 128.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   313.74948     -34527.639      9215.5802      0              3333.9813    
       100   294.26068     -34526.822     -1599.6699     -1316.954       3333.9813    
       200   287.49992     -34546.896     -12982.983     -2411.7418      3333.9813    
       300   287.19451     -34545.189     -12566.703     -2759.0732      3333.9813    
       400   298.62516     -34544.644     -19194.491     -3531.5051      3333.9813    
       500   311.64965     -34541.529      2049.2304     -6605.4705      3333.9813    
       600   334.89366     -34541.893     -5654.4251     -1756.6175      3333.9813    
       700   316.71943     -34533.277      9411.4271     -2893.1434      3333.9813    
       800   314.89896     -34564.001     -1684.272      -4595.9352      3333.9813    
       900   277.77409     -34540.048     -3374.6018     -1216.2613      3333.9813    
      1000   301.43071     -34561.568     -3968.4359     -560.75854      3333.9813    
      1100   310.33291     -34549.513     -19048.154     -10577.441      3333.9813    
      1200   333.45219     -34545.314     -1815.3043     -8628.8722      3333.9813    
      1300   318.09252     -34537.833      4454.5374     -2765.0043      3333.9813    
      1400   313.31696     -34556.708      8961.1691     -2225.3806      3333.9813    
      1500   275.56679     -34531.741      1924.6289     -2278.1975      3333.9813    
      1600   297.19092     -34553.268     -35341.127     -5500.9257      3333.9813    
      1700   280.8842      -34543.356     -18846.046     -10931.635      3333.9813    
      1800   296.6201      -34547.047      12767.09      -3034.1559      3333.9813    
      1900   309.8733      -34539.881      4153.4373     -1635.7147      3333.9813    
      2000   335.29251     -34544.731     -14886.085      2442.8689      3333.9813    
Loop time of 94.0669 on 8 procs for 2000 steps with 310 atoms

Performance: 0.918 ns/day, 26.130 hours/ns, 21.261 timesteps/s, 6.591 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.807     | 66.756     | 79.466     | 129.0 | 70.97
Bond    | 0.00063123 | 0.00085276 | 0.0010498  |   0.0 |  0.00
Neigh   | 4.09       | 5.0536     | 5.9595     |  34.3 |  5.37
Comm    | 0.64411    | 13.356     | 25.309     | 288.4 | 14.20
Output  | 0.00091383 | 0.0010304  | 0.0015134  |   0.6 |  0.00
Modify  | 7.9524     | 8.8636     | 9.8235     |  26.0 |  9.42
Other   |            | 0.03644    |            |       |  0.04

Nlocal:          38.75 ave          46 max          33 min
Histogram: 1 0 1 3 0 1 0 1 0 1
Nghost:         3254.5 ave        3302 max        3213 min
Histogram: 1 0 1 2 1 1 0 1 0 1
Neighs:        25298.6 ave       29879 max       21665 min
Histogram: 1 0 2 2 0 1 0 1 0 1

Total # of neighbors = 202389
Ave neighs/atom = 652.86774
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -30.2987141254815
variable C2pos equal ${d2}
variable C2pos equal -79.1793445909574
variable C3pos equal ${d3}
variable C3pos equal -12.8400382790524
variable C4pos equal ${d4}
variable C4pos equal 2.85268190268926
variable C5pos equal ${d5}
variable C5pos equal -4.64730664541317
variable C6pos equal ${d6}
variable C6pos equal -8.50643977798289

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(28.3204987497789+${C1pos})
variable C11 equal 0.5*(28.3204987497789+-30.2987141254815)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(56.5154691269491+${C2pos})
variable C21 equal 0.5*(56.5154691269491+-79.1793445909574)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-6.5899192125165+${C3pos})
variable C31 equal 0.5*(-6.5899192125165+-12.8400382790524)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-1.13668954312309+${C4pos})
variable C41 equal 0.5*(-1.13668954312309+2.85268190268926)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-0.334062746030252+${C5pos})
variable C51 equal 0.5*(-0.334062746030252+-4.64730664541317)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-4.30770320067385+${C6pos})
variable C61 equal 0.5*(-4.30770320067385+-8.50643977798289)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.5434280440749
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.5434280440749
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.125434280440749 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.125434280440749 yz delta -0.00938290713391877 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.51683 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.51683 17.263562) with tilt (-7.6265417 -1.2687662 0.92890781)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.4 | 128.6 | 130.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34556.395      69113.264      0              3267.9619    
       100   291.97186     -34569.182     -14696.972      3591.3404      3267.9619    
       200   267.67956     -34558.565      7104.4499     -1287.1302      3267.9619    
       300   291.78069     -34562.448     -9619.1133      173.27145      3267.9619    
       400   317.50255     -34550.984      6150.7844      8847.1708      3267.9619    
       500   293.71439     -34532.155     -9985.8329      4140.0424      3267.9619    
       600   294.62259     -34540.158      7700.6561      1086.2543      3267.9619    
       700   295.63892     -34552.444     -10467.028     -162.43956      3267.9619    
       800   298.2578      -34574.082     -3282.927      -1383.1151      3267.9619    
       900   277.77306     -34584.945     -643.27218      1111.0684      3267.9619    
      1000   286.42278     -34589.587      3084.5517     -1372.3699      3267.9619    
      1100   285.94241     -34566.135     -260.08184     -2263.4948      3267.9619    
      1200   286.79866     -34556.715      2960.9937     -3052.0399      3267.9619    
      1300   296.159       -34555.179      5750.1783      6346.7855      3267.9619    
      1400   307.61698     -34561.871      1275.6468      19.157672      3267.9619    
      1500   301.79917     -34559.423     -10348.181     -39.652501      3267.9619    
      1600   300.85913     -34583.606     -8123.6442     -3539.4886      3267.9619    
      1700   269.37939     -34567.624      6002.436       2202.612       3267.9619    
      1800   296.70408     -34574.295     -945.25732     -3448.0852      3267.9619    
      1900   299.78543     -34555.836      20057.191      1302.2793      3267.9619    
      2000   295.75056     -34542.604     -992.52467      1458.4034      3267.9619    
Loop time of 97.1029 on 8 procs for 2000 steps with 310 atoms

Performance: 0.890 ns/day, 26.973 hours/ns, 20.597 timesteps/s, 6.385 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.447     | 71.254     | 82.079     | 131.4 | 73.38
Bond    | 0.00064536 | 0.00083767 | 0.0010002  |   0.0 |  0.00
Neigh   | 4.1611     | 5.3278     | 6.0992     |  35.4 |  5.49
Comm    | 0.69662    | 11.535     | 27.355     | 326.5 | 11.88
Output  | 0.0040445  | 0.0049787  | 0.005904   |   1.0 |  0.01
Modify  | 8.1661     | 8.9422     | 10.101     |  27.4 |  9.21
Other   |            | 0.03834    |            |       |  0.04

Nlocal:          38.75 ave          48 max          31 min
Histogram: 1 0 1 0 4 1 0 0 0 1
Nghost:           3298 ave        3340 max        3263 min
Histogram: 4 0 0 0 0 0 1 0 1 2
Neighs:        25833.5 ave       31684 max       20926 min
Histogram: 1 0 1 0 4 1 0 0 0 1

Total # of neighbors = 206668
Ave neighs/atom = 666.67097
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.4 | 128.6 | 130.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.75056     -34542.604     -992.57827      0              3267.9619    
       100   312.17946     -34558.123      3845.8219      8554.6522      3267.9619    
       200   307.95269     -34565.979      20145.75       7135.9477      3267.9619    
       300   279.5695      -34567.305     -4256.7959     -1454.9006      3267.9619    
       400   287.89703     -34576.079      1853.4978      4967.413       3267.9619    
       500   274.43704     -34536.633      2350.4497     -1031.2566      3267.9619    
       600   290.73882     -34540.873      7937.2095     -2255.0293      3267.9619    
       700   291.57547     -34551.613      473.25387     -790.9527       3267.9619    
       800   310.17933     -34582.551      8402.2379      3169.1941      3267.9619    
       900   292.90688     -34585.074      2547.2331     -647.37304      3267.9619    
      1000   284.48714     -34591.212      7597.257      -39.85164       3267.9619    
      1100   280.62221     -34571.754      18891.252      426.93666      3267.9619    
      1200   297.34163     -34559.842      6886.7849      7380.3165      3267.9619    
      1300   302.32097     -34555.668      7170.5877      1333.9328      3267.9619    
      1400   301.31416     -34560.474      2968.6011      724.21083      3267.9619    
      1500   289.93894     -34569.026      6754.2764      208.89787      3267.9619    
      1600   279.1843      -34574.802     -6570.0137      6725.5944      3267.9619    
      1700   285.54613     -34564.193     -8855.9841      1095.0215      3267.9619    
      1800   306.23039     -34552.681      220.70383      1619.6827      3267.9619    
      1900   289.32553     -34546.983     -90.661481     -1728.2107      3267.9619    
      2000   269.23887     -34546.72      -6603.7523     -120.26522      3267.9619    
Loop time of 96.9975 on 8 procs for 2000 steps with 310 atoms

Performance: 0.891 ns/day, 26.944 hours/ns, 20.619 timesteps/s, 6.392 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.754     | 71.282     | 81.984     | 131.0 | 73.49
Bond    | 0.00065077 | 0.00083423 | 0.00099605 |   0.0 |  0.00
Neigh   | 4.1872     | 5.328      | 6.0718     |  35.0 |  5.49
Comm    | 0.72612    | 11.44      | 26.977     | 327.1 | 11.79
Output  | 0.00089434 | 0.00099751 | 0.001493   |   0.0 |  0.00
Modify  | 8.1563     | 8.9072     | 10.043     |  27.1 |  9.18
Other   |            | 0.03844    |            |       |  0.04

Nlocal:          38.75 ave          48 max          33 min
Histogram: 2 0 0 3 1 1 0 0 0 1
Nghost:        3301.75 ave        3344 max        3254 min
Histogram: 2 1 1 0 0 0 0 0 1 3
Neighs:        25848.1 ave       31655 max       22227 min
Histogram: 2 0 0 3 1 1 0 0 0 1

Total # of neighbors = 206785
Ave neighs/atom = 667.04839
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 4.32775728794339
variable C2neg equal ${d2}
variable C2neg equal 46.420569931991
variable C3neg equal ${d3}
variable C3neg equal 5.55848577629505
variable C4neg equal ${d4}
variable C4neg equal -12.9118794649387
variable C5neg equal ${d5}
variable C5neg equal 1.76453802692774
variable C6neg equal ${d6}
variable C6neg equal 0.0323497510116324

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.5434280440749
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.125434280440749 yz delta ${deltayz} remap units box
change_box all y delta 0 0.125434280440749 yz delta 0.00938290713391877 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.767698 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.767698 17.263562) with tilt (-7.6265417 -1.2687662 0.94767362)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.8 | 126.4 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34552.024     -48581.992      0              3333.9813    
       100   296.86588     -34567.755     -1730.2262     -759.12227      3333.9813    
       200   264.9531      -34549.432      7534.9353     -9444.85        3333.9813    
       300   299.32885     -34561.841     -4807.1671     -247.87132      3333.9813    
       400   328.7593      -34557.523     -3633.0301      854.81126      3333.9813    
       500   308.03498     -34546.633     -10022.128     -4351.7855      3333.9813    
       600   294.93111     -34549.049      3106.3971     -3531.8645      3333.9813    
       700   291.81404     -34562.731     -9539.133      -4379.9673      3333.9813    
       800   292.8928      -34564.679     -548.69159     -3770.1301      3333.9813    
       900   300.39679     -34538.834     -7890.2498     -1662.6482      3333.9813    
      1000   329.18821     -34545.889     -21557.369     -1965.709       3333.9813    
      1100   306.80089     -34545.565     -11764.836     -1823.705       3333.9813    
      1200   283.38709     -34549.022      1373.8383     -2710.8104      3333.9813    
      1300   293.30045     -34560.521      8679.4749      287.30786      3333.9813    
      1400   303.81799     -34557.992     -13091.831     -6288.2782      3333.9813    
      1500   301.76127     -34540.401     -1907.7709      1564.3097      3333.9813    
      1600   320.07196     -34536.465      3733.6885     -3981.8403      3333.9813    
      1700   330.76032     -34554.603     -8627.9208     -10210.433      3333.9813    
      1800   282.44344     -34542.706     -6386.5407     -1243.0362      3333.9813    
      1900   292.11652     -34559.606     -4034.7813     -6146.8482      3333.9813    
      2000   296.19513     -34562.23       699.30422      5617.8605      3333.9813    
Loop time of 96.253 on 8 procs for 2000 steps with 310 atoms

Performance: 0.898 ns/day, 26.737 hours/ns, 20.779 timesteps/s, 6.441 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.811     | 71.54      | 79.987     |  91.5 | 74.32
Bond    | 0.00066071 | 0.00087445 | 0.0010329  |   0.0 |  0.00
Neigh   | 4.5525     | 5.3817     | 5.9099     |  24.8 |  5.59
Comm    | 1.5645     | 10.055     | 20.726     | 243.7 | 10.45
Output  | 0.0042105  | 0.0051982  | 0.0061387  |   1.0 |  0.01
Modify  | 8.6611     | 9.2323     | 10.119     |  19.5 |  9.59
Other   |            | 0.03841    |            |       |  0.04

Nlocal:          38.75 ave          44 max          34 min
Histogram: 1 0 0 0 3 2 1 0 0 1
Nghost:        3261.25 ave        3306 max        3216 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Neighs:        25287.2 ave       28489 max       22348 min
Histogram: 1 0 0 1 4 0 1 0 0 1

Total # of neighbors = 202298
Ave neighs/atom = 652.57419
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.9 | 126.4 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.19513     -34562.23       699.26855      0              3333.9813    
       100   293.7164      -34553.157     -6575.0697     -2599.2836      3333.9813    
       200   309.53981     -34536.929      5099.2111      48.382322      3333.9813    
       300   290.2266      -34512.531      12775.916      1016.0579      3333.9813    
       400   316.23948     -34547.849     -198.96892     -7279.245       3333.9813    
       500   303.90218     -34548.564     -16401.707     -1461.9128      3333.9813    
       600   307.41805     -34564.9       -532.86734      1565.1373      3333.9813    
       700   276.54249     -34547.159     -2014.4905     -6302.6365      3333.9813    
       800   306.82383     -34558.104      2917.1215     -2626.6542      3333.9813    
       900   320.58666     -34533.689     -4427.9231      4315.9413      3333.9813    
      1000   323.89808     -34538.25      -18858.34      -590.18016      3333.9813    
      1100   300.77801     -34532.798      3152.8636     -3376.1591      3333.9813    
      1200   299.95517     -34551.18       4835.6683      1101.1538      3333.9813    
      1300   281.54172     -34532.986      12209.108     -1153.6325      3333.9813    
      1400   310.86256     -34554.349      2276.1147     -4571.4365      3333.9813    
      1500   284.39892     -34534.365      2393.0314      1804.0211      3333.9813    
      1600   298.05071     -34567.346      168.70041     -3750.3343      3333.9813    
      1700   266.52283     -34563.185      8506.5011      3646.4916      3333.9813    
      1800   283.75112     -34570.575      532.91042      704.07869      3333.9813    
      1900   305.38179     -34563.538      2382.7814     -8409.596       3333.9813    
      2000   315.19563     -34559.953      11697.148     -4372.5024      3333.9813    
Loop time of 96.1982 on 8 procs for 2000 steps with 310 atoms

Performance: 0.898 ns/day, 26.722 hours/ns, 20.790 timesteps/s, 6.445 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.235     | 78.165     | 80.838     |  15.6 | 81.25
Bond    | 0.00068454 | 0.00086006 | 0.0010164  |   0.0 |  0.00
Neigh   | 5.6409     | 5.8049     | 5.9823     |   4.7 |  6.03
Comm    | 1.0631     | 3.7359     | 5.6586     |  71.2 |  3.88
Output  | 0.0009316  | 0.0011292  | 0.0020647  |   1.1 |  0.00
Modify  | 8.2785     | 8.4493     | 8.6138     |   3.9 |  8.78
Other   |            | 0.04099    |            |       |  0.04

Nlocal:          38.75 ave          46 max          33 min
Histogram: 1 0 1 2 2 0 1 0 0 1
Nghost:        3252.25 ave        3303 max        3200 min
Histogram: 2 0 1 1 0 0 0 2 0 2
Neighs:        25294.2 ave       29761 max       21784 min
Histogram: 1 0 2 0 3 0 1 0 0 1

Total # of neighbors = 202354
Ave neighs/atom = 652.75484
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 38.7580354577078
variable C2pos equal ${d2}
variable C2pos equal 31.9200226591822
variable C3pos equal ${d3}
variable C3pos equal 42.9863440354675
variable C4pos equal ${d4}
variable C4pos equal -0.0721299610743385
variable C5pos equal ${d5}
variable C5pos equal 0.364330332113767
variable C6pos equal ${d6}
variable C6pos equal 4.66667259784064

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(4.32775728794339+${C1pos})
variable C12 equal 0.5*(4.32775728794339+38.7580354577078)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(46.420569931991+${C2pos})
variable C22 equal 0.5*(46.420569931991+31.9200226591822)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(5.55848577629505+${C3pos})
variable C32 equal 0.5*(5.55848577629505+42.9863440354675)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-12.9118794649387+${C4pos})
variable C42 equal 0.5*(-12.9118794649387+-0.0721299610743385)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(1.76453802692774+${C5pos})
variable C52 equal 0.5*(1.76453802692774+0.364330332113767)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(0.0323497510116324+${C6pos})
variable C62 equal 0.5*(0.0323497510116324+4.66667259784064)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0237234147291
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0237234147291
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.170237234147291 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.093324) with tilt (-7.6265417 -1.2687662 0.93829071)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.9 | 128.7 | 130.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34547.426      71610.313      0              3267.9619    
       100   295.82128     -34566.238     -13038.305      2981.2251      3267.9619    
       200   283.45596     -34568.919      10603.94      -5974.9315      3267.9619    
       300   302.65259     -34574.491     -3293.5863     -1688.2902      3267.9619    
       400   304.33015     -34556.914      7532.2321      2860.3016      3267.9619    
       500   322.53412     -34530.109     -17236.895      821.35333      3267.9619    
       600   298.31414     -34506.829      279.03004     -1713.4507      3267.9619    
       700   318.64368     -34550.732     -6356.524      -4992.3131      3267.9619    
       800   311.85577     -34564.486      4876.1755      3495.5424      3267.9619    
       900   287.58703     -34557.06       4992.6762      1370.7413      3267.9619    
      1000   291.45627     -34570.883     -14017.45      -5921.2589      3267.9619    
      1100   296.96019     -34576.221      12074.135      3505.2184      3267.9619    
      1200   308.14934     -34556.396      15185.537      8848.9421      3267.9619    
      1300   293.90022     -34525.638     -589.06161      1077.3882      3267.9619    
      1400   317.96207     -34547.505      1980.3027     -3326.998       3267.9619    
      1500   295.8812      -34557.406     -1666.1574      644.31292      3267.9619    
      1600   300.65699     -34578.899      3389.483      -2961.7476      3267.9619    
      1700   294.59627     -34566.641      3470.6923     -2112.9509      3267.9619    
      1800   303.10744     -34554.191      12208.885      4177.2376      3267.9619    
      1900   312.65475     -34554.819     -6239.6024     -3075.7647      3267.9619    
      2000   297.03216     -34536.202      2515.1673     -2037.6151      3267.9619    
Loop time of 100.177 on 8 procs for 2000 steps with 310 atoms

Performance: 0.862 ns/day, 27.827 hours/ns, 19.965 timesteps/s, 6.189 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.832     | 81.746     | 84.43      |  18.7 | 81.60
Bond    | 0.00064368 | 0.00086186 | 0.0009928  |   0.0 |  0.00
Neigh   | 5.7744     | 5.9838     | 6.2079     |   6.3 |  5.97
Comm    | 1.071      | 3.7572     | 5.6685     |  87.0 |  3.75
Output  | 0.0044298  | 0.0054582  | 0.0063611  |   1.0 |  0.01
Modify  | 8.4185     | 8.6422     | 8.8501     |   5.2 |  8.63
Other   |            | 0.04138    |            |       |  0.04

Nlocal:          38.75 ave          46 max          31 min
Histogram: 1 0 1 1 1 0 1 1 1 1
Nghost:         3313.5 ave        3384 max        3252 min
Histogram: 2 0 2 0 0 1 0 1 1 1
Neighs:        25838.1 ave       30328 max       20910 min
Histogram: 1 0 1 2 0 0 1 2 0 1

Total # of neighbors = 206705
Ave neighs/atom = 666.79032
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.9 | 128.7 | 130.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   297.03216     -34536.202      2515.2087      0              3267.9619    
       100   298.0054      -34547.817      1313.5951      2302.5975      3267.9619    
       200   298.76083     -34572.856     -5860.7766      5541.8746      3267.9619    
       300   275.08761     -34572.277      2266.7094     -3544.7644      3267.9619    
       400   260.69572     -34540.403      2386.2764     -3535.0442      3267.9619    
       500   296.78721     -34543.336      2443.6152     -1000.6548      3267.9619    
       600   301.28306     -34543.576      14916.061     -2081.3511      3267.9619    
       700   321.48621     -34562.251      14679.947      3642.9286      3267.9619    
       800   295.48823     -34560.33       6483.2652     -3576.9772      3267.9619    
       900   274.99489     -34561.554     -1324.678       1101.0229      3267.9619    
      1000   283.74234     -34564.757      10131.028      1944.3408      3267.9619    
      1100   304.31564     -34564.336     -6392.7834      3781.8282      3267.9619    
      1200   324.39529     -34554.402     -620.74834      3073.2148      3267.9619    
      1300   304.42925     -34540.126      1969.3408      1771.5558      3267.9619    
      1400   303.10839     -34553.547     -14853.341      1563.9708      3267.9619    
      1500   296.81247     -34563.717      6979.5308     -1921.0497      3267.9619    
      1600   271.74383     -34549.852     -3092.2613      3749.0069      3267.9619    
      1700   292.52218     -34552.772     -1782.0753      1465.7233      3267.9619    
      1800   305.24455     -34532.668      9101.0715      1573.9238      3267.9619    
      1900   301.37384     -34528.532      1680.4808      6072.7448      3267.9619    
      2000   287.03278     -34541.373      2130.1958      4477.2603      3267.9619    
Loop time of 100.271 on 8 procs for 2000 steps with 310 atoms

Performance: 0.862 ns/day, 27.853 hours/ns, 19.946 timesteps/s, 6.183 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.326     | 81.417     | 84.903     |  20.9 | 81.20
Bond    | 0.00069495 | 0.00087178 | 0.0010166  |   0.0 |  0.00
Neigh   | 5.7787     | 5.9551     | 6.2033     |   5.6 |  5.94
Comm    | 0.77393    | 4.2711     | 6.3673     |  91.5 |  4.26
Output  | 0.0011121  | 0.0012105  | 0.0017399  |   0.6 |  0.00
Modify  | 8.344      | 8.5853     | 8.759      |   4.6 |  8.56
Other   |            | 0.04072    |            |       |  0.04

Nlocal:          38.75 ave          48 max          31 min
Histogram: 1 0 1 0 2 3 0 0 0 1
Nghost:        3310.75 ave        3366 max        3255 min
Histogram: 1 1 0 0 3 1 0 0 1 1
Neighs:          25851 ave       31654 max       20893 min
Histogram: 1 0 1 0 2 3 0 0 0 1

Total # of neighbors = 206808
Ave neighs/atom = 667.12258
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 50.9121847553932
variable C2neg equal ${d2}
variable C2neg equal 73.3444427219097
variable C3neg equal ${d3}
variable C3neg equal 49.0371022082768
variable C4neg equal ${d4}
variable C4neg equal 4.98311516841895
variable C5neg equal ${d5}
variable C5neg equal -8.7035950356054
variable C6neg equal ${d6}
variable C6neg equal -7.71684141634219

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0237234147291
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.170237234147291 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.433799) with tilt (-7.6265417 -1.2687662 0.93829071)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.2 | 126.9 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34558.111     -51988.658      0              3333.9813    
       100   295.3689      -34570.757     -10946.486     -2421.3546      3333.9813    
       200   269.82788     -34555.709     -3467.1647     -8626.0953      3333.9813    
       300   318.8392      -34574.775     -76.617669      1462.705       3333.9813    
       400   325.29959     -34557.9       -10267.05      -2290.4254      3333.9813    
       500   307.88904     -34551.813     -6309.7239     -364.70902      3333.9813    
       600   311.03983     -34563.621      3407.8583     -6721.8363      3333.9813    
       700   307.18002     -34562.064     -14557.878     -5423.8102      3333.9813    
       800   291.53212     -34553.597      9764.0714     -3172.5934      3333.9813    
       900   286.74309     -34556.416      8018.4523      1342.1115      3333.9813    
      1000   290.29887     -34562.265      5742.1083     -3023.4415      3333.9813    
      1100   305.74024     -34565.004      7855.6879     -3972.4629      3333.9813    
      1200   305.10121     -34544.167     -929.36959      436.38805      3333.9813    
      1300   304.71809     -34525.409      9203.0593      2842.1556      3333.9813    
      1400   321.14791     -34531.857     -4966.0267      1997.4052      3333.9813    
      1500   320.51304     -34561.35      -23616.847      389.47898      3333.9813    
      1600   296.51667     -34565.254      4215.8572     -2999.9384      3333.9813    
      1700   296.1934      -34565.043     -1159.9895     -897.1685       3333.9813    
      1800   298.47961     -34558.846     -1353.618       1126.4226      3333.9813    
      1900   336.83276     -34572.998     -13113.563     -1209.1329      3333.9813    
      2000   306.33777     -34541.332     -914.53251      1397.7498      3333.9813    
Loop time of 97.4886 on 8 procs for 2000 steps with 310 atoms

Performance: 0.886 ns/day, 27.080 hours/ns, 20.515 timesteps/s, 6.360 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.095     | 79.137     | 82.023     |  19.3 | 81.18
Bond    | 0.00070074 | 0.0008545  | 0.00099278 |   0.0 |  0.00
Neigh   | 5.6885     | 5.8413     | 6.0598     |   5.0 |  5.99
Comm    | 0.8961     | 3.7851     | 5.828      |  88.1 |  3.88
Output  | 0.0040911  | 0.0050724  | 0.0059442  |   1.0 |  0.01
Modify  | 8.4591     | 8.6779     | 8.8362     |   4.2 |  8.90
Other   |            | 0.04115    |            |       |  0.04

Nlocal:          38.75 ave          50 max          31 min
Histogram: 1 0 1 3 1 0 1 0 0 1
Nghost:         3253.5 ave        3298 max        3216 min
Histogram: 2 2 0 0 0 0 0 2 1 1
Neighs:        25294.4 ave       32226 max       20465 min
Histogram: 1 0 1 3 1 0 1 0 0 1

Total # of neighbors = 202355
Ave neighs/atom = 652.75806
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.2 | 126.7 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   306.33777     -34541.332     -914.49164      0              3333.9813    
       100   295.43862     -34538.8        2397.7849      205.03385      3333.9813    
       200   284.33451     -34560.623     -3546.2385     -3242.1454      3333.9813    
       300   272.14557     -34556.307      7923.6306     -1045.6464      3333.9813    
       400   300.35102     -34572.922     -6554.3308     -2538.7666      3333.9813    
       500   311.11812     -34568.477     -3723.5711     -4502.321       3333.9813    
       600   303.55573     -34555.955     -8425.029       4941.6289      3333.9813    
       700   302.79186     -34547.296     -15822.166      1653.1882      3333.9813    
       800   320.30293     -34526.397      12142.071     -6031.2658      3333.9813    
       900   323.35099     -34526.302     -7078.1046      3952.9075      3333.9813    
      1000   305.40282     -34544.749      7574.6206      3537.3722      3333.9813    
      1100   301.51048     -34555.881     -8399.6496      1944.8058      3333.9813    
      1200   300.81699     -34567.58       3599.5275      290.20378      3333.9813    
      1300   296.58471     -34567.918      1353.9846     -4339.9134      3333.9813    
      1400   288.46201     -34543.703     -4478.8306      4737.6995      3333.9813    
      1500   300.97857     -34529.969      22377.405      760.57432      3333.9813    
      1600   307.70957     -34541.633      1347.0007     -265.71146      3333.9813    
      1700   303.95594     -34556.344      18455.734      1280.7081      3333.9813    
      1800   291.70436     -34567.277     -3566.5694      2059.7092      3333.9813    
      1900   265.89309     -34565.319     -15631.638     -3817.8574      3333.9813    
      2000   275.68482     -34588.588      1902.2129     -370.35313      3333.9813    
Loop time of 97.4745 on 8 procs for 2000 steps with 310 atoms

Performance: 0.886 ns/day, 27.076 hours/ns, 20.518 timesteps/s, 6.361 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.531     | 79.425     | 82.085     |  16.9 | 81.48
Bond    | 0.00070233 | 0.00086949 | 0.0010816  |   0.0 |  0.00
Neigh   | 5.6873     | 5.8556     | 6.0994     |   5.1 |  6.01
Comm    | 0.81266    | 3.4767     | 5.3727     |  80.6 |  3.57
Output  | 0.0010355  | 0.0012098  | 0.0016981  |   0.5 |  0.00
Modify  | 8.4303     | 8.6734     | 8.8463     |   4.3 |  8.90
Other   |            | 0.04146    |            |       |  0.04

Nlocal:          38.75 ave          47 max          29 min
Histogram: 1 0 1 1 0 2 1 0 0 2
Nghost:        3241.12 ave        3289 max        3199 min
Histogram: 1 2 1 0 0 0 1 1 1 1
Neighs:        25312.8 ave       30640 max       19234 min
Histogram: 1 0 1 1 1 1 1 0 0 2

Total # of neighbors = 202502
Ave neighs/atom = 653.23226
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -1.79374155288562
variable C2pos equal ${d2}
variable C2pos equal -33.0765696060033
variable C3pos equal ${d3}
variable C3pos equal 24.689375429165
variable C4pos equal ${d4}
variable C4pos equal -3.49964105457918
variable C5pos equal ${d5}
variable C5pos equal 2.77027011831075
variable C6pos equal ${d6}
variable C6pos equal 0.636904273315438

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(50.9121847553932+${C1pos})
variable C13 equal 0.5*(50.9121847553932+-1.79374155288562)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(73.3444427219097+${C2pos})
variable C23 equal 0.5*(73.3444427219097+-33.0765696060033)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(49.0371022082768+${C3pos})
variable C33 equal 0.5*(49.0371022082768+24.689375429165)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(4.98311516841895+${C4pos})
variable C43 equal 0.5*(4.98311516841895+-3.49964105457918)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-8.7035950356054+${C5pos})
variable C53 equal 0.5*(-8.7035950356054+2.77027011831075)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-7.71684141634219+${C6pos})
variable C63 equal 0.5*(-7.71684141634219+0.636904273315438)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0237234147291
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0237234147291
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.170237234147291 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.76805348)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.1 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34567.756      8968.6377      0              3300.9716    
       100   294.09819     -34577.14      -13466.658     -226.63628      3300.9716    
       200   277.61095     -34563.615     -6212.8453     -8879.0513      3300.9716    
       300   307.8229      -34558.234      3297.6109      1679.7977      3300.9716    
       400   303.75107     -34542.469      1552.9454      798.67152      3300.9716    
       500   296.10609     -34547.254      9670.0692     -2760.6079      3300.9716    
       600   289.25887     -34556.14      -471.85518      926.19437      3300.9716    
       700   286.26747     -34560.552     -3790.8237     -431.9412       3300.9716    
       800   278.46048     -34550.949     -5811.8965      2394.241       3300.9716    
       900   316.54457     -34559.843      1557.2352      438.54804      3300.9716    
      1000   311.19945     -34547.45      -229.8333      -189.12405      3300.9716    
      1100   293.50913     -34546.415      3662.5118     -575.9911       3300.9716    
      1200   289.38205     -34568.541      5709.5826     -4981.1174      3300.9716    
      1300   298.64976     -34579.568     -12615.862      6114.5488      3300.9716    
      1400   288.75335     -34557.649      4427.0753     -1690.5681      3300.9716    
      1500   307.28062     -34567.998     -2757.0246     -3102.831       3300.9716    
      1600   289.7983      -34546.151     -681.6758      -10259.662      3300.9716    
      1700   299.01259     -34548.539      1894.1789      1198.2518      3300.9716    
      1800   321.92644     -34551.656      5593.2926     -13.020935      3300.9716    
      1900   310.77462     -34537.007     -7614.3955     -5167.8247      3300.9716    
      2000   307.03243     -34562.17      -21371.75       55.965321      3300.9716    
Loop time of 97.6083 on 8 procs for 2000 steps with 310 atoms

Performance: 0.885 ns/day, 27.113 hours/ns, 20.490 timesteps/s, 6.352 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.101     | 79.884     | 82.204     |  16.3 | 81.84
Bond    | 0.00067734 | 0.0008627  | 0.0011016  |   0.0 |  0.00
Neigh   | 5.73       | 5.8724     | 6.0053     |   4.1 |  6.02
Comm    | 1.0634     | 3.3869     | 5.1613     |  79.2 |  3.47
Output  | 0.0042739  | 0.0052529  | 0.0061045  |   0.9 |  0.01
Modify  | 8.279      | 8.4169     | 8.559      |   3.5 |  8.62
Other   |            | 0.04151    |            |       |  0.04

Nlocal:          38.75 ave          47 max          30 min
Histogram: 1 0 0 0 3 2 1 0 0 1
Nghost:         3273.5 ave        3303 max        3238 min
Histogram: 2 1 0 0 1 0 0 0 2 2
Neighs:        25555.5 ave       30720 max       20030 min
Histogram: 1 0 0 0 3 2 1 0 0 1

Total # of neighbors = 204444
Ave neighs/atom = 659.49677
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.1 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.03243     -34562.17      -21371.733      0              3300.9716    
       100   287.55649     -34543.805      11734.869      2313.849       3300.9716    
       200   301.80104     -34557.101     -2454.7951      408.76303      3300.9716    
       300   308.82604     -34561.572      10241.359      5490.3214      3300.9716    
       400   308.97369     -34567.241     -9599.4138     -2181.675       3300.9716    
       500   303.34164     -34575.393     -2186.096       331.27708      3300.9716    
       600   303.196       -34587.786     -4289.9792     -161.4073       3300.9716    
       700   302.17482     -34587.36       1163.0675     -1336.1044      3300.9716    
       800   310.03383     -34562.844     -15049.141      1202.2634      3300.9716    
       900   321.92634     -34560.8       -5058.1821      615.48046      3300.9716    
      1000   305.51707     -34554.092     -4689.8403      2413.3419      3300.9716    
      1100   292.45579     -34561.572      2020.5274      5432.9824      3300.9716    
      1200   291.89815     -34585.71      -6336.0778      1098.4264      3300.9716    
      1300   290.39078     -34575.44      -3140.4915      4893.1852      3300.9716    
      1400   283.81462     -34557.862      6389.1462      1159.7439      3300.9716    
      1500   307.54821     -34561.069     -9386.4611     -2225.0364      3300.9716    
      1600   309.60628     -34558.802      2057.0494      3744.146       3300.9716    
      1700   318.65863     -34568.173     -6687.9395     -5292.0238      3300.9716    
      1800   278.28384     -34564.181     -2393.412       6308.1368      3300.9716    
      1900   277.75126     -34573.247      5344.8021      8810.5891      3300.9716    
      2000   290.38801     -34566.436     -1867.4305     -5508.8791      3300.9716    
Loop time of 97.449 on 8 procs for 2000 steps with 310 atoms

Performance: 0.887 ns/day, 27.069 hours/ns, 20.524 timesteps/s, 6.362 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.288     | 79.942     | 82.082     |  15.6 | 82.04
Bond    | 0.00065464 | 0.00085965 | 0.0010927  |   0.0 |  0.00
Neigh   | 5.7601     | 5.8827     | 5.9836     |   3.5 |  6.04
Comm    | 1.0691     | 3.2099     | 4.8596     |  77.8 |  3.29
Output  | 0.00098171 | 0.0011041  | 0.0017538  |   0.7 |  0.00
Modify  | 8.2622     | 8.3701     | 8.4946     |   3.0 |  8.59
Other   |            | 0.04198    |            |       |  0.04

Nlocal:          38.75 ave          49 max          32 min
Histogram: 1 0 2 2 1 1 0 0 0 1
Nghost:        3285.88 ave        3340 max        3241 min
Histogram: 2 1 1 0 0 0 1 1 1 1
Neighs:        25578.9 ave       31982 max       21322 min
Histogram: 1 0 2 2 1 1 0 0 0 1

Total # of neighbors = 204631
Ave neighs/atom = 660.1
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -50.2723725198452
variable C2neg equal ${d2}
variable C2neg equal -21.7145636323236
variable C3neg equal ${d3}
variable C3neg equal -76.7031359331933
variable C4neg equal ${d4}
variable C4neg equal 7.26139242890404
variable C5neg equal ${d5}
variable C5neg equal -3.24295881260489
variable C6neg equal ${d6}
variable C6neg equal 16.0849064735125

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0237234147291
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.170237234147291 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 1.1085279)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128.1 | 129.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34569.146      8434.3232      0              3300.9716    
       100   292.98307     -34575.069     -9193.2298      181.07559      3300.9716    
       200   276.75944     -34559.519     -4247.3169     -7257.0324      3300.9716    
       300   303.55261     -34549.504     -8170.1891      6747.7081      3300.9716    
       400   321.1197      -34561.27      -2481.5103      2066.3785      3300.9716    
       500   281.29494     -34538.403      396.81349     -2382.6889      3300.9716    
       600   284.68925     -34548.598      2781.077       1983.2951      3300.9716    
       700   299.57159     -34556.967     -3861.776      -4538.55        3300.9716    
       800   298.57629     -34533.992     -12578.09      -3605.6189      3300.9716    
       900   330.34262     -34557.234     -14528.119     -2710.8987      3300.9716    
      1000   312.76181     -34567.332     -3954.889      -3102.1149      3300.9716    
      1100   291.92583     -34565.313     -11724.624     -1213.7261      3300.9716    
      1200   283.22824     -34557.535      12325.167      7464.0721      3300.9716    
      1300   328.47262     -34579.033      19403.372      5127.6033      3300.9716    
      1400   299.27346     -34538.831      18697.885      2326.2112      3300.9716    
      1500   315.9688      -34555.118     -2457.3524      1157.7367      3300.9716    
      1600   296.67395     -34572.474     -12402.706     -5552.9291      3300.9716    
      1700   294.41415     -34583.854      5251.4487     -2046.1678      3300.9716    
      1800   285.13052     -34563.639      16463.963      1342.6596      3300.9716    
      1900   296.7263      -34550.91       2675.9927      2019.9776      3300.9716    
      2000   314.66879     -34551.144     -6715.8366     -7265.9824      3300.9716    
Loop time of 97.5695 on 8 procs for 2000 steps with 310 atoms

Performance: 0.886 ns/day, 27.103 hours/ns, 20.498 timesteps/s, 6.354 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.188     | 79.903     | 82.171     |  15.8 | 81.89
Bond    | 0.00065505 | 0.00086729 | 0.0011221  |   0.0 |  0.00
Neigh   | 5.7436     | 5.9401     | 6.0849     |   4.4 |  6.09
Comm    | 0.98003    | 3.2511     | 4.9599     |  78.5 |  3.33
Output  | 0.0041189  | 0.0050611  | 0.0059246  |   1.0 |  0.01
Modify  | 8.2822     | 8.4269     | 8.624      |   3.7 |  8.64
Other   |            | 0.04242    |            |       |  0.04

Nlocal:          38.75 ave          44 max          33 min
Histogram: 1 2 0 1 0 1 0 0 0 3
Nghost:        3277.62 ave        3315 max        3236 min
Histogram: 1 0 0 1 1 2 1 1 0 1
Neighs:        25577.6 ave       28889 max       21982 min
Histogram: 1 2 0 1 0 1 0 0 0 3

Total # of neighbors = 204621
Ave neighs/atom = 660.06774
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.1 | 128.1 | 129.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   314.66879     -34551.144     -6715.8578      0              3300.9716    
       100   300.6315      -34553.155     -14119.694      2741.189       3300.9716    
       200   279.10509     -34557.672      14831.517     -1188.3928      3300.9716    
       300   286.31728     -34565.193      10881.979      1044.6246      3300.9716    
       400   269.16239     -34537.446     -6700.87        7341.1197      3300.9716    
       500   303.76747     -34553.222     -16799.666     -7189.5536      3300.9716    
       600   314.4331      -34557.354      9918.5224     -241.32631      3300.9716    
       700   304.13576     -34553.782     -445.93168      3018.7167      3300.9716    
       800   306.32683     -34578.73      -6139.3106     -772.71508      3300.9716    
       900   278.27824     -34559.715     -5772.5861     -2230.5205      3300.9716    
      1000   334.34632     -34584.507      10096.276     -2903.4291      3300.9716    
      1100   309.60447     -34553.779      74.63444       6165.7209      3300.9716    
      1200   295.42109     -34547.224      15757.847      7217.6671      3300.9716    
      1300   274.26404     -34536.846      4654.5814     -2873.7547      3300.9716    
      1400   304.74562     -34565.265     -7695.0929      2256.7215      3300.9716    
      1500   318.0659      -34569.069     -6217.4564      1592.1368      3300.9716    
      1600   320.22581     -34552.966      1805.2598      5068.5845      3300.9716    
      1700   332.40389     -34545.067     -9476.5555     -2160.5587      3300.9716    
      1800   296.04317     -34532.129     -10408.085     -3381.0379      3300.9716    
      1900   294.26032     -34550.408     -1421.1922      3008.0561      3300.9716    
      2000   300.46475     -34564.241     -12775.21      -1204.4509      3300.9716    
Loop time of 97.4682 on 8 procs for 2000 steps with 310 atoms

Performance: 0.886 ns/day, 27.075 hours/ns, 20.520 timesteps/s, 6.361 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.327     | 80.145     | 82.029     |  13.5 | 82.23
Bond    | 0.00065827 | 0.00085981 | 0.0010834  |   0.0 |  0.00
Neigh   | 5.8585     | 5.983      | 6.1632     |   4.1 |  6.14
Comm    | 1.088      | 2.9724     | 4.7893     |  69.9 |  3.05
Output  | 0.00095064 | 0.0010934  | 0.0018049  |   0.8 |  0.00
Modify  | 8.1444     | 8.3225     | 8.4506     |   3.5 |  8.54
Other   |            | 0.04355    |            |       |  0.04

Nlocal:          38.75 ave          45 max          34 min
Histogram: 2 0 2 0 2 0 0 0 0 2
Nghost:        3270.62 ave        3311 max        3227 min
Histogram: 2 0 1 0 0 1 1 1 0 2
Neighs:        25553.6 ave       29399 max       22530 min
Histogram: 2 0 2 0 2 0 0 0 0 2

Total # of neighbors = 204429
Ave neighs/atom = 659.44839
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 6.65775456100365
variable C2pos equal ${d2}
variable C2pos equal 16.0410567835277
variable C3pos equal ${d3}
variable C3pos equal 79.9222202875259
variable C4pos equal ${d4}
variable C4pos equal 14.1158826603018
variable C5pos equal ${d5}
variable C5pos equal -16.3583395915534
variable C6pos equal ${d6}
variable C6pos equal 20.3102378142823

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-50.2723725198452+${C1pos})
variable C14 equal 0.5*(-50.2723725198452+6.65775456100365)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-21.7145636323236+${C2pos})
variable C24 equal 0.5*(-21.7145636323236+16.0410567835277)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-76.7031359331933+${C3pos})
variable C34 equal 0.5*(-76.7031359331933+79.9222202875259)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(7.26139242890404+${C4pos})
variable C44 equal 0.5*(7.26139242890404+14.1158826603018)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-3.24295881260489+${C5pos})
variable C54 equal 0.5*(-3.24295881260489+-16.3583395915534)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(16.0849064735125+${C6pos})
variable C64 equal 0.5*(16.0849064735125+20.3102378142823)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0237234147291
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0237234147291
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.170237234147291 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.4390034 0.93829071)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.1 | 128.1 | 129.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34566.129      7215.9643      0              3300.9716    
       100   294.29725     -34575.708     -6467.6608     -384.46624      3300.9716    
       200   275.58542     -34563.555     -2834.9676     -6595.4584      3300.9716    
       300   300.02723     -34554.171     -2702.5993      3698.2065      3300.9716    
       400   320.38559     -34559.418     -3108.2274      2812.9531      3300.9716    
       500   283.46442     -34533.578      16216.8        2129.516       3300.9716    
       600   286.85226     -34548.485      7400.5014     -3169.8945      3300.9716    
       700   280.61734     -34561.295     -3617.4945     -575.42426      3300.9716    
       800   273.94824     -34568.107     -6172.0336     -2891.2135      3300.9716    
       900   283.3309      -34548.007      10162.529     -3532.2951      3300.9716    
      1000   293.29641     -34538.075     -6287.3869     -788.79464      3300.9716    
      1100   296.70121     -34533.64       8938.2747     -524.62174      3300.9716    
      1200   315.87577     -34568.536      5279.7546      1461.2673      3300.9716    
      1300   292.5658      -34571.375      10250.772      3151.4511      3300.9716    
      1400   310.52548     -34585.002     -3195.9734     -523.8101       3300.9716    
      1500   290.42006     -34558.978      3267.2044      2611.5922      3300.9716    
      1600   300.02365     -34549.942     -6099.793      -3221.2231      3300.9716    
      1700   312.82221     -34526.478     -16258.265     -2805.9558      3300.9716    
      1800   330.06259     -34530.563     -1420.6361     -1266.4144      3300.9716    
      1900   310.99134     -34528.252      1966.7408     -2056.9914      3300.9716    
      2000   313.14263     -34550.648     -518.99632     -2256.5719      3300.9716    
Loop time of 97.5444 on 8 procs for 2000 steps with 310 atoms

Performance: 0.886 ns/day, 27.096 hours/ns, 20.503 timesteps/s, 6.356 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.968     | 79.838     | 82.223     |  16.4 | 81.85
Bond    | 0.00065512 | 0.0008447  | 0.0010211  |   0.0 |  0.00
Neigh   | 5.8188     | 5.9497     | 6.1012     |   4.4 |  6.10
Comm    | 0.93012    | 3.3205     | 5.1904     |  80.6 |  3.40
Output  | 0.0045384  | 0.0055115  | 0.0063496  |   0.9 |  0.01
Modify  | 8.2366     | 8.3879     | 8.5202     |   3.8 |  8.60
Other   |            | 0.04229    |            |       |  0.04

Nlocal:          38.75 ave          45 max          32 min
Histogram: 1 0 0 1 1 1 3 0 0 1
Nghost:           3287 ave        3339 max        3241 min
Histogram: 1 1 0 2 0 1 1 1 0 1
Neighs:        25566.5 ave       29415 max       21314 min
Histogram: 1 0 1 0 1 1 3 0 0 1

Total # of neighbors = 204532
Ave neighs/atom = 659.78065
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.1 | 128.1 | 129.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   313.14263     -34550.648     -519.01411      0              3300.9716    
       100   288.66913     -34534.451     -6375.1562     -640.73537      3300.9716    
       200   277.17688     -34547.978     -4053.572       4278.2238      3300.9716    
       300   283.02748     -34568.011     -3273.5541      3864.0763      3300.9716    
       400   286.88486     -34554.963     -3059.7034     -9440.3113      3300.9716    
       500   333.48556     -34564.973     -9561.36       -6159.7924      3300.9716    
       600   319.66071     -34561.055      12055.535      4864.9392      3300.9716    
       700   310.9645      -34572.227      6580.9681     -4508.1508      3300.9716    
       800   315.36685     -34581.74      -1509.5937      806.19118      3300.9716    
       900   302.51516     -34570.836      6195.5329      290.99923      3300.9716    
      1000   303.22426     -34542.957      6705.9325     -6936.9061      3300.9716    
      1100   302.2803      -34527.345      8038.5561      5382.5099      3300.9716    
      1200   323.73108     -34561.6       -5702.017      -5388.9595      3300.9716    
      1300   294.8334      -34561.888     -526.1511       3634.9476      3300.9716    
      1400   299.3145      -34566.77       11547.052      7920.0928      3300.9716    
      1500   295.43225     -34558.307     -4598.1627     -478.44257      3300.9716    
      1600   311.85586     -34562.657     -343.37439     -4394.4973      3300.9716    
      1700   331.93421     -34550.084     -3103.2671      3053.0478      3300.9716    
      1800   325.94201     -34555.885      11553.588      2602.6177      3300.9716    
      1900   295.27741     -34554.213     -1578.2561     -1802.0106      3300.9716    
      2000   285.39221     -34551.324     -14279.866     -8951.0685      3300.9716    
Loop time of 98.047 on 8 procs for 2000 steps with 310 atoms

Performance: 0.881 ns/day, 27.235 hours/ns, 20.398 timesteps/s, 6.323 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.465     | 80.484     | 82.483     |  15.6 | 82.09
Bond    | 0.00066435 | 0.0008578  | 0.0010396  |   0.0 |  0.00
Neigh   | 5.8575     | 5.9739     | 6.1247     |   3.7 |  6.09
Comm    | 1.1981     | 3.199      | 5.218      |  78.3 |  3.26
Output  | 0.00099293 | 0.0011061  | 0.0016428  |   0.6 |  0.00
Modify  | 8.1938     | 8.3458     | 8.4653     |   3.2 |  8.51
Other   |            | 0.04264    |            |       |  0.04

Nlocal:          38.75 ave          49 max          29 min
Histogram: 1 0 0 0 3 3 0 0 0 1
Nghost:        3279.12 ave        3322 max        3241 min
Histogram: 2 2 0 0 0 0 1 0 2 1
Neighs:          25565 ave       31882 max       19409 min
Histogram: 1 0 0 1 2 3 0 0 0 1

Total # of neighbors = 204520
Ave neighs/atom = 659.74194
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -85.1503572848129
variable C2neg equal ${d2}
variable C2neg equal -46.6329625437964
variable C3neg equal ${d3}
variable C3neg equal -134.983035025465
variable C4neg equal ${d4}
variable C4neg equal 4.70684542215996
variable C5neg equal ${d5}
variable C5neg equal 16.254659904378
variable C6neg equal ${d6}
variable C6neg equal -1.07972620504099

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0237234147291
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.170237234147291 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.098529 0.93829071)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 127.9 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34570.008      8484.1709      0              3300.9716    
       100   294.02515     -34577.837     -10335.561      934.4608       3300.9716    
       200   275.11333     -34556.649     -1335.2701     -5975.2852      3300.9716    
       300   302.83585     -34548.201     -521.15184     -3540.4931      3300.9716    
       400   307.70632     -34550.021      5409.4008     -942.13192      3300.9716    
       500   288.50449     -34546.51      -10830.393      666.17434      3300.9716    
       600   299.77193     -34567.091     -2576.0479     -1953.8961      3300.9716    
       700   289.69065     -34568.84      -10354.064     -4191.9319      3300.9716    
       800   287.18368     -34569.602      7577.7162      3200.527       3300.9716    
       900   304.7498      -34561.027      6745.3568      1153.9488      3300.9716    
      1000   307.67402     -34548.313     -17037.967     -4021.0926      3300.9716    
      1100   314.5344      -34563.177     -9264.3353     -3124.0964      3300.9716    
      1200   288.84771     -34566.103     -11907.676      2750.7747      3300.9716    
      1300   296.60348     -34582.824      1256.2963      7076.6714      3300.9716    
      1400   300.85325     -34563.682     -2715.7582     -4649.1653      3300.9716    
      1500   309.60908     -34545.788      232.94482     -5872.1782      3300.9716    
      1600   327.97626     -34564.318      1472.3454     -198.58003      3300.9716    
      1700   297.93572     -34561.571      6030.4365     -2746.3868      3300.9716    
      1800   281.26294     -34562.121     -2021.6665      4060.6388      3300.9716    
      1900   281.97573     -34553.441      1563.3331     -2018.7874      3300.9716    
      2000   304.04074     -34550.08      -9903.4871     -5520.911       3300.9716    
Loop time of 98.3528 on 8 procs for 2000 steps with 310 atoms

Performance: 0.878 ns/day, 27.320 hours/ns, 20.335 timesteps/s, 6.304 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.845     | 80.582     | 82.752     |  16.3 | 81.93
Bond    | 0.00065046 | 0.00085583 | 0.0010757  |   0.0 |  0.00
Neigh   | 5.7432     | 5.9037     | 6.0443     |   4.2 |  6.00
Comm    | 1.2221     | 3.3904     | 5.1226     |  79.4 |  3.45
Output  | 0.0044977  | 0.0054931  | 0.0064009  |   1.0 |  0.01
Modify  | 8.2856     | 8.4285     | 8.5947     |   3.6 |  8.57
Other   |            | 0.04169    |            |       |  0.04

Nlocal:          38.75 ave          46 max          33 min
Histogram: 1 0 1 2 1 1 1 0 0 1
Nghost:        3280.38 ave        3351 max        3213 min
Histogram: 1 2 1 0 0 0 1 1 1 1
Neighs:        25537.1 ave       30079 max       21981 min
Histogram: 1 0 2 1 1 1 1 0 0 1

Total # of neighbors = 204297
Ave neighs/atom = 659.02258
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 127.9 | 129.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.04074     -34550.08      -9903.5081      0              3300.9716    
       100   308.28114     -34564.124     -8722.2686      3756.0845      3300.9716    
       200   301.89062     -34582.398     -6350.2837     -4698.339       3300.9716    
       300   278.4039      -34580.01       937.28318     -40.617659      3300.9716    
       400   291.26446     -34571.235      8291.2853      2931.7282      3300.9716    
       500   314.31796     -34566.727     -3659.0235      2190.2956      3300.9716    
       600   314.69307     -34558.431      11574.839      1401.8675      3300.9716    
       700   302.99743     -34548.611      5862.7315      1678.9401      3300.9716    
       800   315.81001     -34575.423     -18444.621     -1002.1065      3300.9716    
       900   291.63661     -34572.381     -946.37203     -2548.8663      3300.9716    
      1000   295.03091     -34570.898     -8244.8306      1663.4783      3300.9716    
      1100   317.22992     -34553.472     -8598.8288      2757.4101      3300.9716    
      1200   298.45784     -34530.592     -17195.794      3438.8715      3300.9716    
      1300   295.01686     -34534.247     -4014.5638     -4216.5241      3300.9716    
      1400   297.71346     -34563.158     -10857.911     -2973.6322      3300.9716    
      1500   293.54018     -34573.594     -8275.474       5327.0599      3300.9716    
      1600   312.38573     -34586.79      -2553.1208      2366.1665      3300.9716    
      1700   289.07174     -34549.72      -6339.9643     -761.47208      3300.9716    
      1800   303.50216     -34549.523     -7057.4768     -1340.4606      3300.9716    
      1900   299.17046     -34549.584     -15133.645     -389.84025      3300.9716    
      2000   288.51498     -34580.901     -6707.1093     -384.9684       3300.9716    
Loop time of 98.0706 on 8 procs for 2000 steps with 310 atoms

Performance: 0.881 ns/day, 27.242 hours/ns, 20.393 timesteps/s, 6.322 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.326     | 80.094     | 82.709     |  17.7 | 81.67
Bond    | 0.00064782 | 0.00084653 | 0.0010483  |   0.0 |  0.00
Neigh   | 5.7159     | 5.896      | 6.0077     |   4.1 |  6.01
Comm    | 0.97491    | 3.5906     | 5.352      |  83.7 |  3.66
Output  | 0.00092206 | 0.0010829  | 0.001745   |   0.8 |  0.00
Modify  | 8.3298     | 8.4462     | 8.6295     |   3.5 |  8.61
Other   |            | 0.04159    |            |       |  0.04

Nlocal:          38.75 ave          48 max          33 min
Histogram: 1 0 3 0 3 0 0 0 0 1
Nghost:         3286.5 ave        3338 max        3244 min
Histogram: 1 1 0 2 1 0 1 1 0 1
Neighs:          25560 ave       31301 max       21975 min
Histogram: 1 0 3 0 3 0 0 0 0 1

Total # of neighbors = 204480
Ave neighs/atom = 659.6129
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -1.64565239615425
variable C2pos equal ${d2}
variable C2pos equal -9.34889171451388
variable C3pos equal ${d3}
variable C3pos equal 33.8394046127467
variable C4pos equal ${d4}
variable C4pos equal 2.21586132664253
variable C5pos equal ${d5}
variable C5pos equal 7.07919155166315
variable C6pos equal ${d6}
variable C6pos equal -1.88507116848254

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-85.1503572848129+${C1pos})
variable C15 equal 0.5*(-85.1503572848129+-1.64565239615425)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-46.6329625437964+${C2pos})
variable C25 equal 0.5*(-46.6329625437964+-9.34889171451388)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-134.983035025465+${C3pos})
variable C35 equal 0.5*(-134.983035025465+33.8394046127467)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(4.70684542215996+${C4pos})
variable C45 equal 0.5*(4.70684542215996+2.21586132664253)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(16.254659904378+${C5pos})
variable C55 equal 0.5*(16.254659904378+7.07919155166315)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-1.07972620504099+${C6pos})
variable C65 equal 0.5*(-1.07972620504099+-1.88507116848254)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.5434280440749

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.5434280440749
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.125434280440749 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.751976 -1.2687662 0.93829071)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.5 | 128.4 | 129.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34566.414      10945.559      0              3300.9716    
       100   297.85656     -34579.399     -8914.0761      227.33764      3300.9716    
       200   265.73539     -34554.907     -4248.161      -6117.8828      3300.9716    
       300   311.84644     -34564.883     -15839.502     -1369.5016      3300.9716    
       400   333.26845     -34570.244     -1360.2147      1549.2349      3300.9716    
       500   292.3678      -34543.506     -6520.8855      1941.7563      3300.9716    
       600   306.33453     -34568.581      545.44901      519.61637      3300.9716    
       700   270.53558     -34544.374      2421.3779      1727.7344      3300.9716    
       800   299.14225     -34570.592     -1042.622       237.02508      3300.9716    
       900   286.97897     -34542.576      8094.7502      2845.0051      3300.9716    
      1000   303.27112     -34540.359     -2088.9102      3435.1488      3300.9716    
      1100   304.29405     -34541.564     -9346.1165     -3251.5476      3300.9716    
      1200   290.61069     -34557.626      5496.012       4556.1265      3300.9716    
      1300   283.54323     -34556.609     -16607.085      818.33375      3300.9716    
      1400   287.45981     -34547.263      11572.644      3424.3222      3300.9716    
      1500   298.18256     -34554.751     -1662.3033      5488.6662      3300.9716    
      1600   306.7792      -34563.67      -1480.3362     -6290.478       3300.9716    
      1700   299.69759     -34565.913     -935.00015      561.97764      3300.9716    
      1800   276.53688     -34578.65      -7266.5116     -3540.4721      3300.9716    
      1900   275.0868      -34572.366      10122.917     -2833.7729      3300.9716    
      2000   278.82187     -34552.821     -4121.8785     -4695.0762      3300.9716    
Loop time of 98.1374 on 8 procs for 2000 steps with 310 atoms

Performance: 0.880 ns/day, 27.260 hours/ns, 20.380 timesteps/s, 6.318 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.462     | 80.287     | 82.547     |  17.3 | 81.81
Bond    | 0.00066422 | 0.00084566 | 0.0010058  |   0.0 |  0.00
Neigh   | 5.777      | 5.9544     | 6.1368     |   4.7 |  6.07
Comm    | 1.1532     | 3.415      | 5.2446     |  83.9 |  3.48
Output  | 0.0041135  | 0.0050913  | 0.0059695  |   1.0 |  0.01
Modify  | 8.2482     | 8.4325     | 8.6115     |   4.0 |  8.59
Other   |            | 0.0422     |            |       |  0.04

Nlocal:          38.75 ave          48 max          33 min
Histogram: 1 1 1 3 0 0 1 0 0 1
Nghost:           3280 ave        3345 max        3217 min
Histogram: 1 1 1 1 0 0 1 1 1 1
Neighs:        25545.8 ave       31284 max       21967 min
Histogram: 1 1 1 3 0 0 1 0 0 1

Total # of neighbors = 204366
Ave neighs/atom = 659.24516
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   278.82187     -34552.821     -4121.8775      0              3300.9716    
       100   273.94168     -34538.517     -1165.5723     -1135.6629      3300.9716    
       200   316.4544      -34547.515      13120.964      2256.9166      3300.9716    
       300   320.60504     -34549.312      3421.1479      971.62469      3300.9716    
       400   309.61099     -34550.638      2520.2782     -774.54491      3300.9716    
       500   279.77326     -34532.808      3762.0009      3322.8759      3300.9716    
       600   295.68329     -34551.257      2571.475       249.49909      3300.9716    
       700   306.43027     -34556.608     -13826.28      -5086.6723      3300.9716    
       800   320.19303     -34559.268      313.82568      4495.4342      3300.9716    
       900   299.45964     -34538.263     -7943.857      -1738.9195      3300.9716    
      1000   284.94247     -34536.52       10444.296      1385.6303      3300.9716    
      1100   294.13835     -34564.514     -14778.444     -1667.4543      3300.9716    
      1200   297.30298     -34584.64       5957.6751      909.04116      3300.9716    
      1300   299.6987      -34574.977      12693.483      3238.9178      3300.9716    
      1400   309.93247     -34545.589     -15786.786      4009.5385      3300.9716    
      1500   314.19288     -34543.442      8230.6437      1407.5758      3300.9716    
      1600   282.05035     -34534.399      5068.5021      1656.3092      3300.9716    
      1700   304.60428     -34566.659      351.52798      1671.7032      3300.9716    
      1800   292.30929     -34563.41       2593.8024     -894.98357      3300.9716    
      1900   300.87572     -34574.814     -5248.877       843.06949      3300.9716    
      2000   296.59362     -34569.756      6575.4927     -4725.845       3300.9716    
Loop time of 97.9912 on 8 procs for 2000 steps with 310 atoms

Performance: 0.882 ns/day, 27.220 hours/ns, 20.410 timesteps/s, 6.327 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.475     | 80.406     | 82.479     |  16.1 | 82.05
Bond    | 0.00067004 | 0.00084884 | 0.0009884  |   0.0 |  0.00
Neigh   | 5.8166     | 5.9642     | 6.1235     |   4.5 |  6.09
Comm    | 1.1341     | 3.2058     | 5.1429     |  80.5 |  3.27
Output  | 0.0010037  | 0.0010885  | 0.0014956  |   0.5 |  0.00
Modify  | 8.2074     | 8.3706     | 8.5224     |   3.9 |  8.54
Other   |            | 0.04226    |            |       |  0.04

Nlocal:          38.75 ave          47 max          33 min
Histogram: 2 0 0 2 1 2 0 0 0 1
Nghost:         3299.5 ave        3343 max        3258 min
Histogram: 1 3 0 0 0 0 0 1 2 1
Neighs:        25563.4 ave       30700 max       21968 min
Histogram: 2 0 0 2 2 1 0 0 0 1

Total # of neighbors = 204507
Ave neighs/atom = 659.7
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -42.3382801535298
variable C2neg equal ${d2}
variable C2neg equal 5.59887542504833
variable C3neg equal ${d3}
variable C3neg equal -36.4163318800974
variable C4neg equal ${d4}
variable C4neg equal -0.0747103606892185
variable C5neg equal ${d5}
variable C5neg equal 10.5045310577077
variable C6neg equal ${d6}
variable C6neg equal 29.8904724859228

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.5434280440749
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.125434280440749 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.5011074 -1.2687662 0.93829071)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 127.6 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34570.776      4312.5718      0              3300.9716    
       100   291.2711      -34575.292     -4984.8128     -1510.9042      3300.9716    
       200   274.27117     -34558.968     -8765.0292     -6226.2546      3300.9716    
       300   305.75319     -34554.957     -1097.6744     -854.61275      3300.9716    
       400   321.5321      -34561.041     -8978.6956      3336.1876      3300.9716    
       500   297.34104     -34552.38      -3942.5663     -71.053994      3300.9716    
       600   310.53877     -34571.31      -3312.1353     -2887.7584      3300.9716    
       700   300.60083     -34554.611     -2766.8987     -4564.7474      3300.9716    
       800   320.11657     -34541.871      5723.1399     -1096.0681      3300.9716    
       900   308.23023     -34534.095     -4286.7343     -282.35643      3300.9716    
      1000   302.55018     -34557.418     -2697.3151      5208.9516      3300.9716    
      1100   300.72219     -34564.794     -2427.785      -2869.0642      3300.9716    
      1200   293.30858     -34562.124     -5657.5561      72.060409      3300.9716    
      1300   296.03676     -34552.215      7654.2699      6065.4035      3300.9716    
      1400   322.9464      -34542.102      122.03843     -1224.3648      3300.9716    
      1500   313.14228     -34535.845     -12382.24      -1419.508       3300.9716    
      1600   292.51512     -34538.129      1606.6595      3322.3566      3300.9716    
      1700   308.14127     -34559.574      3133.4984     -3757.4192      3300.9716    
      1800   312.04164     -34566.836      4732.5789     -2508.2526      3300.9716    
      1900   307.71172     -34567.462     -5259.9938     -797.96727      3300.9716    
      2000   296.36851     -34557.242     -11294.159      344.33227      3300.9716    
Loop time of 97.0626 on 8 procs for 2000 steps with 310 atoms

Performance: 0.890 ns/day, 26.962 hours/ns, 20.605 timesteps/s, 6.388 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.978     | 78.503     | 81.565     |  31.0 | 80.88
Bond    | 0.00065512 | 0.00084583 | 0.0010331  |   0.0 |  0.00
Neigh   | 5.3753     | 5.8071     | 6.0206     |   7.8 |  5.98
Comm    | 1.1425     | 4.2054     | 10.737     | 134.0 |  4.33
Output  | 0.0048143  | 0.0057801  | 0.0066376  |   0.9 |  0.01
Modify  | 8.2896     | 8.4991     | 8.9266     |   6.4 |  8.76
Other   |            | 0.04145    |            |       |  0.04

Nlocal:          38.75 ave          47 max          32 min
Histogram: 1 0 1 1 2 1 1 0 0 1
Nghost:         3278.5 ave        3319 max        3240 min
Histogram: 1 1 0 1 1 1 1 0 1 1
Neighs:        25545.2 ave       30664 max       21279 min
Histogram: 1 1 0 1 2 1 1 0 0 1

Total # of neighbors = 204362
Ave neighs/atom = 659.23226
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.9 | 127.6 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.36851     -34557.242     -11294.101      0              3300.9716    
       100   279.87286     -34539.722      8510.8715      604.50348      3300.9716    
       200   315.28694     -34551.163      2374.6905     -303.56598      3300.9716    
       300   330.2283      -34542.535      14446.146     -1585.3143      3300.9716    
       400   299.58452     -34535.459      3870.6472     -5605.5884      3300.9716    
       500   288.72664     -34547.133     -1921.9389     -3975.3632      3300.9716    
       600   298.7685      -34554.783      10144.8       -4880.559       3300.9716    
       700   290.14963     -34546.304      4333.1474      2895.06        3300.9716    
       800   312.19065     -34563.254     -2669.1984     -6063.8633      3300.9716    
       900   315.39854     -34548.887      8560.5181     -1562.7181      3300.9716    
      1000   303.15403     -34532.297     -6887.9566      3135.4703      3300.9716    
      1100   306.38074     -34552.761     -1336.1669     -5548.9416      3300.9716    
      1200   291.14894     -34568.283      176.851        495.18274      3300.9716    
      1300   291.61604     -34570.456      2730.419       7752.9042      3300.9716    
      1400   292.44772     -34558.274     -2599.9477      1096.2607      3300.9716    
      1500   305.47913     -34557.503     -11245.298      1497.7998      3300.9716    
      1600   295.95438     -34547.835     -4533.0978      413.35082      3300.9716    
      1700   305.34276     -34560.678     -9190.8485     -971.81721      3300.9716    
      1800   309.73181     -34569.943      4679.2635     -5085.2482      3300.9716    
      1900   280.04454     -34560.554      3923.5789     -1863.5312      3300.9716    
      2000   290.10923     -34583.859     -4845.7876      845.66752      3300.9716    
Loop time of 97.3761 on 8 procs for 2000 steps with 310 atoms

Performance: 0.887 ns/day, 27.049 hours/ns, 20.539 timesteps/s, 6.367 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.662     | 76.479     | 81.99      |  99.9 | 78.54
Bond    | 0.00064956 | 0.00086033 | 0.0010172  |   0.0 |  0.00
Neigh   | 4.0981     | 5.644      | 6.0795     |  25.2 |  5.80
Comm    | 1.064      | 6.5774     | 29.389     | 340.7 |  6.75
Output  | 0.00082819 | 0.00096356 | 0.0013343  |   0.0 |  0.00
Modify  | 8.1919     | 8.6329     | 10.188     |  20.5 |  8.87
Other   |            | 0.04145    |            |       |  0.04

Nlocal:          38.75 ave          46 max          30 min
Histogram: 1 0 0 1 2 0 1 2 0 1
Nghost:           3259 ave        3322 max        3193 min
Histogram: 1 0 2 0 1 0 1 1 1 1
Neighs:          25550 ave       30046 max       20008 min
Histogram: 1 0 0 1 2 0 1 2 0 1

Total # of neighbors = 204400
Ave neighs/atom = 659.35484
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -14.1150708387273
variable C2pos equal ${d2}
variable C2pos equal -4.51213389255113
variable C3pos equal ${d3}
variable C3pos equal 24.2825055293081
variable C4pos equal ${d4}
variable C4pos equal -9.99966371407569
variable C5pos equal ${d5}
variable C5pos equal 14.524816380706
variable C6pos equal ${d6}
variable C6pos equal -14.3785400875584

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-42.3382801535298+${C1pos})
variable C16 equal 0.5*(-42.3382801535298+-14.1150708387273)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(5.59887542504833+${C2pos})
variable C26 equal 0.5*(5.59887542504833+-4.51213389255113)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-36.4163318800974+${C3pos})
variable C36 equal 0.5*(-36.4163318800974+24.2825055293081)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-0.0747103606892185+${C4pos})
variable C46 equal 0.5*(-0.0747103606892185+-9.99966371407569)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(10.5045310577077+${C5pos})
variable C56 equal 0.5*(10.5045310577077+14.524816380706)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(29.8904724859228+${C6pos})
variable C66 equal 0.5*(29.8904724859228+-14.3785400875584)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal -0.9891076878513
variable C22all equal ${C22}
variable C22all equal 39.1702962955866
variable C33all equal ${C33}
variable C33all equal 36.8632388187209

variable C44all equal ${C44}
variable C44all equal 10.6886375446029
variable C55all equal ${C55}
variable C55all equal 11.6669257280206
variable C66all equal ${C66}
variable C66all equal 7.7559661991822

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(21.5428963728256+${C21})
variable C12all equal 0.5*(21.5428963728256+-11.3319377320041)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(24.5592216012538+${C31})
variable C13all equal 0.5*(24.5592216012538+-9.71497874578445)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(20.1339365579532+${C32})
variable C23all equal 0.5*(20.1339365579532+24.2724149058813)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-21.8073089794208+${C41})
variable C14all equal 0.5*(-21.8073089794208+0.857996179783085)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-43.3980048404836+${C51})
variable C15all equal 0.5*(-43.3980048404836+-2.49068469572171)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-28.2266754961285+${C61})
variable C16all equal 0.5*(-28.2266754961285+-6.40707148932837)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-2.83675342439795+${C42})
variable C24all equal 0.5*(-2.83675342439795+-6.49200471300652)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-27.9909271291551+${C52})
variable C25all equal 0.5*(-27.9909271291551+1.06443417952075)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(0.5433707662486+${C62})
variable C26all equal 0.5*(0.5433707662486+2.34951117442614)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(1.6095421771663+${C43})
variable C34all equal 0.5*(1.6095421771663+0.741737056919885)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-50.5718152063591+${C53})
variable C35all equal 0.5*(-50.5718152063591+-2.96666245864732)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-6.06691317539465+${C63})
variable C36all equal 0.5*(-6.06691317539465+-3.53996857151338)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(3.46135337440125+${C54})
variable C45all equal 0.5*(3.46135337440125+-9.80064920207914)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-5.03718703738245+${C64})
variable C46all equal 0.5*(-5.03718703738245+18.1975721438974)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(12.5146737192069+${C65})
variable C56all equal 0.5*(12.5146737192069+-1.48239868676177)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:40:34
