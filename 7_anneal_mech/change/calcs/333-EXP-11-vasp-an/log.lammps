LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-11-vasp-an
read_data       ${structure}.data
read_data       333-EXP-11-vasp-an.data
Reading data file ...
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
  reading velocities ...
  274 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.013 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              244.12834      3653.2211    
         1   300            0              0              244.12834      3653.2211    
Loop time of 6.68435e-05 on 8 procs for 1 steps with 274 atoms

64.9% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.52e-07   | 2.2962e-07 | 3.21e-07   |   0.0 |  0.34
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.24e-07   | 1.3206e-06 | 1.72e-06   |   0.0 |  1.98
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.529e-05  |            |       | 97.68

Nlocal:          34.25 ave          44 max          26 min
Histogram: 1 1 1 0 2 0 1 1 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.1 | 121.3 | 122.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -32270.304     -15755.402      0              1.6588329      3054.746     
       100   281.212       -32248.049      8309.728       2476.3999      1.6588329      3054.746     
       200   314.46578     -32250.577      20077.466      2549.4257      1.6588329      3054.746     
       300   310.22511     -32228.361      11730.488      5913.7963      1.6588329      3054.746     
       400   311.07756     -32212.531      7010.4609      2640.0578      1.6588329      3054.746     
       500   315.89101     -32229.212     -1059.2943      7918.5365      1.6588329      3054.746     
       600   307.80322     -32254.991      18546.815      2352.7599      1.6588329      3054.746     
       700   299.95313     -32266.622      5040.0127      5806.2874      1.6588329      3054.746     
       800   306.19933     -32279.665      3822.649       5193.8655      1.6588329      3054.746     
       900   292.98876     -32273.437      1960.8701      8458.378       1.6588329      3054.746     
      1000   297.5549      -32260.829     -15995.46      -461.11951      1.6588329      3054.746     
      1100   297.69463     -32236.483      7889.8147      9425.7544      1.6588329      3054.746     
      1200   313.80376     -32251.198     -9402.3691      4842.6939      1.6588329      3054.746     
      1300   293.79732     -32258.063      2325.8251      7045.5234      1.6588329      3054.746     
      1400   309.78217     -32274.331      2050.7294      3631.942       1.6588329      3054.746     
      1500   306.17889     -32275.334      18676.602      2910.9867      1.6588329      3054.746     
      1600   272.53784     -32263.969     -444.61111      8319.5293      1.6588329      3054.746     
      1700   259.25931     -32253.874      9035.5988      13281.626      1.6588329      3054.746     
      1800   313.95133     -32265.297      18585.414      7064.2657      1.6588329      3054.746     
      1900   302.31657     -32246.625      5931.4461      2766.9258      1.6588329      3054.746     
      2000   311.55735     -32268.658     -385.37691      6769.8855      1.6588329      3054.746     
Loop time of 89.3772 on 8 procs for 2000 steps with 274 atoms

Performance: 0.967 ns/day, 24.827 hours/ns, 22.377 timesteps/s, 6.131 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.792     | 66.597     | 75.549     | 106.4 | 74.51
Bond    | 0.00066485 | 0.00080876 | 0.00099724 |   0.0 |  0.00
Neigh   | 4.0918     | 5.0613     | 5.6134     |  26.5 |  5.66
Comm    | 1.3457     | 10.299     | 26.115     | 270.7 | 11.52
Output  | 0.0012299  | 0.0013431  | 0.0019184  |   0.6 |  0.00
Modify  | 6.8248     | 7.3806     | 8.3413     |  21.8 |  8.26
Other   |            | 0.03756    |            |       |  0.04

Nlocal:          34.25 ave          47 max          27 min
Histogram: 2 1 1 0 2 0 0 1 0 1
Nghost:        3112.75 ave        3133 max        3101 min
Histogram: 2 0 1 2 0 2 0 0 0 1
Neighs:        21650.1 ave       29378 max       17254 min
Histogram: 3 0 1 1 1 0 0 1 0 1

Total # of neighbors = 173201
Ave neighs/atom = 632.12044
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-11-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.39621277898
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.5921534688336
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 15.7565520784056

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-6769.885529702)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-6769.885529702)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-4784.98538280859)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-4784.98538280859)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-7346.14891120644)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-7346.14891120644)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1989.03029865356)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1989.03029865356)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--992.374739992053)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--992.374739992053)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--233.845834935914)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--233.845834935914)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.39621277898
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.39621277898
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.1539621277898 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.1539621277898 xy delta 0.0820404152679998 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.1539621277898 xy delta 0.0820404152679998 xz delta 0.00317650080177537 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (15.953594 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (15.953594 12.717077 15.916026) with tilt (-8.1220011 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (15.953594 12.717077 15.916026) with tilt (-8.1220011 -0.31447358 -0.0091731748)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.7 | 121.3 | 122 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32255.226      51400.501      0              3024.1985    
       100   302.58298     -32274.778      1803.8019      9997.6299      3024.1985    
       200   291.07997     -32263.539      4706.4837      2426.6758      3024.1985    
       300   291.48771     -32257.5       -6915.2795      3143.6203      3024.1985    
       400   304.3647      -32254.241      1565.434       10868.469      3024.1985    
       500   322.59063     -32257.187     -15351.873      2300.5454      3024.1985    
       600   307.79561     -32244.573     -1293.6233      10406.118      3024.1985    
       700   307.06768     -32260.403      2002.7543     -1164.581       3024.1985    
       800   289.59636     -32268.582      2627.3438      12775.768      3024.1985    
       900   290.73423     -32273.673      10703.307      8137.7521      3024.1985    
      1000   324.59854     -32290.875      9895.1364      8368.1549      3024.1985    
      1100   302.55108     -32238.721      9720.729       8480.8984      3024.1985    
      1200   331.81629     -32252.976      6890.4978      9752.8958      3024.1985    
      1300   318.30177     -32265.358      16686.94       13066.397      3024.1985    
      1400   293.25146     -32263.467     -4411.8863      6635.4712      3024.1985    
      1500   281.56548     -32254.44      -1106.7768      6981.8492      3024.1985    
      1600   302.15218     -32256.186      754.72448      9263.4618      3024.1985    
      1700   309.72108     -32246.556     -2831.6193      9755.7243      3024.1985    
      1800   291.21204     -32252.928      2734.5151      6370.8252      3024.1985    
      1900   297.44451     -32281.717      5404.4918      10367.922      3024.1985    
      2000   307.76297     -32292.281     -2398.5823      5531.6569      3024.1985    
Loop time of 91.4347 on 8 procs for 2000 steps with 274 atoms

Performance: 0.945 ns/day, 25.399 hours/ns, 21.874 timesteps/s, 5.993 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.139     | 69.836     | 77.554     | 121.5 | 76.38
Bond    | 0.0006528  | 0.0008204  | 0.0010325  |   0.0 |  0.00
Neigh   | 4.1103     | 5.2931     | 5.7383     |  29.6 |  5.79
Comm    | 1.0759     | 8.8067     | 27.514     | 342.3 |  9.63
Output  | 0.0038019  | 0.0049459  | 0.0059067  |   1.2 |  0.01
Modify  | 7.011      | 7.4551     | 8.6311     |  24.8 |  8.15
Other   |            | 0.0383     |            |       |  0.04

Nlocal:          34.25 ave          43 max          29 min
Histogram: 3 0 0 1 1 1 1 0 0 1
Nghost:        3138.25 ave        3156 max        3124 min
Histogram: 2 1 0 1 1 0 0 1 0 2
Neighs:        21870.4 ave       27258 max       18581 min
Histogram: 3 0 0 1 1 1 1 0 0 1

Total # of neighbors = 174963
Ave neighs/atom = 638.55109
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.7 | 121.3 | 122 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.76297     -32292.281     -2398.5918      0              3024.1985    
       100   299.59087     -32279.96       9000.4146      8166.9584      3024.1985    
       200   288.71616     -32242.54      -873.433        12876.784      3024.1985    
       300   305.61579     -32246.549      13990.877      10666.762      3024.1985    
       400   295.50221     -32251.241     -7792.1258      7198.1459      3024.1985    
       500   301.48582     -32263.735      9043.0621      5796.0425      3024.1985    
       600   306.41601     -32279.6       -6463.7619      11342.047      3024.1985    
       700   313.58094     -32294.221      4371.6171      11306.455      3024.1985    
       800   296.48049     -32290.423      178.66809      10643.289      3024.1985    
       900   291.01258     -32291.195      3392.9703      9469.5781      3024.1985    
      1000   270.74635     -32252.31       3276.4694      4630.6872      3024.1985    
      1100   297.53224     -32257.022      17330.691      14247.248      3024.1985    
      1200   307.08259     -32266.168      1316.1502      5105.2998      3024.1985    
      1300   292.57744     -32270.029      4892.1944      11003.042      3024.1985    
      1400   297.28949     -32297.813      5481.2261      6269.4146      3024.1985    
      1500   286.11741     -32307.408     -1994.8909      9433.7082      3024.1985    
      1600   286.4501      -32291.455     -3163.8691      9205.6602      3024.1985    
      1700   292.31428     -32261.067      13012.367      8734.4471      3024.1985    
      1800   318.60774     -32266.959      2669.9335      5134.4675      3024.1985    
      1900   318.57439     -32270.314      5818.7171      4530.5821      3024.1985    
      2000   325.78297     -32300.477     -9027.9754      7240.8247      3024.1985    
Loop time of 91.7202 on 8 procs for 2000 steps with 274 atoms

Performance: 0.942 ns/day, 25.478 hours/ns, 21.805 timesteps/s, 5.975 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.818     | 70.082     | 77.72      | 120.2 | 76.41
Bond    | 0.00063198 | 0.00081353 | 0.0010334  |   0.0 |  0.00
Neigh   | 4.1385     | 5.3064     | 5.746      |  29.2 |  5.79
Comm    | 1.1314     | 8.7798     | 27.053     | 339.7 |  9.57
Output  | 0.00095981 | 0.0010563  | 0.0015464  |   0.6 |  0.00
Modify  | 7.0737     | 7.5119     | 8.6734     |  24.4 |  8.19
Other   |            | 0.03788    |            |       |  0.04

Nlocal:          34.25 ave          44 max          26 min
Histogram: 1 2 0 0 0 2 1 1 0 1
Nghost:        3120.38 ave        3146 max        3094 min
Histogram: 1 0 0 0 3 2 0 1 0 1
Neighs:        21864.1 ave       27798 max       16757 min
Histogram: 1 2 0 0 0 2 1 1 0 1

Total # of neighbors = 174913
Ave neighs/atom = 638.36861
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 4.77179135740086
variable C2neg equal ${d2}
variable C2neg equal -59.7085143490224
variable C3neg equal ${d3}
variable C3neg equal -28.4003142008823
variable C4neg equal ${d4}
variable C4neg equal 12.7283372935547
variable C5neg equal ${d5}
variable C5neg equal 23.9772753402802
variable C6neg equal ${d6}
variable C6neg equal -0.171281694452986

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.39621277898
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.1539621277898 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.1539621277898 xy delta -0.0820404152679998 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.1539621277898 xy delta -0.0820404152679998 xz delta -0.00317650080177537 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.261519 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.261519 12.717077 15.916026) with tilt (-8.2860819 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.261519 12.717077 15.916026) with tilt (-8.2860819 -0.32082658 -0.0091731748)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.7 | 120.1 | 120.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32251.489     -43920.26       0              3085.2934    
       100   299.50224     -32269.524     -9762.9602     -555.66025      3085.2934    
       200   296.62787     -32269.23      -2716.831       2916.5004      3085.2934    
       300   305.25269     -32272.145     -4948.4315     -4925.7289      3085.2934    
       400   308.37058     -32263.246     -8659.6831     -1551.899       3085.2934    
       500   319.36635     -32253.503      3863.221       3613.8746      3085.2934    
       600   331.62315     -32255.139      13239.351      7885.0307      3085.2934    
       700   311.02061     -32268.49       4154.3995     -2546.9104      3085.2934    
       800   291.91791     -32273.387      5708.4421     -1939.0567      3085.2934    
       900   296.00219     -32280.161      18226.94       3250.6123      3085.2934    
      1000   300.9195      -32280.163     -2433.4487      1611.7254      3085.2934    
      1100   291.61435     -32256.035      1457.6028     -121.13197      3085.2934    
      1200   316.32479     -32253.344      410.94422      5320.7871      3085.2934    
      1300   290.85755     -32230.44      -1634.6632      4125.9145      3085.2934    
      1400   311.78031     -32278.038     -3424.257       8245.4231      3085.2934    
      1500   298.76747     -32279.972     -8424.99       -749.83001      3085.2934    
      1600   288.13377     -32274.223     -2236.9174     -1086.8014      3085.2934    
      1700   295.28484     -32285.398      4526.1618      2989.5633      3085.2934    
      1800   272.5093      -32279.502     -1714.2065      7153.3953      3085.2934    
      1900   291.12428     -32297.544      6889.721       6321.288       3085.2934    
      2000   307.97577     -32286.674     -665.62822     -336.30276      3085.2934    
Loop time of 88.7841 on 8 procs for 2000 steps with 274 atoms

Performance: 0.973 ns/day, 24.662 hours/ns, 22.527 timesteps/s, 6.172 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.907     | 70.364     | 75.67      |  76.8 | 79.25
Bond    | 0.00058868 | 0.00079555 | 0.0010732  |   0.0 |  0.00
Neigh   | 4.06       | 4.7778     | 4.9969     |  15.6 |  5.38
Comm    | 1.0737     | 6.3998     | 20.875     | 255.1 |  7.21
Output  | 0.0040309  | 0.005025   | 0.0059318  |   1.0 |  0.01
Modify  | 6.9774     | 7.1998     | 7.9021     |  12.4 |  8.11
Other   |            | 0.0373     |            |       |  0.04

Nlocal:          34.25 ave          42 max          28 min
Histogram: 2 0 1 1 0 2 0 1 0 1
Nghost:        3086.25 ave        3108 max        3062 min
Histogram: 1 0 0 1 1 3 0 1 0 1
Neighs:        21407.6 ave       26092 max       17605 min
Histogram: 2 0 1 1 0 2 0 1 0 1

Total # of neighbors = 171261
Ave neighs/atom = 625.04015
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.7 | 120.1 | 120.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.97577     -32286.674     -665.6326       0              3085.2934    
       100   289.5185      -32272.785     -8276.5798     -212.89886      3085.2934    
       200   312.54376     -32298.091      156.12563     -3751.9599      3085.2934    
       300   284.20971     -32288.113     -7778.5906     -3845.6333      3085.2934    
       400   285.36433     -32298.394      8220.8197      1908.8401      3085.2934    
       500   269.21883     -32269.601     -1721.5229      4287.2993      3085.2934    
       600   316.37682     -32284.532     -4623.2343      4537.6315      3085.2934    
       700   328.38675     -32296.34       11863.542      3930.4512      3085.2934    
       800   273.09901     -32263.279      451.78045      633.28386      3085.2934    
       900   299.28655     -32282.031      3473.3363      89.322249      3085.2934    
      1000   307.44676     -32272.309     -307.94412      3043.5269      3085.2934    
      1100   319.75707     -32274.169     -352.88783      2445.209       3085.2934    
      1200   302.88724     -32267.731      4667.5138     -1426.1741      3085.2934    
      1300   304.57536     -32289.83      -3814.2187      5961.0411      3085.2934    
      1400   296.91413     -32301.283     -8001.36        521.76784      3085.2934    
      1500   293.90982     -32293.006     -1698.6389     -1720.0273      3085.2934    
      1600   295.74783     -32256.798     -8374.6149      6179.7721      3085.2934    
      1700   309.55857     -32260.65      -8909.7575      4308.4428      3085.2934    
      1800   317.7193      -32278.44      -4553.5907     -572.28443      3085.2934    
      1900   300.3602      -32283.563     -1299.7244      4290.0965      3085.2934    
      2000   289.19311     -32287.22      -375.11683     -843.96379      3085.2934    
Loop time of 89.1006 on 8 procs for 2000 steps with 274 atoms

Performance: 0.970 ns/day, 24.750 hours/ns, 22.447 timesteps/s, 6.150 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.169     | 71.155     | 76.101     |  99.8 | 79.86
Bond    | 0.00061598 | 0.00081698 | 0.0011338  |   0.0 |  0.00
Neigh   | 3.5915     | 4.8169     | 5.043      |  21.2 |  5.41
Comm    | 1.0138     | 5.9631     | 27.969     | 345.1 |  6.69
Output  | 0.00098374 | 0.0010973  | 0.0016362  |   0.6 |  0.00
Modify  | 6.8818     | 7.1253     | 8.3373     |  17.2 |  8.00
Other   |            | 0.03809    |            |       |  0.04

Nlocal:          34.25 ave          45 max          27 min
Histogram: 2 2 0 0 0 2 0 1 0 1
Nghost:        3095.75 ave        3129 max        3066 min
Histogram: 1 3 0 0 0 1 0 0 1 2
Neighs:        21413.5 ave       27936 max       16974 min
Histogram: 2 2 0 0 1 1 0 1 0 1

Total # of neighbors = 171308
Ave neighs/atom = 625.21168
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 77.1473282673968
variable C2pos equal ${d2}
variable C2pos equal 75.943443758404
variable C3pos equal ${d3}
variable C3pos equal 161.022756103559
variable C4pos equal ${d4}
variable C4pos equal 3.89235975197495
variable C5pos equal ${d5}
variable C5pos equal -16.2120518119602
variable C6pos equal ${d6}
variable C6pos equal 1.05061763280631

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(4.77179135740086+${C1pos})
variable C11 equal 0.5*(4.77179135740086+77.1473282673968)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-59.7085143490224+${C2pos})
variable C21 equal 0.5*(-59.7085143490224+75.943443758404)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-28.4003142008823+${C3pos})
variable C31 equal 0.5*(-28.4003142008823+161.022756103559)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(12.7283372935547+${C4pos})
variable C41 equal 0.5*(12.7283372935547+3.89235975197495)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(23.9772753402802+${C5pos})
variable C51 equal 0.5*(23.9772753402802+-16.2120518119602)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-0.171281694452986+${C6pos})
variable C61 equal 0.5*(-0.171281694452986+1.05061763280631)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.5921534688336
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.5921534688336
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.125921534688336 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.125921534688336 yz delta 9.17317476104144e-05 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.591155 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.591155 15.916026) with tilt (-8.2040415 -0.31765008 -0.009081443)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.1 | 122.1 | 123.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32255.763      49362.708      0              3024.1985    
       100   302.50498     -32275.13      -3875.3639      6654.4231      3024.1985    
       200   295.37075     -32267.132      9625.3133      1802.7784      3024.1985    
       300   299.70183     -32262.906      10597.562      7118.1515      3024.1985    
       400   316.34794     -32264.779      429.32793      3554.5248      3024.1985    
       500   308.60313     -32267.698      7519.1277      318.18734      3024.1985    
       600   289.55034     -32280.556      13327.583      12579.05       3024.1985    
       700   284.29799     -32275.676      5911.993      -2538.0111      3024.1985    
       800   314.20815     -32283.506     -2394.1128      3771.525       3024.1985    
       900   303.0514      -32253.274      4890.5676      7169.0278      3024.1985    
      1000   310.44531     -32243.932     -3851.9388      2363.0962      3024.1985    
      1100   336.06212     -32237.107      5702.1546      6781.7404      3024.1985    
      1200   303.8218      -32238.705      6838.7183      11323.938      3024.1985    
      1300   310.33566     -32266.572     -2527.7564      8420.9358      3024.1985    
      1400   302.20333     -32273.575     -8486.6318      9623.9687      3024.1985    
      1500   289.73888     -32278.224      3265.2236      9136.7505      3024.1985    
      1600   290.29545     -32283.904      2529.1314      4464.5063      3024.1985    
      1700   292.34008     -32274.262      3021.4838      3891.0963      3024.1985    
      1800   324.59641     -32272.087     -5260.7268     -3780.8307      3024.1985    
      1900   325.09387     -32279.076      10689.709     -100.75463      3024.1985    
      2000   293.82421     -32278.023      19262.259      4244.7929      3024.1985    
Loop time of 92.535 on 8 procs for 2000 steps with 274 atoms

Performance: 0.934 ns/day, 25.704 hours/ns, 21.613 timesteps/s, 5.922 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.121     | 76.138     | 78.397     |  26.2 | 82.28
Bond    | 0.00062389 | 0.00082135 | 0.0010546  |   0.0 |  0.00
Neigh   | 5.6074     | 5.7542     | 5.883      |   3.4 |  6.22
Comm    | 1.1228     | 3.4072     | 8.4539     | 124.4 |  3.68
Output  | 0.0041464  | 0.0050558  | 0.0058566  |   0.9 |  0.01
Modify  | 7.045      | 7.191      | 7.3113     |   3.1 |  7.77
Other   |            | 0.03873    |            |       |  0.04

Nlocal:          34.25 ave          45 max          27 min
Histogram: 2 0 2 1 0 1 0 0 1 1
Nghost:           3137 ave        3162 max        3110 min
Histogram: 1 0 0 2 0 2 1 1 0 1
Neighs:        21852.5 ave       28413 max       17310 min
Histogram: 2 0 2 1 0 1 0 0 1 1

Total # of neighbors = 174820
Ave neighs/atom = 638.0292
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.1 | 122.1 | 123.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.82421     -32278.023      19262.208      0              3024.1985    
       100   281.44794     -32264.281      12378.528      10190.717      3024.1985    
       200   335.1801      -32280.682     -3346.9211      1021.8978      3024.1985    
       300   324.25684     -32263.817      15461.899      11565.083      3024.1985    
       400   322.56029     -32291.962      4991.0771      3707.7543      3024.1985    
       500   309.64401     -32298.517      12941.723      6173.2883      3024.1985    
       600   276.69911     -32264.89       11361.886      7821.0932      3024.1985    
       700   309.3431      -32269.111      11673.099      3570.1167      3024.1985    
       800   308.36335     -32274.602      4121.3049      12268.658      3024.1985    
       900   300.11655     -32285.016     -8572.1077      6665.5017      3024.1985    
      1000   279.72996     -32291.58      -9446.5095      7201.8196      3024.1985    
      1100   276.02242     -32304.822      7281.6822      8414.11        3024.1985    
      1200   298.37606     -32295.133     -2451.4216      4633.4567      3024.1985    
      1300   311.47891     -32281.857      14107.795      507.50347      3024.1985    
      1400   321.9373      -32282.976      6372.7467      4705.0339      3024.1985    
      1500   299.75564     -32265.068      9084.2999      10889.115      3024.1985    
      1600   305.50281     -32290.481      18706.246      4276.319       3024.1985    
      1700   286.28927     -32293.137     -4583.9878      4706.2103      3024.1985    
      1800   285.0392      -32280.176      16695.635      4340.0905      3024.1985    
      1900   285.52388     -32265.892     -4511.3766     -430.61803      3024.1985    
      2000   297.28084     -32269.556      315.71735      5555.4547      3024.1985    
Loop time of 92.2623 on 8 procs for 2000 steps with 274 atoms

Performance: 0.936 ns/day, 25.628 hours/ns, 21.677 timesteps/s, 5.940 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.977     | 75.846     | 78.131     |  26.1 | 82.21
Bond    | 0.00062807 | 0.00080801 | 0.0010515  |   0.0 |  0.00
Neigh   | 5.6283     | 5.7342     | 5.8568     |   2.9 |  6.22
Comm    | 1.1927     | 3.504      | 8.4037     | 122.2 |  3.80
Output  | 0.0010252  | 0.0011073  | 0.0015709  |   0.5 |  0.00
Modify  | 6.9963     | 7.1382     | 7.2423     |   2.8 |  7.74
Other   |            | 0.03815    |            |       |  0.04

Nlocal:          34.25 ave          44 max          30 min
Histogram: 3 2 0 0 1 1 0 0 0 1
Nghost:        3161.75 ave        3182 max        3140 min
Histogram: 1 1 0 0 2 1 0 2 0 1
Neighs:        21868.4 ave       27839 max       19248 min
Histogram: 3 2 0 0 1 1 0 0 0 1

Total # of neighbors = 174947
Ave neighs/atom = 638.4927
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -12.3052203818472
variable C2neg equal ${d2}
variable C2neg equal 21.4135204540946
variable C3neg equal ${d3}
variable C3neg equal -91.4582489072463
variable C4neg equal ${d4}
variable C4neg equal 10.7795094669002
variable C5neg equal ${d5}
variable C5neg equal 8.32182612597773
variable C6neg equal ${d6}
variable C6neg equal 5.61548248750934

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.5921534688336
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.125921534688336 yz delta ${deltayz} remap units box
change_box all y delta 0 0.125921534688336 yz delta -9.17317476104144e-05 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.842998 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.842998 15.916026) with tilt (-8.2040415 -0.31765008 -0.0092649065)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.5 | 119.9 | 120.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32251.507     -46333.891      0              3085.2934    
       100   299.30567     -32269.68      -4683.44        3520.1996      3085.2934    
       200   289.58205     -32263.393      6966.6158      3941.1392      3085.2934    
       300   300.40307     -32268.71      -1523.3339     -3120.483       3085.2934    
       400   301.48572     -32261.146     -7010.6225      3533.2206      3085.2934    
       500   320.1117      -32259.285      11478.022      4539.4549      3085.2934    
       600   322.95879     -32250.747      12700.223      6046.0628      3085.2934    
       700   321.8256      -32264.504     -1786.3436     -2691.8328      3085.2934    
       800   288.71849     -32266.673      13255.169     -2377.9178      3085.2934    
       900   295.73585     -32271.981      11177.388      6226.4082      3085.2934    
      1000   303.06529     -32268.088      3431.2207      2679.9794      3085.2934    
      1100   301.27819     -32260.718      7032.8793      5886.4555      3085.2934    
      1200   312.81098     -32278.531      21811.276      14354.432      3085.2934    
      1300   271.92948     -32271.294      2871.6242      12852.302      3085.2934    
      1400   297.10212     -32295.592     -12433.891      6650.0509      3085.2934    
      1500   294.65214     -32273.278      1128.2079      5509.3269      3085.2934    
      1600   315.18816     -32271.671     -2356.6022      1351.4655      3085.2934    
      1700   299.24963     -32259.665     -7042.4502      6251.1383      3085.2934    
      1800   308.28787     -32278.052     -20106.333      2548.2771      3085.2934    
      1900   301.60232     -32287.232     -3334.1483     -1469.4022      3085.2934    
      2000   293.64207     -32284.059      4303.7498      7546.0101      3085.2934    
Loop time of 89.5672 on 8 procs for 2000 steps with 274 atoms

Performance: 0.965 ns/day, 24.880 hours/ns, 22.330 timesteps/s, 6.118 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.669     | 70.43      | 76.018     |  91.3 | 78.63
Bond    | 0.00061053 | 0.00078504 | 0.00098984 |   0.0 |  0.00
Neigh   | 4.1383     | 5.3642     | 5.604      |  20.2 |  5.99
Comm    | 0.90508    | 6.4948     | 26.274     | 301.0 |  7.25
Output  | 0.0041123  | 0.0050741  | 0.0059647  |   1.0 |  0.01
Modify  | 6.9946     | 7.2345     | 8.4465     |  17.2 |  8.08
Other   |            | 0.03758    |            |       |  0.04

Nlocal:          34.25 ave          42 max          26 min
Histogram: 2 0 0 0 1 2 1 0 1 1
Nghost:        3097.12 ave        3132 max        3064 min
Histogram: 2 1 1 0 0 0 1 0 1 2
Neighs:        21419.8 ave       26050 max       16454 min
Histogram: 2 0 0 0 1 2 1 0 1 1

Total # of neighbors = 171358
Ave neighs/atom = 625.39416
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.4 | 119.9 | 120.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.64207     -32284.059      4303.7157      0              3085.2934    
       100   305.92855     -32287.58      -6455.4531      8349.4454      3085.2934    
       200   338.80571     -32291.74       9676.9516      488.24342      3085.2934    
       300   342.64216     -32270.194     -7259.9503      2783.364       3085.2934    
       400   321.51328     -32262.11      -6198.6192      6046.8112      3085.2934    
       500   308.5561      -32267.195      6506.7818      8187.6574      3085.2934    
       600   307.82704     -32276.603     -4855.9034      10170.211      3085.2934    
       700   303.07754     -32283.584      5517.1171      8952.7225      3085.2934    
       800   295.52084     -32277.705      7711.8827      1930.732       3085.2934    
       900   313.64295     -32261.626     -4059.8784      7836.7439      3085.2934    
      1000   323.8177      -32255.588     -4892.9886     -602.12982      3085.2934    
      1100   285.65811     -32240.143      17813.876      6499.9062      3085.2934    
      1200   291.97175     -32265.801      2971.6207      5771.0465      3085.2934    
      1300   291.11063     -32270.359      11278.026      10095.557      3085.2934    
      1400   302.70559     -32276.152      7654.0324      4167.3897      3085.2934    
      1500   306.39058     -32273.042      1832.8552     -1256.3816      3085.2934    
      1600   322.55358     -32264.829      356.34799      5710.825       3085.2934    
      1700   326.65294     -32255.325     -891.78966     -421.86023      3085.2934    
      1800   317.42138     -32275.568     -12777.662      1767.926       3085.2934    
      1900   306.53219     -32281.894     -3029.7131     -4018.727       3085.2934    
      2000   279.86449     -32266.423     -10616.572      2587.6621      3085.2934    
Loop time of 89.433 on 8 procs for 2000 steps with 274 atoms

Performance: 0.966 ns/day, 24.842 hours/ns, 22.363 timesteps/s, 6.127 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.007     | 67.869     | 75.762     | 120.5 | 75.89
Bond    | 0.00061651 | 0.00078029 | 0.0009897  |   0.0 |  0.00
Neigh   | 3.9746     | 5.1609     | 5.6277     |  29.7 |  5.77
Comm    | 1.0481     | 8.9443     | 26.818     | 332.0 | 10.00
Output  | 0.0010007  | 0.0010992  | 0.0015495  |   0.5 |  0.00
Modify  | 6.952      | 7.419      | 8.6004     |  24.6 |  8.30
Other   |            | 0.03738    |            |       |  0.04

Nlocal:          34.25 ave          45 max          22 min
Histogram: 1 0 0 1 1 2 1 1 0 1
Nghost:           3088 ave        3105 max        3064 min
Histogram: 1 0 0 0 3 1 0 0 1 2
Neighs:          21401 ave       27932 max       13969 min
Histogram: 1 0 0 1 1 2 1 1 0 1

Total # of neighbors = 171208
Ave neighs/atom = 624.84672
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 42.3763789958048
variable C2pos equal ${d2}
variable C2pos equal 27.3292948560406
variable C3pos equal ${d3}
variable C3pos equal 98.8599951640179
variable C4pos equal ${d4}
variable C4pos equal 7.20734867745999
variable C5pos equal ${d5}
variable C5pos equal -14.4601552398984
variable C6pos equal ${d6}
variable C6pos equal -0.421782112311099

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-12.3052203818472+${C1pos})
variable C12 equal 0.5*(-12.3052203818472+42.3763789958048)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(21.4135204540946+${C2pos})
variable C22 equal 0.5*(21.4135204540946+27.3292948560406)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-91.4582489072463+${C3pos})
variable C32 equal 0.5*(-91.4582489072463+98.8599951640179)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(10.7795094669002+${C4pos})
variable C42 equal 0.5*(10.7795094669002+7.20734867745999)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(8.32182612597773+${C5pos})
variable C52 equal 0.5*(8.32182612597773+-14.4601552398984)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(5.61548248750934+${C6pos})
variable C62 equal 0.5*(5.61548248750934+-0.421782112311099)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 15.7565520784056
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.7565520784056
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.157565520784056 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.758461) with tilt (-8.2040415 -0.31765008 -0.0091731748)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 121.5 | 122.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32255.264      51575.011      0              3024.1985    
       100   298.93941     -32272.228      2395.3974      7808.0057      3024.1985    
       200   297.60959     -32270.613      4281.1019      2510.9081      3024.1985    
       300   291.24089     -32258.634     -7357.0517      472.27007      3024.1985    
       400   316.18748     -32263.584      7749.3454      6284.8772      3024.1985    
       500   328.89373     -32262.654      2277.2728      5433.5865      3024.1985    
       600   311.48669     -32240.068      8693.9602      6808.4339      3024.1985    
       700   321.22953     -32249.689     -1030.6657      1947.2686      3024.1985    
       800   297.33545     -32265.053     -5550.3706      3793.1017      3024.1985    
       900   299.60567     -32280.354      11756.842      8757.0559      3024.1985    
      1000   312.41166     -32291.85      -3877.4463      196.59419      3024.1985    
      1100   301.89432     -32289.964     -6399.3841      697.84297      3024.1985    
      1200   281.30264     -32270.848     -1189.9696      5432.2543      3024.1985    
      1300   298.80676     -32266.601      2188.781       14788.8        3024.1985    
      1400   287.26468     -32253.024      14885.445      14912.397      3024.1985    
      1500   314.6895      -32271.762      17549.73       12359.99       3024.1985    
      1600   323.5969      -32280.093      4699.7909     -169.87202      3024.1985    
      1700   299.22077     -32284.471     -6019.6902      10149.127      3024.1985    
      1800   306.13229     -32294.402     -3118.603       5390.8811      3024.1985    
      1900   281.81817     -32268.454      9544.4103      6088.913       3024.1985    
      2000   308.53388     -32256.998     -6285.4811      7997.0041      3024.1985    
Loop time of 92.0745 on 8 procs for 2000 steps with 274 atoms

Performance: 0.938 ns/day, 25.576 hours/ns, 21.722 timesteps/s, 5.952 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.519     | 70.777     | 78.123     |  94.2 | 76.87
Bond    | 0.00066154 | 0.00083785 | 0.0010946  |   0.0 |  0.00
Neigh   | 4.3442     | 5.381      | 5.7988     |  21.7 |  5.84
Comm    | 1.0852     | 8.4346     | 22.709     | 273.4 |  9.16
Output  | 0.0039849  | 0.0048899  | 0.0057215  |   1.0 |  0.01
Modify  | 7.0226     | 7.4381     | 8.4607     |  18.1 |  8.08
Other   |            | 0.03757    |            |       |  0.04

Nlocal:          34.25 ave          45 max          27 min
Histogram: 2 1 0 2 0 1 0 1 0 1
Nghost:        3148.75 ave        3198 max        3094 min
Histogram: 1 1 0 0 0 3 1 0 1 1
Neighs:        21883.6 ave       28482 max       17393 min
Histogram: 2 1 0 2 0 1 0 1 0 1

Total # of neighbors = 175069
Ave neighs/atom = 638.93796
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.8 | 121.5 | 122.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.53388     -32256.998     -6285.4724      0              3024.1985    
       100   289.14018     -32253.833      7414.0212      7843.0761      3024.1985    
       200   280.70281     -32272.725     -5948.875       4378.1396      3024.1985    
       300   297.6026      -32283.046      12734.306      6340.7334      3024.1985    
       400   314.0436      -32286.089      12618.281      10696.747      3024.1985    
       500   301.59632     -32277.856     -10914.8        6789.5272      3024.1985    
       600   305.04252     -32289.99       6490.4828      6325.434       3024.1985    
       700   281.70336     -32277.088      4639.3793      1745.592       3024.1985    
       800   285.91478     -32282.937      2519.0697      12676.335      3024.1985    
       900   302.26509     -32284.008      3380.532       6740.7265      3024.1985    
      1000   308.41657     -32266.888      6954.4652      9767.0399      3024.1985    
      1100   316.13243     -32270.808     -5353.995       5214.991       3024.1985    
      1200   295.04106     -32276.23       54.262928      10813.34       3024.1985    
      1300   275.63353     -32286.157      6591.7411      3310.2567      3024.1985    
      1400   303.09742     -32297.62       9231.3145      871.69306      3024.1985    
      1500   305.32926     -32287.468      9107.8514      7317.664       3024.1985    
      1600   307.35136     -32273.576      7107.7022      1216.5217      3024.1985    
      1700   328.97867     -32268.613      10627.326      4718.4614      3024.1985    
      1800   327.86808     -32247.297     -3359.9386      3775.6459      3024.1985    
      1900   282.81069     -32243.361      5680.7715      7470.4289      3024.1985    
      2000   308.61866     -32288.98       5242.208       7121.3977      3024.1985    
Loop time of 92.3342 on 8 procs for 2000 steps with 274 atoms

Performance: 0.936 ns/day, 25.648 hours/ns, 21.660 timesteps/s, 5.935 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.689     | 70.238     | 78.488     | 134.2 | 76.07
Bond    | 0.00065592 | 0.00084202 | 0.0010879  |   0.0 |  0.00
Neigh   | 4.1296     | 5.3344     | 5.8058     |  29.9 |  5.78
Comm    | 0.93547    | 9.1794     | 28.736     | 371.1 |  9.94
Output  | 0.00086225 | 0.0010353  | 0.0015882  |   0.7 |  0.00
Modify  | 7.0626     | 7.542      | 8.7633     |  25.3 |  8.17
Other   |            | 0.03816    |            |       |  0.04

Nlocal:          34.25 ave          46 max          26 min
Histogram: 1 2 0 2 0 1 0 0 1 1
Nghost:           3131 ave        3167 max        3090 min
Histogram: 1 0 0 1 2 1 1 0 1 1
Neighs:        21858.1 ave       29140 max       16724 min
Histogram: 1 2 0 2 0 1 0 0 1 1

Total # of neighbors = 174865
Ave neighs/atom = 638.19343
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 3.56169689635098
variable C2neg equal ${d2}
variable C2neg equal 47.2960706056106
variable C3neg equal ${d3}
variable C3neg equal -33.5415867414788
variable C4neg equal ${d4}
variable C4neg equal -5.96109233054749
variable C5neg equal ${d5}
variable C5neg equal 19.377546133879
variable C6neg equal ${d6}
variable C6neg equal 1.52794179363259

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.7565520784056
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.157565520784056 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 16.073592) with tilt (-8.2040415 -0.31765008 -0.0091731748)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.7 | 120.1 | 120.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32254.152     -44968.061      0              3085.2934    
       100   299.65649     -32271.331     -2187.2546      3594.5744      3085.2934    
       200   291.07821     -32264.462     -7755.4638      221.64486      3085.2934    
       300   305.62279     -32269.872      336.01517     -1859.6629      3085.2934    
       400   309.10128     -32263.29      -6732.6863     -2116.8163      3085.2934    
       500   302.27873     -32245.915      11134.74       3029.367       3085.2934    
       600   345.63284     -32266.372      23226.036      9495.3564      3085.2934    
       700   340.77596     -32276.81      -577.56714     -924.96181      3085.2934    
       800   290.51617     -32261.34       5471.6787      3121.3288      3085.2934    
       900   310.58379     -32278.629     -5132.2052     -78.586091      3085.2934    
      1000   292.60115     -32264.374      5313.6725     -4344.6255      3085.2934    
      1100   284.50072     -32265.656     -1451.1387      4796.5657      3085.2934    
      1200   275.75237     -32278.419     -1151.378       3300.0482      3085.2934    
      1300   282.32832     -32286.215      1880.5961      9679.807       3085.2934    
      1400   311.51507     -32281.167     -7098.5838      8090.8981      3085.2934    
      1500   298.84582     -32258.016     -10893.124      1995.0319      3085.2934    
      1600   311.57448     -32275.197      10495.239      5221.4685      3085.2934    
      1700   294.157       -32263.002      2070.1974      3671.2952      3085.2934    
      1800   308.62506     -32279.633     -13902.098     -3441.5399      3085.2934    
      1900   287.25428     -32274.584     -566.00027      1321.7549      3085.2934    
      2000   289.91611     -32287.199      10047.283     -1486.0601      3085.2934    
Loop time of 89.8149 on 8 procs for 2000 steps with 274 atoms

Performance: 0.962 ns/day, 24.949 hours/ns, 22.268 timesteps/s, 6.101 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.203     | 68.045     | 75.998     | 129.9 | 75.76
Bond    | 0.00068248 | 0.0008131  | 0.0010649  |   0.0 |  0.00
Neigh   | 4.0275     | 5.2268     | 5.6815     |  29.5 |  5.82
Comm    | 1.008      | 8.9752     | 27.821     | 357.7 |  9.99
Output  | 0.0045962  | 0.005447   | 0.0062666  |   0.9 |  0.01
Modify  | 7.0601     | 7.5242     | 8.7244     |  24.8 |  8.38
Other   |            | 0.03757    |            |       |  0.04

Nlocal:          34.25 ave          47 max          23 min
Histogram: 1 1 1 0 1 2 0 1 0 1
Nghost:         3092.5 ave        3111 max        3080 min
Histogram: 1 2 1 1 0 1 0 1 0 1
Neighs:        21408.4 ave       29124 max       14603 min
Histogram: 1 1 1 0 1 2 0 1 0 1

Total # of neighbors = 171267
Ave neighs/atom = 625.06204
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.6 | 120.1 | 120.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.91611     -32287.199      10047.265      0              3085.2934    
       100   305.13284     -32288.469      4189.215      -550.04023      3085.2934    
       200   309.53449     -32266.653     -3226.5372      5833.2926      3085.2934    
       300   337.6032      -32274.895     -9393.3334     -820.5841       3085.2934    
       400   308.81485     -32260.697     -5798.7815      2500.8399      3085.2934    
       500   310.11371     -32272.393     -2216.0807      4673.7881      3085.2934    
       600   317.00279     -32292.457      15201.365      8284.4471      3085.2934    
       700   289.53835     -32276.898     -6465.1581     -705.10901      3085.2934    
       800   304.99384     -32266.17      -2698.6135      4717.6786      3085.2934    
       900   306.81848     -32243.127     -7500.7241      4081.3861      3085.2934    
      1000   313.97157     -32258.351      3515.2231      2871.4838      3085.2934    
      1100   296.15254     -32261.255     -3992.2977     -5405.7833      3085.2934    
      1200   280.48359     -32261.845      1775.0831     -830.29683      3085.2934    
      1300   274.49214     -32261.997     -5920.2693      1163.0217      3085.2934    
      1400   295.50746     -32274.973     -5105.0817      3457.2528      3085.2934    
      1500   328.89148     -32269.34       3827.8043     -2236.4896      3085.2934    
      1600   331.32064     -32264.38      -4487.1431     -2756.1212      3085.2934    
      1700   297.20119     -32262.727      200.39252      2646.8972      3085.2934    
      1800   305.99992     -32282.026     -5296.6648      2620.1883      3085.2934    
      1900   296.04977     -32286.255     -7577.6881      1150.7665      3085.2934    
      2000   300.93014     -32301.753     -4704.1985     -2744.2754      3085.2934    
Loop time of 89.8655 on 8 procs for 2000 steps with 274 atoms

Performance: 0.961 ns/day, 24.963 hours/ns, 22.255 timesteps/s, 6.098 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.369     | 68.122     | 75.935     | 129.2 | 75.80
Bond    | 0.00063968 | 0.00080373 | 0.0010711  |   0.0 |  0.00
Neigh   | 4.0417     | 5.2171     | 5.6279     |  29.3 |  5.81
Comm    | 1.0907     | 8.9173     | 27.677     | 357.2 |  9.92
Output  | 0.00089839 | 0.0010391  | 0.0015608  |   0.6 |  0.00
Modify  | 7.1542     | 7.5692     | 8.7441     |  24.4 |  8.42
Other   |            | 0.03768    |            |       |  0.04

Nlocal:          34.25 ave          45 max          26 min
Histogram: 1 2 1 0 1 0 0 2 0 1
Nghost:        3072.25 ave        3095 max        3045 min
Histogram: 1 0 0 2 1 0 1 1 1 1
Neighs:        21405.8 ave       27866 max       16435 min
Histogram: 1 2 1 0 1 0 0 2 0 1

Total # of neighbors = 171246
Ave neighs/atom = 624.9854
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 96.4022355542172
variable C2pos equal ${d2}
variable C2pos equal 40.4709541115933
variable C3pos equal ${d3}
variable C3pos equal 138.063447559771
variable C4pos equal ${d4}
variable C4pos equal -18.448205660956
variable C5pos equal ${d5}
variable C5pos equal -21.6016844376191
variable C6pos equal ${d6}
variable C6pos equal 2.26155105442717

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(3.56169689635098+${C1pos})
variable C13 equal 0.5*(3.56169689635098+96.4022355542172)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(47.2960706056106+${C2pos})
variable C23 equal 0.5*(47.2960706056106+40.4709541115933)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-33.5415867414788+${C3pos})
variable C33 equal 0.5*(-33.5415867414788+138.063447559771)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-5.96109233054749+${C4pos})
variable C43 equal 0.5*(-5.96109233054749+-18.448205660956)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(19.377546133879+${C5pos})
variable C53 equal 0.5*(19.377546133879+-21.6016844376191)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(1.52794179363259+${C6pos})
variable C63 equal 0.5*(1.52794179363259+2.26155105442717)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 15.7565520784056
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.7565520784056
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.157565520784056 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.1667387)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.5 | 120.9 | 121.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32267.288     -1267.0801      0              3054.746     
       100   297.5463      -32279.321     -2191.3839      4852.0112      3054.746     
       200   282.33519     -32264.407      198.9004       781.33711      3054.746     
       300   296.64229     -32267.522     -3137.2554      1539.6329      3054.746     
       400   290.13906     -32251.629      8528.3025      7790.1976      3054.746     
       500   320.27422     -32266.192      9440.9962      4157.0811      3054.746     
       600   334.85819     -32251.434      5257.5834      3138.8829      3054.746     
       700   332.80183     -32253.613      14799.643      1188.1222      3054.746     
       800   303.78586     -32263.382      2074.6283      2346.277       3054.746     
       900   300.04912     -32269.328     -514.12811      1900.6923      3054.746     
      1000   304.46045     -32279.67       1554.4457      6302.6481      3054.746     
      1100   300.51749     -32293.633     -1182.6381      1904.3256      3054.746     
      1200   283.86239     -32288.166      11832.368      10887.764      3054.746     
      1300   297.72157     -32272.03      -2924.83        10642.004      3054.746     
      1400   323.6759      -32274.24       8314.955       7721.1078      3054.746     
      1500   309.49709     -32277.695      542.88092      7323.7627      3054.746     
      1600   305.99113     -32291.071      17198.667      8410.3799      3054.746     
      1700   315.61012     -32293.296      4757.0705      4445.2307      3054.746     
      1800   311.98006     -32274.729     -9064.2689      9243.4157      3054.746     
      1900   322.22341     -32248.328     -20161.063      5174.427       3054.746     
      2000   321.65123     -32256.251     -5084.3034      4648.4406      3054.746     
Loop time of 90.7706 on 8 procs for 2000 steps with 274 atoms

Performance: 0.952 ns/day, 25.214 hours/ns, 22.034 timesteps/s, 6.037 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.005     | 68.843     | 76.777     | 131.5 | 75.84
Bond    | 0.00066902 | 0.00081741 | 0.0010586  |   0.0 |  0.00
Neigh   | 4.1123     | 5.326      | 5.7555     |  30.1 |  5.87
Comm    | 1.118      | 9.0636     | 27.905     | 362.4 |  9.99
Output  | 0.004453   | 0.0052714  | 0.0060895  |   0.9 |  0.01
Modify  | 7.0599     | 7.4943     | 8.7205     |  25.6 |  8.26
Other   |            | 0.03742    |            |       |  0.04

Nlocal:          34.25 ave          45 max          27 min
Histogram: 2 1 0 1 1 1 0 1 0 1
Nghost:        3120.12 ave        3159 max        3085 min
Histogram: 2 0 0 1 0 2 2 0 0 1
Neighs:        21648.1 ave       28223 max       17147 min
Histogram: 2 1 0 1 1 1 0 1 0 1

Total # of neighbors = 173185
Ave neighs/atom = 632.06204
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.5 | 120.9 | 121.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   321.65123     -32256.251     -5084.2651      0              3054.746     
       100   324.02022     -32274.304      16868.318      8591.6069      3054.746     
       200   296.05226     -32275.338     -9369.0063      557.56567      3054.746     
       300   288.50733     -32274.275      11078.914      8702.8876      3054.746     
       400   287.62669     -32274.591      3691.2999      10373.216      3054.746     
       500   310.19749     -32276.899      3765.9072      1943.282       3054.746     
       600   315.70902     -32254.63       11044.148      9526.2724      3054.746     
       700   308.10785     -32255.378      1116.0811      4570.4837      3054.746     
       800   302.24666     -32273.505      10485.138      14911.152      3054.746     
       900   300.45294     -32277.515     -11024.883      3817.1266      3054.746     
      1000   300.60143     -32274.546      1915.4157      5066.1766      3054.746     
      1100   321.50822     -32281.379      13182.552      13316.797      3054.746     
      1200   306.15804     -32265.242     -4482.8684      7785.6755      3054.746     
      1300   286.73131     -32271.602      11020.654      4890.5592      3054.746     
      1400   295.89325     -32295.064     -1320.6646      6259.5729      3054.746     
      1500   270.75226     -32269.313      3284.0862      2780.5258      3054.746     
      1600   317.44654     -32282.353      6118.7703      9487.4697      3054.746     
      1700   320.55671     -32279.274      2336.7036      8701.9601      3054.746     
      1800   297.82934     -32266.515      12845.148      15983.08       3054.746     
      1900   298.23082     -32281.379     -2225.8722      2778.889       3054.746     
      2000   284.52205     -32288.019      1491.8874      4467.0373      3054.746     
Loop time of 91.0193 on 8 procs for 2000 steps with 274 atoms

Performance: 0.949 ns/day, 25.283 hours/ns, 21.973 timesteps/s, 6.021 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.584     | 69.291     | 77.035     | 129.7 | 76.13
Bond    | 0.00064438 | 0.00081881 | 0.0010662  |   0.0 |  0.00
Neigh   | 4.1123     | 5.3185     | 5.8008     |  29.9 |  5.84
Comm    | 1.1315     | 8.8805     | 27.585     | 362.3 |  9.76
Output  | 0.00088444 | 0.0011605  | 0.0027418  |   1.8 |  0.00
Modify  | 7.0106     | 7.49       | 8.7036     |  25.3 |  8.23
Other   |            | 0.03745    |            |       |  0.04

Nlocal:          34.25 ave          44 max          29 min
Histogram: 3 1 1 0 1 0 0 0 1 1
Nghost:           3105 ave        3126 max        3084 min
Histogram: 1 1 1 0 1 1 1 0 0 2
Neighs:        21647.5 ave       27612 max       18442 min
Histogram: 3 1 1 0 1 0 0 0 1 1

Total # of neighbors = 173180
Ave neighs/atom = 632.0438
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -23.3336095331263
variable C2neg equal ${d2}
variable C2neg equal 0.99785519161266
variable C3neg equal ${d3}
variable C3neg equal -138.156234334737
variable C4neg equal ${d4}
variable C4neg equal -1.43887360414416
variable C5neg equal ${d5}
variable C5neg equal 7.42299704863943
variable C6neg equal ${d6}
variable C6neg equal 2.92639056773278

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.7565520784056
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.157565520784056 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 0.14839235)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 120.7 | 121.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32263.295      1004.5488      0              3054.746     
       100   291.9541      -32272.542      5161.8596      6197.8147      3054.746     
       200   287.66093     -32265.499      1023.4423      1644.5678      3054.746     
       300   300.5056      -32266.021     -1913.0266     -510.54512      3054.746     
       400   318.12248     -32268.106      11041.573      1990.549       3054.746     
       500   316.29855     -32265.291      17879.701      4548.118       3054.746     
       600   300.28386     -32264.038      5883.9415      7467.9618      3054.746     
       700   295.58386     -32272.901     -6725.3163     -3249.8571      3054.746     
       800   278.13558     -32266.483     -2859.6522      4865.9283      3054.746     
       900   279.78969     -32260.283      6930.7998      6525.9054      3054.746     
      1000   312.47346     -32262.533      9525.5902     -217.49917      3054.746     
      1100   309.13337     -32246.522      6097.8051      5190.7689      3054.746     
      1200   298.77291     -32254.779      12929.744      3617.8993      3054.746     
      1300   296.93066     -32276.611     -2720.8501      9097.6316      3054.746     
      1400   295.89008     -32280.563      4809.4763      12285.054      3054.746     
      1500   308.30508     -32280.9       -6651.7964      5370.3418      3054.746     
      1600   315.16097     -32265.482      14871.53       4332.156       3054.746     
      1700   322.55097     -32260.943      12101.084      7537.7687      3054.746     
      1800   308.2842      -32260.483     -661.84121      4248.4178      3054.746     
      1900   281.44574     -32268.889      1220.3956      2381.0065      3054.746     
      2000   278.6333      -32275.763      14741.802      6407.3827      3054.746     
Loop time of 91.0242 on 8 procs for 2000 steps with 274 atoms

Performance: 0.949 ns/day, 25.285 hours/ns, 21.972 timesteps/s, 6.020 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.949     | 69.065     | 77.277     | 131.7 | 75.88
Bond    | 0.0006736  | 0.00082654 | 0.0010271  |   0.0 |  0.00
Neigh   | 4.1036     | 5.3193     | 5.797      |  30.4 |  5.84
Comm    | 0.86754    | 9.093      | 28.212     | 362.9 |  9.99
Output  | 0.0040095  | 0.004871   | 0.0056791  |   0.9 |  0.01
Modify  | 7.0242     | 7.5038     | 8.7234     |  25.7 |  8.24
Other   |            | 0.0372     |            |       |  0.04

Nlocal:          34.25 ave          46 max          28 min
Histogram: 2 2 0 1 1 0 1 0 0 1
Nghost:        3116.75 ave        3156 max        3078 min
Histogram: 2 0 0 1 2 0 0 1 1 1
Neighs:        21631.8 ave       28721 max       17858 min
Histogram: 2 2 0 1 1 0 1 0 0 1

Total # of neighbors = 173054
Ave neighs/atom = 631.58394
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 120.7 | 121.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   278.6333      -32275.763      14741.796      0              3054.746     
       100   289.17892     -32268.696      559.21878      3011.3715      3054.746     
       200   307.09139     -32263.396      185.09682      224.97401      3054.746     
       300   318.05724     -32273.06       6611.4988      6900.1964      3054.746     
       400   294.24379     -32263.241      13156.68       1491.4819      3054.746     
       500   297.42397     -32271.153      12785.912      2949.0382      3054.746     
       600   302.72518     -32278.155     -10230.154      832.34831      3054.746     
       700   291.87017     -32272.199     -4000.9118      5994.6017      3054.746     
       800   305.29212     -32273.885     -4119.2528      8589.8951      3054.746     
       900   302.79462     -32258.934      2148.2623     -4921.9559      3054.746     
      1000   303.96094     -32248.628      11386.66       2110.7257      3054.746     
      1100   298.52344     -32257.635      3525.7996      7538.5485      3054.746     
      1200   311.55388     -32296.508      14505.853      7045.7327      3054.746     
      1300   295.2665      -32288.483     -1757.1565      8199.6649      3054.746     
      1400   289.09781     -32270.361      17259.246      11505.923      3054.746     
      1500   313.05458     -32273.043     -386.75689      7392.0526      3054.746     
      1600   293.52534     -32252.923      1988.978       2965.4618      3054.746     
      1700   311.56473     -32267.554      8673.6649      7435.7516      3054.746     
      1800   297.20353     -32267.699      21636.006      5034.1449      3054.746     
      1900   288.88899     -32277.533      6888.9391      7157.0639      3054.746     
      2000   309.56962     -32304.778      11058.371      8704.7436      3054.746     
Loop time of 91.173 on 8 procs for 2000 steps with 274 atoms

Performance: 0.948 ns/day, 25.326 hours/ns, 21.936 timesteps/s, 6.011 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.306     | 69.409     | 77.153     | 125.3 | 76.13
Bond    | 0.00066843 | 0.00081218 | 0.0010067  |   0.0 |  0.00
Neigh   | 4.1024     | 5.3358     | 5.7644     |  28.4 |  5.85
Comm    | 1.1428     | 8.8891     | 27.986     | 350.1 |  9.75
Output  | 0.00089122 | 0.0010713  | 0.0017031  |   0.7 |  0.00
Modify  | 7.0809     | 7.4993     | 8.7448     |  24.1 |  8.23
Other   |            | 0.03753    |            |       |  0.04

Nlocal:          34.25 ave          45 max          27 min
Histogram: 3 0 1 1 0 0 1 0 1 1
Nghost:        3090.25 ave        3116 max        3068 min
Histogram: 1 0 1 1 2 1 1 0 0 1
Neighs:        21609.9 ave       28211 max       17164 min
Histogram: 3 0 1 1 0 0 1 0 1 1

Total # of neighbors = 172879
Ave neighs/atom = 630.94526
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -19.6049493484196
variable C2pos equal ${d2}
variable C2pos equal 25.202216817843
variable C3pos equal ${d3}
variable C3pos equal 41.9633802267208
variable C4pos equal ${d4}
variable C4pos equal 13.0228545156368
variable C5pos equal ${d5}
variable C5pos equal -5.03386482029834
variable C6pos equal ${d6}
variable C6pos equal -0.62808023297392

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-23.3336095331263+${C1pos})
variable C14 equal 0.5*(-23.3336095331263+-19.6049493484196)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(0.99785519161266+${C2pos})
variable C24 equal 0.5*(0.99785519161266+25.202216817843)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-138.156234334737+${C3pos})
variable C34 equal 0.5*(-138.156234334737+41.9633802267208)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-1.43887360414416+${C4pos})
variable C44 equal 0.5*(-1.43887360414416+13.0228545156368)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(7.42299704863943+${C5pos})
variable C54 equal 0.5*(7.42299704863943+-5.03386482029834)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(2.92639056773278+${C6pos})
variable C64 equal 0.5*(2.92639056773278+-0.62808023297392)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 15.7565520784056
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.7565520784056
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.157565520784056 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.4752156 -0.0091731748)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.5 | 120.9 | 121.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32264.767      525.20831      0              3054.746     
       100   293.37186     -32274.443      2948.7643      7095.8886      3054.746     
       200   283.20237     -32263.518      1558.8846      2156.8627      3054.746     
       300   303.62778     -32269.147     -2517.2865      958.7848       3054.746     
       400   313.01628     -32265.303      9387.0307      7643.1384      3054.746     
       500   315.98369     -32265.674      23786.214      2916.8166      3054.746     
       600   281.49511     -32248.481      7339.1052      12319.875      3054.746     
       700   290.18994     -32277.511      3746.9327      3575.8234      3054.746     
       800   268.55679     -32271.499      11884.338      3563.7766      3054.746     
       900   282.36762     -32266.84       3887.3113      579.6913       3054.746     
      1000   309.97073     -32265.904      6090.8719      9172.2932      3054.746     
      1100   304.04489     -32257.193     -9614.3843      3925.3701      3054.746     
      1200   300.16449     -32259.782     -6261.2457      10159.661      3054.746     
      1300   297.70946     -32279.799     -1696.4806      9544.6338      3054.746     
      1400   298.38621     -32297.207      3313.9689      3308.618       3054.746     
      1500   275.15995     -32275.061      4974.5923      4363.6639      3054.746     
      1600   308.5084      -32259.756     -4412.1266      2907.539       3054.746     
      1700   313.22978     -32254.152     -11264.742      3062.8742      3054.746     
      1800   310.40452     -32261.887      2677.9706      2250.9104      3054.746     
      1900   301.68511     -32276.799      6083.7458      6316.845       3054.746     
      2000   297.2458      -32280.071     -2950.0532      10305.629      3054.746     
Loop time of 90.7802 on 8 procs for 2000 steps with 274 atoms

Performance: 0.952 ns/day, 25.217 hours/ns, 22.031 timesteps/s, 6.037 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.383     | 70.505     | 77.353     | 109.4 | 77.67
Bond    | 0.00065151 | 0.00083339 | 0.0011127  |   0.0 |  0.00
Neigh   | 3.6367     | 4.8057     | 5.1145     |  22.9 |  5.29
Comm    | 1.1535     | 8.0194     | 28.139     | 324.3 |  8.83
Output  | 0.0042799  | 0.0052878  | 0.0062091  |   1.1 |  0.01
Modify  | 7.0949     | 7.4067     | 8.5822     |  18.5 |  8.16
Other   |            | 0.03776    |            |       |  0.04

Nlocal:          34.25 ave          46 max          24 min
Histogram: 2 0 0 2 0 1 1 1 0 1
Nghost:        3124.75 ave        3167 max        3082 min
Histogram: 1 0 1 0 1 2 2 0 0 1
Neighs:        21647.5 ave       28756 max       15387 min
Histogram: 2 0 0 2 0 1 1 1 0 1

Total # of neighbors = 173180
Ave neighs/atom = 632.0438
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.9 | 121.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   297.2458      -32280.071     -2950.0695      0              3054.746     
       100   300.88777     -32274.096      7063.9011      5630.8943      3054.746     
       200   297.14398     -32244.388      7045.1943     -795.47047      3054.746     
       300   314.85982     -32246.741     -7264.5603      2649.4119      3054.746     
       400   315.75782     -32258.932     -1320.7358      9002.7384      3054.746     
       500   299.43474     -32258.448      4652.716       10087.283      3054.746     
       600   289.38519     -32263.184      7468.285       8155.866       3054.746     
       700   302.26128     -32264.23       2808.9843      10331.751      3054.746     
       800   311.87316     -32245.718     -3075.1718      5390.792       3054.746     
       900   314.18876     -32233.07      -3782.5822      4851.6041      3054.746     
      1000   311.00861     -32237.928     -1154.2961     -2895.0198      3054.746     
      1100   297.53149     -32264.403      10136.282      8057.9854      3054.746     
      1200   288.8303      -32276.098      613.51539      12675.103      3054.746     
      1300   293.51694     -32282.599      4549.7228      10670.712      3054.746     
      1400   286.73126     -32265.601      7853.4713      8160.9455      3054.746     
      1500   285.90753     -32239.136      4238.1725      11250.539      3054.746     
      1600   302.06066     -32241.762     -2673.5541      7049.9304      3054.746     
      1700   313.85264     -32261.679     -7850.8044      3879.6671      3054.746     
      1800   304.61459     -32266.48      -5122.2993      7782.5807      3054.746     
      1900   294.02235     -32261.162      8678.4445      8536.8604      3054.746     
      2000   312.46628     -32273.591      666.09227      6139.9223      3054.746     
Loop time of 90.0274 on 8 procs for 2000 steps with 274 atoms

Performance: 0.960 ns/day, 25.008 hours/ns, 22.215 timesteps/s, 6.087 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.83      | 67.792     | 76.879     | 121.9 | 75.30
Bond    | 0.0006342  | 0.000814   | 0.0010303  |   0.0 |  0.00
Neigh   | 3.6908     | 4.6388     | 5.1036     |  26.3 |  5.15
Comm    | 1.0428     | 10.146     | 27.113     | 315.2 | 11.27
Output  | 0.00091929 | 0.001112   | 0.0019598  |   1.0 |  0.00
Modify  | 6.9329     | 7.4119     | 8.3596     |  20.9 |  8.23
Other   |            | 0.0371     |            |       |  0.04

Nlocal:          34.25 ave          45 max          27 min
Histogram: 2 0 2 0 0 2 0 1 0 1
Nghost:           3129 ave        3147 max        3115 min
Histogram: 2 0 1 0 1 2 1 0 0 1
Neighs:        21629.5 ave       28161 max       17160 min
Histogram: 2 0 2 0 2 0 0 1 0 1

Total # of neighbors = 173036
Ave neighs/atom = 631.51825
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -6.3831021298201
variable C2neg equal ${d2}
variable C2neg equal 9.33716875006823
variable C3neg equal ${d3}
variable C3neg equal -64.881123221734
variable C4neg equal ${d4}
variable C4neg equal 6.23242367862171
variable C5neg equal ${d5}
variable C5neg equal 25.3461200266319
variable C6neg equal ${d6}
variable C6neg equal -6.1776308825345

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.7565520784056
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.157565520784056 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.16008456 -0.0091731748)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 120.7 | 121.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32265.767     -71.707733      0              3054.746     
       100   292.97496     -32275.378      6722.337       4383.7374      3054.746     
       200   278.92835     -32260.87      -6950.7112      1640.7477      3054.746     
       300   286.89892     -32256.902      3131.423       279.68797      3054.746     
       400   305.36627     -32259.358     -406.00579      6640.6065      3054.746     
       500   318.76947     -32267.796      526.32326      6053.4988      3054.746     
       600   301.2227      -32258.627      8793.8167      7665.7397      3054.746     
       700   317.92699     -32280.028      9867.2577      4821.9783      3054.746     
       800   297.09573     -32281.311      2319.0829     -5054.218       3054.746     
       900   290.65347     -32287.156     -2217.1834      5024.1827      3054.746     
      1000   295.41734     -32281.789     -3039.0896      1903.5809      3054.746     
      1100   308.6466      -32260.727      16617.275      7416.1657      3054.746     
      1200   312.44059     -32260.536     -3930.0282      8098.4381      3054.746     
      1300   288.21707     -32261.475      8347.4101      10114.218      3054.746     
      1400   307.77068     -32283.879      6041.2056      8371.9216      3054.746     
      1500   302.03894     -32278.541     -1401.9362      6604.7703      3054.746     
      1600   307.59982     -32272.613      2544.7464      1283.8977      3054.746     
      1700   314.28951     -32252.882     -4050.1809      4658.9183      3054.746     
      1800   315.52441     -32259.688     -11478.25       2146.625       3054.746     
      1900   303.25381     -32277.692     -11589.642      1360.194       3054.746     
      2000   312.82286     -32298.732     -11431.895     -535.49034      3054.746     
Loop time of 90.7097 on 8 procs for 2000 steps with 274 atoms

Performance: 0.952 ns/day, 25.197 hours/ns, 22.048 timesteps/s, 6.041 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.643     | 69.596     | 77.076     | 114.6 | 76.72
Bond    | 0.00066164 | 0.00082859 | 0.001127   |   0.0 |  0.00
Neigh   | 4.0754     | 5.3032     | 5.7745     |  28.0 |  5.85
Comm    | 0.86133    | 8.3585     | 27.322     | 330.8 |  9.21
Output  | 0.0040089  | 0.0049052  | 0.0057131  |   1.0 |  0.01
Modify  | 6.9361     | 7.4089     | 8.629      |  23.6 |  8.17
Other   |            | 0.03779    |            |       |  0.04

Nlocal:          34.25 ave          45 max          27 min
Histogram: 1 2 1 0 1 1 1 0 0 1
Nghost:        3122.62 ave        3145 max        3093 min
Histogram: 1 1 1 0 0 0 1 2 0 2
Neighs:        21648.8 ave       28151 max       17263 min
Histogram: 1 2 1 0 1 1 1 0 0 1

Total # of neighbors = 173190
Ave neighs/atom = 632.08029
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 120.7 | 121.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.82286     -32298.732     -11431.894      0              3054.746     
       100   292.66241     -32273.712      4672.501       11010.001      3054.746     
       200   329.36447     -32276.542     -7419.6458      4352.1279      3054.746     
       300   302.93131     -32241.81       8757.4544      11071.42       3054.746     
       400   304.06373     -32255.975      361.16753      6508.1467      3054.746     
       500   305.76838     -32267.352      15009.281      11568.713      3054.746     
       600   300.45007     -32277.99       758.61834      2608.897       3054.746     
       700   299.88545     -32281.45       13728.36       6745.8064      3054.746     
       800   306.80262     -32272.65       3092.4019      1584.142       3054.746     
       900   308.24829     -32247.006      12596.04       6345.0868      3054.746     
      1000   292.96845     -32230.336      5990.2999      2577.7255      3054.746     
      1100   307.73939     -32259.638      10794.478      6656.3674      3054.746     
      1200   287.20944     -32256.076      13874.975      8848.3793      3054.746     
      1300   292.25919     -32268.505     -6451.0554      2633.363       3054.746     
      1400   292.82365     -32279.636     -7631.8396      3093.0693      3054.746     
      1500   277.79586     -32275.051      4650.6839      4667.3654      3054.746     
      1600   273.97229     -32266.78      -2021.1985      3177.4658      3054.746     
      1700   296.84432     -32258.533      3156.7315      8119.2321      3054.746     
      1800   307.94261     -32258.691      3468.8951      6576.7462      3054.746     
      1900   292.83654     -32261.569     -1760.3664      6939.8249      3054.746     
      2000   284.36454     -32277.835      6349.595       8274.1775      3054.746     
Loop time of 91.7184 on 8 procs for 2000 steps with 274 atoms

Performance: 0.942 ns/day, 25.477 hours/ns, 21.806 timesteps/s, 5.975 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.381     | 71.336     | 77.478     |  93.1 | 77.78
Bond    | 0.000655   | 0.00083643 | 0.0011797  |   0.0 |  0.00
Neigh   | 4.1747     | 5.3906     | 5.7069     |  20.8 |  5.88
Comm    | 1.2976     | 7.4337     | 26.404     | 288.5 |  8.10
Output  | 0.00093074 | 0.0010691  | 0.0018015  |   0.8 |  0.00
Modify  | 7.1933     | 7.5174     | 8.7227     |  17.4 |  8.20
Other   |            | 0.03866    |            |       |  0.04

Nlocal:          34.25 ave          44 max          26 min
Histogram: 2 0 0 1 1 2 1 0 0 1
Nghost:        3120.75 ave        3149 max        3092 min
Histogram: 2 0 0 1 0 2 1 1 0 1
Neighs:        21631.4 ave       27636 max       16518 min
Histogram: 2 0 0 1 1 2 1 0 0 1

Total # of neighbors = 173051
Ave neighs/atom = 631.57299
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -15.2422383589891
variable C2pos equal ${d2}
variable C2pos equal -0.956966520553587
variable C3pos equal ${d3}
variable C3pos equal 60.2056521749021
variable C4pos equal ${d4}
variable C4pos equal 1.94172821649044
variable C5pos equal ${d5}
variable C5pos equal -4.88591868596251
variable C6pos equal ${d6}
variable C6pos equal -4.45417476353096

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-6.3831021298201+${C1pos})
variable C15 equal 0.5*(-6.3831021298201+-15.2422383589891)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(9.33716875006823+${C2pos})
variable C25 equal 0.5*(9.33716875006823+-0.956966520553587)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-64.881123221734+${C3pos})
variable C35 equal 0.5*(-64.881123221734+60.2056521749021)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(6.23242367862171+${C4pos})
variable C45 equal 0.5*(6.23242367862171+1.94172821649044)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(25.3461200266319+${C5pos})
variable C55 equal 0.5*(25.3461200266319+-4.88591868596251)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-6.1776308825345+${C6pos})
variable C65 equal 0.5*(-6.1776308825345+-4.45417476353096)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.5921534688336

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.5921534688336
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.125921534688336 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.3299631 -0.31765008 -0.0091731748)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 121 | 121.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32266.077     -2554.9535      0              3054.746     
       100   293.55872     -32276.035      722.82672      4295.5073      3054.746     
       200   280.39984     -32262.792      637.6128       47.425364      3054.746     
       300   299.06349     -32268.619     -4855.5535      2426.9836      3054.746     
       400   305.46621     -32260.566      11740.492      3983.1007      3054.746     
       500   312.88419     -32260.027      1490.5575      4717.7076      3054.746     
       600   323.06153     -32251.353      13115.513      6000.6955      3054.746     
       700   307.1506      -32230.911      15402.598      2319.1904      3054.746     
       800   309.32852     -32263.008      3873.4134      6004.8448      3054.746     
       900   308.42422     -32278.004      1012.6425      5125.7931      3054.746     
      1000   298.52147     -32276.724      14631.91       5093.2038      3054.746     
      1100   302.0284      -32283.303      608.79812      1567.5813      3054.746     
      1200   298.09523     -32269.509      2921.9874      8294.467       3054.746     
      1300   294.15485     -32246.245      10973.221      8678.2997      3054.746     
      1400   300.40773     -32257.356      7820.3366      6666.244       3054.746     
      1500   300.25898     -32283.032     -1036.6668      7267.5573      3054.746     
      1600   310.61911     -32293.961     -5415.0596      1851.6711      3054.746     
      1700   290.81813     -32278.55      -4004.2947      4221.3526      3054.746     
      1800   292.46931     -32269.859      12267.515      3892.1765      3054.746     
      1900   316.42306     -32284.339      5180.5697      4837.0588      3054.746     
      2000   307.0895      -32283.657      7485.8585      8066.8944      3054.746     
Loop time of 90.9159 on 8 procs for 2000 steps with 274 atoms

Performance: 0.950 ns/day, 25.254 hours/ns, 21.998 timesteps/s, 6.028 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.488     | 69.684     | 77.372     | 124.6 | 76.65
Bond    | 0.00066714 | 0.00083232 | 0.0011012  |   0.0 |  0.00
Neigh   | 3.6907     | 4.7502     | 5.1208     |  26.9 |  5.22
Comm    | 1.2891     | 8.9832     | 27.177     | 347.1 |  9.88
Output  | 0.0049002  | 0.0058747  | 0.0067844  |   0.9 |  0.01
Modify  | 7.0803     | 7.4543     | 8.5208     |  21.6 |  8.20
Other   |            | 0.03779    |            |       |  0.04

Nlocal:          34.25 ave          45 max          28 min
Histogram: 3 0 1 1 0 1 0 1 0 1
Nghost:           3133 ave        3153 max        3118 min
Histogram: 2 0 0 3 0 1 0 0 1 1
Neighs:        21654.8 ave       28160 max       17825 min
Histogram: 3 0 1 1 0 1 0 1 0 1

Total # of neighbors = 173238
Ave neighs/atom = 632.25547
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 121 | 121.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.0895      -32283.657      7485.8746      0              3054.746     
       100   306.68442     -32280.091      13531.971      9468.7334      3054.746     
       200   312.55856     -32259.815     -1920.1917     -988.83281      3054.746     
       300   304.94319     -32245.655     -4499.3862      4613.6044      3054.746     
       400   292.3         -32271.281     -6281.6154      11465.499      3054.746     
       500   284.07807     -32273.205     -16323.042     -1573.8054      3054.746     
       600   299.83028     -32278.576     -1720.9336      4565.7361      3054.746     
       700   287.83125     -32256.514      13946.258      113.85545      3054.746     
       800   312.16566     -32264.24       2931.9282      248.50341      3054.746     
       900   315.29878     -32254.27       7555.9512      10223.638      3054.746     
      1000   285.70447     -32241.842      4183.3322      8947.0883      3054.746     
      1100   292.48054     -32275.151      2228.7684      1814.6205      3054.746     
      1200   303.98285     -32290.878      4729.2207      10464.914      3054.746     
      1300   305.79977     -32287.434     -980.37839      807.27148      3054.746     
      1400   298.00862     -32265.967     -16606.751     -6448.8879      3054.746     
      1500   320.15853     -32259.502     -3967.2088      4110.4531      3054.746     
      1600   302.77717     -32258.035      1872.7845      10664.424      3054.746     
      1700   291.27496     -32268.227     -3756.5813      5189.6809      3054.746     
      1800   288.14601     -32278.29       5414.2052      9771.9369      3054.746     
      1900   274.39619     -32262.959      7438.399       339.79079      3054.746     
      2000   304.98123     -32278          8820.1873      4052.1967      3054.746     
Loop time of 89.7769 on 8 procs for 2000 steps with 274 atoms

Performance: 0.962 ns/day, 24.938 hours/ns, 22.277 timesteps/s, 6.104 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.601     | 68.577     | 76.096     | 118.5 | 76.39
Bond    | 0.00066927 | 0.00080718 | 0.0010576  |   0.0 |  0.00
Neigh   | 3.6451     | 4.7493     | 5.1772     |  25.0 |  5.29
Comm    | 1.4654     | 8.9808     | 28.963     | 327.4 | 10.00
Output  | 0.00089296 | 0.0010497  | 0.001814   |   0.9 |  0.00
Modify  | 6.9926     | 7.4304     | 8.5352     |  20.1 |  8.28
Other   |            | 0.03723    |            |       |  0.04

Nlocal:          34.25 ave          46 max          26 min
Histogram: 2 0 1 1 0 1 2 0 0 1
Nghost:        3142.12 ave        3160 max        3126 min
Histogram: 2 1 0 0 0 2 0 1 1 1
Neighs:        21641.2 ave       28745 max       16582 min
Histogram: 2 0 1 1 0 1 2 0 0 1

Total # of neighbors = 173130
Ave neighs/atom = 631.86131
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -27.5369820979422
variable C2neg equal ${d2}
variable C2neg equal -34.5975679278935
variable C3neg equal ${d3}
variable C3neg equal -86.3804275729577
variable C4neg equal ${d4}
variable C4neg equal 15.0547215007519
variable C5neg equal ${d5}
variable C5neg equal -2.75770507190053
variable C6neg equal ${d6}
variable C6neg equal 5.30611373831603

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.5921534688336
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.125921534688336 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.07812 -0.31765008 -0.0091731748)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.7 | 120.1 | 120.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32264.166      3759.1639      0              3054.746     
       100   295.45867     -32276.113      9750.3272      6383.4224      3054.746     
       200   293.34211     -32270.746     -6830.2014      434.90741      3054.746     
       300   283.68077     -32253.88      -4124.6007      2307.5739      3054.746     
       400   307.0364      -32260.662     -5474.6002      5917.748       3054.746     
       500   326.2246      -32269.937      7146.4181      3948.5241      3054.746     
       600   317.86564     -32254.073      9857.1234      7708.4089      3054.746     
       700   323.97199     -32263.096     -3154.4571      2336.6029      3054.746     
       800   299.62394     -32273.43       9169.0043      611.44843      3054.746     
       900   302.81265     -32289.026     -159.22353      10218.01       3054.746     
      1000   314.42477     -32295.61      -9726.0692      4632.2293      3054.746     
      1100   291.11752     -32264.726     -5222.1963      2991.0257      3054.746     
      1200   296.38698     -32242.136      18820.559      11234.03       3054.746     
      1300   336.10506     -32266.437     -7093.1315      7903.4969      3054.746     
      1400   294.1646      -32259.54       21621.438      15697.783      3054.746     
      1500   285.15479     -32261.013     -12324.164      882.27015      3054.746     
      1600   294.8748      -32269.645      6026.3215      4715.4022      3054.746     
      1700   304.53252     -32270.072      2379.3703      2857.0523      3054.746     
      1800   305.32192     -32257.816      2963.346      -1042.7748      3054.746     
      1900   303.31615     -32252.102      4327.9002      8468.855       3054.746     
      2000   297.23129     -32271.149      528.34174      6241.3011      3054.746     
Loop time of 83.7294 on 8 procs for 2000 steps with 274 atoms

Performance: 1.032 ns/day, 23.258 hours/ns, 23.886 timesteps/s, 6.545 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.472     | 60.616     | 70.5       | 139.1 | 72.40
Bond    | 0.0006008  | 0.00071207 | 0.00090872 |   0.0 |  0.00
Neigh   | 4.0194     | 5.027      | 5.663      |  34.6 |  6.00
Comm    | 0.77949    | 10.655     | 26.805     | 331.7 | 12.73
Output  | 0.0037603  | 0.0044773  | 0.005158   |   0.8 |  0.01
Modify  | 6.7375     | 7.3914     | 8.4048     |  28.8 |  8.83
Other   |            | 0.03416    |            |       |  0.04

Nlocal:          34.25 ave          41 max          29 min
Histogram: 2 1 1 0 1 0 1 0 0 2
Nghost:           3107 ave        3132 max        3078 min
Histogram: 2 0 1 0 0 0 2 1 0 2
Neighs:        21639.2 ave       25773 max       18399 min
Histogram: 2 1 1 0 1 0 1 0 0 2

Total # of neighbors = 173114
Ave neighs/atom = 631.80292
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.6 | 120.1 | 120.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   297.23129     -32271.15       528.30369      0              3054.746     
       100   303.769       -32279.884      17795.019      6788.5855      3054.746     
       200   274.66463     -32265.666      17452.864      7639.3204      3054.746     
       300   270.24689     -32267.461     -3426.3404      837.47463      3054.746     
       400   310.75375     -32285.526      6672.92        6778.993       3054.746     
       500   304.39695     -32266.876     -5111.5754      4581.4425      3054.746     
       600   304.92018     -32261.16       4346.5099      9411.0501      3054.746     
       700   288.15911     -32260.766     -4670.4002      1056.67        3054.746     
       800   308.15771     -32296.902     -848.22842      4354.5085      3054.746     
       900   287.89786     -32293.869      1342.5025      7429.603       3054.746     
      1000   287.09652     -32284.092      10398.057      5603.5215      3054.746     
      1100   307.53161     -32268.429     -2266.7241      3765.5349      3054.746     
      1200   321.00326     -32274.302      6700.2839      8872.8947      3054.746     
      1300   315.89098     -32287.636      3202.8477      3338.412       3054.746     
      1400   299.63209     -32288.766     -4066.3199      2477.7093      3054.746     
      1500   302.65228     -32292.32       22176.195      4567.6993      3054.746     
      1600   316.20132     -32272.85       7278.2479      4255.4935      3054.746     
      1700   318.01039     -32255.541      2779.1727     -2350.33        3054.746     
      1800   298.60311     -32255.239      17536.08       8950.4308      3054.746     
      1900   293.86219     -32270.008      7633.7721      10393.009      3054.746     
      2000   287.84856     -32278.584      16130.324      4432.844       3054.746     
Loop time of 78.607 on 8 procs for 2000 steps with 274 atoms

Performance: 1.099 ns/day, 21.835 hours/ns, 25.443 timesteps/s, 6.971 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 42.96      | 51.65      | 65.519     | 115.4 | 65.71
Bond    | 0.00061292 | 0.00067968 | 0.00075386 |   0.0 |  0.00
Neigh   | 4          | 4.5098     | 5.5974     |  29.5 |  5.74
Comm    | 1.1291     | 15.014     | 23.718     | 214.3 | 19.10
Output  | 0.00085942 | 0.00098141 | 0.0013509  |   0.0 |  0.00
Modify  | 6.314      | 7.3986     | 7.9232     |  22.9 |  9.41
Other   |            | 0.03258    |            |       |  0.04

Nlocal:          34.25 ave          42 max          26 min
Histogram: 1 2 0 0 0 2 0 1 0 2
Nghost:         3109.5 ave        3135 max        3082 min
Histogram: 1 0 0 2 2 1 0 0 0 2
Neighs:        21624.5 ave       26409 max       16577 min
Histogram: 1 2 0 0 1 1 0 1 0 2

Total # of neighbors = 172996
Ave neighs/atom = 631.37226
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 23.6800737926251
variable C2pos equal ${d2}
variable C2pos equal -13.5810162920999
variable C3pos equal ${d3}
variable C3pos equal 39.4736478253849
variable C4pos equal ${d4}
variable C4pos equal -16.7355506474525
variable C5pos equal ${d5}
variable C5pos equal -15.6150842508124
variable C6pos equal ${d6}
variable C6pos equal 2.61471888709121

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-27.5369820979422+${C1pos})
variable C16 equal 0.5*(-27.5369820979422+23.6800737926251)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-34.5975679278935+${C2pos})
variable C26 equal 0.5*(-34.5975679278935+-13.5810162920999)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-86.3804275729577+${C3pos})
variable C36 equal 0.5*(-86.3804275729577+39.4736478253849)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(15.0547215007519+${C4pos})
variable C46 equal 0.5*(15.0547215007519+-16.7355506474525)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-2.75770507190053+${C5pos})
variable C56 equal 0.5*(-2.75770507190053+-15.6150842508124)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(5.30611373831603+${C6pos})
variable C66 equal 0.5*(5.30611373831603+2.61471888709121)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 40.9595598123988
variable C22all equal ${C22}
variable C22all equal 24.3714076550676
variable C33all equal ${C33}
variable C33all equal 52.2609304091461

variable C44all equal ${C44}
variable C44all equal 5.79199045574632
variable C55all equal ${C55}
variable C55all equal 10.2301006703347
variable C66all equal ${C66}
variable C66all equal 3.96041631270362

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(15.0355793069788+${C21})
variable C12all equal 0.5*(15.0355793069788+8.1174647046908)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(49.9819662252841+${C31})
variable C13all equal 0.5*(49.9819662252841+66.3112209513384)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(43.8835123586019+${C32})
variable C23all equal 0.5*(43.8835123586019+3.7008731283858)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-21.469279440773+${C41})
variable C14all equal 0.5*(-21.469279440773+8.31034852276482)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-10.8126702444046+${C51})
variable C15all equal 0.5*(-10.8126702444046+3.88261176416)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-1.92845415265855+${C61})
variable C16all equal 0.5*(-1.92845415265855+0.439667969176662)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(13.1000360047278+${C42})
variable C24all equal 0.5*(13.1000360047278+8.9934290721801)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(4.19010111475732+${C52})
variable C25all equal 0.5*(4.19010111475732+-3.06916455696034)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-24.0892921099967+${C62})
variable C26all equal 0.5*(-24.0892921099967+2.59685018759912)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-48.0964270540081+${C43})
variable C34all equal 0.5*(-48.0964270540081+-12.2046489957517)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-2.33773552341595+${C53})
variable C35all equal 0.5*(-2.33773552341595+-1.11206915187005)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-23.4533898737864+${C63})
variable C36all equal 0.5*(-23.4533898737864+1.89474642402988)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(4.08707594755607+${C54})
variable C45all equal 0.5*(4.08707594755607+1.19456611417055)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-0.8404145733503+${C64})
variable C46all equal 0.5*(-0.8404145733503+1.14915516737943)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-9.18639466135646+${C65})
variable C56all equal 0.5*(-9.18639466135646+-5.31590282303273)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:37:31
