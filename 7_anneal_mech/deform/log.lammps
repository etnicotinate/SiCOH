LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333SiCOH
read_data       ${structure}.data
read_data       333SiCOH.data
Reading data file ...
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.012 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 9.09767e-05 on 8 procs for 1 steps with 373 atoms

57.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.397e-06  | 2.4181e-06 | 2.864e-06  |   0.0 |  2.66
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 5.517e-06  | 6.4252e-06 | 7.752e-06  |   0.0 |  7.06
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 8.213e-05  |            |       | 90.28

Nlocal:         46.625 ave          55 max          38 min
Histogram: 2 0 0 2 0 0 0 2 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = 39.36 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 123.1 | 123.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -37805.726      120410.25      0              1.1428982      4699.6115    
       100   903.04092     -39179.581     -28649.235     -9792.4337      1.1428982      4699.6115    
       200   651.54509     -39633.63      -16474.908     -9178.1277      1.1428982      4699.6115    
       300   531.14314     -39954.318     -824.25296      925.97749      1.1428982      4699.6115    
       400   376.67395     -40083.235      6915.4492     -5459.9373      1.1428982      4699.6115    
       500   324.42538     -40213.574      2669.6096     -377.7467       1.1428982      4699.6115    
       600   300.76819     -40311.14      -1810.0617     -4140.8544      1.1428982      4699.6115    
       700   281.72264     -40367.996     -2349.1868     -3475.9704      1.1428982      4699.6115    
       800   268.37001     -40371.69       1898.4375     -1620.8598      1.1428982      4699.6115    
       900   294.17996     -40367.959     -11183.084     -4091.1805      1.1428982      4699.6115    
      1000   343.75483     -40372.467     -542.96193     -2247.5154      1.1428982      4699.6115    
      1100   328.9223      -40354.056     -9308.1225     -3182.1826      1.1428982      4699.6115    
      1200   305.68736     -40363.235      6435.1285     -3051.8267      1.1428982      4699.6115    
      1300   294.51427     -40394.567      948.64458     -2956.7914      1.1428982      4699.6115    
      1400   289.13804     -40430.091     -6449.2616     -3414.9335      1.1428982      4699.6115    
      1500   275.57473     -40440.729     -4342.4294     -3572.1092      1.1428982      4699.6115    
      1600   287.09849     -40435.242      3166.2204     -4688.9169      1.1428982      4699.6115    
      1700   310.08056     -40420.722      92.799466     -3731.3702      1.1428982      4699.6115    
      1800   315.7728      -40422.46      -4416.3968     -1859.2642      1.1428982      4699.6115    
      1900   311.06666     -40457.401      1745.9021     -3375.2609      1.1428982      4699.6115    
      2000   294.19945     -40475.217     -2480.3365      504.58325      1.1428982      4699.6115    
Loop time of 43.4347 on 8 procs for 2000 steps with 373 atoms

Performance: 1.989 ns/day, 12.065 hours/ns, 46.046 timesteps/s, 17.175 katom-step/s
98.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.75      | 32.028     | 33.21      |  12.8 | 73.74
Bond    | 0.0034751  | 0.0035781  | 0.0037657  |   0.1 |  0.01
Neigh   | 3.8823     | 3.9044     | 3.9292     |   0.7 |  8.99
Comm    | 0.66767    | 1.8491     | 3.128      |  53.1 |  4.26
Output  | 0.00067474 | 0.00072062 | 0.0010225  |   0.0 |  0.00
Modify  | 5.5822     | 5.6096     | 5.6332     |   0.6 | 12.92
Other   |            | 0.03932    |            |       |  0.09

Nlocal:         46.625 ave          54 max          35 min
Histogram: 1 0 0 0 2 2 0 0 1 2
Nghost:        3242.75 ave        3312 max        3188 min
Histogram: 2 0 0 1 1 2 1 0 0 1
Neighs:        25675.8 ave       29569 max       19588 min
Histogram: 1 0 0 0 2 2 0 0 1 2

Total # of neighbors = 205406
Ave neighs/atom = 550.68633
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333SiCOH_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 19.0492
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.0575
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.55

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-504.5832513659)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-504.5832513659)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2132.48321742359)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2132.48321742359)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3270.12669728435)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3270.12669728435)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1494.22124125237)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1494.22124125237)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--767.303950747086)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--767.303950747086)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-150.532010756433)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-150.532010756433)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 19.0492
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*19.0492
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.190492 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.190492 xy delta 0.107944 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.190492 xy delta 0.107944 xz delta -0.013894 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8450.8125     -4557.9159      4697.2617    
       200   297.33544     -40472.402     -6621.3096     -3019.583       4694.9119    
       300   321.34658     -40471.622     -2689.9655     -4139.5817      4692.562     
       400   320.47445     -40470.102     -244.936       -382.34558      4690.2122    
       500   295.93934     -40467.544     -4062.0864     -7430.367       4687.8624    
       600   273.42712     -40460.837     -14704.178     -8652.0343      4685.5126    
       700   302.36425     -40492.287     -10165.264     -466.13509      4683.1628    
       800   293.90873     -40483.396     -125.80445     -1879.2796      4680.813     
       900   311.97961     -40506.577     -2799.8313     -2738.2843      4678.4632    
      1000   310.06738     -40509.317     -975.17501     -1708.3893      4676.1134    
      1100   301.59631     -40506.965     -5550.3543      322.5236       4673.7636    
      1200   296.04667     -40511.752      6011.821      -6522.116       4671.4138    
      1300   302.34909     -40531.239     -3849.621      -3758.5897      4669.064     
      1400   292.2964      -40535.821     -7220.8298     -4453.4821      4666.7142    
      1500   295.02429     -40541.179     -7856.3775     -2529.6371      4664.3644    
      1600   294.18945     -40534.598     -5852.015      -5185.1418      4662.0146    
      1700   300.4609      -40552.27       1262.286      -6074.5432      4659.6648    
      1800   290.6498      -40562.684      4745.0084     -200.69162      4657.315     
      1900   273.7706      -40565.457     -18633.895     -3027.4237      4654.9652    
      2000   305.90855     -40606.088     -10888.289     -6621.8999      4652.6153    
Loop time of 42.88 on 8 procs for 2000 steps with 373 atoms

Performance: 2.015 ns/day, 11.911 hours/ns, 46.642 timesteps/s, 17.397 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.361     | 31.609     | 32.77      |  15.6 | 73.72
Bond    | 0.0033405  | 0.0035379  | 0.0037201  |   0.2 |  0.01
Neigh   | 3.9945     | 4.0258     | 4.0546     |   1.1 |  9.39
Comm    | 0.55943    | 1.7198     | 2.9658     |  66.8 |  4.01
Output  | 0.0033444  | 0.0044854  | 0.005313   |   1.1 |  0.01
Modify  | 5.4475     | 5.4778     | 5.5107     |   1.0 | 12.77
Other   |            | 0.03958    |            |       |  0.09

Nlocal:         46.625 ave          52 max          36 min
Histogram: 1 0 1 0 0 1 1 0 1 3
Nghost:           3096 ave        3128 max        3066 min
Histogram: 2 0 0 1 1 1 1 1 0 1
Neighs:        25936.6 ave       28771 max       20434 min
Histogram: 1 0 1 0 0 1 1 0 1 3

Total # of neighbors = 207493
Ave neighs/atom = 556.2815
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -72.2090908451998
variable C2neg equal ${d2}
variable C2neg equal -38.3319571787656
variable C3neg equal ${d3}
variable C3neg equal -100.448090142109
variable C4neg equal ${d4}
variable C4neg equal -6.53210707931694
variable C5neg equal ${d5}
variable C5neg equal 5.98106679598773
variable C6neg equal ${d6}
variable C6neg equal -2.48567400242384

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*19.0492
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.190492 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.190492 xy delta -0.107944 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.190492 xy delta -0.107944 xz delta 0.013894 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8442.3659     -4557.8637      4701.9613    
       200   297.77516     -40472.602     -6958.3368     -2879.2077      4704.3111    
       300   320.5878      -40469.483     -4801.0562     -3840.8795      4706.6609    
       400   314.50805     -40462.147     -4829.3311     -2460.5693      4709.0107    
       500   299.98264     -40469.077     -5830.6961     -7799.2632      4711.3605    
       600   293.60709     -40479.559     -4618.853      -7161.7345      4713.7103    
       700   309.14623     -40501.021     -8356.5615     -941.68895      4716.0601    
       800   305.00216     -40510.73      -8664.0112     -4198.3842      4718.4099    
       900   296.57687     -40516.587     -3131.4109     -1026.87        4720.7597    
      1000   286.29742     -40513.447     -2222.7639     -3425.0363      4723.1095    
      1100   283.22208     -40508.365     -9788.6242     -4094.6296      4725.4593    
      1200   292.46935     -40513.212      2535.2671     -5661.6224      4727.8091    
      1300   297.7401      -40527.329      367.71079     -105.69392      4730.1589    
      1400   287.99184     -40523.247     -10211.902     -5040.4289      4732.5087    
      1500   284.95048     -40510.613     -2268.5361     -6762.5028      4734.8585    
      1600   311.87082     -40514.873      5433.6998     -4629.9643      4737.2084    
      1700   325.41606     -40518.613     -451.44379     -3411.8389      4739.5582    
      1800   320.07646     -40526.871     -2055.9764     -4004.6956      4741.908     
      1900   295.95781     -40536.056      7193.6539     -217.39408      4744.2578    
      2000   292.57367     -40562.187      7762.0366     -6679.3533      4746.6076    
Loop time of 42.2424 on 8 procs for 2000 steps with 373 atoms

Performance: 2.045 ns/day, 11.734 hours/ns, 47.346 timesteps/s, 17.660 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.761     | 31.168     | 32.252     |  16.2 | 73.78
Bond    | 0.0033186  | 0.0035312  | 0.0036813  |   0.2 |  0.01
Neigh   | 3.9664     | 4.0119     | 4.0455     |   1.3 |  9.50
Comm    | 0.57355    | 1.6595     | 3.0635     |  70.1 |  3.93
Output  | 0.0031603  | 0.0043026  | 0.005097   |   1.1 |  0.01
Modify  | 5.322      | 5.3553     | 5.4033     |   1.2 | 12.68
Other   |            | 0.0398     |            |       |  0.09

Nlocal:         46.625 ave          57 max          35 min
Histogram: 1 0 0 1 2 1 1 0 1 1
Nghost:           3061 ave        3109 max        3013 min
Histogram: 1 0 2 1 1 0 0 1 0 2
Neighs:        25420.8 ave       30641 max       19497 min
Histogram: 1 0 0 1 2 1 1 0 1 1

Total # of neighbors = 203366
Ave neighs/atom = 545.21716
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 72.7912367549946
variable C2pos equal ${d2}
variable C2pos equal -22.8470856374365
variable C3pos equal ${d3}
variable C3pos equal 65.5994261606647
variable C4pos equal ${d4}
variable C4pos equal 16.4835164662354
variable C5pos equal ${d5}
variable C5pos equal 1.69467337274083
variable C6pos equal ${d6}
variable C6pos equal -0.230989300599879

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-72.2090908451998+${C1pos})
variable C11 equal 0.5*(-72.2090908451998+72.7912367549946)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-38.3319571787656+${C2pos})
variable C21 equal 0.5*(-38.3319571787656+-22.8470856374365)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-100.448090142109+${C3pos})
variable C31 equal 0.5*(-100.448090142109+65.5994261606647)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-6.53210707931694+${C4pos})
variable C41 equal 0.5*(-6.53210707931694+16.4835164662354)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(5.98106679598773+${C5pos})
variable C51 equal 0.5*(5.98106679598773+1.69467337274083)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-2.48567400242384+${C6pos})
variable C61 equal 0.5*(-2.48567400242384+-0.230989300599879)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.0575
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.0575
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.140575 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.140575 yz delta 0.033406 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8450.8125     -4557.9159      4697.2617    
       200   297.9901      -40473.728     -7442.9587     -3105.7664      4694.9119    
       300   318.03552     -40467.885     -4966.2486     -3949.1556      4692.562     
       400   317.21831     -40468.568     -2694.3446     -378.14455      4690.2122    
       500   291.55488     -40468.643     -9056.9682     -9842.914       4687.8624    
       600   290.19227     -40479.722     -10222.197     -6467.0012      4685.5126    
       700   286.44864     -40469.778     -3969.3681     -1184.2904      4683.1628    
       800   292.79165     -40479.022     -2949.6101     -1052.5592      4680.813     
       900   301.10038     -40493.423     -7082.2933     -232.24499      4678.4632    
      1000   297.57166     -40499.106     -12411.453     -5001.483       4676.1134    
      1100   291.20465     -40499.587     -4563.7636     -5242.9548      4673.7636    
      1200   313.41668     -40542.536     -2961.1502     -8008.8534      4671.4138    
      1300   304.78694     -40554.844      40.646784     -4844.3095      4669.064     
      1400   275.21378     -40538.562     -4508.5136     -3700.2232      4666.7142    
      1500   304.26893     -40563.725      708.56714     -523.53405      4664.3644    
      1600   303.25595     -40526.92      -5386.3553     -5382.9316      4662.0146    
      1700   312.60047     -40493.357      2900.6182     -6426.6978      4659.6648    
      1800   315.74319     -40502.927     -4622.7724      2376.8951      4657.315     
      1900   296.25962     -40530.955      4207.0631     -1002.304       4654.9652    
      2000   287.47955     -40562.346     -9224.7475     -2761.2491      4652.6153    
Loop time of 42.8897 on 8 procs for 2000 steps with 373 atoms

Performance: 2.014 ns/day, 11.914 hours/ns, 46.631 timesteps/s, 17.393 katom-step/s
98.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.34      | 31.468     | 32.851     |  16.0 | 73.37
Bond    | 0.0034886  | 0.0035733  | 0.0037476  |   0.1 |  0.01
Neigh   | 3.9964     | 4.0414     | 4.0958     |   1.6 |  9.42
Comm    | 0.40649    | 1.7901     | 2.9169     |  67.0 |  4.17
Output  | 0.0033241  | 0.0043893  | 0.0051587  |   1.0 |  0.01
Modify  | 5.4872     | 5.5418     | 5.5859     |   1.4 | 12.92
Other   |            | 0.03986    |            |       |  0.09

Nlocal:         46.625 ave          55 max          34 min
Histogram: 1 0 0 1 0 0 3 1 1 1
Nghost:        3082.25 ave        3127 max        3048 min
Histogram: 1 1 3 0 1 0 0 0 0 2
Neighs:        25940.5 ave       30132 max       19382 min
Histogram: 1 0 0 1 0 0 3 1 1 1

Total # of neighbors = 207524
Ave neighs/atom = 556.36461
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -33.0910465930529
variable C2neg equal ${d2}
variable C2neg equal -10.414028945011
variable C3neg equal ${d3}
variable C3neg equal -76.2331272632311
variable C4neg equal ${d4}
variable C4neg equal -3.84550533943904
variable C5neg equal ${d5}
variable C5neg equal 11.3760624500735
variable C6neg equal ${d6}
variable C6neg equal -8.48378903586879

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.0575
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.140575 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.140575 yz delta -0.033406 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8442.3659     -4557.8637      4701.9613    
       200   297.18831     -40471.645     -6232.1716     -2883.437       4704.3111    
       300   321.5303      -40470.655     -6160.1985     -4001.8924      4706.6609    
       400   321.75549     -40470.421     -119.74064     -2029.1137      4709.0107    
       500   301.90165     -40471.822     -5880.3512     -9280.7816      4711.3605    
       600   291.67237     -40472.718     -11781.932     -6735.5573      4713.7103    
       700   290.2162      -40467.705     -5140.6747      628.06678      4716.0601    
       800   294.13589     -40475.922     -244.57397     -5315.616       4718.4099    
       900   308.27981     -40488.178     -4932.5821     -790.19894      4720.7597    
      1000   297.55771     -40481.285     -7061.0588     -5671.1848      4723.1095    
      1100   301.05068     -40504.087      437.10883     -2719.5336      4725.4593    
      1200   283.55202     -40508.539     -1546.1553     -5528.337       4727.8091    
      1300   291.2748      -40528.484     -4597.2317     -5972.1246      4730.1589    
      1400   297.26341     -40539.489     -12320.462     -7900.6654      4732.5087    
      1500   286.21433     -40514.899      1135.2631     -5805.1555      4734.8585    
      1600   321.14509     -40528.277     -1343.1523     -9873.221       4737.2084    
      1700   310.95478     -40515.419     -2067.0639     -7192.6857      4739.5582    
      1800   290.39707     -40509.586     -7422.3814     -2637.6079      4741.908     
      1900   295.60742     -40530.33       371.52236     -2284.1753      4744.2578    
      2000   286.56698     -40526.665     -7548.3092     -4744.127       4746.6076    
Loop time of 42.2236 on 8 procs for 2000 steps with 373 atoms

Performance: 2.046 ns/day, 11.729 hours/ns, 47.367 timesteps/s, 17.668 katom-step/s
98.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.626     | 30.901     | 32.279     |  16.7 | 73.18
Bond    | 0.0033997  | 0.003518   | 0.0037318  |   0.2 |  0.01
Neigh   | 3.9663     | 4.0187     | 4.0601     |   1.6 |  9.52
Comm    | 0.40696    | 1.7857     | 3.0585     |  69.4 |  4.23
Output  | 0.0032994  | 0.0043815  | 0.0051224  |   1.0 |  0.01
Modify  | 5.4309     | 5.4708     | 5.5238     |   1.4 | 12.96
Other   |            | 0.03958    |            |       |  0.09

Nlocal:         46.625 ave          55 max          38 min
Histogram: 1 0 0 2 0 3 1 0 0 1
Nghost:        3034.88 ave        3062 max        3010 min
Histogram: 2 0 0 1 1 1 1 0 1 1
Neighs:        25409.5 ave       29609 max       20955 min
Histogram: 1 0 0 2 0 2 2 0 0 1

Total # of neighbors = 203276
Ave neighs/atom = 544.97587
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 53.1825567715259
variable C2pos equal ${d2}
variable C2pos equal 1.15615646684448
variable C3pos equal ${d3}
variable C3pos equal 92.0958627637149
variable C4pos equal ${d4}
variable C4pos equal 11.4210589218202
variable C5pos equal ${d5}
variable C5pos equal -0.0648289781800187
variable C6pos equal ${d6}
variable C6pos equal -3.53103140442791

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-33.0910465930529+${C1pos})
variable C12 equal 0.5*(-33.0910465930529+53.1825567715259)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-10.414028945011+${C2pos})
variable C22 equal 0.5*(-10.414028945011+1.15615646684448)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-76.2331272632311+${C3pos})
variable C32 equal 0.5*(-76.2331272632311+92.0958627637149)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-3.84550533943904+${C4pos})
variable C42 equal 0.5*(-3.84550533943904+11.4210589218202)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(11.3760624500735+${C5pos})
variable C52 equal 0.5*(11.3760624500735+-0.0648289781800187)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-8.48378903586879+${C6pos})
variable C62 equal 0.5*(-8.48378903586879+-3.53103140442791)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.55
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.55
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.1755 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8450.8125     -4557.9159      4697.2617    
       200   296.61999     -40471.861     -6844.7145     -3058.6957      4694.9119    
       300   320.6977      -40470.655     -4725.8467     -3934.6904      4692.562     
       400   320.48343     -40473.069     -1468.8122      914.34916      4690.2122    
       500   301.96615     -40479.265     -7178.1464     -9640.8786      4687.8624    
       600   274.92213     -40462.94      -464.2469      -6427.018       4685.5126    
       700   292.85342     -40478.056     -5455.4228      171.98056      4683.1628    
       800   306.62446     -40493.581      4718.6136     -1775.7409      4680.813     
       900   306.50089     -40494.964     -7486.0781     -2556.7691      4678.4632    
      1000   301.08603     -40490.146      2809.9809     -2112.8951      4676.1134    
      1100   309.1662      -40503.04      -11303.419     -2905.036       4673.7636    
      1200   292.35137     -40503.243     -2198.8179     -5289.6699      4671.4138    
      1300   297.39371     -40530.941     -520.2634      -1500.7745      4669.064     
      1400   265.10212     -40510.28      -12216.189     -6293.7659      4666.7142    
      1500   274.24022     -40523.16      -4385.4886     -374.30912      4664.3644    
      1600   284.04481     -40513.574     -1515.0387     -4632.2317      4662.0146    
      1700   293.08176     -40488.98       335.23191     -6604.2374      4659.6648    
      1800   317.93943     -40497.251     -6254.1576     -1213.3971      4657.315     
      1900   318.04179     -40517.583     -8412.7712     -2464.0473      4654.9652    
      2000   290.09944     -40530.136     -9946.6231     -3918.0804      4652.6153    
Loop time of 44.7414 on 8 procs for 2000 steps with 373 atoms

Performance: 1.931 ns/day, 12.428 hours/ns, 44.701 timesteps/s, 16.674 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 32.192     | 33.26      | 34.589     |  14.1 | 74.34
Bond    | 0.0035232  | 0.0036397  | 0.0037306  |   0.1 |  0.01
Neigh   | 3.9247     | 3.972      | 4.0307     |   1.6 |  8.88
Comm    | 0.44493    | 1.7777     | 2.8481     |  61.2 |  3.97
Output  | 0.0031572  | 0.0042077  | 0.0049725  |   1.0 |  0.01
Modify  | 5.6252     | 5.6833     | 5.7311     |   1.4 | 12.70
Other   |            | 0.0408     |            |       |  0.09

Nlocal:         46.625 ave          54 max          33 min
Histogram: 1 0 0 0 0 1 2 2 0 2
Nghost:        3271.75 ave        3294 max        3246 min
Histogram: 1 0 2 0 1 0 1 1 1 1
Neighs:        25955.8 ave       29698 max       18692 min
Histogram: 1 0 0 0 0 1 2 2 1 1

Total # of neighbors = 207646
Ave neighs/atom = 556.69169
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -44.8126395939765
variable C2neg equal ${d2}
variable C2neg equal -9.17831434882285
variable C3neg equal ${d3}
variable C3neg equal -42.6619218336688
variable C4neg equal ${d4}
variable C4neg equal -16.7461120387549
variable C5neg equal ${d5}
variable C5neg equal 8.93569073880773
variable C6neg equal ${d6}
variable C6neg equal 8.2208307498593

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.55
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.1755 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8442.3659     -4557.8637      4701.9613    
       200   299.32941     -40474.099     -6608.6454     -2940.3382      4704.3111    
       300   322.16521     -40471.828     -6164.8341     -4334.3182      4706.6609    
       400   315.6261      -40464.105     -4946.6602     -1460.1017      4709.0107    
       500   302.53257     -40475.756     -7906.941      -8871.7901      4711.3605    
       600   298.02983     -40490.134     -14534.364     -5732.8472      4713.7103    
       700   297.44112     -40500.711     -7410.1933     -1337.7378      4716.0601    
       800   298.61816     -40520.152     -6719.111      -2008.5724      4718.4099    
       900   291.06872     -40518.085     -3866.2257     -2588.0181      4720.7597    
      1000   301.30694     -40517.65      -2800.6533     -4260.6709      4723.1095    
      1100   322.62997     -40526.936     -10676.405     -3011.3018      4725.4593    
      1200   322.54386     -40538.982      208.65475     -6881.6212      4727.8091    
      1300   300.602       -40539.749      1012.6266     -2979.0798      4730.1589    
      1400   285.8278      -40544.166     -6103.7473     -6678.608       4732.5087    
      1500   286.60568     -40533.795      6382.0738     -3282.0261      4734.8585    
      1600   295.53629     -40511.67      -5350.5678      244.57396      4737.2084    
      1700   331.61493     -40534.583      443.5591      -616.86745      4739.5582    
      1800   327.98251     -40550.549     -2627.1809     -6611.3837      4741.908     
      1900   285.74726     -40548.005     -6492.0626     -5102.5473      4744.2578    
      2000   274.1584      -40553.929     -16445.569     -4554.9106      4746.6076    
Loop time of 44.3256 on 8 procs for 2000 steps with 373 atoms

Performance: 1.949 ns/day, 12.313 hours/ns, 45.121 timesteps/s, 16.830 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.406     | 32.703     | 34.216     |  16.7 | 73.78
Bond    | 0.0034856  | 0.0036219  | 0.0037601  |   0.2 |  0.01
Neigh   | 3.8642     | 3.9246     | 3.9732     |   1.8 |  8.85
Comm    | 0.44039    | 1.9621     | 3.2647     |  68.6 |  4.43
Output  | 0.003115   | 0.0042043  | 0.0050103  |   1.1 |  0.01
Modify  | 5.6469     | 5.6881     | 5.7432     |   1.4 | 12.83
Other   |            | 0.04042    |            |       |  0.09

Nlocal:         46.625 ave          58 max          33 min
Histogram: 1 0 0 0 3 1 0 1 1 1
Nghost:        3236.62 ave        3329 max        3162 min
Histogram: 1 0 3 0 1 0 2 0 0 1
Neighs:        25409.8 ave       30893 max       18347 min
Histogram: 1 0 0 0 3 1 0 1 1 1

Total # of neighbors = 203278
Ave neighs/atom = 544.98123
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 51.2653215032745
variable C2pos equal ${d2}
variable C2pos equal 24.0433660570002
variable C3pos equal ${d3}
variable C3pos equal 79.3069068705853
variable C4pos equal ${d4}
variable C4pos equal 15.1266892643239
variable C5pos equal ${d5}
variable C5pos equal 3.0865456069793
variable C6pos equal ${d6}
variable C6pos equal 1.03766709977394

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-44.8126395939765+${C1pos})
variable C13 equal 0.5*(-44.8126395939765+51.2653215032745)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-9.17831434882285+${C2pos})
variable C23 equal 0.5*(-9.17831434882285+24.0433660570002)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-42.6619218336688+${C3pos})
variable C33 equal 0.5*(-42.6619218336688+79.3069068705853)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-16.7461120387549+${C4pos})
variable C43 equal 0.5*(-16.7461120387549+15.1266892643239)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(8.93569073880773+${C5pos})
variable C53 equal 0.5*(8.93569073880773+3.0865456069793)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(8.2208307498593+${C6pos})
variable C63 equal 0.5*(8.2208307498593+1.03766709977394)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.55
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.55
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.1755 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8446.5871     -4557.8898      4699.6115    
       200   298.08772     -40473.009     -6504.4263     -2934.7416      4699.6115    
       300   320.12068     -40469.804     -5101.436      -4033.7978      4699.6115    
       400   319.69299     -40469.406     -3213.0609     -1329.894       4699.6115    
       500   306.60335     -40477.968      525.8764      -7984.9242      4699.6115    
       600   292.46293     -40477.397     -11516.319     -7537.4234      4699.6115    
       700   307.8154      -40488.618     -11650.327      953.63773      4699.6115    
       800   316.23202     -40509.414     -11334.944     -4011.0417      4699.6115    
       900   299.85514     -40518.812      2881.9945     -1781.3475      4699.6115    
      1000   279.71751     -40516.844      10462.182     -2917.4857      4699.6115    
      1100   290.01709     -40524.826     -3051.5913     -3981.6734      4699.6115    
      1200   290.00053     -40510.209     -10037.727     -7785.2339      4699.6115    
      1300   316.99112     -40535.296     -7509.8971     -4868.3517      4699.6115    
      1400   321.20379     -40560.366     -9332.4997     -3310.8541      4699.6115    
      1500   275.81095     -40534.918     -5652.973      -3540.8309      4699.6115    
      1600   268.11337     -40539.629      3321.7748     -567.78088      4699.6115    
      1700   304.39166     -40558.924     -3003.0708     -7994.3235      4699.6115    
      1800   313.11548     -40533.565     -1292.2763     -1028.5789      4699.6115    
      1900   311.44859     -40528.032     -8134.385      -2184.3356      4699.6115    
      2000   296.48466     -40536.316     -1862.8086     -2471.9431      4699.6115    
Loop time of 42.3276 on 8 procs for 2000 steps with 373 atoms

Performance: 2.041 ns/day, 11.758 hours/ns, 47.251 timesteps/s, 17.624 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.112     | 31.276     | 32.47      |  14.3 | 73.89
Bond    | 0.0033791  | 0.0035534  | 0.0037464  |   0.2 |  0.01
Neigh   | 3.9823     | 4.0232     | 4.0452     |   1.0 |  9.50
Comm    | 0.43843    | 1.6309     | 2.7933     |  62.6 |  3.85
Output  | 0.0031759  | 0.0043324  | 0.0051287  |   1.1 |  0.01
Modify  | 5.3261     | 5.3494     | 5.3899     |   0.8 | 12.64
Other   |            | 0.03978    |            |       |  0.09

Nlocal:         46.625 ave          58 max          39 min
Histogram: 1 0 2 2 1 1 0 0 0 1
Nghost:           3078 ave        3113 max        3049 min
Histogram: 2 0 0 1 1 2 0 1 0 1
Neighs:        25675.9 ave       31410 max       21783 min
Histogram: 1 0 2 2 1 1 0 0 0 1

Total # of neighbors = 205407
Ave neighs/atom = 550.68901
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -30.1596531444911
variable C2neg equal ${d2}
variable C2neg equal -5.30579387691443
variable C3neg equal ${d3}
variable C3neg equal -39.9001546198229
variable C4neg equal ${d4}
variable C4neg equal -7.88937012314278
variable C5neg equal ${d5}
variable C5neg equal 2.92325289770583
variable C6neg equal ${d6}
variable C6neg equal -2.91734549640435

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.55
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.1755 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8446.5871     -4557.8898      4699.6115    
       200   297.93143     -40472.913     -7130.2608     -2982.7538      4699.6115    
       300   311.91641     -40460.183     -6266.9479     -4546.8261      4699.6115    
       400   311.00827     -40460.968      3136.8297      427.06735      4699.6115    
       500   298.00413     -40473.878     -8413.1128     -10030.441      4699.6115    
       600   282.36651     -40472.037     -15571.286     -7548.4807      4699.6115    
       700   308.15163     -40501.169     -2952.5973     -594.20798      4699.6115    
       800   296.03731     -40493.772     -2355.1204     -3988.9252      4699.6115    
       900   293.69567     -40493.691      3709.5544     -228.97794      4699.6115    
      1000   298.7998      -40492.608      4891.3156     -3766.9557      4699.6115    
      1100   322.43623     -40510.496     -8642.8971     -3117.3297      4699.6115    
      1200   311.04763     -40512.627     -10005.942     -5882.2526      4699.6115    
      1300   303.32834     -40527.125     -12325.703     -7184.0503      4699.6115    
      1400   298.28495     -40540.806     -14418.851     -3784.0633      4699.6115    
      1500   292.54324     -40534.647     -5699.4265     -4851.982       4699.6115    
      1600   306.45812     -40535.228     -2690.0689     -3112.4709      4699.6115    
      1700   304.54226     -40517.224     -6933.3699     -5976.948       4699.6115    
      1800   302.50489     -40511.359     -20318.141     -1251.4513      4699.6115    
      1900   297.17491     -40524.023     -7522.9309     -924.78989      4699.6115    
      2000   290.45402     -40536.61      -10303.026     -3188.8572      4699.6115    
Loop time of 42.5325 on 8 procs for 2000 steps with 373 atoms

Performance: 2.031 ns/day, 11.815 hours/ns, 47.023 timesteps/s, 17.540 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.185     | 31.279     | 32.621     |  15.7 | 73.54
Bond    | 0.0033894  | 0.0035562  | 0.0037052  |   0.2 |  0.01
Neigh   | 3.9863     | 4.0203     | 4.0537     |   1.1 |  9.45
Comm    | 0.42029    | 1.7616     | 2.8541     |  66.1 |  4.14
Output  | 0.0031054  | 0.0042436  | 0.0050482  |   1.1 |  0.01
Modify  | 5.3909     | 5.4239     | 5.4572     |   1.0 | 12.75
Other   |            | 0.03987    |            |       |  0.09

Nlocal:         46.625 ave          52 max          35 min
Histogram: 1 0 0 0 1 1 0 0 4 1
Nghost:        3072.88 ave        3088 max        3051 min
Histogram: 1 0 1 1 0 0 0 3 0 2
Neighs:        25687.6 ave       28552 max       19622 min
Histogram: 1 0 0 0 1 1 0 0 4 1

Total # of neighbors = 205501
Ave neighs/atom = 550.94102
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 37.4237848926284
variable C2pos equal ${d2}
variable C2pos equal 43.9504215084987
variable C3pos equal ${d3}
variable C3pos equal 99.0755572272859
variable C4pos equal ${d4}
variable C4pos equal 20.0612854855141
variable C5pos equal ${d5}
variable C5pos equal 10.0505141229972
variable C6pos equal ${d6}
variable C6pos equal 0.134026553786255

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-30.1596531444911+${C1pos})
variable C14 equal 0.5*(-30.1596531444911+37.4237848926284)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-5.30579387691443+${C2pos})
variable C24 equal 0.5*(-5.30579387691443+43.9504215084987)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-39.9001546198229+${C3pos})
variable C34 equal 0.5*(-39.9001546198229+99.0755572272859)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-7.88937012314278+${C4pos})
variable C44 equal 0.5*(-7.88937012314278+20.0612854855141)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(2.92325289770583+${C5pos})
variable C54 equal 0.5*(2.92325289770583+10.0505141229972)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-2.91734549640435+${C6pos})
variable C64 equal 0.5*(-2.91734549640435+0.134026553786255)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.55
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.55
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.1755 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8446.5871     -4557.8898      4699.6115    
       200   297.24548     -40472.196     -6833.4414     -3032.3029      4699.6115    
       300   323.46286     -40473.689     -4111.8065     -3400.1823      4699.6115    
       400   322.64962     -40472.763     -3541.3832     -1560.553       4699.6115    
       500   290.65226     -40465.851      1531.4853     -7316.7112      4699.6115    
       600   273.76885     -40467.99      -10244.266     -8669.1348      4699.6115    
       700   299.48691     -40495.292     -2758.198      -4284.9598      4699.6115    
       800   294.81713     -40502.897     -722.57839     -3313.9635      4699.6115    
       900   311.01335     -40533.161     -3014.9126     -1376.8905      4699.6115    
      1000   293.6445      -40522.549     -1489.0949     -4253.4017      4699.6115    
      1100   283.35435     -40511.329     -12451.257     -7387.6242      4699.6115    
      1200   306.26972     -40524.411     -6426.8296     -4943.7685      4699.6115    
      1300   318.63251     -40530.867     -10316.916     -3013.8081      4699.6115    
      1400   311.76467     -40544.382     -9662.9763     -7737.7984      4699.6115    
      1500   276.04688     -40544.414      5057.5369     -6461.2589      4699.6115    
      1600   279.11921     -40551.76       6303.9024     -5430.9058      4699.6115    
      1700   279.54918     -40516.03      -3236.2053     -4814.5165      4699.6115    
      1800   323.30921     -40522.506      11024.207     -1415.8592      4699.6115    
      1900   316.63924     -40503.679     -4024.6486     -6050.7707      4699.6115    
      2000   319.66071     -40540.461     -10754.257     -1117.3965      4699.6115    
Loop time of 42.6881 on 8 procs for 2000 steps with 373 atoms

Performance: 2.024 ns/day, 11.858 hours/ns, 46.852 timesteps/s, 17.476 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.995     | 31.395     | 32.637     |  17.7 | 73.54
Bond    | 0.0033735  | 0.0035202  | 0.0036379  |   0.1 |  0.01
Neigh   | 3.9785     | 4.026      | 4.0831     |   1.6 |  9.43
Comm    | 0.51828    | 1.7604     | 3.1583     |  74.6 |  4.12
Output  | 0.0033166  | 0.0044092  | 0.0051678  |   1.0 |  0.01
Modify  | 5.4006     | 5.4594     | 5.5089     |   1.4 | 12.79
Other   |            | 0.03976    |            |       |  0.09

Nlocal:         46.625 ave          56 max          37 min
Histogram: 2 0 0 1 0 2 0 2 0 1
Nghost:           3074 ave        3108 max        3047 min
Histogram: 1 1 2 0 2 0 0 0 0 2
Neighs:        25646.4 ave       30464 max       20798 min
Histogram: 2 0 0 1 0 2 0 2 0 1

Total # of neighbors = 205171
Ave neighs/atom = 550.0563
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -16.4347095380566
variable C2neg equal ${d2}
variable C2neg equal -23.8247744655305
variable C3neg equal ${d3}
variable C3neg equal -86.7004121895269
variable C4neg equal ${d4}
variable C4neg equal -12.5094589010754
variable C5neg equal ${d5}
variable C5neg equal 3.24843993716531
variable C6neg equal ${d6}
variable C6neg equal -9.51067854041142

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.55
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.1755 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8446.5871     -4557.8898      4699.6115    
       200   297.8176      -40472.92      -7007.4666     -3008.8794      4699.6115    
       300   319.48898     -40468.79      -4489.7851     -4349.7726      4699.6115    
       400   318.09291     -40467.97      -5666.2908     -1180.4763      4699.6115    
       500   305.06024     -40481.196      2136.6599     -8440.6921      4699.6115    
       600   284.1948      -40478.288     -7605.6401     -8570.4699      4699.6115    
       700   311.20216     -40514.728     -6028.6702     -2299.3937      4699.6115    
       800   287.75975     -40501.653     -4781.1439     -2776.0091      4699.6115    
       900   304.54344     -40521.112      4576.6556     -915.46065      4699.6115    
      1000   302.58825     -40510.56       5765.2334     -2144.3569      4699.6115    
      1100   299.8388      -40496.201     -3268.2676     -7390.5029      4699.6115    
      1200   319.47353     -40504.878     -3398.8612     -6810.7896      4699.6115    
      1300   308.39909     -40503.577     -5726.4093     -3904.8429      4699.6115    
      1400   289.98455     -40522.234     -5788.8355     -3687.4741      4699.6115    
      1500   269.77108     -40535.932     -1307.9353     -7564.6808      4699.6115    
      1600   299.13294     -40565.189     -11418.263     -7341.617       4699.6115    
      1700   311.42278     -40554.286     -4151.0919     -8804.3488      4699.6115    
      1800   299.27025     -40527.294     -3481.9927     -5405.3682      4699.6115    
      1900   309.42687     -40539.592     -10092.007     -6303.2423      4699.6115    
      2000   303.51201     -40545.983     -6555.4788     -6438.3778      4699.6115    
Loop time of 42.668 on 8 procs for 2000 steps with 373 atoms

Performance: 2.025 ns/day, 11.852 hours/ns, 46.874 timesteps/s, 17.484 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.307     | 31.468     | 32.78      |  15.2 | 73.75
Bond    | 0.0034516  | 0.0035604  | 0.0037762  |   0.2 |  0.01
Neigh   | 3.9912     | 4.0319     | 4.0704     |   1.3 |  9.45
Comm    | 0.43351    | 1.7445     | 2.9043     |  64.3 |  4.09
Output  | 0.0032784  | 0.0043715  | 0.0051342  |   1.0 |  0.01
Modify  | 5.3378     | 5.3758     | 5.4162     |   1.1 | 12.60
Other   |            | 0.03985    |            |       |  0.09

Nlocal:         46.625 ave          59 max          38 min
Histogram: 1 1 0 3 1 1 0 0 0 1
Nghost:        3057.25 ave        3079 max        3031 min
Histogram: 1 1 0 1 1 0 1 0 1 2
Neighs:        25680.4 ave       31982 max       21327 min
Histogram: 1 1 0 3 1 1 0 0 0 1

Total # of neighbors = 205443
Ave neighs/atom = 550.78552
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 70.3495528121939
variable C2pos equal ${d2}
variable C2pos equal 19.3653026480581
variable C3pos equal ${d3}
variable C3pos equal 92.5281257880349
variable C4pos equal ${d4}
variable C4pos equal 25.1515837558987
variable C5pos equal ${d5}
variable C5pos equal -10.8465729392274
variable C6pos equal ${d6}
variable C6pos equal 4.72373125578757

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-16.4347095380566+${C1pos})
variable C15 equal 0.5*(-16.4347095380566+70.3495528121939)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-23.8247744655305+${C2pos})
variable C25 equal 0.5*(-23.8247744655305+19.3653026480581)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-86.7004121895269+${C3pos})
variable C35 equal 0.5*(-86.7004121895269+92.5281257880349)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-12.5094589010754+${C4pos})
variable C45 equal 0.5*(-12.5094589010754+25.1515837558987)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(3.24843993716531+${C5pos})
variable C55 equal 0.5*(3.24843993716531+-10.8465729392274)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-9.51067854041142+${C6pos})
variable C65 equal 0.5*(-9.51067854041142+4.72373125578757)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.0575

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.0575
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.140575 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8446.5871     -4557.8898      4699.6115    
       200   298.16034     -40473.281     -6622.9207     -2928.2691      4699.6115    
       300   322.83501     -40472.73      -4636.9781     -3282.7626      4699.6115    
       400   321.6925      -40471.584     -3031.0476     -1824.2653      4699.6115    
       500   307.24082     -40481.917     -6461.8298     -6647.4915      4699.6115    
       600   280.44446     -40472.491      3729.1393     -4621.9674      4699.6115    
       700   293.04791     -40482.69      -2668.0153     -484.64781      4699.6115    
       800   299.95812     -40492.559     -666.90588     -2760.044       4699.6115    
       900   312.78717     -40513.496     -524.29855     -4430.7015      4699.6115    
      1000   282.57845     -40493.21      -9088.8647     -2009.8714      4699.6115    
      1100   301.52962     -40515.097     -6063.0672     -3423.4801      4699.6115    
      1200   297.91669     -40507.794     -1180.6578     -6503.1755      4699.6115    
      1300   321.76798     -40539.567     -946.13249     -2027.5604      4699.6115    
      1400   310.16997     -40558.758     -12174.32      -3969.2589      4699.6115    
      1500   283.7363      -40561.196     -1762.7969     -2949.204       4699.6115    
      1600   288.64913     -40579.84      -5000.8613     -4324.0553      4699.6115    
      1700   309.3613      -40585.652     -6964.477      -5259.2424      4699.6115    
      1800   318.12017     -40568.429     -6982.4674     -7238.3096      4699.6115    
      1900   309.61892     -40544.906     -6187.5745     -1841.0581      4699.6115    
      2000   309.4443      -40539.955     -3413.8963     -6085.3909      4699.6115    
Loop time of 42.4894 on 8 procs for 2000 steps with 373 atoms

Performance: 2.033 ns/day, 11.803 hours/ns, 47.071 timesteps/s, 17.557 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 29.807     | 31.235     | 32.604     |  16.6 | 73.51
Bond    | 0.0034264  | 0.0035269  | 0.0036292  |   0.1 |  0.01
Neigh   | 3.9701     | 4.0118     | 4.0612     |   1.5 |  9.44
Comm    | 0.43445    | 1.8022     | 3.2292     |  69.3 |  4.24
Output  | 0.0033543  | 0.0044635  | 0.0052305  |   1.0 |  0.01
Modify  | 5.3427     | 5.3924     | 5.4355     |   1.3 | 12.69
Other   |            | 0.03981    |            |       |  0.09

Nlocal:         46.625 ave          59 max          38 min
Histogram: 2 0 0 2 1 2 0 0 0 1
Nghost:        3074.75 ave        3109 max        3045 min
Histogram: 1 0 2 2 0 0 1 0 1 1
Neighs:        25664.6 ave       31956 max       21279 min
Histogram: 2 0 0 2 1 2 0 0 0 1

Total # of neighbors = 205317
Ave neighs/atom = 550.44772
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -66.7729133754026
variable C2neg equal ${d2}
variable C2neg equal -48.0010322435435
variable C3neg equal ${d3}
variable C3neg equal -133.413165433662
variable C4neg equal ${d4}
variable C4neg equal -2.14241992538977
variable C5neg equal ${d5}
variable C5neg equal 11.8583325684995
variable C6neg equal ${d6}
variable C6neg equal -4.14760745678824

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.0575
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.140575 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.8 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.19945     -40475.217     -2480.3296      0              4699.6115    
       100   309.71101     -40503.54      -8446.5871     -4557.8898      4699.6115    
       200   296.93646     -40472.003     -7041.6805     -3040.9505      4699.6115    
       300   316.79102     -40465.924     -4285.1389     -4621.9318      4699.6115    
       400   315.19305     -40464.813     -2020.3148     -1108.4018      4699.6115    
       500   290.22714     -40464.553      1589.7407     -6193.2607      4699.6115    
       600   294.28057     -40493.154     -8443.8264     -7727.7324      4699.6115    
       700   322.6366      -40532.297      2074.8316     -3631.8335      4699.6115    
       800   296.41461     -40513.055     -2137.7289     -2984.7381      4699.6115    
       900   297.34671     -40509.34      -305.83783     -4453.8258      4699.6115    
      1000   322.09864     -40526.203      2688.0446     -5036.371       4699.6115    
      1100   297.09458     -40495.026      1852.7901     -4816.1521      4699.6115    
      1200   306.25214     -40515.135     -2566.3352     -7131.9655      4699.6115    
      1300   315.83588     -40558.041     -5674.5234     -6263.8786      4699.6115    
      1400   281.59656     -40552.837     -9832.3848     -5779.5237      4699.6115    
      1500   286.33808     -40557.522     -1630.0479     -1302.364       4699.6115    
      1600   295.54843     -40527.901     -204.06054     -562.7473       4699.6115    
      1700   325.10076     -40527.632      2612.4119     -6563.6033      4699.6115    
      1800   324.86857     -40539.677     -3952.754      -3675.2217      4699.6115    
      1900   289.81168     -40544.833     -3221.7156     -7907.9333      4699.6115    
      2000   290.52012     -40571.784     -8837.9362     -6324.566       4699.6115    
Loop time of 42.5459 on 8 procs for 2000 steps with 373 atoms

Performance: 2.031 ns/day, 11.818 hours/ns, 47.008 timesteps/s, 17.534 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.107     | 31.39      | 32.597     |  15.8 | 73.78
Bond    | 0.00351    | 0.0035843  | 0.0036697  |   0.1 |  0.01
Neigh   | 3.9855     | 4.0248     | 4.0564     |   1.2 |  9.46
Comm    | 0.46951    | 1.6765     | 2.957      |  68.4 |  3.94
Output  | 0.003257   | 0.0043713  | 0.0051347  |   1.0 |  0.01
Modify  | 5.3752     | 5.4072     | 5.4477     |   1.0 | 12.71
Other   |            | 0.03996    |            |       |  0.09

Nlocal:         46.625 ave          61 max          35 min
Histogram: 2 0 0 0 3 1 1 0 0 1
Nghost:           3063 ave        3095 max        3038 min
Histogram: 1 2 0 2 0 1 0 0 0 2
Neighs:        25689.8 ave       33024 max       19566 min
Histogram: 2 0 0 0 3 1 1 0 0 1

Total # of neighbors = 205518
Ave neighs/atom = 550.9866
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 69.1963545822116
variable C2pos equal ${d2}
variable C2pos equal 22.9080898748516
variable C3pos equal ${d3}
variable C3pos equal 64.7338509533939
variable C4pos equal ${d4}
variable C4pos equal 8.98333176895093
variable C5pos equal ${d5}
variable C5pos equal -0.0521615221630377
variable C6pos equal ${d6}
variable C6pos equal 10.2354911239024

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-66.7729133754026+${C1pos})
variable C16 equal 0.5*(-66.7729133754026+69.1963545822116)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-48.0010322435435+${C2pos})
variable C26 equal 0.5*(-48.0010322435435+22.9080898748516)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-133.413165433662+${C3pos})
variable C36 equal 0.5*(-133.413165433662+64.7338509533939)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-2.14241992538977+${C4pos})
variable C46 equal 0.5*(-2.14241992538977+8.98333176895093)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(11.8583325684995+${C5pos})
variable C56 equal 0.5*(11.8583325684995+-0.0521615221630377)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-4.14760745678824+${C6pos})
variable C66 equal 0.5*(-4.14760745678824+10.2354911239024)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 0.291072954897402
variable C22all equal ${C22}
variable C22all equal -4.62893623908326
variable C33all equal ${C33}
variable C33all equal 18.3224925184582

variable C44all equal ${C44}
variable C44all equal 6.08595768118566
variable C55all equal ${C55}
variable C55all equal -3.79906650103104
variable C66all equal ${C66}
variable C66all equal 3.04394183355708

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(10.0457550892365+${C21})
variable C12all equal 0.5*(10.0457550892365+-30.589521408101)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(3.226340954649+${C31})
variable C13all equal 0.5*(3.226340954649+-17.4243319907221)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(7.43252585408867+${C32})
variable C23all equal 0.5*(7.43252585408867+7.9313677502419)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(3.63206587406865+${C41})
variable C14all equal 0.5*(3.63206587406865+4.97570469345923)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(26.9574216370687+${C51})
variable C15all equal 0.5*(26.9574216370687+3.83787008436428)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(1.2117206034045+${C61})
variable C16all equal 0.5*(1.2117206034045+-1.35833165151186)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(19.3223138157921+${C42})
variable C24all equal 0.5*(19.3223138157921+3.78777679119058)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-2.2297359087362+${C52})
variable C25all equal 0.5*(-2.2297359087362+5.65561673594674)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-12.5464711843459+${C62})
variable C26all equal 0.5*(-12.5464711843459+-6.00741022014835)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(29.5877013037315+${C43})
variable C34all equal 0.5*(29.5877013037315+-0.809711387215501)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(2.913856799254+${C53})
variable C35all equal 0.5*(2.913856799254+6.01111817289352)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-34.339657240134+${C63})
variable C36all equal 0.5*(-34.339657240134+4.62924892481662)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(6.32106242741165+${C54})
variable C45all equal 0.5*(6.32106242741165+6.48688351035151)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(3.42045592178058+${C64})
variable C46all equal 0.5*(3.42045592178058+-1.39165947130905)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(5.90308552316823+${C65})
variable C56all equal 0.5*(5.90308552316823+-2.39347364231192)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:09:19
