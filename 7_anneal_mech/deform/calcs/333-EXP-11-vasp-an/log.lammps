LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-11-vasp-an
read_data       ${structure}.data
read_data       333-EXP-11-vasp-an.data
Reading data file ...
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
  reading velocities ...
  274 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              244.12834      3653.2211    
         1   300            0              0              244.12834      3653.2211    
Loop time of 4.9438e-05 on 8 procs for 1 steps with 274 atoms

53.1% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.03e-07   | 2.0925e-07 | 3e-07      |   0.0 |  0.42
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.62e-07   | 1.2259e-06 | 1.534e-06  |   0.0 |  2.48
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.8e-05    |            |       | 97.10

Nlocal:          34.25 ave          44 max          26 min
Histogram: 1 1 1 0 2 0 1 1 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.1 | 121.3 | 122.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -32270.304     -15755.402      0              1.6588329      3054.746     
       100   281.212       -32248.049      8309.728       2476.3999      1.6588329      3054.746     
       200   314.46578     -32250.577      20077.466      2549.4257      1.6588329      3054.746     
       300   310.22511     -32228.361      11730.488      5913.7963      1.6588329      3054.746     
       400   311.07756     -32212.531      7010.4609      2640.0578      1.6588329      3054.746     
       500   315.89101     -32229.212     -1059.2943      7918.5365      1.6588329      3054.746     
       600   307.80322     -32254.991      18546.815      2352.7599      1.6588329      3054.746     
       700   299.95313     -32266.622      5040.0127      5806.2874      1.6588329      3054.746     
       800   306.19933     -32279.665      3822.649       5193.8655      1.6588329      3054.746     
       900   292.98876     -32273.437      1960.8701      8458.378       1.6588329      3054.746     
      1000   297.5549      -32260.829     -15995.46      -461.11951      1.6588329      3054.746     
      1100   297.69463     -32236.483      7889.8147      9425.7544      1.6588329      3054.746     
      1200   313.80376     -32251.198     -9402.3691      4842.6939      1.6588329      3054.746     
      1300   293.79732     -32258.063      2325.8251      7045.5234      1.6588329      3054.746     
      1400   309.78217     -32274.331      2050.7294      3631.942       1.6588329      3054.746     
      1500   306.17889     -32275.334      18676.602      2910.9867      1.6588329      3054.746     
      1600   272.53784     -32263.969     -444.61111      8319.5293      1.6588329      3054.746     
      1700   259.25931     -32253.874      9035.5988      13281.626      1.6588329      3054.746     
      1800   313.95133     -32265.297      18585.414      7064.2657      1.6588329      3054.746     
      1900   302.31657     -32246.625      5931.4461      2766.9258      1.6588329      3054.746     
      2000   311.55735     -32268.658     -385.37691      6769.8855      1.6588329      3054.746     
Loop time of 84.6307 on 8 procs for 2000 steps with 274 atoms

Performance: 1.021 ns/day, 23.509 hours/ns, 23.632 timesteps/s, 6.475 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.193     | 63.52      | 70.946     | 107.4 | 75.06
Bond    | 0.00060683 | 0.00076314 | 0.00092845 |   0.0 |  0.00
Neigh   | 4.0442     | 5.2018     | 5.7039     |  29.0 |  6.15
Comm    | 1.1648     | 8.6194     | 23.928     | 291.2 | 10.18
Output  | 0.0011268  | 0.0012819  | 0.0021492  |   0.9 |  0.00
Modify  | 6.7286     | 7.2534     | 8.4326     |  25.1 |  8.57
Other   |            | 0.03422    |            |       |  0.04

Nlocal:          34.25 ave          47 max          27 min
Histogram: 2 1 1 0 2 0 0 1 0 1
Nghost:        3112.75 ave        3133 max        3101 min
Histogram: 2 0 1 2 0 2 0 0 0 1
Neighs:        21650.1 ave       29378 max       17254 min
Histogram: 3 0 1 1 1 0 0 1 0 1

Total # of neighbors = 173201
Ave neighs/atom = 632.12044
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-11-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.39621277898
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.5921534688336
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 15.7565520784056

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-6769.885529702)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-6769.885529702)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-4784.98538280859)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-4784.98538280859)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-7346.14891120644)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-7346.14891120644)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1989.03029865356)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1989.03029865356)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--992.374739992053)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--992.374739992053)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--233.845834935914)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--233.845834935914)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.39621277898
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.39621277898
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.1539621277898 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.1539621277898 xy delta 0.0820404152679998 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.1539621277898 xy delta 0.0820404152679998 xz delta 0.00317650080177537 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2953.8986      5531.6919      3053.2186    
       200   284.53058     -32266.237      3784.0171      3372.698       3051.6912    
       300   289.74323     -32260.483     -8839.0172     -211.49166      3050.1639    
       400   306.2815      -32260.574      4074.8538      7195.2049      3048.6365    
       500   329.04337     -32277.455      6216.5589      4495.9403      3047.1091    
       600   278.99807     -32256.598     -3350.3788      7140.7027      3045.5817    
       700   282.94438     -32275.653      4576.239       214.02895      3044.0544    
       800   293.6578      -32283.064      7537.247       5650.5245      3042.527     
       900   284.93791     -32253.147      15911.161      6674.9105      3040.9996    
      1000   314.99696     -32258.87       1418.1171      6307.3735      3039.4722    
      1100   296.77118     -32252.883     -1601.404       2578.5818      3037.9449    
      1200   307.88019     -32267.363      8623.9341      11390.752      3036.4175    
      1300   277.29654     -32248.492      12129.677      13543.612      3034.8901    
      1400   317.38194     -32286.61       413.13629      14095.414      3033.3628    
      1500   282.71082     -32266.268     -6139.3219      6523.1279      3031.8354    
      1600   296.97496     -32274.98       12738.489      6227.4982      3030.308     
      1700   284.57637     -32262.951     -8976.3397      6482.4203      3028.7806    
      1800   303.42926     -32275         -3401.5682      5358.8776      3027.2533    
      1900   293.46586     -32263.943     -14459.815      17475.876      3025.7259    
      2000   301.42457     -32264.793      6731.3565      1404.5749      3024.1985    
Loop time of 81.7535 on 8 procs for 2000 steps with 274 atoms

Performance: 1.057 ns/day, 22.709 hours/ns, 24.464 timesteps/s, 6.703 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.601     | 58.248     | 68.731     | 112.4 | 71.25
Bond    | 0.00057194 | 0.00070519 | 0.00083317 |   0.0 |  0.00
Neigh   | 3.8738     | 4.7502     | 5.5883     |  31.9 |  5.81
Comm    | 1.0239     | 11.496     | 23.147     | 252.9 | 14.06
Output  | 0.003589   | 0.0043908  | 0.0051185  |   0.8 |  0.01
Modify  | 6.3664     | 7.2184     | 8.0917     |  26.2 |  8.83
Other   |            | 0.03569    |            |       |  0.04

Nlocal:          34.25 ave          39 max          28 min
Histogram: 2 0 0 1 0 0 2 0 1 2
Nghost:        3034.75 ave        3075 max        2989 min
Histogram: 1 0 2 1 0 0 1 0 1 2
Neighs:        21873.9 ave       24749 max       17943 min
Histogram: 2 0 0 1 0 0 2 0 1 2

Total # of neighbors = 174991
Ave neighs/atom = 638.65328
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -54.3640100510828
variable C2neg equal ${d2}
variable C2neg equal -59.4256127965915
variable C3neg equal ${d3}
variable C3neg equal -116.64269097603
variable C4neg equal ${d4}
variable C4neg equal 4.49745234647104
variable C5neg equal ${d5}
variable C5neg equal -0.248832851356568
variable C6neg equal ${d6}
variable C6neg equal -17.2045391353221

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.39621277898
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.1539621277898 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.1539621277898 xy delta -0.0820404152679998 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.1539621277898 xy delta -0.0820404152679998 xz delta -0.00317650080177537 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2950.9461      5530.1292      3056.2734    
       200   284.07011     -32265.918      2987.7631      2831.5948      3057.8007    
       300   286.55719     -32258.474     -13618.317     -3279.6036      3059.3281    
       400   312.30945     -32266.58       2807.8229      4043.423       3060.8555    
       500   317.59725     -32271.521      5993.8365      3456.1108      3062.3828    
       600   289.11411     -32261.24      -379.50694      7323.0542      3063.9102    
       700   300.6639      -32280.57      -4969.8547     -131.65665      3065.4376    
       800   287.07354     -32273.506      2615.9885      3429.2975      3066.965     
       900   299.04691     -32285.737      15786.773      8109.5801      3068.4923    
      1000   312.6436      -32284.469     -1342.3264      1986.9529      3070.0197    
      1100   298.11043     -32250.348     -12507.668     -1057.7259      3071.5471    
      1200   297.17355     -32242.586      394.81755      6041.0898      3073.0745    
      1300   282.15869     -32249.443      7762.6772      11522.551      3074.6018    
      1400   288.10348     -32281.647      4450.049       8849.1509      3076.1292    
      1500   282.00188     -32280.87      -11084.2        2462.9915      3077.6566    
      1600   288.08461     -32269.727     -12468.113     -2029.8548      3079.1839    
      1700   305.08012     -32263.473     -11924.921      1864.5571      3080.7113    
      1800   332.73433     -32288.763      9304.5192      2211.3435      3082.2387    
      1900   294.97285     -32271.265     -9329.6311      2915.4814      3083.7661    
      2000   283.25914     -32269.322     -586.8719       3027.4958      3085.2934    
Loop time of 80.6876 on 8 procs for 2000 steps with 274 atoms

Performance: 1.071 ns/day, 22.413 hours/ns, 24.787 timesteps/s, 6.792 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.318     | 55.327     | 68.239     | 123.3 | 68.57
Bond    | 0.00055852 | 0.00069067 | 0.00078954 |   0.0 |  0.00
Neigh   | 3.8212     | 4.5428     | 5.5572     |  36.1 |  5.63
Comm    | 0.60719    | 13.513     | 22.529     | 249.3 | 16.75
Output  | 0.0035636  | 0.0043005  | 0.0050079  |   0.8 |  0.01
Modify  | 6.2404     | 7.2648     | 8          |  28.9 |  9.00
Other   |            | 0.03532    |            |       |  0.04

Nlocal:          34.25 ave          39 max          27 min
Histogram: 1 1 0 0 0 1 1 1 1 2
Nghost:        3026.75 ave        3076 max        2974 min
Histogram: 1 1 0 2 0 1 0 1 0 2
Neighs:        21430.9 ave       24198 max       16958 min
Histogram: 1 1 0 0 0 1 1 1 1 2

Total # of neighbors = 171447
Ave neighs/atom = 625.71898
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 37.9197639508895
variable C2pos equal ${d2}
variable C2pos equal 36.9619520812449
variable C3pos equal ${d3}
variable C3pos equal 60.7063444222838
variable C4pos equal ${d4}
variable C4pos equal -3.21987890143181
variable C5pos equal ${d5}
variable C5pos equal 8.03672414708849
variable C6pos equal ${d6}
variable C6pos equal 4.29126254819879

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-54.3640100510828+${C1pos})
variable C11 equal 0.5*(-54.3640100510828+37.9197639508895)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-59.4256127965915+${C2pos})
variable C21 equal 0.5*(-59.4256127965915+36.9619520812449)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-116.64269097603+${C3pos})
variable C31 equal 0.5*(-116.64269097603+60.7063444222838)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(4.49745234647104+${C4pos})
variable C41 equal 0.5*(4.49745234647104+-3.21987890143181)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-0.248832851356568+${C5pos})
variable C51 equal 0.5*(-0.248832851356568+8.03672414708849)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-17.2045391353221+${C6pos})
variable C61 equal 0.5*(-17.2045391353221+4.29126254819879)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.5921534688336
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.5921534688336
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.125921534688336 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.125921534688336 yz delta 9.17317476104144e-05 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2953.8986      5531.6919      3053.2186    
       200   283.64299     -32265.771      3373.1174      3163.7472      3051.6912    
       300   291.06219     -32261.709     -11640.549     -2531.9804      3050.1639    
       400   306.53799     -32261.802     -3350.6524      5551.0629      3048.6365    
       500   325.51211     -32274.873      7947.0498      4993.8297      3047.1091    
       600   291.72723     -32253.381     -3359.3207      7313.2973      3045.5817    
       700   280.84094     -32253.928      5479.8172      2097.643       3044.0544    
       800   295.8102      -32277.001      10134.85       4686.3404      3042.527     
       900   298.44158     -32293.222      20089.027      9731.9734      3040.9996    
      1000   279.23505     -32272.507      2130.8534      756.92683      3039.4722    
      1100   312.86215     -32267.973     -2695.3541      6231.9786      3037.9449    
      1200   316.49248     -32266.161      8208.2163      11037.65       3036.4175    
      1300   296.63156     -32261.119      11521.123      9620.8403      3034.8901    
      1400   289.50833     -32277.118      7792.2998      7907.9988      3033.3628    
      1500   280.49155     -32274.522      9321.7562      4041.8559      3031.8354    
      1600   302.95039     -32286.16       8210.2241      2445.2161      3030.308     
      1700   321.22569     -32295.356     -10282.928      3899.564       3028.7806    
      1800   317.7533      -32279.512      6943.4437      5082.734       3027.2533    
      1900   324.80006     -32258.485     -3055.7904      9784.8845      3025.7259    
      2000   325.83712     -32275.213      10176.262      3292.8566      3024.1985    
Loop time of 81.6823 on 8 procs for 2000 steps with 274 atoms

Performance: 1.058 ns/day, 22.690 hours/ns, 24.485 timesteps/s, 6.709 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.024     | 57.38      | 68.978     | 135.4 | 70.25
Bond    | 0.00056238 | 0.00068662 | 0.00078328 |   0.0 |  0.00
Neigh   | 3.8436     | 4.7002     | 5.6057     |  38.1 |  5.75
Comm    | 0.72961    | 12.316     | 22.65      | 292.1 | 15.08
Output  | 0.0034582  | 0.0042581  | 0.0050021  |   0.9 |  0.01
Modify  | 6.3254     | 7.2447     | 8.1136     |  30.9 |  8.87
Other   |            | 0.03559    |            |       |  0.04

Nlocal:          34.25 ave          38 max          30 min
Histogram: 1 0 2 0 0 1 1 1 1 1
Nghost:        3043.25 ave        3104 max        2983 min
Histogram: 1 1 1 1 0 1 1 0 0 2
Neighs:        21857.1 ave       24136 max       19129 min
Histogram: 1 0 2 0 0 1 1 1 1 1

Total # of neighbors = 174857
Ave neighs/atom = 638.16423
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -35.2309957056037
variable C2neg equal ${d2}
variable C2neg equal 32.4488920836743
variable C3neg equal ${d3}
variable C3neg equal -33.8430571051643
variable C4neg equal ${d4}
variable C4neg equal -11.6553639931495
variable C5neg equal ${d5}
variable C5neg equal 10.3383760960873
variable C6neg equal ${d6}
variable C6neg equal -4.86844447002723

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.5921534688336
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.125921534688336 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.125921534688336 yz delta -9.17317476104144e-05 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2950.9461      5530.1292      3056.2734    
       200   284.95461     -32266.455      3366.1498      2872.4439      3057.8007    
       300   287.62236     -32259.149     -10208.577     -800.85198      3059.3281    
       400   309.71585     -32264.235      1508.0167      4675.3466      3060.8555    
       500   318.72168     -32268.954      5732.2772      770.51809      3062.3828    
       600   288.91412     -32247.561     -5818.4091      3781.6595      3063.9102    
       700   297.88581     -32259.251      12295.631      1652.6646      3065.4376    
       800   302.12594     -32277.349      12610.979      6967.0199      3066.965     
       900   282.3684      -32276.685      5959.475       8233.251       3068.4923    
      1000   312.07527     -32299.288      7103.1271      3198.0701      3070.0197    
      1100   307.19721     -32270.84      -10192.415      2992.9514      3071.5471    
      1200   293.02931     -32237.758     -1552.7724      8186.3956      3073.0745    
      1300   307.40989     -32258.416      8804.5705      13371.091      3074.6018    
      1400   298.62324     -32269.471     -2253.7351      6910.5124      3076.1292    
      1500   306.14564     -32280.976      11588.246      5824.4498      3077.6566    
      1600   315.85864     -32281.484     -4684.2649      3023.373       3079.1839    
      1700   283.80338     -32255.495      2211.8942      9010.8874      3080.7113    
      1800   294.99714     -32259.798      8026.2929      3514.0721      3082.2387    
      1900   313.01216     -32268.775     -3523.0191      5542.5727      3083.7661    
      2000   310.14302     -32271.1       -1828.4877      1891.9265      3085.2934    
Loop time of 80.6234 on 8 procs for 2000 steps with 274 atoms

Performance: 1.072 ns/day, 22.395 hours/ns, 24.807 timesteps/s, 6.797 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.82      | 56.294     | 67.869     | 135.8 | 69.82
Bond    | 0.00055999 | 0.00068945 | 0.00080698 |   0.0 |  0.00
Neigh   | 3.8168     | 4.6468     | 5.5406     |  37.9 |  5.76
Comm    | 0.78653    | 12.35      | 22.834     | 289.7 | 15.32
Output  | 0.0035035  | 0.0043472  | 0.0050972  |   0.9 |  0.01
Modify  | 6.3747     | 7.2918     | 8.1472     |  30.5 |  9.04
Other   |            | 0.03596    |            |       |  0.04

Nlocal:          34.25 ave          39 max          28 min
Histogram: 1 0 2 0 1 0 0 0 2 2
Nghost:         2997.5 ave        3045 max        2957 min
Histogram: 3 0 1 0 0 0 0 2 1 1
Neighs:        21429.1 ave       24403 max       17557 min
Histogram: 1 0 2 0 1 0 0 0 3 1

Total # of neighbors = 171433
Ave neighs/atom = 625.66788
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 49.425919869442
variable C2pos equal ${d2}
variable C2pos equal 66.3747547198654
variable C3pos equal ${d3}
variable C3pos equal 109.438809576196
variable C4pos equal ${d4}
variable C4pos equal 4.70016700330081
variable C5pos equal ${d5}
variable C5pos equal -14.5699765668637
variable C6pos equal ${d6}
variable C6pos equal -11.3175930157333

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-35.2309957056037+${C1pos})
variable C12 equal 0.5*(-35.2309957056037+49.425919869442)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(32.4488920836743+${C2pos})
variable C22 equal 0.5*(32.4488920836743+66.3747547198654)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-33.8430571051643+${C3pos})
variable C32 equal 0.5*(-33.8430571051643+109.438809576196)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-11.6553639931495+${C4pos})
variable C42 equal 0.5*(-11.6553639931495+4.70016700330081)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(10.3383760960873+${C5pos})
variable C52 equal 0.5*(10.3383760960873+-14.5699765668637)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-4.86844447002723+${C6pos})
variable C62 equal 0.5*(-4.86844447002723+-11.3175930157333)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 15.7565520784056
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.7565520784056
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.157565520784056 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.3 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2953.8986      5531.6919      3053.2186    
       200   283.22883     -32265.661      4308.9859      3203.9776      3051.6912    
       300   287.88818     -32259.413     -10781.854     -1212.1953      3050.1639    
       400   305.16581     -32260.288      6828.0964      4549.1375      3048.6365    
       500   315.61293     -32266.651      11325.59       3477.799       3047.1091    
       600   275.57771     -32243.417      5231.6014      7311.9441      3045.5817    
       700   291.64374     -32269.467     -91.401762     -1351.0288      3044.0544    
       800   286.13754     -32270.865      4787.0667      6429.4595      3042.527     
       900   302.15561     -32274.798      11510.38       10283.657      3040.9996    
      1000   318.79865     -32264.98       14515.137      5302.8782      3039.4722    
      1100   305.38158     -32248.35       10271.122      4911.9019      3037.9449    
      1200   296.42742     -32261.606     -7428.9221      1499.9325      3036.4175    
      1300   307.11511     -32299.05       20363.186      14215.105      3034.8901    
      1400   286.65522     -32285.514     -4964.3896      6951.38        3033.3628    
      1500   285.84685     -32272.928      1370.1422      4110.9886      3031.8354    
      1600   311.04839     -32266.519      7049.505       7143.5007      3030.308     
      1700   310.93318     -32270.699      3186.039       5572.877       3028.7806    
      1800   288.73606     -32263.036     -11376.312      5601.5393      3027.2533    
      1900   307.90199     -32282.538      9775.9832      6030.5269      3025.7259    
      2000   292.03942     -32282.384     -12688.264      5211.9246      3024.1985    
Loop time of 83.0647 on 8 procs for 2000 steps with 274 atoms

Performance: 1.040 ns/day, 23.074 hours/ns, 24.078 timesteps/s, 6.597 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.491     | 58.562     | 70.315     | 119.5 | 70.50
Bond    | 0.00046186 | 0.00067449 | 0.00083185 |   0.0 |  0.00
Neigh   | 4.0267     | 4.8899     | 5.8142     |  36.8 |  5.89
Comm    | 0.56338    | 12.309     | 22.385     | 260.6 | 14.82
Output  | 0.0036039  | 0.0044414  | 0.0052238  |   0.9 |  0.01
Modify  | 6.3276     | 7.2635     | 8.1415     |  30.5 |  8.74
Other   |            | 0.03589    |            |       |  0.04

Nlocal:          34.25 ave          44 max          28 min
Histogram: 1 2 1 1 1 0 0 0 1 1
Nghost:         3128.5 ave        3171 max        3084 min
Histogram: 1 0 0 1 4 0 0 0 1 1
Neighs:        21867.5 ave       27928 max       17943 min
Histogram: 1 2 1 1 1 0 0 0 1 1

Total # of neighbors = 174940
Ave neighs/atom = 638.46715
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -15.7860391004373
variable C2neg equal ${d2}
variable C2neg equal -53.4169364967705
variable C3neg equal ${d3}
variable C3neg equal -67.8540009136504
variable C4neg equal ${d4}
variable C4neg equal 3.70356160745354
variable C5neg equal ${d5}
variable C5neg equal -5.05631607961221
variable C6neg equal ${d6}
variable C6neg equal -5.38940921394875

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.7565520784056
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.157565520784056 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.3 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2950.9461      5530.1292      3056.2734    
       200   285.19244     -32266.6        2643.0756      2990.9348      3057.8007    
       300   285.22854     -32256.776     -12980.569     -2899.9805      3059.3281    
       400   312.24409     -32266.474      1044.2813      4092.7619      3060.8555    
       500   320.12831     -32273.377      6267.1652      3697.6623      3062.3828    
       600   283.52849     -32263.515     -1587.1099      6621.9044      3063.9102    
       700   281.92197     -32274.163     -236.7928      -928.10144      3065.4376    
       800   274.41939     -32260.816      12910.818      3283.7871      3066.965     
       900   310.18359     -32268.425      8148.7334      1746.4673      3068.4923    
      1000   330.00529     -32269.002     -2223.4196      359.1924       3070.0197    
      1100   307.3246      -32265.729     -16705.686     -121.87897      3071.5471    
      1200   279.73519     -32275.852     -3410.9768      6085.9602      3073.0745    
      1300   290.78307     -32279.091      7317.5855      14269.293      3074.6018    
      1400   302.98953     -32266.42       8854.4633      9998.4793      3076.1292    
      1500   290.66555     -32241.675     -3977.0466      2549.1337      3077.6566    
      1600   316.05494     -32255.726      2782.2649     -172.37155      3079.1839    
      1700   299.05092     -32263.289      19663.147      8379.8178      3080.7113    
      1800   288.33277     -32274.914      6745.7197     -1248.9945      3082.2387    
      1900   277.90595     -32262.654     -7997.1833      3060.8407      3083.7661    
      2000   306.17218     -32269.907      434.96395      8399.852       3085.2934    
Loop time of 81.7722 on 8 procs for 2000 steps with 274 atoms

Performance: 1.057 ns/day, 22.714 hours/ns, 24.458 timesteps/s, 6.702 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.516     | 57.775     | 69.164     | 119.7 | 70.65
Bond    | 0.00048116 | 0.00069307 | 0.00082917 |   0.0 |  0.00
Neigh   | 4.0139     | 4.8514     | 5.74       |  37.0 |  5.93
Comm    | 0.58077    | 11.958     | 22.225     | 262.9 | 14.62
Output  | 0.003445   | 0.0042694  | 0.0050728  |   0.9 |  0.01
Modify  | 6.2427     | 7.1469     | 8.0008     |  30.8 |  8.74
Other   |            | 0.03613    |            |       |  0.04

Nlocal:          34.25 ave          45 max          27 min
Histogram: 1 1 2 0 1 1 1 0 0 1
Nghost:        3091.12 ave        3124 max        3067 min
Histogram: 1 2 1 1 0 0 1 0 1 1
Neighs:        21438.8 ave       27923 max       17110 min
Histogram: 1 1 2 0 1 1 1 0 0 1

Total # of neighbors = 171510
Ave neighs/atom = 625.94891
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -16.5156356995788
variable C2pos equal ${d2}
variable C2pos equal 18.3334730357097
variable C3pos equal ${d3}
variable C3pos equal 92.154689606479
variable C4pos equal ${d4}
variable C4pos equal -16.5643612319358
variable C5pos equal ${d5}
variable C5pos equal -17.4719809562237
variable C6pos equal ${d6}
variable C6pos equal 1.51678243833875

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-15.7860391004373+${C1pos})
variable C13 equal 0.5*(-15.7860391004373+-16.5156356995788)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-53.4169364967705+${C2pos})
variable C23 equal 0.5*(-53.4169364967705+18.3334730357097)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-67.8540009136504+${C3pos})
variable C33 equal 0.5*(-67.8540009136504+92.154689606479)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(3.70356160745354+${C4pos})
variable C43 equal 0.5*(3.70356160745354+-16.5643612319358)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-5.05631607961221+${C5pos})
variable C53 equal 0.5*(-5.05631607961221+-17.4719809562237)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-5.38940921394875+${C6pos})
variable C63 equal 0.5*(-5.38940921394875+1.51678243833875)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 15.7565520784056
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.7565520784056
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.157565520784056 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2952.4216      5530.9102      3054.746     
       200   283.64095     -32265.663      3208.672       3072.29        3054.746     
       300   287.61273     -32258.974     -11707.308     -2608.8684      3054.746     
       400   308.98343     -32263.583     -710.87495      3735.8395      3054.746     
       500   323.2358      -32274.819      12795.686      4552.9173      3054.746     
       600   292.53945     -32261.394      4538.4574      8087.3411      3054.746     
       700   295.67387     -32272.677      1808.3478      662.03991      3054.746     
       800   281.83149     -32266.371      11696.583      6294.29        3054.746     
       900   311.72082     -32288.147      15509.555      7296.9799      3054.746     
      1000   322.23414     -32281.401     -4846.9544     -614.22615      3054.746     
      1100   305.097       -32252.181      2731.2403      3838.8912      3054.746     
      1200   311.12602     -32251.804     -5279.5582      5771.8696      3054.746     
      1300   333.61656     -32294.781      3968.6988      11263.978      3054.746     
      1400   292.0179      -32284.048      806.43622      9475.5854      3054.746     
      1500   275.0637      -32269.03      -4679.4499      4952.9153      3054.746     
      1600   312.63857     -32279.027      18783.968      6740.0005      3054.746     
      1700   328.75443     -32286.139      6475.8533      7290.0171      3054.746     
      1800   304.67871     -32282.365      3368.527       2305.1102      3054.746     
      1900   270.9861      -32292.615     -2968.3655      1405.9942      3054.746     
      2000   262.44093     -32288.148     -7783.9653      3808.8119      3054.746     
Loop time of 81.6539 on 8 procs for 2000 steps with 274 atoms

Performance: 1.058 ns/day, 22.682 hours/ns, 24.494 timesteps/s, 6.711 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.806     | 59.061     | 68.766     | 130.8 | 72.33
Bond    | 0.00053624 | 0.00073051 | 0.00099805 |   0.0 |  0.00
Neigh   | 3.8694     | 4.8704     | 5.6089     |  35.4 |  5.96
Comm    | 0.9122     | 10.607     | 23.833     | 308.6 | 12.99
Output  | 0.0035534  | 0.0043174  | 0.0050627  |   0.8 |  0.01
Modify  | 6.3226     | 7.0748     | 8.1049     |  29.7 |  8.66
Other   |            | 0.03574    |            |       |  0.04

Nlocal:          34.25 ave          38 max          29 min
Histogram: 2 0 0 0 1 1 0 0 3 1
Nghost:           3012 ave        3076 max        2956 min
Histogram: 1 2 0 1 0 1 0 2 0 1
Neighs:        21639.6 ave       23841 max       18347 min
Histogram: 2 0 0 0 1 1 0 0 0 4

Total # of neighbors = 173117
Ave neighs/atom = 631.81387
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -30.003078477731
variable C2neg equal ${d2}
variable C2neg equal -56.6575398851856
variable C3neg equal ${d3}
variable C3neg equal -100.624132021691
variable C4neg equal ${d4}
variable C4neg equal 18.0033275670008
variable C5neg equal ${d5}
variable C5neg equal -1.43594247148013
variable C6neg equal ${d6}
variable C6neg equal -3.54836131942279

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.7565520784056
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.157565520784056 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2952.4216      5530.9102      3054.746     
       200   284.85122     -32266.431      3307.9491      3054.3002      3054.746     
       300   289.06207     -32260.325     -10579.976     -1338.3265      3054.746     
       400   308.44856     -32263.611      772.21164      6403.7364      3054.746     
       500   324.08761     -32273.784      8715.5498      4243.1915      3054.746     
       600   300.63299     -32255.178      1594.2597      5269.5868      3054.746     
       700   326.40446     -32277.167     -962.78822      973.87526      3054.746     
       800   289.62356     -32265.146      3507.0268      3933.4418      3054.746     
       900   266.73442     -32263.532      14136.863      6805.2894      3054.746     
      1000   296.05358     -32283.202     -7510.63        440.52723      3054.746     
      1100   311.53627     -32267.373     -13134.454      3856.2349      3054.746     
      1200   286.09964     -32233.742      6390.093       6814.5263      3054.746     
      1300   311.26099     -32263.069      18423.322      14976.29       3054.746     
      1400   298.6981      -32265.622      4909.4493      8008.4323      3054.746     
      1500   285.68285     -32268.863      2136.3393      4178.037       3054.746     
      1600   288.34011     -32277.213      5825.6125      7110.8499      3054.746     
      1700   279.14324     -32277.384     -257.25951      1338.0427      3054.746     
      1800   296.40044     -32310.268      27.535422      2824.004       3054.746     
      1900   269.98812     -32288.431      575.59257     -641.54533      3054.746     
      2000   290.87831     -32278.828      2199.3431      1879.4195      3054.746     
Loop time of 81.7806 on 8 procs for 2000 steps with 274 atoms

Performance: 1.056 ns/day, 22.717 hours/ns, 24.456 timesteps/s, 6.701 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.738     | 59.451     | 68.68      | 134.5 | 72.70
Bond    | 0.00056181 | 0.00071474 | 0.00094166 |   0.0 |  0.00
Neigh   | 3.8634     | 4.8653     | 5.5735     |  35.1 |  5.95
Comm    | 1.0745     | 10.294     | 23.979     | 323.0 | 12.59
Output  | 0.0034683  | 0.0042661  | 0.0049658  |   0.8 |  0.01
Modify  | 6.4074     | 7.1293     | 8.1495     |  29.3 |  8.72
Other   |            | 0.03608    |            |       |  0.04

Nlocal:          34.25 ave          39 max          31 min
Histogram: 1 1 2 1 0 1 0 1 0 1
Nghost:        3021.12 ave        3055 max        2981 min
Histogram: 2 0 1 0 1 0 0 2 0 2
Neighs:        21649.8 ave       24575 max       19557 min
Histogram: 1 1 2 0 1 1 0 1 0 1

Total # of neighbors = 173198
Ave neighs/atom = 632.10949
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 49.5526474260435
variable C2pos equal ${d2}
variable C2pos equal 28.0326915857549
variable C3pos equal ${d3}
variable C3pos equal 105.209780590463
variable C4pos equal ${d4}
variable C4pos equal 4.62135519030879
variable C5pos equal ${d5}
variable C5pos equal 1.0841421091365
variable C6pos equal ${d6}
variable C6pos equal 4.06926709903025

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-30.003078477731+${C1pos})
variable C14 equal 0.5*(-30.003078477731+49.5526474260435)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-56.6575398851856+${C2pos})
variable C24 equal 0.5*(-56.6575398851856+28.0326915857549)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-100.624132021691+${C3pos})
variable C34 equal 0.5*(-100.624132021691+105.209780590463)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(18.0033275670008+${C4pos})
variable C44 equal 0.5*(18.0033275670008+4.62135519030879)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-1.43594247148013+${C5pos})
variable C54 equal 0.5*(-1.43594247148013+1.0841421091365)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-3.54836131942279+${C6pos})
variable C64 equal 0.5*(-3.54836131942279+4.06926709903025)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 15.7565520784056
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.7565520784056
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.157565520784056 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2952.4216      5530.9102      3054.746     
       200   284.24134     -32266.182      2054.4877      3045.0576      3054.746     
       300   288.61857     -32259.687     -11489.394     -2922.5776      3054.746     
       400   311.88366     -32265.585      6426.2494      5304.7732      3054.746     
       500   325.49187     -32276.624      8205.6527      4112.4723      3054.746     
       600   282.19801     -32258.685      7207.5468      6306.8892      3054.746     
       700   299.96775     -32285.734     -6529.1363      1125.1045      3054.746     
       800   294.8402      -32282.414      2458.7188      5803.2787      3054.746     
       900   277.91581     -32252.071      19411.173      7164.5487      3054.746     
      1000   312.98957     -32255.58      -6942.1073      6232.3312      3054.746     
      1100   312.96289     -32258.843      10079.737      2423.3436      3054.746     
      1200   276.29835     -32242.773      12056.469      6071.853       3054.746     
      1300   288.93418     -32258.38       4988.3805      8262.5919      3054.746     
      1400   312.01939     -32280.181      9449.6578      11143.57       3054.746     
      1500   288.67569     -32272.03       8972.2081     -1109.8189      3054.746     
      1600   279.98641     -32269.795      2350.8282      1972.335       3054.746     
      1700   289.68558     -32275.286      6433.294       5061.7612      3054.746     
      1800   302.23799     -32269.119      13811.868      6722.6662      3054.746     
      1900   312.08994     -32259.478     -3904.6686      7651.9992      3054.746     
      2000   316.41361     -32269.85       648.97557      2093.795       3054.746     
Loop time of 82.431 on 8 procs for 2000 steps with 274 atoms

Performance: 1.048 ns/day, 22.897 hours/ns, 24.263 timesteps/s, 6.648 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.361     | 62.613     | 69.409     | 101.0 | 75.96
Bond    | 0.00059734 | 0.00072639 | 0.00095056 |   0.0 |  0.00
Neigh   | 3.8712     | 5.0996     | 5.5891     |  26.0 |  6.19
Comm    | 0.91987    | 7.7236     | 23.956     | 287.5 |  9.37
Output  | 0.0035761  | 0.0042813  | 0.0049444  |   0.8 |  0.01
Modify  | 6.4531     | 6.9523     | 8.2023     |  22.5 |  8.43
Other   |            | 0.03786    |            |       |  0.05

Nlocal:          34.25 ave          38 max          27 min
Histogram: 1 0 0 1 1 0 0 0 2 3
Nghost:           3024 ave        3070 max        2984 min
Histogram: 1 2 1 0 0 1 0 2 0 1
Neighs:          21670 ave       23896 max       17161 min
Histogram: 1 0 0 1 1 0 0 0 2 3

Total # of neighbors = 173360
Ave neighs/atom = 632.70073
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -47.3804869213861
variable C2neg equal ${d2}
variable C2neg equal -2.28653960290577
variable C3neg equal ${d3}
variable C3neg equal -77.4709743358943
variable C4neg equal ${d4}
variable C4neg equal 12.5862223920189
variable C5neg equal ${d5}
variable C5neg equal 28.868737716248
variable C6neg equal ${d6}
variable C6neg equal -4.16049249430509

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.7565520784056
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.157565520784056 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2952.4216      5530.9102      3054.746     
       200   284.17459     -32266.109      3510.0421      2975.9088      3054.746     
       300   287.53481     -32259.134     -11020.119     -2477.8253      3054.746     
       400   310.72586     -32265.609     -318.28012      3637.2979      3054.746     
       500   321.39014     -32273.94       14645.562      5187.6762      3054.746     
       600   295.96427     -32262.743      2461.7409      6362.6632      3054.746     
       700   291.27814     -32264.86      -0.093734665    1088.5968      3054.746     
       800   293.00163     -32264.817      7794.8411      7980.8003      3054.746     
       900   302.79111     -32266.226      15682.171      12237.656      3054.746     
      1000   293.04489     -32243.24       405.07286      4504.7529      3054.746     
      1100   325.81746     -32264.39       2506.8657      3030.5412      3054.746     
      1200   289.6006      -32263.217      13664.51       10201.425      3054.746     
      1300   279.19719     -32274.326      21488.903      13232.036      3054.746     
      1400   296.58955     -32288.897     -5720.445       12264.874      3054.746     
      1500   304.94255     -32278.99       2807.416       2101.4872      3054.746     
      1600   287.91097     -32241.726     -21.802807      5562.7994      3054.746     
      1700   296.81417     -32253.959      4011.5868      8893.9306      3054.746     
      1800   299.66374     -32256.759      3638.6089      3010.5554      3054.746     
      1900   309.30106     -32266.203     -8188.5536      3741.9632      3054.746     
      2000   270.04522     -32254.907      1865.7938      2366.0643      3054.746     
Loop time of 82.7944 on 8 procs for 2000 steps with 274 atoms

Performance: 1.044 ns/day, 22.998 hours/ns, 24.156 timesteps/s, 6.619 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.306     | 65.349     | 69.548     |  89.6 | 78.93
Bond    | 0.00055621 | 0.00070525 | 0.00084037 |   0.0 |  0.00
Neigh   | 3.8425     | 5.2976     | 5.6993     |  24.4 |  6.40
Comm    | 0.96593    | 5.1813     | 24.212     | 318.0 |  6.26
Output  | 0.0035018  | 0.0041852  | 0.0048105  |   0.7 |  0.01
Modify  | 6.4949     | 6.9201     | 8.3913     |  21.6 |  8.36
Other   |            | 0.04156    |            |       |  0.05

Nlocal:          34.25 ave          37 max          29 min
Histogram: 1 0 1 1 0 0 1 0 0 4
Nghost:        3030.38 ave        3089 max        2975 min
Histogram: 1 1 1 1 0 1 0 1 0 2
Neighs:          21667 ave       23407 max       18387 min
Histogram: 1 0 1 1 0 0 1 0 0 4

Total # of neighbors = 173336
Ave neighs/atom = 632.61314
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 44.6217184911552
variable C2pos equal ${d2}
variable C2pos equal 72.8656325823788
variable C3pos equal ${d3}
variable C3pos equal 71.2492034450661
variable C4pos equal ${d4}
variable C4pos equal 1.89998750239959
variable C5pos equal ${d5}
variable C5pos equal 4.80088336756207
variable C6pos equal ${d6}
variable C6pos equal 6.25423007655893

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-47.3804869213861+${C1pos})
variable C15 equal 0.5*(-47.3804869213861+44.6217184911552)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-2.28653960290577+${C2pos})
variable C25 equal 0.5*(-2.28653960290577+72.8656325823788)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-77.4709743358943+${C3pos})
variable C35 equal 0.5*(-77.4709743358943+71.2492034450661)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(12.5862223920189+${C4pos})
variable C45 equal 0.5*(12.5862223920189+1.89998750239959)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(28.868737716248+${C5pos})
variable C55 equal 0.5*(28.868737716248+4.80088336756207)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-4.16049249430509+${C6pos})
variable C65 equal 0.5*(-4.16049249430509+6.25423007655893)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.5921534688336

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.5921534688336
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.125921534688336 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2952.4216      5530.9102      3054.746     
       200   284.11198     -32265.89       2872.9017      2949.9235      3054.746     
       300   287.56163     -32259.182     -13190.221     -2641.8337      3054.746     
       400   310.47117     -32265.541      263.59222      4110.2659      3054.746     
       500   324.54725     -32275.944      7720.4772      5385.9751      3054.746     
       600   296.27928     -32260.355     -755.36062      6405.8078      3054.746     
       700   293.56304     -32265.585      10328.266     -550.28402      3054.746     
       800   289.34844     -32271.758      12115.846      9181.5606      3054.746     
       900   295.05583     -32286.702      22840.35       7358.5958      3054.746     
      1000   304.47649     -32288.894     -1270.2768      4225.821       3054.746     
      1100   291.82268     -32250.293     -8147.7962      706.11799      3054.746     
      1200   300.39075     -32247.561      4676.5293      10018.947      3054.746     
      1300   303.91908     -32260.701      19337.965      10419.718      3054.746     
      1400   306.33118     -32279.032      12206.06       10849.164      3054.746     
      1500   289.53386     -32267.223     -10726.99       7141.5927      3054.746     
      1600   284.74167     -32253.114     -1439.1229     -586.61939      3054.746     
      1700   332.35416     -32277.631      5518.1045      6225.05        3054.746     
      1800   322.26955     -32271.3       -6687.5529      5087.4079      3054.746     
      1900   292.06712     -32276.836      3261.4506      9302.4903      3054.746     
      2000   293.15714     -32289.928      4631.4836      3919.5722      3054.746     
Loop time of 82.8715 on 8 procs for 2000 steps with 274 atoms

Performance: 1.043 ns/day, 23.020 hours/ns, 24.134 timesteps/s, 6.613 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.506     | 65.409     | 69.683     |  88.9 | 78.93
Bond    | 0.00055092 | 0.00070597 | 0.00085403 |   0.0 |  0.00
Neigh   | 3.8545     | 5.3097     | 5.6958     |  24.4 |  6.41
Comm    | 0.91435    | 5.2053     | 24.093     | 314.9 |  6.28
Output  | 0.0037403  | 0.0046164  | 0.005435   |   0.9 |  0.01
Modify  | 6.4923     | 6.9003     | 8.3752     |  21.7 |  8.33
Other   |            | 0.04134    |            |       |  0.05

Nlocal:          34.25 ave          38 max          28 min
Histogram: 1 0 0 2 0 0 0 1 1 3
Nghost:        3019.75 ave        3073 max        2969 min
Histogram: 1 1 2 0 0 0 1 0 2 1
Neighs:        21664.9 ave       23914 max       17773 min
Histogram: 1 0 0 2 0 0 0 1 1 3

Total # of neighbors = 173319
Ave neighs/atom = 632.55109
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -28.8808000923861
variable C2neg equal ${d2}
variable C2neg equal -5.2041449394276
variable C3neg equal ${d3}
variable C3neg equal -93.0087750280801
variable C4neg equal ${d4}
variable C4neg equal 7.77067998419706
variable C5neg equal ${d5}
variable C5neg equal 11.8862297272717
variable C6neg equal ${d6}
variable C6neg equal 10.2218200831029

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.71134361 0.12492327 0.15947396) to (16.107556 12.717077 15.916026) with tilt (-8.2040415 -0.31765008 -0.0091731748)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.5921534688336
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.125921534688336 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 120.8 | 121.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.55735     -32268.658     -385.37203      0              3054.746     
       100   293.76153     -32277.721      2952.4216      5530.9102      3054.746     
       200   284.55492     -32266.295      2982.7925      3142.5561      3054.746     
       300   287.8009      -32258.79      -9256.0781     -1339.4215      3054.746     
       400   311.18795     -32265.409      3096.0308      3843.0812      3054.746     
       500   325.06225     -32276.364      13570.166      4160.5167      3054.746     
       600   290.48293     -32261.772      2290.578       6919.5843      3054.746     
       700   305.34836     -32283.923     -2030.2552     -104.37156      3054.746     
       800   278.01999     -32265.263      10709.082      6671.0014      3054.746     
       900   300.51803     -32272.619      14901.337      10963.139      3054.746     
      1000   317.71306     -32263.899     -121.31241      1618.1539      3054.746     
      1100   322.40365     -32263.358      7532.5052      2592.1855      3054.746     
      1200   283.83994     -32257.664     -5398.9654      5241.3472      3054.746     
      1300   277.76953     -32279.516      6969.7597      6786.3766      3054.746     
      1400   303.40211     -32299.479      16823.027      8614.0078      3054.746     
      1500   304.2445      -32281.754      2392.9263      1318.7921      3054.746     
      1600   322.97501     -32281.649      3896.2787      893.06166      3054.746     
      1700   302.01344     -32268.69      -12073.725      9158.7918      3054.746     
      1800   297.48839     -32270.715      611.68579      430.67321      3054.746     
      1900   319.90289     -32288.636      9347.2995      3788.2511      3054.746     
      2000   288.86258     -32263.828     -4174.0242      5777.309       3054.746     
Loop time of 71.8858 on 8 procs for 2000 steps with 274 atoms

Performance: 1.202 ns/day, 19.968 hours/ns, 27.822 timesteps/s, 7.623 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.345     | 54.368     | 60.147     |  76.9 | 75.63
Bond    | 0.00051279 | 0.00067107 | 0.0007977  |   0.0 |  0.00
Neigh   | 3.8537     | 4.6591     | 5.0901     |  19.7 |  6.48
Comm    | 0.67539    | 6.469      | 16.491     | 222.9 |  9.00
Output  | 0.0032639  | 0.0041376  | 0.0048997  |   1.0 |  0.01
Modify  | 5.8981     | 6.3466     | 7.1558     |  17.0 |  8.83
Other   |            | 0.03861    |            |       |  0.05

Nlocal:          34.25 ave          38 max          29 min
Histogram: 1 1 0 0 0 1 3 0 0 2
Nghost:        3044.38 ave        3098 max        2993 min
Histogram: 1 2 0 1 0 1 0 1 1 1
Neighs:        21642.8 ave       23980 max       18354 min
Histogram: 1 1 0 0 0 1 3 0 0 2

Total # of neighbors = 173142
Ave neighs/atom = 631.90511
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 10.0572813984136
variable C2pos equal ${d2}
variable C2pos equal 18.5642518509102
variable C3pos equal ${d3}
variable C3pos equal 71.1060891310376
variable C4pos equal ${d4}
variable C4pos equal 13.1235267640966
variable C5pos equal ${d5}
variable C5pos equal -13.1103267908535
variable C6pos equal ${d6}
variable C6pos equal 0.987297063383966

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-28.8808000923861+${C1pos})
variable C16 equal 0.5*(-28.8808000923861+10.0572813984136)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-5.2041449394276+${C2pos})
variable C26 equal 0.5*(-5.2041449394276+18.5642518509102)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-93.0087750280801+${C3pos})
variable C36 equal 0.5*(-93.0087750280801+71.1060891310376)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(7.77067998419706+${C4pos})
variable C46 equal 0.5*(7.77067998419706+13.1235267640966)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(11.8862297272717+${C5pos})
variable C56 equal 0.5*(11.8862297272717+-13.1103267908535)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(10.2218200831029+${C6pos})
variable C66 equal 0.5*(10.2218200831029+0.987297063383966)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal -8.22212305009665
variable C22all equal ${C22}
variable C22all equal 49.4118234017699
variable C33all equal ${C33}
variable C33all equal 12.1503443464143

variable C44all equal ${C44}
variable C44all equal 11.3123413786548
variable C55all equal ${C55}
variable C55all equal 16.834810541905
variable C66all equal ${C66}
variable C66all equal 5.60455857324343

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(7.09746208191915+${C21})
variable C12all equal 0.5*(7.09746208191915+-11.2318303576733)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(-16.1508374000081+${C31})
variable C13all equal 0.5*(-16.1508374000081+-27.9681732768731)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(-17.5417317305304+${C32})
variable C23all equal 0.5*(-17.5417317305304+37.7978762355158)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(9.77478447415625+${C41})
variable C14all equal 0.5*(9.77478447415625+0.638786722519615)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-1.37938421511545+${C51})
variable C15all equal 0.5*(-1.37938421511545+3.89394564786596)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-9.41175934698625+${C61})
variable C16all equal 0.5*(-9.41175934698625+-6.45663829356165)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-14.3124241497153+${C42})
variable C24all equal 0.5*(-14.3124241497153+-3.47759849492435)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(35.2895464897365+${C52})
variable C25all equal 0.5*(35.2895464897365+-2.1158002353882)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(6.6800534557413+${C62})
variable C26all equal 0.5*(6.6800534557413+-8.09301874288026)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(2.292824284386+${C43})
variable C34all equal 0.5*(2.292824284386+-6.43039981224113)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-3.1108854454141+${C53})
variable C35all equal 0.5*(-3.1108854454141+-11.264148517918)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-10.9513429485212+${C63})
variable C36all equal 0.5*(-10.9513429485212+-1.936313387805)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(7.24310494720925+${C54})
variable C45all equal 0.5*(7.24310494720925+-0.175900181171815)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(10.4471033741468+${C64})
variable C46all equal 0.5*(10.4471033741468+0.26045288980373)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-0.6120485317909+${C65})
variable C56all equal 0.5*(-0.6120485317909+1.04686879112692)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:17:39
