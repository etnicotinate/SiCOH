LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-11-VASP-an
read_data       ${structure}.data
read_data       333-HD-100C-11-VASP-an.data
Reading data file ...
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
  reading velocities ...
  366 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              326.3987       3977.1731    
         1   300            0              0              326.3987       3977.1731    
Loop time of 4.70496e-05 on 8 procs for 1 steps with 366 atoms

50.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.57e-07   | 1.9937e-07 | 2.32e-07   |   0.0 |  0.42
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.733e-06  | 1.8975e-06 | 2.026e-06  |   0.0 |  4.03
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.495e-05  |            |       | 95.54

Nlocal:          45.75 ave          55 max          36 min
Histogram: 1 0 1 2 1 0 0 0 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131 | 134 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -44401.657     -6665.225       0              1.9047473      3751.5158    
       100   302.13336     -44400.349     -9313.5178     -1929.9261      1.9047473      3751.5158    
       200   308.04123     -44394.215      562.9855       1050.3351      1.9047473      3751.5158    
       300   317.83814     -44382.375     -980.3266      -1299.2102      1.9047473      3751.5158    
       400   324.24795     -44401.536     -10189.884     -2908.8353      1.9047473      3751.5158    
       500   305.31321     -44414.166     -3024.0497     -585.59621      1.9047473      3751.5158    
       600   292.06142     -44404.057     -15539.265      52.690569      1.9047473      3751.5158    
       700   287.45249     -44395.181     -15864.969     -4457.4894      1.9047473      3751.5158    
       800   312.6759      -44401.196     -3335.5127      1320.0708      1.9047473      3751.5158    
       900   320.71795     -44382.112     -2871.4279      3788.1506      1.9047473      3751.5158    
      1000   328.6148      -44401.729     -4298.2359     -1074.6691      1.9047473      3751.5158    
      1100   299.73787     -44392.612     -3260.8196     -3411.5355      1.9047473      3751.5158    
      1200   295.93168     -44404.022     -12209.862     -3267.0046      1.9047473      3751.5158    
      1300   301.16291     -44418.239     -6225.9161     -2078.2328      1.9047473      3751.5158    
      1400   298.03053     -44406.742     -3353.6904      474.12592      1.9047473      3751.5158    
      1500   320.43713     -44392.395     -7116.501       1216.8045      1.9047473      3751.5158    
      1600   315.21092     -44390.368     -9552.0538     -4877.0917      1.9047473      3751.5158    
      1700   282.73819     -44379.65      -2150.0774      215.49874      1.9047473      3751.5158    
      1800   303.65587     -44408.421     -4229.0658      127.07843      1.9047473      3751.5158    
      1900   291.11692     -44403.595     -121.26035     -11047.536      1.9047473      3751.5158    
      2000   288.30867     -44402.436     -4921.068      -2611.2399      1.9047473      3751.5158    
Loop time of 107.684 on 8 procs for 2000 steps with 366 atoms

Performance: 0.802 ns/day, 29.912 hours/ns, 18.573 timesteps/s, 6.798 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.07      | 87.348     | 90.966     |  24.2 | 81.12
Bond    | 0.00066903 | 0.0008211  | 0.0010211  |   0.0 |  0.00
Neigh   | 7.0565     | 7.384      | 7.691      |   8.9 |  6.86
Comm    | 0.77915    | 4.4154     | 7.7032     | 108.2 |  4.10
Output  | 0.0011977  | 0.0012868  | 0.001784   |   0.5 |  0.00
Modify  | 8.199      | 8.494      | 8.8076     |   7.9 |  7.89
Other   |            | 0.0404     |            |       |  0.04

Nlocal:          45.75 ave          54 max          37 min
Histogram: 1 2 0 0 0 2 0 0 2 1
Nghost:        3428.62 ave        3531 max        3342 min
Histogram: 1 2 0 1 1 0 0 2 0 1
Neighs:        31266.1 ave       36469 max       25364 min
Histogram: 1 2 0 0 0 1 1 0 1 2

Total # of neighbors = 250129
Ave neighs/atom = 683.41257
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-11-VASP-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.1763539518821
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.814787633041
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.8934924756973

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--2611.23994961813)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--2611.23994961813)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--6336.61484961408)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--6336.61484961408)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--5894.75611426952)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--5894.75611426952)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--569.586646099418)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--569.586646099418)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--4068.83778771931)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--4068.83778771931)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-291.086033326918)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-291.086033326918)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.1763539518821
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.1763539518821
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.151763539518821 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.151763539518821 xy delta 0.0750671509384637 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.151763539518821 xy delta 0.0750671509384637 xz delta -0.0025342046423892 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6156.0823     -425.59924      3749.64      
       200   313.73872     -44379.818     -13740.738     -10175.65       3747.7642    
       300   308.98814     -44389.257     -15984.129     -6458.2805      3745.8885    
       400   294.93824     -44406.089     -2728.4063     -4651.6103      3744.0127    
       500   294.88327     -44414.069     -13571.367     -4465.6946      3742.137     
       600   277.28969     -44384.44      -4264.1299     -1216.3038      3740.2612    
       700   310.51583     -44394.294     -11605.028     -1336.5927      3738.3855    
       800   292.48975     -44373.936      5261.3991      695.45141      3736.5097    
       900   304.7793      -44396.709     -13133.738     -1940.2926      3734.6339    
      1000   309.57099     -44416.668      5494.7252      4922.3605      3732.7582    
      1100   291.73709     -44413.483     -5332.128       2355.8509      3730.8824    
      1200   295.76664     -44414.518     -9785.2901      5620.4968      3729.0067    
      1300   322.20025     -44400.942      1006.8521      3526.026       3727.1309    
      1400   319.78092     -44376.057     -7827.623      -679.42966      3725.2551    
      1500   309.9805      -44388.767     -5033.472      -1345.0163      3723.3794    
      1600   296.67624     -44400.952     -18831.094      2688.3588      3721.5036    
      1700   286.7814      -44409.69      -7537.4848      7869.7783      3719.6279    
      1800   310.18326     -44425.959      6956.9337      4835.416       3717.7521    
      1900   302.9552      -44397.71       2746.171       9200.0143      3715.8764    
      2000   310.95366     -44379.928     -14777.78      -470.08498      3714.0006    
Loop time of 107.035 on 8 procs for 2000 steps with 366 atoms

Performance: 0.807 ns/day, 29.732 hours/ns, 18.685 timesteps/s, 6.839 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.583     | 87.485     | 89.743     |  20.2 | 81.73
Bond    | 0.00067507 | 0.00080679 | 0.00099253 |   0.0 |  0.00
Neigh   | 7.0975     | 7.4227     | 7.7525     |   7.5 |  6.93
Comm    | 1.2675     | 3.5452     | 6.4524     | 100.9 |  3.31
Output  | 0.0046762  | 0.0056127  | 0.0063188  |   0.8 |  0.01
Modify  | 8.2186     | 8.5326     | 8.8418     |   6.7 |  7.97
Other   |            | 0.04329    |            |       |  0.04

Nlocal:          45.75 ave          57 max          33 min
Histogram: 1 0 1 1 2 0 0 1 0 2
Nghost:        3457.75 ave        3574 max        3363 min
Histogram: 1 2 0 0 2 0 0 2 0 1
Neighs:        31549.9 ave       39067 max       22934 min
Histogram: 1 0 1 1 2 0 0 0 1 2

Total # of neighbors = 252399
Ave neighs/atom = 689.61475
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 21.6952526946016
variable C2neg equal ${d2}
variable C2neg equal 16.7410793834113
variable C3neg equal ${d3}
variable C3neg equal 15.5021847190037
variable C4neg equal ${d4}
variable C4neg equal 6.51659237459157
variable C5neg equal ${d5}
variable C5neg equal 2.58983224099886
variable C6neg equal ${d6}
variable C6neg equal 2.10018123098282

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.1763539518821
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.151763539518821 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.151763539518821 xy delta -0.0750671509384637 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.151763539518821 xy delta -0.0750671509384637 xz delta 0.0025342046423892 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6149.9293     -425.6683       3753.3915    
       200   313.17404     -44379.106     -13695.19      -11404.889      3755.2673    
       300   316.50057     -44395.316     -14569.457     -7693.6411      3757.143     
       400   294.29643     -44402.882     -7087.9117     -7331.161       3759.0188    
       500   292.89055     -44408.25      -1327.0355     -4072.0805      3760.8945    
       600   282.56989     -44380.373     -1705.234      -3304.4158      3762.7703    
       700   314.8114      -44396.664     -7376.0814     -1015.6804      3764.6461    
       800   309.1221      -44396.174     -5076.3538     -4485.9101      3766.5218    
       900   273.02421     -44367.379     -5805.6712     -7650.7152      3768.3976    
      1000   288.38652     -44387.476     -8571.3708     -2437.844       3770.2733    
      1100   266.18172     -44362.043     -14411.858     -5698.1192      3772.1491    
      1200   295.36779     -44384.326     -980.20319     -4736.3045      3774.0249    
      1300   296.71963     -44386.743     -12237.254     -3537.2514      3775.9006    
      1400   302.46146     -44392.676     -3295.7514     -2607.6425      3777.7764    
      1500   297.05816     -44393.415     -14229.307     -5839.4285      3779.6521    
      1600   298.57952     -44412.048     -9611.4619     -8367.3793      3781.5279    
      1700   281.0553      -44417.069     -10708.909     -11288.617      3783.4036    
      1800   295.60916     -44414.679     -11029.023     -10199.948      3785.2794    
      1900   319.1048      -44410.896     -9546.238      -1966.1859      3787.1552    
      2000   313.80125     -44403.614     -7819.266      -10384.59       3789.0309    
Loop time of 104.212 on 8 procs for 2000 steps with 366 atoms

Performance: 0.829 ns/day, 28.948 hours/ns, 19.192 timesteps/s, 7.024 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.311     | 82.38      | 87.407     |  92.9 | 79.05
Bond    | 0.00066386 | 0.00079378 | 0.00096287 |   0.0 |  0.00
Neigh   | 5.2756     | 7.0654     | 7.652      |  26.4 |  6.78
Comm    | 1.0793     | 6.1231     | 28.178     | 340.6 |  5.88
Output  | 0.0044379  | 0.0054525  | 0.0061789  |   0.8 |  0.01
Modify  | 8.0215     | 8.5961     | 10.404     |  24.0 |  8.25
Other   |            | 0.0415     |            |       |  0.04

Nlocal:          45.75 ave          56 max          36 min
Histogram: 1 0 1 2 1 0 0 0 2 1
Nghost:        3413.12 ave        3515 max        3330 min
Histogram: 2 1 0 1 0 1 0 1 1 1
Neighs:        30953.6 ave       37680 max       24465 min
Histogram: 1 0 2 1 1 0 0 1 1 1

Total # of neighbors = 247629
Ave neighs/atom = 676.58197
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 78.7634670362195
variable C2pos equal ${d2}
variable C2pos equal 40.4768445120061
variable C3pos equal ${d3}
variable C3pos equal 27.5806342733893
variable C4pos equal ${d4}
variable C4pos equal 3.80360410612326
variable C5pos equal ${d5}
variable C5pos equal -11.9409799697617
variable C6pos equal ${d6}
variable C6pos equal -3.50491804911289

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(21.6952526946016+${C1pos})
variable C11 equal 0.5*(21.6952526946016+78.7634670362195)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(16.7410793834113+${C2pos})
variable C21 equal 0.5*(16.7410793834113+40.4768445120061)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(15.5021847190037+${C3pos})
variable C31 equal 0.5*(15.5021847190037+27.5806342733893)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(6.51659237459157+${C4pos})
variable C41 equal 0.5*(6.51659237459157+3.80360410612326)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(2.58983224099886+${C5pos})
variable C51 equal 0.5*(2.58983224099886+-11.9409799697617)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(2.10018123098282+${C6pos})
variable C61 equal 0.5*(2.10018123098282+-3.50491804911289)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.814787633041
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.814787633041
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.13814787633041 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.13814787633041 yz delta 0.00114592194874483 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6156.0823     -425.59924      3749.64      
       200   313.12261     -44379.386     -13655.176     -10539.385      3747.7642    
       300   308.56593     -44388.407     -14445.397     -7000.1236      3745.8885    
       400   295.17204     -44405.793     -1125.2961     -3329.6288      3744.0127    
       500   296.92415     -44414.966     -9844.5425     -5265.0605      3742.137     
       600   285.67009     -44390.822     -7537.6044      725.81419      3740.2612    
       700   313.93635     -44396.392     -8732.2968     -1640.0941      3738.3855    
       800   313.8227      -44396.426     -1684.4293     -2002.4951      3736.5097    
       900   299.50349     -44394.091      1758.9556      2080.2738      3734.6339    
      1000   297.07528     -44404.986     -1568.4818      1976.0513      3732.7582    
      1100   309.62986     -44430.554     -12176.164      2204.947       3730.8824    
      1200   302.32638     -44416.688     -335.25877     -3120.9509      3729.0067    
      1300   304.05479     -44375.083      4266.3937      1930.5537      3727.1309    
      1400   318.90947     -44400.935     -5781.016      -328.32502      3725.2551    
      1500   299.4886      -44405.275     -2112.2909     -4073.0314      3723.3794    
      1600   297.26675     -44413.603      4551.4068      6515.379       3721.5036    
      1700   299.44535     -44420.888     -3280.2937      14.564665      3719.6279    
      1800   290.41423     -44410.651      3135.9996     -1051.8415      3717.7521    
      1900   303.42442     -44398.274      2986.8313      4767.7248      3715.8764    
      2000   325.62688     -44408.231      3428.2645     -1449.8224      3714.0006    
Loop time of 105.446 on 8 procs for 2000 steps with 366 atoms

Performance: 0.819 ns/day, 29.290 hours/ns, 18.967 timesteps/s, 6.942 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.483     | 80.195     | 88.554     | 119.9 | 76.05
Bond    | 0.00067925 | 0.00080849 | 0.00095165 |   0.0 |  0.00
Neigh   | 5.3194     | 6.8399     | 7.7389     |  33.5 |  6.49
Comm    | 0.97597    | 9.3534     | 28.045     | 350.9 |  8.87
Output  | 0.0044454  | 0.0053968  | 0.0061111  |   0.8 |  0.01
Modify  | 8.1257     | 9.0109     | 10.553     |  29.5 |  8.55
Other   |            | 0.03999    |            |       |  0.04

Nlocal:          45.75 ave          56 max          33 min
Histogram: 1 0 1 1 0 0 2 1 0 2
Nghost:        3459.75 ave        3570 max        3364 min
Histogram: 2 1 1 0 0 0 1 1 1 1
Neighs:        31567.1 ave       38419 max       22962 min
Histogram: 1 0 2 0 0 1 1 1 1 1

Total # of neighbors = 252537
Ave neighs/atom = 689.9918
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 11.7680632769429
variable C2neg equal ${d2}
variable C2neg equal 83.6256836355313
variable C3neg equal ${d3}
variable C3neg equal 61.0638446754811
variable C4neg equal ${d4}
variable C4neg equal -4.15272613379509
variable C5neg equal ${d5}
variable C5neg equal 0.987449311515598
variable C6neg equal ${d6}
variable C6neg equal -11.7174734892797

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.814787633041
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.13814787633041 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.13814787633041 yz delta -0.00114592194874483 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6149.9293     -425.6683       3753.3915    
       200   313.74391     -44379.409     -13858.205     -11024.747      3755.2673    
       300   314.44487     -44393.236     -14568.735     -6915.891       3757.143     
       400   287.76809     -44395.13      -9955.614      -6854.6032      3759.0188    
       500   288.32562     -44402.297     -122.94205     -4016.0006      3760.8945    
       600   279.02945     -44382.308     -3326.71       -2617.3636      3762.7703    
       700   312.52995     -44393.145     -2057.3013     -2896.4408      3764.6461    
       800   311.24318     -44387.977      4306.6774     -894.88547      3766.5218    
       900   294.02672     -44379.609     -11837.017     -7327.1839      3768.3976    
      1000   320.34626     -44414.849     -1440.8801      1643.9601      3770.2733    
      1100   308.78121     -44420.17      -3971.9977      2569.0793      3772.1491    
      1200   291.78716     -44404.594     -17025.591     -3502.9757      3774.0249    
      1300   309.78371     -44392.749     -11969.895     -10849.79       3775.9006    
      1400   312.40478     -44374.848     -9228.4063     -530.47317      3777.7764    
      1500   292.66627     -44365.783     -15933.063     -3853.8884      3779.6521    
      1600   296.06893     -44392.101     -14787.844     -8461.8976      3781.5279    
      1700   308.65563     -44415.635     -6455.119      -5742.3952      3783.4036    
      1800   293.59549     -44400.559     -9516.1929     -5440.9219      3785.2794    
      1900   295.50132     -44387.347      2383.796      -1351.5471      3787.1552    
      2000   316.3346      -44390.263     -9939.0398     -1590.1697      3789.0309    
Loop time of 103.807 on 8 procs for 2000 steps with 366 atoms

Performance: 0.832 ns/day, 28.835 hours/ns, 19.267 timesteps/s, 7.052 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.089     | 78.977     | 87.17      | 116.5 | 76.08
Bond    | 0.00064209 | 0.00078713 | 0.00093453 |   0.0 |  0.00
Neigh   | 5.2566     | 6.782      | 7.6353     |  33.7 |  6.53
Comm    | 0.92408    | 9.1358     | 27.008     | 342.2 |  8.80
Output  | 0.0044243  | 0.0053173  | 0.0059831  |   0.7 |  0.01
Modify  | 8.0253     | 8.8655     | 10.41      |  29.8 |  8.54
Other   |            | 0.04067    |            |       |  0.04

Nlocal:          45.75 ave          54 max          35 min
Histogram: 1 0 1 1 0 1 1 0 2 1
Nghost:        3403.38 ave        3502 max        3316 min
Histogram: 2 1 1 0 0 0 1 1 1 1
Neighs:          30930 ave       36045 max       23837 min
Histogram: 1 0 1 1 0 1 1 0 1 2

Total # of neighbors = 247440
Ave neighs/atom = 676.06557
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -10.3459944964714
variable C2pos equal ${d2}
variable C2pos equal 39.3703902642756
variable C3pos equal ${d3}
variable C3pos equal 42.3809763889734
variable C4pos equal ${d4}
variable C4pos equal 1.50282121380675
variable C5pos equal ${d5}
variable C5pos equal -1.49615949517876
variable C6pos equal ${d6}
variable C6pos equal -2.09216162705836

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(11.7680632769429+${C1pos})
variable C12 equal 0.5*(11.7680632769429+-10.3459944964714)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(83.6256836355313+${C2pos})
variable C22 equal 0.5*(83.6256836355313+39.3703902642756)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(61.0638446754811+${C3pos})
variable C32 equal 0.5*(61.0638446754811+42.3809763889734)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-4.15272613379509+${C4pos})
variable C42 equal 0.5*(-4.15272613379509+1.50282121380675)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(0.987449311515598+${C5pos})
variable C52 equal 0.5*(0.987449311515598+-1.49615949517876)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-11.7174734892797+${C6pos})
variable C62 equal 0.5*(-11.7174734892797+-2.09216162705836)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.8934924756973
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.8934924756973
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.178934924756973 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6156.0823     -425.59924      3749.64      
       200   313.91713     -44380.217     -13970.99      -10440.544      3747.7642    
       300   310.34182     -44391.195     -14946.785     -6664.9944      3745.8885    
       400   297.41207     -44408.904     -7431.3095     -5387.6089      3744.0127    
       500   291.55653     -44410.962     -6691.1447     -2824.5129      3742.137     
       600   297.2443      -44403.158     -3584.307      -4348.0655      3740.2612    
       700   313.46184     -44397.786     -9792.4927     -2184.9245      3738.3855    
       800   320.94661     -44406.055      6451.6573      1121.9107      3736.5097    
       900   300.16144     -44398.895     -4761.8027     -2046.5408      3734.6339    
      1000   293.64332     -44408.581      5191.5794      2027.8745      3732.7582    
      1100   294.43643     -44412.65      -1043.26        1114.7558      3730.8824    
      1200   321.71258     -44431.209     -1303.2622      1906.6243      3729.0067    
      1300   287.27416     -44393.281     -14696.815     -4170.6913      3727.1309    
      1400   295.05023     -44439.241      3998.9353     -83.971488      3725.2551    
      1500   298.37594     -44454.923      548.11955      2675.5462      3723.3794    
      1600   291.72918     -44427.721     -1639.4604      1480.9792      3721.5036    
      1700   300.44327     -44415.412      13738.665     -131.49306      3719.6279    
      1800   286.62988     -44386.922      8810.999       2462.955       3717.7521    
      1900   304.57984     -44406.886      12039.843      1649.7675      3715.8764    
      2000   296.5555      -44405.036      4561.7335      4811.6407      3714.0006    
Loop time of 105.968 on 8 procs for 2000 steps with 366 atoms

Performance: 0.815 ns/day, 29.436 hours/ns, 18.874 timesteps/s, 6.908 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.998     | 80.549     | 88.883     | 119.8 | 76.01
Bond    | 0.00066787 | 0.00080531 | 0.0010192  |   0.0 |  0.00
Neigh   | 5.3254     | 6.8647     | 7.7366     |  33.9 |  6.48
Comm    | 1.1994     | 9.5539     | 28.085     | 347.6 |  9.02
Output  | 0.004518   | 0.0054629  | 0.0061734  |   0.8 |  0.01
Modify  | 8.0985     | 8.9546     | 10.515     |  30.0 |  8.45
Other   |            | 0.03933    |            |       |  0.04

Nlocal:          45.75 ave          55 max          34 min
Histogram: 1 0 2 0 0 1 1 0 1 2
Nghost:         3466.5 ave        3567 max        3377 min
Histogram: 2 1 1 0 0 0 1 1 1 1
Neighs:          31541 ave       37357 max       23631 min
Histogram: 1 0 2 0 0 0 2 0 0 3

Total # of neighbors = 252328
Ave neighs/atom = 689.42077
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 75.2123382731304
variable C2neg equal ${d2}
variable C2neg equal 103.518420731915
variable C3neg equal ${d3}
variable C3neg equal 137.065531471759
variable C4neg equal ${d4}
variable C4neg equal -1.19981681668259
variable C5neg equal ${d5}
variable C5neg equal -4.45373504791716
variable C6neg equal ${d6}
variable C6neg equal 4.48840021897296

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.8934924756973
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.178934924756973 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6149.9293     -425.6683       3753.3915    
       200   313.03357     -44378.861     -13583.173     -11077.442      3755.2673    
       300   312.67982     -44391.106     -13028.98      -7895.2329      3757.143     
       400   306.23206     -44415.735     -3654.6383     -7476.7373      3759.0188    
       500   301.7125      -44417.501     -7775.7814     -5976.7541      3760.8945    
       600   286.02026     -44386.115     -2408.8461     -4276.1139      3762.7703    
       700   309.47445     -44392.026     -9548.2252     -3589.3212      3764.6461    
       800   327.96061     -44413.836     -9692.8481     -3126.5438      3766.5218    
       900   289.45907     -44392.045     -15739.905     -6868.4892      3768.3976    
      1000   282.75099     -44407.459     -470.2678      -636.70011      3770.2733    
      1100   252.63389     -44423.103     -16156.35      -2909.2061      3772.1491    
      1200   273.34927     -44442.818     -12284.645     -7328.3856      3774.0249    
      1300   281.29136     -44416.372      1765.9053     -3362.3088      3775.9006    
      1400   295.91304     -44402.927     -9814.3689     -2593.3609      3777.7764    
      1500   307.90452     -44392.434     -24905.564     -12485.992      3779.6521    
      1600   318.33627     -44396.58      -16746.592     -5936.1292      3781.5279    
      1700   312.99416     -44414.843     -9288.4201     -9453.1098      3783.4036    
      1800   294.64414     -44413.347     -9916.4893     -7138.7674      3785.2794    
      1900   291.8327      -44406.296     -10496.363     -6830.4932      3787.1552    
      2000   306.32234     -44407.607     -6639.2916     -10772.059      3789.0309    
Loop time of 103.336 on 8 procs for 2000 steps with 366 atoms

Performance: 0.836 ns/day, 28.704 hours/ns, 19.354 timesteps/s, 7.084 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.351     | 78.899     | 86.934     | 120.4 | 76.35
Bond    | 0.0006806  | 0.00078408 | 0.00089986 |   0.0 |  0.00
Neigh   | 4.9765     | 6.472      | 7.2745     |  33.6 |  6.26
Comm    | 1.0988     | 9.1545     | 27.684     | 353.2 |  8.86
Output  | 0.0043928  | 0.0053773  | 0.0060966  |   0.8 |  0.01
Modify  | 7.9778     | 8.7645     | 10.28      |  29.3 |  8.48
Other   |            | 0.03955    |            |       |  0.04

Nlocal:          45.75 ave          57 max          38 min
Histogram: 2 1 0 1 1 0 1 1 0 1
Nghost:        3398.38 ave        3514 max        3306 min
Histogram: 2 1 0 1 0 1 0 2 0 1
Neighs:        30937.4 ave       38355 max       25617 min
Histogram: 2 1 0 1 1 0 0 2 0 1

Total # of neighbors = 247499
Ave neighs/atom = 676.22678
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 82.6895015542636
variable C2pos equal ${d2}
variable C2pos equal -5.71344149622247
variable C3pos equal ${d3}
variable C3pos equal 94.0087638796888
variable C4pos equal ${d4}
variable C4pos equal -2.53500757753343
variable C5pos equal ${d5}
variable C5pos equal -16.1487824361582
variable C6pos equal ${d6}
variable C6pos equal 10.2022397697451

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(75.2123382731304+${C1pos})
variable C13 equal 0.5*(75.2123382731304+82.6895015542636)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(103.518420731915+${C2pos})
variable C23 equal 0.5*(103.518420731915+-5.71344149622247)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(137.065531471759+${C3pos})
variable C33 equal 0.5*(137.065531471759+94.0087638796888)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-1.19981681668259+${C4pos})
variable C43 equal 0.5*(-1.19981681668259+-2.53500757753343)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-4.45373504791716+${C5pos})
variable C53 equal 0.5*(-4.45373504791716+-16.1487824361582)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(4.48840021897296+${C6pos})
variable C63 equal 0.5*(4.48840021897296+10.2022397697451)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.8934924756973
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.8934924756973
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.178934924756973 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6153.0043     -425.63379      3751.5158    
       200   313.27564     -44379.092     -13919.774     -10781.558      3751.5158    
       300   310.54346     -44389.622     -14560.807     -7334.4623      3751.5158    
       400   293.62689     -44403.257     -1333.1369     -3463.2593      3751.5158    
       500   300.60339     -44418.903     -14521.129     -3677.1743      3751.5158    
       600   285.96725     -44389.541     -10663.883     -2611.9256      3751.5158    
       700   313.72582     -44397.683     -8166.0697      225.29144      3751.5158    
       800   324.07268     -44410.696     -2176.6647     -1037.2981      3751.5158    
       900   284.12016     -44377.029     -10446.344     -4848.9186      3751.5158    
      1000   300.04996     -44405.53       2864.4202      1313.069       3751.5158    
      1100   302.24303     -44419.613     -2012.7787      2380.8373      3751.5158    
      1200   313.43196     -44421.075      4648.4534     -3063.0474      3751.5158    
      1300   309.70448     -44379.27       5125.865       116.99708      3751.5158    
      1400   296.90115     -44369.029     -6841.6714      1501.125       3751.5158    
      1500   296.55774     -44381.743     -12107.593     -4794.115       3751.5158    
      1600   306.69496     -44404.388     -10614.902     -1939.5195      3751.5158    
      1700   284.10869     -44401.98      -9022.698      -7455.8375      3751.5158    
      1800   286.79226     -44420.033     -299.53969     -6913.5925      3751.5158    
      1900   302.58034     -44427.293      249.20052      2882.6937      3751.5158    
      2000   307.06711     -44390.386      1951.3996     -2295.7657      3751.5158    
Loop time of 105.657 on 8 procs for 2000 steps with 366 atoms

Performance: 0.818 ns/day, 29.349 hours/ns, 18.929 timesteps/s, 6.928 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.222     | 78.231     | 88.881     | 118.6 | 74.04
Bond    | 0.00063866 | 0.00078016 | 0.00097006 |   0.0 |  0.00
Neigh   | 5.3083     | 6.737      | 7.784      |  35.1 |  6.38
Comm    | 0.95133    | 11.617     | 27.606     | 307.5 | 10.99
Output  | 0.0045313  | 0.0055363  | 0.0062576  |   0.8 |  0.01
Modify  | 7.989      | 9.0268     | 10.48      |  30.7 |  8.54
Other   |            | 0.03954    |            |       |  0.04

Nlocal:          45.75 ave          53 max          36 min
Histogram: 1 1 0 0 1 1 0 1 1 2
Nghost:        3426.25 ave        3520 max        3345 min
Histogram: 2 0 1 1 0 1 0 1 1 1
Neighs:        31243.4 ave       35737 max       24746 min
Histogram: 1 1 0 0 1 1 1 0 0 3

Total # of neighbors = 249947
Ave neighs/atom = 682.9153
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 3.19654270413262
variable C2neg equal ${d2}
variable C2neg equal 12.5230995259138
variable C3neg equal ${d3}
variable C3neg equal -1.81616209009333
variable C4neg equal ${d4}
variable C4neg equal 15.2218187565129
variable C5neg equal ${d5}
variable C5neg equal 1.70741766745543
variable C6neg equal ${d6}
variable C6neg equal -10.3513513652997

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.8934924756973
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.178934924756973 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6153.0043     -425.63379      3751.5158    
       200   313.74847     -44379.814     -13681.19      -10726.667      3751.5158    
       300   311.11377     -44390.801     -15670.401     -7770.1394      3751.5158    
       400   298.56855     -44408.454     -205.15292     -5239.2915      3751.5158    
       500   296.82244     -44414.13      -10384.511     -5092.6297      3751.5158    
       600   280.44434     -44385.854      139.27044     -3737.5252      3751.5158    
       700   313.46614     -44396.628     -8460.5152     -2149.0463      3751.5158    
       800   326.6072      -44406.702     -11705.386     -4828.9896      3751.5158    
       900   301.38904     -44387.006     -11924.325     -4809.3256      3751.5158    
      1000   290.37607     -44387.798      3798.9913     -1150.3813      3751.5158    
      1100   283.42255     -44396.521     -954.74526      1322.451       3751.5158    
      1200   287.03264     -44397.784     -1716.1271     -1532.3653      3751.5158    
      1300   308.18855     -44390.477      1761.1182     -6083.7932      3751.5158    
      1400   320.00666     -44381.758     -18963.347     -6973.8017      3751.5158    
      1500   302.47741     -44378.47      -2001.6571     -1346.4907      3751.5158    
      1600   310.70467     -44407.816     -7807.5758     -3727.7664      3751.5158    
      1700   301.4123      -44405.57      -6064.6979     -11967.346      3751.5158    
      1800   303.57278     -44408.594     -4745.6666     -4793.6901      3751.5158    
      1900   313.6218      -44414.755      5440.1338     -831.71964      3751.5158    
      2000   287.04764     -44390.127      1334.3604      766.85989      3751.5158    
Loop time of 105.57 on 8 procs for 2000 steps with 366 atoms

Performance: 0.818 ns/day, 29.325 hours/ns, 18.945 timesteps/s, 6.934 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.876     | 76.32      | 88.831     | 141.2 | 72.29
Bond    | 0.00068951 | 0.00079892 | 0.00095184 |   0.0 |  0.00
Neigh   | 5.0829     | 6.5387     | 7.6578     |  40.0 |  6.19
Comm    | 1.1033     | 13.628     | 32.076     | 333.9 | 12.91
Output  | 0.0045091  | 0.0054325  | 0.0061855  |   0.8 |  0.01
Modify  | 7.9275     | 9.0388     | 10.494     |  34.3 |  8.56
Other   |            | 0.03877    |            |       |  0.04

Nlocal:          45.75 ave          54 max          34 min
Histogram: 1 0 1 1 0 1 1 0 0 3
Nghost:           3434 ave        3511 max        3370 min
Histogram: 3 0 0 1 0 0 1 1 1 1
Neighs:          31239 ave       36881 max       23399 min
Histogram: 1 0 1 1 0 1 1 0 0 3

Total # of neighbors = 249912
Ave neighs/atom = 682.81967
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -34.2285966713542
variable C2pos equal ${d2}
variable C2pos equal -31.5439723153234
variable C3pos equal ${d3}
variable C3pos equal -53.1800949172469
variable C4pos equal ${d4}
variable C4pos equal 31.316988841156
variable C5pos equal ${d5}
variable C5pos equal -7.26751232830275
variable C6pos equal ${d6}
variable C6pos equal 5.4138271563375

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(3.19654270413262+${C1pos})
variable C14 equal 0.5*(3.19654270413262+-34.2285966713542)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(12.5230995259138+${C2pos})
variable C24 equal 0.5*(12.5230995259138+-31.5439723153234)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-1.81616209009333+${C3pos})
variable C34 equal 0.5*(-1.81616209009333+-53.1800949172469)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(15.2218187565129+${C4pos})
variable C44 equal 0.5*(15.2218187565129+31.316988841156)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(1.70741766745543+${C5pos})
variable C54 equal 0.5*(1.70741766745543+-7.26751232830275)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-10.3513513652997+${C6pos})
variable C64 equal 0.5*(-10.3513513652997+5.4138271563375)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.8934924756973
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.8934924756973
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.178934924756973 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6153.0043     -425.63379      3751.5158    
       200   312.91496     -44379.268     -13867.773     -10838.335      3751.5158    
       300   312.16263     -44392.423     -12555.152     -7026.9037      3751.5158    
       400   298.73461     -44409.078     -7109.4459     -5749.7013      3751.5158    
       500   290.0844      -44404.885     -5520.3003     -4014.3768      3751.5158    
       600   269.17778     -44369.08      -5514.0645     -2829.7419      3751.5158    
       700   308.46425     -44389.201     -3501.875      -978.69572      3751.5158    
       800   314.29975     -44394.96      -9010.3655     -2053.0006      3751.5158    
       900   282.9197      -44374.097     -7244.7531     -4745.4362      3751.5158    
      1000   306.67282     -44410.777      6100.9937      2422.0081      3751.5158    
      1100   293.23277     -44406.192     -3609.7334      3645.865       3751.5158    
      1200   296.47046     -44413.1       -7883.2345     -2190.8767      3751.5158    
      1300   299.55336     -44404.138     -11615.892     -7037.05        3751.5158    
      1400   306.43287     -44394.996     -3308.0353      584.49822      3751.5158    
      1500   303.49138     -44385.343     -16.647973      3431.8663      3751.5158    
      1600   302.32347     -44390.673      2486.2013     -1953.246       3751.5158    
      1700   285.82896     -44409.075     -3602.7095      499.27467      3751.5158    
      1800   285.04941     -44409.09      -7511.2738     -3630.6762      3751.5158    
      1900   291.30973     -44398.827      5763.304      -3794.8344      3751.5158    
      2000   294.78784     -44383.403      6290.0715     -569.85507      3751.5158    
Loop time of 98.8396 on 8 procs for 2000 steps with 366 atoms

Performance: 0.874 ns/day, 27.455 hours/ns, 20.235 timesteps/s, 7.406 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.419     | 68.961     | 83.301     | 103.4 | 69.77
Bond    | 0.00056937 | 0.00074912 | 0.00087218 |   0.0 |  0.00
Neigh   | 5.0665     | 6.0834     | 7.3946     |  31.2 |  6.15
Comm    | 0.70531    | 15.06      | 27.608     | 221.2 | 15.24
Output  | 0.0042072  | 0.0050521  | 0.0056718  |   0.7 |  0.01
Modify  | 7.3874     | 8.6915     | 9.7044     |  26.3 |  8.79
Other   |            | 0.03835    |            |       |  0.04

Nlocal:          45.75 ave          55 max          36 min
Histogram: 2 0 1 0 0 2 0 1 0 2
Nghost:           3428 ave        3546 max        3327 min
Histogram: 1 1 1 0 2 0 1 0 1 1
Neighs:        31231.1 ave       37430 max       24602 min
Histogram: 2 0 1 0 0 1 1 0 1 2

Total # of neighbors = 249849
Ave neighs/atom = 682.64754
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 20.6843323125798
variable C2neg equal ${d2}
variable C2neg equal -5.67575028678672
variable C3neg equal ${d3}
variable C3neg equal -3.43565678478516
variable C4neg equal ${d4}
variable C4neg equal 6.70359356242486
variable C5neg equal ${d5}
variable C5neg equal 15.4891308641788
variable C6neg equal ${d6}
variable C6neg equal -5.04309161534247

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.8934924756973
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.178934924756973 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6153.0043     -425.63379      3751.5158    
       200   313.90549     -44379.446     -13722.207     -10714.748      3751.5158    
       300   313.04586     -44392.606     -14787.921     -7163.0421      3751.5158    
       400   298.73786     -44408.91      -5128.9954     -5831.073       3751.5158    
       500   297.9502      -44415.324     -6353.0219     -3280.9223      3751.5158    
       600   277.30876     -44379.635     -6948.8674     -3819.7445      3751.5158    
       700   313.34126     -44396.552      82.281042     -2179.4483      3751.5158    
       800   316.87355     -44403.656     -4917.242      -4072.7921      3751.5158    
       900   299.90744     -44396.226     -17794.7       -56.602264      3751.5158    
      1000   287.28195     -44391.002     -634.94752     -2228.7868      3751.5158    
      1100   283.912       -44391.425     -11858.571     -2679.4089      3751.5158    
      1200   293.32222     -44389.442     -9785.7102     -2552.1788      3751.5158    
      1300   342.72295     -44412.995     -7269.7492     -1847.792       3751.5158    
      1400   306.46527     -44387.845      1897.3103     -5264.4833      3751.5158    
      1500   303.51193     -44418.369     -1891.9976     -4745.6104      3751.5158    
      1600   303.6837      -44420.984     -13616.804     -3074.7212      3751.5158    
      1700   306.05353     -44412.438     -54.804739     -572.22054      3751.5158    
      1800   317.39189     -44405.818     -4313.4221     -2149.8431      3751.5158    
      1900   301.44098     -44374.053      2353.3823      2472.0581      3751.5158    
      2000   321.41941     -44396.176     -9328.0077     -2344.1269      3751.5158    
Loop time of 65.8404 on 8 procs for 2000 steps with 366 atoms

Performance: 1.312 ns/day, 18.289 hours/ns, 30.377 timesteps/s, 11.118 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.418     | 51.738     | 53.874     |  25.5 | 78.58
Bond    | 0.00058096 | 0.00066716 | 0.0008179  |   0.0 |  0.00
Neigh   | 5.07       | 5.2444     | 5.4547     |   5.9 |  7.97
Comm    | 0.56463    | 2.7152     | 5.0423     | 111.7 |  4.12
Output  | 0.0030289  | 0.0038356  | 0.004365   |   0.8 |  0.01
Modify  | 5.8983     | 6.1026     | 6.2646     |   5.2 |  9.27
Other   |            | 0.03615    |            |       |  0.05

Nlocal:          45.75 ave          55 max          36 min
Histogram: 1 1 1 1 0 1 0 0 1 2
Nghost:        3416.88 ave        3543 max        3320 min
Histogram: 2 1 1 0 0 1 0 1 1 1
Neighs:          31242 ave       37426 max       24671 min
Histogram: 1 1 1 1 0 1 0 0 0 3

Total # of neighbors = 249936
Ave neighs/atom = 682.88525
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -2.70652290129119
variable C2pos equal ${d2}
variable C2pos equal -45.6023432171857
variable C3pos equal ${d3}
variable C3pos equal -16.4433042899664
variable C4pos equal ${d4}
variable C4pos equal 4.17089856470624
variable C5pos equal ${d5}
variable C5pos equal 6.17812291483661
variable C6pos equal ${d6}
variable C6pos equal -8.95672120320617

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(20.6843323125798+${C1pos})
variable C15 equal 0.5*(20.6843323125798+-2.70652290129119)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-5.67575028678672+${C2pos})
variable C25 equal 0.5*(-5.67575028678672+-45.6023432171857)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-3.43565678478516+${C3pos})
variable C35 equal 0.5*(-3.43565678478516+-16.4433042899664)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(6.70359356242486+${C4pos})
variable C45 equal 0.5*(6.70359356242486+4.17089856470624)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(15.4891308641788+${C5pos})
variable C55 equal 0.5*(15.4891308641788+6.17812291483661)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-5.04309161534247+${C6pos})
variable C65 equal 0.5*(-5.04309161534247+-8.95672120320617)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.814787633041

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.814787633041
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.13814787633041 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6153.0043     -425.63379      3751.5158    
       200   313.53986     -44379.547     -13705.051     -10765.583      3751.5158    
       300   311.70351     -44391.157     -13854.49      -7747.1775      3751.5158    
       400   298.04534     -44408         -4286.5535     -6418.3341      3751.5158    
       500   298.11389     -44414.733     -9577.0901     -3745.4119      3751.5158    
       600   281.67831     -44385.651     -5834.505      -3388.3544      3751.5158    
       700   310.65865     -44393.229     -13145.345      500.3314       3751.5158    
       800   328.64192     -44413.154     -5832.8844     -1620.5605      3751.5158    
       900   306.53178     -44398.521     -11114.994     -2791.0623      3751.5158    
      1000   294.80017     -44395.537     -6127.7976      240.01479      3751.5158    
      1100   279.47467     -44387.486     -8541.5291      529.32747      3751.5158    
      1200   305.56816     -44408.172     -2933.833      -4064.7019      3751.5158    
      1300   320.84362     -44396.957     -15477.474     -1625.035       3751.5158    
      1400   315.7791      -44387.015     -162.64106     -2120.0135      3751.5158    
      1500   297.66001     -44398.268     -11418.409     -1201.2861      3751.5158    
      1600   295.21853     -44413.233     -15056.291     -1271.2247      3751.5158    
      1700   275.7981      -44387.55      -355.00168     -7363.8807      3751.5158    
      1800   303.40557     -44400.39      -12284.584     -7644.3631      3751.5158    
      1900   307.18006     -44391.998     -3983.3862     -507.95096      3751.5158    
      2000   309.05783     -44383.572     -3290.8354     -3668.2781      3751.5158    
Loop time of 59.1306 on 8 procs for 2000 steps with 366 atoms

Performance: 1.461 ns/day, 16.425 hours/ns, 33.823 timesteps/s, 12.379 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 43.449     | 45.306     | 46.958     |  23.3 | 76.62
Bond    | 0.00039549 | 0.0004887  | 0.00058169 |   0.0 |  0.00
Neigh   | 5.0098     | 5.1923     | 5.3922     |   5.9 |  8.78
Comm    | 0.98204    | 2.6362     | 4.4984     |  96.8 |  4.46
Output  | 0.0029981  | 0.0037784  | 0.0042959  |   0.8 |  0.01
Modify  | 5.7659     | 5.9574     | 6.1309     |   5.2 | 10.08
Other   |            | 0.03429    |            |       |  0.06

Nlocal:          45.75 ave          57 max          35 min
Histogram: 1 0 1 2 1 0 0 1 1 1
Nghost:        3422.88 ave        3520 max        3322 min
Histogram: 1 0 2 0 1 1 0 1 1 1
Neighs:        31238.5 ave       38545 max       24255 min
Histogram: 1 0 1 3 0 0 0 1 1 1

Total # of neighbors = 249908
Ave neighs/atom = 682.80874
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -10.7104391266297
variable C2neg equal ${d2}
variable C2neg equal -44.7556322563477
variable C3neg equal ${d3}
variable C3neg equal -30.5891709768741
variable C4neg equal ${d4}
variable C4neg equal 6.74339314839117
variable C5neg equal ${d5}
variable C5neg equal 7.81260947327649
variable C6neg equal ${d6}
variable C6neg equal 3.51217812082505

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.069576976 -0.13989382 -0.14304624) to (15.106777 13.674894 17.750446) with tilt (-7.5067151 0.25342046 -0.11459219)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.814787633041
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.13814787633041 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 133.6 | 137.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.30867     -44402.436     -4921.0847      0              3751.5158    
       100   317.47922     -44401.506     -6153.0043     -425.63379      3751.5158    
       200   313.46271     -44379.602     -13842.283     -10761.712      3751.5158    
       300   310.10962     -44389.228     -16033.919     -6710.9853      3751.5158    
       400   295.1235      -44404.7       -4706.2594     -4448.6623      3751.5158    
       500   309.2766      -44428.737     -5756.2541     -3281.5727      3751.5158    
       600   280.01843     -44383.399     -6425.1104     -4599.1026      3751.5158    
       700   308.51749     -44392.781      284.81767     -1715.1008      3751.5158    
       800   323.92546     -44407.819     -530.31176     -4845.2001      3751.5158    
       900   281.73559     -44373.375     -2389.2473     -440.12087      3751.5158    
      1000   313.95305     -44414.515     -2489.126       164.71058      3751.5158    
      1100   281.62169     -44391.749     -5482.5824     -1365.1731      3751.5158    
      1200   305.03026     -44408.873     -6338.1821     -5587.1589      3751.5158    
      1300   306.61834     -44373.1       -13383.269     -2530.382       3751.5158    
      1400   312.45979     -44373.404     -4835.2368      1956.7129      3751.5158    
      1500   304.83811     -44392.172     -2849.2225     -1405.6041      3751.5158    
      1600   304.18673     -44406.143     -3959.2373     -3430.9201      3751.5158    
      1700   287.73076     -44400.573     -3511.1647      194.08079      3751.5158    
      1800   294.13697     -44412.413     -13132         -5751.8902      3751.5158    
      1900   306.76089     -44412.206     -4094.4408     -389.50395      3751.5158    
      2000   306.79918     -44386.247      3517.1123      2241.4762      3751.5158    
Loop time of 57.9718 on 8 procs for 2000 steps with 366 atoms

Performance: 1.490 ns/day, 16.103 hours/ns, 34.500 timesteps/s, 12.627 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 42.775     | 44.698     | 46.437     |  20.7 | 77.10
Bond    | 0.00034156 | 0.00047441 | 0.00054633 |   0.0 |  0.00
Neigh   | 4.9596     | 5.1169     | 5.3073     |   5.3 |  8.83
Comm    | 0.48372    | 2.2265     | 4.1572     |  93.1 |  3.84
Output  | 0.002799   | 0.0035742  | 0.0040897  |   0.8 |  0.01
Modify  | 5.7076     | 5.8921     | 6.0388     |   4.7 | 10.16
Other   |            | 0.03401    |            |       |  0.06

Nlocal:          45.75 ave          54 max          35 min
Histogram: 1 0 1 1 0 2 0 0 1 2
Nghost:           3403 ave        3498 max        3315 min
Histogram: 2 0 2 0 0 0 1 1 0 2
Neighs:          31259 ave       36790 max       24097 min
Histogram: 1 0 1 1 0 2 0 0 0 3

Total # of neighbors = 250072
Ave neighs/atom = 683.25683
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -49.170146556683
variable C2pos equal ${d2}
variable C2pos equal -65.850274328355
variable C3pos equal ${d3}
variable C3pos equal -27.8958398794107
variable C4pos equal ${d4}
variable C4pos equal 9.80205974261945
variable C5pos equal ${d5}
variable C5pos equal -3.78777040158952
variable C6pos equal ${d6}
variable C6pos equal 19.5421233331674

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-10.7104391266297+${C1pos})
variable C16 equal 0.5*(-10.7104391266297+-49.170146556683)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-44.7556322563477+${C2pos})
variable C26 equal 0.5*(-44.7556322563477+-65.850274328355)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-30.5891709768741+${C3pos})
variable C36 equal 0.5*(-30.5891709768741+-27.8958398794107)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(6.74339314839117+${C4pos})
variable C46 equal 0.5*(6.74339314839117+9.80205974261945)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(7.81260947327649+${C5pos})
variable C56 equal 0.5*(7.81260947327649+-3.78777040158952)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(3.51217812082505+${C6pos})
variable C66 equal 0.5*(3.51217812082505+19.5421233331674)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 50.2293598654105
variable C22all equal ${C22}
variable C22all equal 61.4980369499035
variable C33all equal ${C33}
variable C33all equal 115.537147675724

variable C44all equal ${C44}
variable C44all equal 23.2694037988344
variable C55all equal ${C55}
variable C55all equal 10.8336268895077
variable C66all equal ${C66}
variable C66all equal 11.5271507269962

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(0.71103439023575+${C21})
variable C12all equal 0.5*(0.71103439023575+28.6089619477087)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(78.950919913697+${C31})
variable C13all equal 0.5*(78.950919913697+21.5414094961965)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(48.9024896178463+${C32})
variable C23all equal 0.5*(48.9024896178463+51.7224105322273)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-15.5160269836108+${C41})
variable C14all equal 0.5*(-15.5160269836108+5.16009824035742)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(8.98890470564431+${C51})
variable C15all equal 0.5*(8.98890470564431+-4.67557386438142)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-29.9402928416564+${C61})
variable C16all equal 0.5*(-29.9402928416564+-0.702368409065035)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-9.5104363947048+${C42})
variable C24all equal 0.5*(-9.5104363947048+-1.32495245999417)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-25.6390467519862+${C52})
variable C25all equal 0.5*(-25.6390467519862+-0.254355091831581)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-55.3029532923513+${C62})
variable C26all equal 0.5*(-55.3029532923513+-6.90481755816903)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-27.4981285036701+${C43})
variable C34all equal 0.5*(-27.4981285036701+-1.86741219710801)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-9.93948053737578+${C53})
variable C35all equal 0.5*(-9.93948053737578+-10.3012587420377)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-29.2425054281424+${C63})
variable C36all equal 0.5*(-29.2425054281424+7.34531999435903)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(5.43724606356555+${C54})
variable C45all equal 0.5*(5.43724606356555+-2.78004733042366)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(8.27272644550531+${C64})
variable C46all equal 0.5*(8.27272644550531+-2.4687621044811)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(2.01241953584349+${C65})
variable C56all equal 0.5*(2.01241953584349+-6.99990640927432)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:20:32
