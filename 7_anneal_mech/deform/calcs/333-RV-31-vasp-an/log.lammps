LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-RV-31-vasp-an
read_data       ${structure}.data
read_data       333-RV-31-vasp-an.data
Reading data file ...
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  310 atoms
  reading velocities ...
  310 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              276.32109      3826.5298    
         1   300            0              0              276.32109      3826.5298    
Loop time of 4.86676e-05 on 8 procs for 1 steps with 310 atoms

56.2% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.18e-07   | 1.8325e-07 | 2.36e-07   |   0.0 |  0.38
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.26e-07   | 1.1144e-06 | 1.439e-06  |   0.0 |  2.29
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.737e-05  |            |       | 97.33

Nlocal:          38.75 ave          45 max          31 min
Histogram: 1 0 0 1 0 3 1 1 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.2 | 127.5 | 129.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -34547.282      1953.4049      0              1.4789743      3300.9716    
       100   301.962       -34550.917     -11710.962      5499.4575      1.4789743      3300.9716    
       200   276.79876     -34545.379     -700.31155      1905.5742      1.4789743      3300.9716    
       300   294.06343     -34581.233     -1778.7849      2734.083       1.4789743      3300.9716    
       400   270.59575     -34550.326     -1999.843      -902.18907      1.4789743      3300.9716    
       500   301.36397     -34546.408      3256.3855      275.57201      1.4789743      3300.9716    
       600   299.96555     -34548.627     -10441.563     -1697.7154      1.4789743      3300.9716    
       700   281.45358     -34550.894     -4357.2122      1454.7871      1.4789743      3300.9716    
       800   293.99566     -34562.627      11176.126      2126.0088      1.4789743      3300.9716    
       900   317.76491     -34565.689      4401.0981      4291.4911      1.4789743      3300.9716    
      1000   331.02372     -34548.389      2192.9069      3801.0479      1.4789743      3300.9716    
      1100   312.2327      -34545.718     -41.341837      1177.6511      1.4789743      3300.9716    
      1200   319.23523     -34567.708     -2557.9533     -8707.4671      1.4789743      3300.9716    
      1300   300.18823     -34557.733     -3441.5115     -2734.8418      1.4789743      3300.9716    
      1400   302.76031     -34562.673     -4188.3448     -3313.025       1.4789743      3300.9716    
      1500   308.73944     -34568.228     -6137.7851     -1128.197       1.4789743      3300.9716    
      1600   289.04568     -34552.55      -8605.1063      633.2309       1.4789743      3300.9716    
      1700   295.04869     -34558.372     -9849.8701      7560.4371      1.4789743      3300.9716    
      1800   298.58833     -34559.051     -1038.2365     -620.88277      1.4789743      3300.9716    
      1900   305.70948     -34564.454     -1927.3327      1505.923       1.4789743      3300.9716    
      2000   302.12829     -34572.841      7891.6248     -547.38166      1.4789743      3300.9716    
Loop time of 84.1494 on 8 procs for 2000 steps with 310 atoms

Performance: 1.027 ns/day, 23.375 hours/ns, 23.767 timesteps/s, 7.368 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.129     | 53.545     | 70.371     | 129.8 | 63.63
Bond    | 0.00054192 | 0.00066718 | 0.00079048 |   0.0 |  0.00
Neigh   | 4.0817     | 4.577      | 5.9291     |  35.8 |  5.44
Comm    | 0.71291    | 17.53      | 24.94      | 226.6 | 20.83
Output  | 0.0010764  | 0.0011891  | 0.001496   |   0.4 |  0.00
Modify  | 7.0922     | 8.4633     | 8.974      |  26.7 | 10.06
Other   |            | 0.03227    |            |       |  0.04

Nlocal:          38.75 ave          47 max          30 min
Histogram: 1 0 0 1 2 1 1 1 0 1
Nghost:           3291 ave        3341 max        3247 min
Histogram: 2 0 1 1 1 0 1 0 1 1
Neighs:        25583.2 ave       30723 max       20034 min
Histogram: 1 0 0 1 2 1 2 0 0 1

Total # of neighbors = 204666
Ave neighs/atom = 660.2129
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-31-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.4586296523921
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.5434280440749
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.0237234147291

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--547.381660032164)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--547.381660032164)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3484.41126572593)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3484.41126572593)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2891.17264285038)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2891.17264285038)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--435.124411967102)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--435.124411967102)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--2433.85548209761)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--2433.85548209761)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-950.506743302348)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-950.506743302348)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.4586296523921
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.4586296523921
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.154586296523921 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.154586296523921 xy delta 0.0762654169564332 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.154586296523921 xy delta 0.0762654169564332 xz delta 0.0126876619114723 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10456.913     -1273.9501      3299.3211    
       200   289.10893     -34571.506     -2136.6825     -9233.3443      3297.6706    
       300   302.77025     -34551.454     -2763.7873      1934.5084      3296.0202    
       400   314.19401     -34555.69      -785.17236      5652.1965      3294.3697    
       500   282.04943     -34540.523      5783.1735      4143.7072      3292.7192    
       600   285.16671     -34555.247     -1882.0309     -1469.4372      3291.0687    
       700   272.43536     -34557.305      4135.0867      1449.926       3289.4182    
       800   299.71773     -34578.461      9589.4563      4099.1415      3287.7677    
       900   320.0219      -34570.365      521.62752      2975.9779      3286.1172    
      1000   300.8743      -34539.19       5070.1997      164.39294      3284.4668    
      1100   307.90528     -34550.022      1856.7016     -289.37022      3282.8163    
      1200   302.26505     -34572.997     -5822.5262      1201.5708      3281.1658    
      1300   308.28216     -34597.071      218.6804       4871.8931      3279.5153    
      1400   277.1741      -34568.212     -11693.96       1829.9297      3277.8648    
      1500   302.76833     -34582.483     -8814.6833     -2146.9053      3276.2143    
      1600   292.37012     -34559.631      6017.2641     -3560.8073      3274.5638    
      1700   305.17861     -34559.612      1779.4274      2996.5169      3272.9134    
      1800   306.21667     -34554.91      -1481.977      -731.36219      3271.2629    
      1900   304.29301     -34560.157      7289.0981      6099.4693      3269.6124    
      2000   295.17447     -34584.473      3355.5576      2309.6429      3267.9619    
Loop time of 84.7477 on 8 procs for 2000 steps with 310 atoms

Performance: 1.019 ns/day, 23.541 hours/ns, 23.599 timesteps/s, 7.316 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.37      | 53.636     | 70.799     | 131.7 | 63.29
Bond    | 0.00053869 | 0.00067103 | 0.00084323 |   0.0 |  0.00
Neigh   | 4.1211     | 4.6341     | 6.038      |  37.2 |  5.47
Comm    | 0.62308    | 17.78      | 25.042     | 228.5 | 20.98
Output  | 0.0036255  | 0.0043479  | 0.0049603  |   0.7 |  0.01
Modify  | 7.2364     | 8.658      | 9.186      |  27.5 | 10.22
Other   |            | 0.03429    |            |       |  0.04

Nlocal:          38.75 ave          47 max          35 min
Histogram: 2 1 2 1 1 0 0 0 0 1
Nghost:        3293.12 ave        3345 max        3240 min
Histogram: 1 1 1 0 1 1 1 0 0 2
Neighs:        25824.8 ave       31026 max       23436 min
Histogram: 2 1 2 1 1 0 0 0 0 1

Total # of neighbors = 206598
Ave neighs/atom = 666.44516
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 28.9488016804126
variable C2neg equal ${d2}
variable C2neg equal 14.0410655090444
variable C3neg equal ${d3}
variable C3neg equal -49.3829893079849
variable C4neg equal ${d4}
variable C4neg equal -4.25855653148834
variable C5neg equal ${d5}
variable C5neg equal 4.10038479964979
variable C6neg equal ${d6}
variable C6neg equal 10.0725295896578

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.4586296523921
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.154586296523921 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.154586296523921 xy delta -0.0762654169564332 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.154586296523921 xy delta -0.0762654169564332 xz delta -0.0126876619114723 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10446.461     -1272.5026      3302.6221    
       200   287.77882     -34568.753     -2585.2408     -9454.547       3304.2726    
       300   308.01492     -34553.726     -4572.4136      1545.7691      3305.9231    
       400   326.57258     -34565.22       4043.7352      3630.6651      3307.5736    
       500   282.28034     -34539.88      -8085.6383      2235.2495      3309.224     
       600   274.56815     -34544.238      7257.7474     -1322.5465      3310.8745    
       700   277.43658     -34544.263      2526.5038     -873.24447      3312.525     
       800   316.49142     -34543.178      3033.2494      2137.6276      3314.1755    
       900   316.43651     -34539.522      8179.285       1136.1881      3315.826     
      1000   303.79795     -34554.742      5915.4374      3622.2634      3317.4765    
      1100   307.00618     -34573.991     -9459.1934      4335.6006      3319.127     
      1200   293.78805     -34562.545      5429.5327     -2880.2502      3320.7774    
      1300   305.76079     -34553.385      3439.3626     -677.27012      3322.4279    
      1400   321.0153      -34533.843     -1286.5052      566.68974      3324.0784    
      1500   319.1534      -34537.205     -3174.1981     -388.12758      3325.7289    
      1600   297.77748     -34539.251     -1804.3522     -837.99164      3327.3794    
      1700   304.8866      -34558.525      14934.844     -4281.5527      3329.0299    
      1800   295.27982     -34562.419     -10223.658     -4595.0154      3330.6804    
      1900   291.45056     -34559.919     -3436.1885      2146.6524      3332.3308    
      2000   316.17882     -34546.013      1222.844      -919.62276      3333.9813    
Loop time of 83.3585 on 8 procs for 2000 steps with 310 atoms

Performance: 1.036 ns/day, 23.155 hours/ns, 23.993 timesteps/s, 7.438 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.408     | 53.037     | 69.497     | 128.0 | 63.63
Bond    | 0.0005508  | 0.0006498  | 0.00074165 |   0.0 |  0.00
Neigh   | 4.0795     | 4.5822     | 5.9593     |  36.3 |  5.50
Comm    | 0.67313    | 17.125     | 24.752     | 225.1 | 20.54
Output  | 0.0035444  | 0.004268   | 0.0048691  |   0.8 |  0.01
Modify  | 7.1787     | 8.5738     | 9.0913     |  26.9 | 10.29
Other   |            | 0.03463    |            |       |  0.04

Nlocal:          38.75 ave          48 max          31 min
Histogram: 1 1 1 0 1 2 0 1 0 1
Nghost:        3269.25 ave        3329 max        3218 min
Histogram: 2 0 1 1 0 1 1 0 1 1
Neighs:        25303.6 ave       30985 max       20411 min
Histogram: 1 1 1 0 1 1 1 1 0 1

Total # of neighbors = 202429
Ave neighs/atom = 652.99677
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 3.77173292185517
variable C2pos equal ${d2}
variable C2pos equal -13.2096459840865
variable C3pos equal ${d3}
variable C3pos equal 1.75139309807595
variable C4pos equal ${d4}
variable C4pos equal -21.1866500150243
variable C5pos equal ${d5}
variable C5pos equal -14.2730466021636
variable C6pos equal ${d6}
variable C6pos equal -4.04605129192515

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(28.9488016804126+${C1pos})
variable C11 equal 0.5*(28.9488016804126+3.77173292185517)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(14.0410655090444+${C2pos})
variable C21 equal 0.5*(14.0410655090444+-13.2096459840865)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-49.3829893079849+${C3pos})
variable C31 equal 0.5*(-49.3829893079849+1.75139309807595)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-4.25855653148834+${C4pos})
variable C41 equal 0.5*(-4.25855653148834+-21.1866500150243)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(4.10038479964979+${C5pos})
variable C51 equal 0.5*(4.10038479964979+-14.2730466021636)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(10.0725295896578+${C6pos})
variable C61 equal 0.5*(10.0725295896578+-4.04605129192515)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.5434280440749
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.5434280440749
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.125434280440749 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.125434280440749 yz delta -0.00938290713391877 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10456.913     -1273.9501      3299.3211    
       200   289.11368     -34571.382     -1414.6497     -9248.392       3297.6706    
       300   306.75347     -34555.05      -5257.5534      471.56733      3296.0202    
       400   316.46858     -34557.013      4263.8038      5483.0279      3294.3697    
       500   279.1732      -34534.608      4324.8082      6510.5806      3292.7192    
       600   292.06306     -34560.241     -3143.6915     -2005.9372      3291.0687    
       700   271.74464     -34551.455      784.35219     -458.7477       3289.4182    
       800   295.23214     -34560.359      3490.3159      739.18572      3287.7677    
       900   316.24505     -34557.577     -6829.3126      2897.4206      3286.1172    
      1000   316.11329     -34552.297      8596.8982      2902.3102      3284.4668    
      1100   306.44371     -34571.027      6321.1394     -1979.5328      3282.8163    
      1200   307.75066     -34586.486      3162.0089     -319.33304      3281.1658    
      1300   295.31557     -34567.695      7128.3074      2465.9159      3279.5153    
      1400   309.60474     -34567.815     -1106.6164      4769.307       3277.8648    
      1500   310.54692     -34559.657      354.50789     -8038.6713      3276.2143    
      1600   320.07919     -34549.203     -8949.016      -4196.0482      3274.5638    
      1700   323.43421     -34558.91       4402.1671      4684.6156      3272.9134    
      1800   298.42031     -34562.884      1894.5343     -2364.5843      3271.2629    
      1900   299.82783     -34580.583     -4675.1944     -292.01456      3269.6124    
      2000   281.17304     -34560.187     -4051.1382     -5508.4157      3267.9619    
Loop time of 84.9242 on 8 procs for 2000 steps with 310 atoms

Performance: 1.017 ns/day, 23.590 hours/ns, 23.550 timesteps/s, 7.301 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.281     | 53.873     | 70.88      | 131.4 | 63.44
Bond    | 0.00050068 | 0.00062216 | 0.00082277 |   0.0 |  0.00
Neigh   | 4.1229     | 4.6315     | 6.0271     |  36.5 |  5.45
Comm    | 0.707      | 17.708     | 25.295     | 229.0 | 20.85
Output  | 0.0034437  | 0.0041073  | 0.0046652  |   0.7 |  0.00
Modify  | 7.2589     | 8.6727     | 9.1968     |  27.0 | 10.21
Other   |            | 0.03488    |            |       |  0.04

Nlocal:          38.75 ave          49 max          33 min
Histogram: 1 0 3 2 1 0 0 0 0 1
Nghost:        3308.62 ave        3366 max        3258 min
Histogram: 2 2 0 0 0 0 1 1 0 2
Neighs:        25808.1 ave       32190 max       22217 min
Histogram: 1 0 3 2 1 0 0 0 0 1

Total # of neighbors = 206465
Ave neighs/atom = 666.01613
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -50.2676770434315
variable C2neg equal ${d2}
variable C2neg equal 50.3771635077619
variable C3neg equal ${d3}
variable C3neg equal -24.0306404447278
variable C4neg equal ${d4}
variable C4neg equal -11.7015665053278
variable C5neg equal ${d5}
variable C5neg equal 12.3695277092782
variable C6neg equal ${d6}
variable C6neg equal 7.00855737186126

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.5434280440749
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.125434280440749 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.125434280440749 yz delta 0.00938290713391877 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10446.461     -1272.5026      3302.6221    
       200   287.43182     -34568.509     -2630.1734     -9395.7469      3304.2726    
       300   309.68029     -34555.845     -5801.5595      521.08108      3305.9231    
       400   315.80584     -34555.597      3745.7075      5741.6348      3307.5736    
       500   291.137       -34545.942      1221.9702      1396.8335      3309.224     
       600   275.60672     -34542.986     -5882.6388     -4055.9494      3310.8745    
       700   287.48057     -34570.317     -12206.389     -5714.4304      3312.525     
       800   288.85599     -34585.528     -4275.5639      2059.786       3314.1755    
       900   290.72062     -34571.889      12037.28       529.12181      3315.826     
      1000   308.46431     -34561.869      1963.3939      512.02808      3317.4765    
      1100   300.86001     -34546.066     -2031.4701     -461.55246      3319.127     
      1200   319.77117     -34558.775      8921.8616      546.848        3320.7774    
      1300   316.63405     -34566.89      -12551.823     -770.97771      3322.4279    
      1400   283.87597     -34570.725      6442.9819      2291.1724      3324.0784    
      1500   280.52794     -34565.773     -6084.1241     -335.12573      3325.7289    
      1600   296.19901     -34557.028     -5298.9631     -6466.9193      3327.3794    
      1700   306.71982     -34554.835     -2403.5873     -4955.9062      3329.0299    
      1800   302.66364     -34548.044      10004.999      412.58309      3330.6804    
      1900   279.92473     -34526.392      3358.8141     -645.77951      3332.3308    
      2000   303.7985      -34527.595      165.35108     -634.76643      3333.9813    
Loop time of 84.3956 on 8 procs for 2000 steps with 310 atoms

Performance: 1.024 ns/day, 23.443 hours/ns, 23.698 timesteps/s, 7.346 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.073     | 53.349     | 70.565     | 132.9 | 63.21
Bond    | 0.00053561 | 0.00063876 | 0.0007455  |   0.0 |  0.00
Neigh   | 4.064      | 4.5719     | 5.9288     |  36.6 |  5.42
Comm    | 0.67684    | 17.884     | 25.158     | 229.4 | 21.19
Output  | 0.0035853  | 0.0043166  | 0.0049209  |   0.7 |  0.01
Modify  | 7.181      | 8.5515     | 9.079      |  27.1 | 10.13
Other   |            | 0.03431    |            |       |  0.04

Nlocal:          38.75 ave          46 max          31 min
Histogram: 1 0 1 0 2 1 1 1 0 1
Nghost:        3232.75 ave        3291 max        3176 min
Histogram: 1 2 1 0 0 0 1 0 1 2
Neighs:        25289.9 ave       29741 max       20458 min
Histogram: 1 0 1 0 2 1 1 1 0 1

Total # of neighbors = 202319
Ave neighs/atom = 652.64194
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 0.885426138825765
variable C2pos equal ${d2}
variable C2pos equal -46.7331326094454
variable C3pos equal ${d3}
variable C3pos equal -1.55724435208106
variable C4pos equal ${d4}
variable C4pos equal 3.1072620518507
variable C5pos equal ${d5}
variable C5pos equal 10.2139827723015
variable C6pos equal ${d6}
variable C6pos equal -4.81731731416716

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-50.2676770434315+${C1pos})
variable C12 equal 0.5*(-50.2676770434315+0.885426138825765)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(50.3771635077619+${C2pos})
variable C22 equal 0.5*(50.3771635077619+-46.7331326094454)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-24.0306404447278+${C3pos})
variable C32 equal 0.5*(-24.0306404447278+-1.55724435208106)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-11.7015665053278+${C4pos})
variable C42 equal 0.5*(-11.7015665053278+3.1072620518507)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(12.3695277092782+${C5pos})
variable C52 equal 0.5*(12.3695277092782+10.2139827723015)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(7.00855737186126+${C6pos})
variable C62 equal 0.5*(7.00855737186126+-4.81731731416716)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0237234147291
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0237234147291
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.170237234147291 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10456.913     -1273.9501      3299.3211    
       200   286.23268     -34568.359     -684.56926     -9082.6343      3297.6706    
       300   304.83236     -34553.3       -4435.2901      1451.926       3296.0202    
       400   326.92734     -34566.613      5581.6223      5214.5795      3294.3697    
       500   273.30213     -34531.873     -159.08507      3968.8915      3292.7192    
       600   281.40478     -34549.545     -9026.1194     -373.94155      3291.0687    
       700   273.04988     -34537.829      8046.3127     -1092.0954      3289.4182    
       800   308.57312     -34539.245      11680.295      5318.3897      3287.7677    
       900   313.53389     -34536.835     -6447.2445      76.450864      3286.1172    
      1000   299.20955     -34551.353     -398.9274      -316.96901      3284.4668    
      1100   296.40178     -34565.561     -9677.9333      1496.8701      3282.8163    
      1200   281.6702      -34547.335      7574.5455      5192.1167      3281.1658    
      1300   309.62272     -34553.449      7738.5365      1895.4273      3279.5153    
      1400   326.14537     -34557.497      1202.0186      2121.1697      3277.8648    
      1500   307.35585     -34551.533      3087.5287     -12.690323      3276.2143    
      1600   293.20647     -34561.512     -17467.242     -8873.1788      3274.5638    
      1700   291.26221     -34561.089     -3555.4557      1985.9295      3272.9134    
      1800   310.26438     -34550.647      18351.405      2221.9635      3271.2629    
      1900   313.14126     -34543.851      1039.7678      28.009725      3269.6124    
      2000   318.02507     -34548.98       7066.8785      2343.7211      3267.9619    
Loop time of 85.8781 on 8 procs for 2000 steps with 310 atoms

Performance: 1.006 ns/day, 23.855 hours/ns, 23.289 timesteps/s, 7.220 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.591     | 54.521     | 71.989     | 134.1 | 63.49
Bond    | 0.00050195 | 0.00064478 | 0.00075294 |   0.0 |  0.00
Neigh   | 4.1118     | 4.6176     | 5.9788     |  36.4 |  5.38
Comm    | 0.70433    | 18.162     | 25.087     | 232.3 | 21.15
Output  | 0.0035097  | 0.0042256  | 0.0048097  |   0.8 |  0.00
Modify  | 7.1615     | 8.5391     | 9.0627     |  27.1 |  9.94
Other   |            | 0.03386    |            |       |  0.04

Nlocal:          38.75 ave          43 max          32 min
Histogram: 1 0 0 0 2 1 1 0 1 2
Nghost:        3306.38 ave        3363 max        3250 min
Histogram: 1 1 0 1 1 1 1 1 0 1
Neighs:        25846.6 ave       28684 max       21519 min
Histogram: 1 0 0 0 2 1 1 0 1 2

Total # of neighbors = 206773
Ave neighs/atom = 667.00968
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 29.2940982677218
variable C2neg equal ${d2}
variable C2neg equal 39.6901628542986
variable C3neg equal ${d3}
variable C3neg equal 31.0679167290823
variable C4neg equal ${d4}
variable C4neg equal 10.7457404259979
variable C5neg equal ${d5}
variable C5neg equal -0.545539147337912
variable C6neg equal ${d6}
variable C6neg equal 19.3088401171204

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0237234147291
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.170237234147291 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10446.461     -1272.5026      3302.6221    
       200   290.03966     -34571.338     -3833.2317     -9318.6252      3304.2726    
       300   304.213       -34551.074     -4414.0385      1398.9982      3305.9231    
       400   313.2193      -34552.659      6401.6632      4045.8014      3307.5736    
       500   289.88068     -34544.588     -8239.621       1275.6743      3309.224     
       600   282.96343     -34551.289      232.69769     -2565.8001      3310.8745    
       700   280.28051     -34545.147     -6464.6946     -493.85145      3312.525     
       800   323.47702     -34553.421      1277.8528     -424.15374      3314.1755    
       900   325.04116     -34543.707      78.427155      2442.2466      3315.826     
      1000   309.97189     -34557.555      152.53638     -656.48808      3317.4765    
      1100   293.472       -34560.192     -12075.703     -6315.5018      3319.127     
      1200   304.23313     -34572.973      7327.4273      1022.402       3320.7774    
      1300   293.817       -34557.749      2244.7536      742.84024      3322.4279    
      1400   320.35081     -34556.774     -15051.972     -1696.1823      3324.0784    
      1500   283.71298     -34512.316      3496.3219     -2768.3972      3325.7289    
      1600   301.47916     -34550.386     -22114.616     -11426.85       3327.3794    
      1700   308.98894     -34579.672     -2507.3015     -4760.6782      3329.0299    
      1800   286.35375     -34556.304      15101.866     -4249.5007      3330.6804    
      1900   292.77461     -34552.829     -8345.5186     -4193.4812      3332.3308    
      2000   305.58684     -34555.237      7611.8872     -2153.869       3333.9813    
Loop time of 84.608 on 8 procs for 2000 steps with 310 atoms

Performance: 1.021 ns/day, 23.502 hours/ns, 23.638 timesteps/s, 7.328 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.493     | 53.396     | 70.683     | 134.0 | 63.11
Bond    | 0.00055719 | 0.00067203 | 0.00079057 |   0.0 |  0.00
Neigh   | 4.0781     | 4.5911     | 5.9804     |  36.8 |  5.43
Comm    | 0.68157    | 17.959     | 24.859     | 230.9 | 21.23
Output  | 0.0035128  | 0.0042435  | 0.00484    |   0.8 |  0.01
Modify  | 7.2178     | 8.6234     | 9.1535     |  27.1 | 10.19
Other   |            | 0.03376    |            |       |  0.04

Nlocal:          38.75 ave          48 max          33 min
Histogram: 1 1 1 1 2 1 0 0 0 1
Nghost:        3251.12 ave        3311 max        3200 min
Histogram: 2 0 2 0 0 0 2 0 0 2
Neighs:        25304.4 ave       31022 max       21773 min
Histogram: 1 1 1 1 2 1 0 0 0 1

Total # of neighbors = 202435
Ave neighs/atom = 653.01613
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 16.2777330965889
variable C2pos equal ${d2}
variable C2pos equal -23.3489313535032
variable C3pos equal ${d3}
variable C3pos equal 92.7083544782118
variable C4pos equal ${d4}
variable C4pos equal 27.4928544445027
variable C5pos equal ${d5}
variable C5pos equal -14.0040601126773
variable C6pos equal ${d6}
variable C6pos equal -17.7453299949218

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(29.2940982677218+${C1pos})
variable C13 equal 0.5*(29.2940982677218+16.2777330965889)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(39.6901628542986+${C2pos})
variable C23 equal 0.5*(39.6901628542986+-23.3489313535032)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(31.0679167290823+${C3pos})
variable C33 equal 0.5*(31.0679167290823+92.7083544782118)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(10.7457404259979+${C4pos})
variable C43 equal 0.5*(10.7457404259979+27.4928544445027)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-0.545539147337912+${C5pos})
variable C53 equal 0.5*(-0.545539147337912+-14.0040601126773)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(19.3088401171204+${C6pos})
variable C63 equal 0.5*(19.3088401171204+-17.7453299949218)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0237234147291
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0237234147291
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.170237234147291 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10451.684     -1273.226       3300.9716    
       200   284.75553     -34566.696     -1690.9153     -9712.8254      3300.9716    
       300   304.31166     -34552.246     -7326.6442      18.306612      3300.9716    
       400   315.84531     -34556.848     -642.36439      4502.0354      3300.9716    
       500   284.10675     -34542.295     -4492.1551      5213.0534      3300.9716    
       600   269.80174     -34539.117      1834.3558      628.88584      3300.9716    
       700   282.06405     -34539.755      1429.2484     -3598.4665      3300.9716    
       800   312.10785     -34534.314      12965.835     -1842.8921      3300.9716    
       900   317.47002     -34541.168      6666.2548      2749.7436      3300.9716    
      1000   295.30078     -34549.013      11351.545     -1858.7823      3300.9716    
      1100   288.76575     -34555.118      7398.3149     -202.13098      3300.9716    
      1200   307.48782     -34574.893     -5203.6217      5904.7109      3300.9716    
      1300   276.72287     -34545.301      3516.2453      3795.1276      3300.9716    
      1400   296.91079     -34541.606     -8399.2125     -3331.9316      3300.9716    
      1500   334.92742     -34562.831      7355.7158     -402.16513      3300.9716    
      1600   296.35909     -34547.67      -12780.25      -6565.8961      3300.9716    
      1700   294.13582     -34563.379     -9433.7684     -1722.389       3300.9716    
      1800   305.74869     -34579.112      1126.6536     -2097.8215      3300.9716    
      1900   293.70803     -34562.23       1538.3974      3258.3273      3300.9716    
      2000   288.90129     -34550.327     -6950.3407      2065.4918      3300.9716    
Loop time of 85.2774 on 8 procs for 2000 steps with 310 atoms

Performance: 1.013 ns/day, 23.688 hours/ns, 23.453 timesteps/s, 7.270 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.94      | 53.972     | 71.407     | 134.4 | 63.29
Bond    | 0.0005334  | 0.0006579  | 0.00084628 |   0.0 |  0.00
Neigh   | 4.0718     | 4.5988     | 5.9877     |  36.7 |  5.39
Comm    | 0.70792    | 18.135     | 25.164     | 231.7 | 21.27
Output  | 0.0036146  | 0.0042534  | 0.004813   |   0.7 |  0.00
Modify  | 7.1238     | 8.5316     | 9.0752     |  27.3 | 10.00
Other   |            | 0.0346     |            |       |  0.04

Nlocal:          38.75 ave          46 max          31 min
Histogram: 1 0 0 1 1 3 0 0 1 1
Nghost:        3279.38 ave        3330 max        3229 min
Histogram: 3 1 0 0 0 0 0 0 1 3
Neighs:        25547.6 ave       30019 max       20712 min
Histogram: 1 0 0 1 1 3 0 1 0 1

Total # of neighbors = 204381
Ave neighs/atom = 659.29355
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 26.4749399944126
variable C2neg equal ${d2}
variable C2neg equal -48.5534745593423
variable C3neg equal ${d3}
variable C3neg equal -78.5422304136651
variable C4neg equal ${d4}
variable C4neg equal 11.8994346521195
variable C5neg equal ${d5}
variable C5neg equal 2.48900723554494
variable C6neg equal ${d6}
variable C6neg equal 8.62393492312655

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0237234147291
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.170237234147291 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10451.684     -1273.226       3300.9716    
       200   289.50241     -34571.143     -3602.0701     -9270.9691      3300.9716    
       300   306.48847     -34553.788     -932.65787      1956.4357      3300.9716    
       400   315.4404      -34555.267      1462.2264      5278.2335      3300.9716    
       500   282.43609     -34538.209     -7109.4146      1903.5648      3300.9716    
       600   290.43135     -34559.334     -13362.173     -2761.5937      3300.9716    
       700   274.84559     -34550.356      9078.387       738.04228      3300.9716    
       800   287.35796     -34553.767      10024.381      1349.4979      3300.9716    
       900   305.16158     -34553.483     -4348.8727      1898.3782      3300.9716    
      1000   321.1131      -34555.029     -6185.0946      2887.6232      3300.9716    
      1100   308.55404     -34550.173     -5955.7395     -1659.4111      3300.9716    
      1200   289.71393     -34564.185      3637.7422     -3482.2205      3300.9716    
      1300   275.16061     -34556.025     -585.26461      4105.9071      3300.9716    
      1400   291.77116     -34557.361     -8436.3275      1935.1727      3300.9716    
      1500   294.44847     -34546.95       10811.867     -3249.6772      3300.9716    
      1600   290.28454     -34541.08       1441.8245     -7802.2357      3300.9716    
      1700   285.12269     -34533.001     -15624.77       3358.4911      3300.9716    
      1800   298.26372     -34545.7        3752.7506      272.14033      3300.9716    
      1900   281.64451     -34556.095      1956.5815      697.69145      3300.9716    
      2000   254.7876      -34549.633     -6309.7611      3379.5274      3300.9716    
Loop time of 84.9837 on 8 procs for 2000 steps with 310 atoms

Performance: 1.017 ns/day, 23.607 hours/ns, 23.534 timesteps/s, 7.296 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.637     | 53.73      | 70.96      | 134.2 | 63.22
Bond    | 0.00050563 | 0.00065233 | 0.00081398 |   0.0 |  0.00
Neigh   | 4.1048     | 4.619      | 5.9996     |  37.1 |  5.44
Comm    | 0.76031    | 17.981     | 25.07      | 231.8 | 21.16
Output  | 0.0034388  | 0.0043676  | 0.0050353  |   1.0 |  0.01
Modify  | 7.2177     | 8.6142     | 9.1454     |  27.5 | 10.14
Other   |            | 0.03467    |            |       |  0.04

Nlocal:          38.75 ave          44 max          36 min
Histogram: 1 1 3 1 0 1 0 0 0 1
Nghost:        3262.25 ave        3301 max        3225 min
Histogram: 3 1 0 0 0 0 0 0 2 2
Neighs:        25548.8 ave       28754 max       23902 min
Histogram: 2 0 3 1 1 0 0 0 0 1

Total # of neighbors = 204390
Ave neighs/atom = 659.32258
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -39.7894064395936
variable C2pos equal ${d2}
variable C2pos equal -19.3072143342036
variable C3pos equal ${d3}
variable C3pos equal -12.990005145812
variable C4pos equal ${d4}
variable C4pos equal -0.66622588764106
variable C5pos equal ${d5}
variable C5pos equal 1.42038814736665
variable C6pos equal ${d6}
variable C6pos equal -15.4038717790511

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(26.4749399944126+${C1pos})
variable C14 equal 0.5*(26.4749399944126+-39.7894064395936)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-48.5534745593423+${C2pos})
variable C24 equal 0.5*(-48.5534745593423+-19.3072143342036)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-78.5422304136651+${C3pos})
variable C34 equal 0.5*(-78.5422304136651+-12.990005145812)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(11.8994346521195+${C4pos})
variable C44 equal 0.5*(11.8994346521195+-0.66622588764106)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(2.48900723554494+${C5pos})
variable C54 equal 0.5*(2.48900723554494+1.42038814736665)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(8.62393492312655+${C6pos})
variable C64 equal 0.5*(8.62393492312655+-15.4038717790511)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0237234147291
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0237234147291
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.170237234147291 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10451.684     -1273.226       3300.9716    
       200   288.16811     -34569.806     -1826.7663     -9298.3856      3300.9716    
       300   308.22631     -34555.203     -3353.6303      2233.8082      3300.9716    
       400   319.66938     -34560.191      4271.2018      4900.8019      3300.9716    
       500   292.06051     -34549.392     -2720.3962      386.00003      3300.9716    
       600   274.82513     -34543.658     -3520.3643     -908.64478      3300.9716    
       700   281.16769     -34558.441     -1063.8861     -3862.0057      3300.9716    
       800   291.64791     -34577.799     -7326.8844      1457.6108      3300.9716    
       900   297.11121     -34566.615      7698.1622      5104.3676      3300.9716    
      1000   317.27524     -34563.214     -7772.0442      769.86276      3300.9716    
      1100   322.36914     -34556.696     -2254.3734     -1251.588       3300.9716    
      1200   310.2216      -34555.404      7107.8637      6921.3063      3300.9716    
      1300   292.31002     -34577.976     -255.02507     -786.08027      3300.9716    
      1400   286.32075     -34572.059     -2334.2148     -1207.5819      3300.9716    
      1500   291.37684     -34562.926      7487.4955     -588.67034      3300.9716    
      1600   304.52493     -34551.353     -9567.3341     -5321.9141      3300.9716    
      1700   321.32452     -34559.331     -3586.1393      4079.8396      3300.9716    
      1800   299.5034      -34551.762     -13622.733     -8611.9103      3300.9716    
      1900   301.05362     -34560.146      14094.886     -867.68573      3300.9716    
      2000   302.47914     -34562.255     -5778.2738     -3904.3462      3300.9716    
Loop time of 86.4473 on 8 procs for 2000 steps with 310 atoms

Performance: 0.999 ns/day, 24.013 hours/ns, 23.135 timesteps/s, 7.172 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.727     | 55.241     | 71.509     | 133.9 | 63.90
Bond    | 0.00048989 | 0.00065945 | 0.00091641 |   0.0 |  0.00
Neigh   | 4.0993     | 4.7536     | 6.1108     |  37.5 |  5.50
Comm    | 1.0821     | 17.333     | 26.84      | 238.8 | 20.05
Output  | 0.0038625  | 0.0044954  | 0.0050756  |   0.7 |  0.01
Modify  | 7.6931     | 9.0778     | 9.7599     |  27.6 | 10.50
Other   |            | 0.03676    |            |       |  0.04

Nlocal:          38.75 ave          46 max          29 min
Histogram: 1 0 0 0 0 5 1 0 0 1
Nghost:        3264.12 ave        3308 max        3227 min
Histogram: 1 1 1 1 0 2 0 0 0 2
Neighs:        25549.9 ave       30077 max       19357 min
Histogram: 1 0 0 0 0 3 3 0 0 1

Total # of neighbors = 204399
Ave neighs/atom = 659.35161
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -34.0144427743207
variable C2neg equal ${d2}
variable C2neg equal -37.9863416830117
variable C3neg equal ${d3}
variable C3neg equal -25.9667555443848
variable C4neg equal ${d4}
variable C4neg equal -1.32087927556417
variable C5neg equal ${d5}
variable C5neg equal 19.847275475042
variable C6neg equal ${d6}
variable C6neg equal 16.1009226917807

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0237234147291
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.170237234147291 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10451.684     -1273.226       3300.9716    
       200   288.888       -34570.635     -3032.447      -9391.7568      3300.9716    
       300   306.83223     -34553.888     -6973.4448      751.74449      3300.9716    
       400   311.60088     -34551.586     -638.65421      4821.8934      3300.9716    
       500   283.18399     -34540.045      6937.9679      4263.4827      3300.9716    
       600   283.38445     -34550.57      -2566.1177     -712.08924      3300.9716    
       700   287.55253     -34549.568     -2205.0754     -1580.4217      3300.9716    
       800   328.90027     -34560.272     -447.83708      2690.2612      3300.9716    
       900   329.73629     -34557.446     -22470.73      -2285.0111      3300.9716    
      1000   293.15431     -34549.144     -644.02648      7480.2956      3300.9716    
      1100   292.64582     -34563.525      8113.0617      1571.9623      3300.9716    
      1200   293.31802     -34557.586     -5554.1458      1543.3963      3300.9716    
      1300   320.04192     -34565.189      10890.712      1712.7443      3300.9716    
      1400   300.11762     -34540.849     -4333.7513      1153.2879      3300.9716    
      1500   318.02075     -34565.822     -11142.173     -1688.2815      3300.9716    
      1600   286.20615     -34559.115     -13495.741     -11138.404      3300.9716    
      1700   294.12892     -34576.91      -34.969534     -747.33366      3300.9716    
      1800   287.8318      -34569.241      3264.6294      465.81944      3300.9716    
      1900   293.37179     -34547.058      7977.8609      4348.1763      3300.9716    
      2000   290.12839     -34530.22      -3966.4206     -2300.3725      3300.9716    
Loop time of 88.7456 on 8 procs for 2000 steps with 310 atoms

Performance: 0.974 ns/day, 24.652 hours/ns, 22.536 timesteps/s, 6.986 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.175     | 57.223     | 73.377     | 155.1 | 64.48
Bond    | 0.00051578 | 0.00064939 | 0.00090721 |   0.0 |  0.00
Neigh   | 4.1047     | 4.8857     | 6.3172     |  42.9 |  5.51
Comm    | 0.77882    | 16.906     | 27.944     | 284.9 | 19.05
Output  | 0.003712   | 0.004361   | 0.0049266  |   0.7 |  0.00
Modify  | 8.2193     | 9.6877     | 10.494     |  31.2 | 10.92
Other   |            | 0.03866    |            |       |  0.04

Nlocal:          38.75 ave          47 max          31 min
Histogram: 1 0 0 2 1 2 1 0 0 1
Nghost:        3285.75 ave        3350 max        3219 min
Histogram: 1 1 0 2 0 1 0 0 2 1
Neighs:        25547.4 ave       30670 max       20642 min
Histogram: 1 0 0 2 1 2 1 0 0 1

Total # of neighbors = 204379
Ave neighs/atom = 659.2871
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 17.762179204742
variable C2pos equal ${d2}
variable C2pos equal 20.2625696142631
variable C3pos equal ${d3}
variable C3pos equal 49.9883782276061
variable C4pos equal ${d4}
variable C4pos equal -8.49622734731238
variable C5pos equal ${d5}
variable C5pos equal -21.289735307137
variable C6pos equal ${d6}
variable C6pos equal -3.11176874654422

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-34.0144427743207+${C1pos})
variable C15 equal 0.5*(-34.0144427743207+17.762179204742)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-37.9863416830117+${C2pos})
variable C25 equal 0.5*(-37.9863416830117+20.2625696142631)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-25.9667555443848+${C3pos})
variable C35 equal 0.5*(-25.9667555443848+49.9883782276061)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-1.32087927556417+${C4pos})
variable C45 equal 0.5*(-1.32087927556417+-8.49622734731238)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(19.847275475042+${C5pos})
variable C55 equal 0.5*(19.847275475042+-21.289735307137)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(16.1009226917807+${C6pos})
variable C65 equal 0.5*(16.1009226917807+-3.11176874654422)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.5434280440749

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.5434280440749
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.125434280440749 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10451.684     -1273.226       3300.9716    
       200   288.94989     -34570.738     -2485.8817     -9312.9284      3300.9716    
       300   311.36538     -34558.27      -4059.2257      1286.3214      3300.9716    
       400   310.52058     -34550.843      3647.4193      3601.6544      3300.9716    
       500   283.31625     -34540.012     -3399.2887      3182.0035      3300.9716    
       600   282.6593      -34551.104     -5324.6111     -3775.9822      3300.9716    
       700   277.39341     -34548.356     -4433.2325      4226.0458      3300.9716    
       800   305.19932     -34560.014     -3820.0004      2325.0239      3300.9716    
       900   308.87329     -34546.139      2801.8102      2536.0611      3300.9716    
      1000   322.15409     -34566.642      2785.7501      531.02387      3300.9716    
      1100   297.95321     -34568.742     -21794.828      3127.6328      3300.9716    
      1200   282.71013     -34562.659      4330.2566      1706.5284      3300.9716    
      1300   301.09891     -34570.16       5937.3678      2049.4349      3300.9716    
      1400   336.08324     -34563.318     -12497.889     -4565.0368      3300.9716    
      1500   309.2933      -34530.944     -15872.064     -2038.2529      3300.9716    
      1600   298.38181     -34530.149     -3765.7335     -7089.2202      3300.9716    
      1700   308.21713     -34554.187     -1376.1289     -3332.6557      3300.9716    
      1800   286.49916     -34542.852     -2325.2604     -313.27102      3300.9716    
      1900   297.65958     -34547.215     -7471.0126     -1988.0611      3300.9716    
      2000   309.85463     -34536.382      15301.203     -1064.1339      3300.9716    
Loop time of 89.7093 on 8 procs for 2000 steps with 310 atoms

Performance: 0.963 ns/day, 24.919 hours/ns, 22.294 timesteps/s, 6.911 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.058     | 57.781     | 74.199     | 155.9 | 64.41
Bond    | 0.00050294 | 0.00065884 | 0.00091112 |   0.0 |  0.00
Neigh   | 4.1101     | 4.9668     | 6.529      |  45.7 |  5.54
Comm    | 0.76884    | 17.177     | 27.886     | 285.7 | 19.15
Output  | 0.0038321  | 0.0045054  | 0.0051238  |   0.7 |  0.01
Modify  | 8.1573     | 9.7426     | 10.634     |  33.2 | 10.86
Other   |            | 0.03753    |            |       |  0.04

Nlocal:          38.75 ave          44 max          33 min
Histogram: 1 2 0 1 0 0 0 1 1 2
Nghost:        3305.38 ave        3353 max        3253 min
Histogram: 2 0 0 2 0 0 0 2 1 1
Neighs:        25565.2 ave       28842 max       22007 min
Histogram: 1 2 0 1 0 0 0 1 1 2

Total # of neighbors = 204522
Ave neighs/atom = 659.74839
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -5.2359916583589
variable C2neg equal ${d2}
variable C2neg equal 14.0370997719864
variable C3neg equal ${d3}
variable C3neg equal -11.8711401288738
variable C4neg equal ${d4}
variable C4neg equal -9.87453945274504
variable C5neg equal ${d5}
variable C5neg equal 1.07367522945871
variable C6neg equal ${d6}
variable C6neg equal 15.6201702758857

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.023614826 0.098835978 0.23983829) to (15.435015 12.642264 17.263562) with tilt (-7.6265417 -1.2687662 0.93829071)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.5434280440749
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.125434280440749 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 128 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.12829     -34572.841      7891.6001      0              3300.9716    
       100   293.91209     -34578.753     -10451.684     -1273.226       3300.9716    
       200   287.77103     -34569.4       -2680.1078     -9417.6754      3300.9716    
       300   301.25413     -34549.142     -6007.0895      726.55073      3300.9716    
       400   322.10336     -34562.704      4662.7018      5423.4976      3300.9716    
       500   275.99005     -34533.529     -5713.2404      1317.154       3300.9716    
       600   278.27604     -34545.715     -7319.5011     -1628.9797      3300.9716    
       700   285.80127     -34553.499     -2502.4279     -1898.5187      3300.9716    
       800   308.33266     -34556.157      6170.5155      173.86727      3300.9716    
       900   299.1772      -34532.771      7115.6409      5269.0551      3300.9716    
      1000   289.63624     -34537.055      9487.975       1372.0172      3300.9716    
      1100   312.06572     -34580.779      11087.402     -5877.1229      3300.9716    
      1200   291.76584     -34571.364     -513.45021      2924.7796      3300.9716    
      1300   284.99585     -34557.92      -1920.4992      1304.2719      3300.9716    
      1400   302.24875     -34564.015      7122.2688     -48.689699      3300.9716    
      1500   318.45937     -34575.78      -4902.121      -2727.8884      3300.9716    
      1600   290.33396     -34554.8       -15838.804     -5934.3437      3300.9716    
      1700   300.96565     -34567.97      -5402.5041     -2145.2445      3300.9716    
      1800   299.88288     -34555.922     -1223.9634      723.71358      3300.9716    
      1900   306.83732     -34544.857      5348.6554      4318.4266      3300.9716    
      2000   305.81584     -34542.237      2468.7829      1286.6623      3300.9716    
Loop time of 88.768 on 8 procs for 2000 steps with 310 atoms

Performance: 0.973 ns/day, 24.658 hours/ns, 22.531 timesteps/s, 6.985 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.11      | 57.21      | 73.337     | 156.7 | 64.45
Bond    | 0.00051768 | 0.00064703 | 0.0009404  |   0.0 |  0.00
Neigh   | 4.0917     | 4.8784     | 6.2866     |  42.8 |  5.50
Comm    | 0.90388    | 17.006     | 28.094     | 287.0 | 19.16
Output  | 0.0037604  | 0.004417   | 0.0049891  |   0.7 |  0.00
Modify  | 8.1856     | 9.6303     | 10.457     |  31.2 | 10.85
Other   |            | 0.0385     |            |       |  0.04

Nlocal:          38.75 ave          47 max          32 min
Histogram: 1 0 1 1 1 3 0 0 0 1
Nghost:         3259.5 ave        3301 max        3220 min
Histogram: 3 0 1 0 0 0 0 2 1 1
Neighs:        25553.8 ave       30698 max       21326 min
Histogram: 1 0 1 1 1 3 0 0 0 1

Total # of neighbors = 204430
Ave neighs/atom = 659.45161
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -18.5834508671271
variable C2pos equal ${d2}
variable C2pos equal -13.6887121549091
variable C3pos equal ${d3}
variable C3pos equal 3.38363168893698
variable C4pos equal ${d4}
variable C4pos equal -9.70297720330271
variable C5pos equal ${d5}
variable C5pos equal -8.32854305814915
variable C6pos equal ${d6}
variable C6pos equal -4.91994154219546

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-5.2359916583589+${C1pos})
variable C16 equal 0.5*(-5.2359916583589+-18.5834508671271)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(14.0370997719864+${C2pos})
variable C26 equal 0.5*(14.0370997719864+-13.6887121549091)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-11.8711401288738+${C3pos})
variable C36 equal 0.5*(-11.8711401288738+3.38363168893698)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-9.87453945274504+${C4pos})
variable C46 equal 0.5*(-9.87453945274504+-9.70297720330271)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(1.07367522945871+${C5pos})
variable C56 equal 0.5*(1.07367522945871+-8.32854305814915)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(15.6201702758857+${C6pos})
variable C66 equal 0.5*(15.6201702758857+-4.91994154219546)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 16.3602673011339
variable C22all equal ${C22}
variable C22all equal 1.82201544915825
variable C33all equal ${C33}
variable C33all equal 61.8881356036471

variable C44all equal ${C44}
variable C44all equal 5.61660438223922
variable C55all equal ${C55}
variable C55all equal -0.7212299160475
variable C66all equal ${C66}
variable C66all equal 5.35011436684512

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-24.6911254523029+${C21})
variable C12all equal 0.5*(-24.6911254523029+0.41570976247895)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(22.7859156821553+${C31})
variable C13all equal 0.5*(22.7859156821553+-23.8157981049545)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(8.1706157503977+${C32})
variable C23all equal 0.5*(8.1706157503977+-12.7939423984044)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-6.6572332225905+${C41})
variable C14all equal 0.5*(-6.6572332225905+-12.7226032732563)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-8.12613178478935+${C51})
variable C15all equal 0.5*(-8.12613178478935+-5.0863309012569)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-11.909721262743+${C61})
variable C16all equal 0.5*(-11.909721262743+3.01323914886632)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-33.9303444467729+${C42})
variable C24all equal 0.5*(-33.9303444467729+-4.29715222673855)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-8.8618860343743+${C52})
variable C25all equal 0.5*(-8.8618860343743+11.2917552407899)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(0.17419380853865+${C62})
variable C26all equal 0.5*(0.17419380853865+1.09562002884705)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-45.7661177797386+${C43})
variable C34all equal 0.5*(-45.7661177797386+19.1192974352503)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(12.0108113416106+${C53})
variable C35all equal 0.5*(12.0108113416106+-7.27479963000761)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-4.24375421996841+${C63})
variable C36all equal 0.5*(-4.24375421996841+0.7817550610993)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-4.90855331143828+${C54})
variable C45all equal 0.5*(-4.90855331143828+1.95469769145579)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-9.78875832802387+${C64})
variable C46all equal 0.5*(-9.78875832802387+-3.38996842796228)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-3.62743391434522+${C65})
variable C56all equal 0.5*(-3.62743391434522+6.49457697261824)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:18:37
