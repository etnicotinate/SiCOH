LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-6-vasp-an
read_data       ${structure}.data
read_data       333-EXP-6-vasp-an.data
Reading data file ...
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
  reading velocities ...
  274 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.009 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              244.12834      3437.259     
         1   300            0              0              244.12834      3437.259     
Loop time of 5.09989e-05 on 8 procs for 1 steps with 274 atoms

57.8% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.29e-07   | 1.66e-07   | 2.18e-07   |   0.0 |  0.33
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.88e-07   | 1.2311e-06 | 1.408e-06  |   0.0 |  2.41
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.96e-05   |            |       | 97.26

Nlocal:          34.25 ave          40 max          25 min
Histogram: 1 0 1 0 1 0 1 1 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.3 | 110.7 | 112.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -32304.589      12518.325      0              1.5607701      3246.6749    
       100   301.00573     -32308.837     -2278.2956      4751.1528      1.5607701      3246.6749    
       200   300.54639     -32318.584     -2830.8977      5475.2405      1.5607701      3246.6749    
       300   270.98548     -32312.181     -8472.0302     -686.22914      1.5607701      3246.6749    
       400   287.01632     -32322.817      5976.8323     -618.71817      1.5607701      3246.6749    
       500   299.24632     -32307.712     -13283.848     -6751.4792      1.5607701      3246.6749    
       600   297.57447     -32293.976      20993.666      1711.8613      1.5607701      3246.6749    
       700   331.77745     -32329.65       8138.0471      4715.8679      1.5607701      3246.6749    
       800   292.10689     -32313.046      13019.113      316.45084      1.5607701      3246.6749    
       900   294.16237     -32322.173     -2402.3534     -269.33209      1.5607701      3246.6749    
      1000   294.23158     -32318.531      11456.181     -673.76061      1.5607701      3246.6749    
      1100   285.38871     -32304.39       10864.844      199.49403      1.5607701      3246.6749    
      1200   312.50257     -32314.451     -2928.5862     -4946.8805      1.5607701      3246.6749    
      1300   307.7843      -32296.884      1344.4543      451.22899      1.5607701      3246.6749    
      1400   318.4579      -32291.604     -581.07464     -4343.5827      1.5607701      3246.6749    
      1500   309.48167     -32284.631      7509.12        1667.2379      1.5607701      3246.6749    
      1600   308.3259      -32317.442     -7246.9034      2012.4577      1.5607701      3246.6749    
      1700   306.32175     -32327.234      163.35194     -2018.9082      1.5607701      3246.6749    
      1800   280.47026     -32314.626     -7260.2713     -653.8984       1.5607701      3246.6749    
      1900   303.31997     -32332.696     -9696.2841      900.3363       1.5607701      3246.6749    
      2000   312.12035     -32315.29      -8489.1715     -615.73584      1.5607701      3246.6749    
Loop time of 77.3563 on 8 procs for 2000 steps with 274 atoms

Performance: 1.117 ns/day, 21.488 hours/ns, 25.854 timesteps/s, 7.084 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.33      | 54.717     | 64.796     | 129.7 | 70.73
Bond    | 0.00055838 | 0.00071635 | 0.00090234 |   0.0 |  0.00
Neigh   | 3.6134     | 4.6586     | 5.478      |  36.4 |  6.02
Comm    | 0.57609    | 10.649     | 24.032     | 293.7 | 13.77
Output  | 0.0010009  | 0.0011789  | 0.0016707  |   0.6 |  0.00
Modify  | 6.4596     | 7.2973     | 8.3507     |  29.6 |  9.43
Other   |            | 0.03309    |            |       |  0.04

Nlocal:          34.25 ave          39 max          24 min
Histogram: 1 0 0 1 0 0 0 2 1 3
Nghost:        2812.75 ave        2830 max        2793 min
Histogram: 2 0 0 1 1 0 0 1 2 1
Neighs:          20287 ave       22946 max       14503 min
Histogram: 1 0 0 1 0 0 0 3 0 3

Total # of neighbors = 162296
Ave neighs/atom = 592.32117
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-6-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 14.6782659945956
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.7846750651723
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.046026835095

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--615.735841948459)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--615.735841948459)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3662.91708139901)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3662.91708139901)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--701.899400454665)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--701.899400454665)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2141.8690630946)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2141.8690630946)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1005.20032153378)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1005.20032153378)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-508.830001382681)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-508.830001382681)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 14.6782659945956
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.6782659945956
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.146782659945956 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.146782659945956 xy delta 0.0724175076197624 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.146782659945956 xy delta 0.0724175076197624 xz delta -0.0111247216999799 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2871.8872      1925.784       3245.0515    
       200   316.79642     -32308.106     -7466.0286     -2200.6713      3243.4282    
       300   289.769       -32307.279      11326.309      2027.3581      3241.8049    
       400   301.8666      -32321.342     -2551.1895     -2106.7214      3240.1815    
       500   289.40032     -32320.934     -1.091256       3339.5571      3238.5582    
       600   296.79784     -32318.206      1048.5799     -158.66826      3236.9349    
       700   320.82847     -32305.479      807.8194       3656.494       3235.3115    
       800   312.32239     -32309.477     -4817.64        550.37571      3233.6882    
       900   322.08549     -32332.941     -6317.5519     -560.41814      3232.0648    
      1000   294.81181     -32317.39      -3891.4336      1511.0973      3230.4415    
      1100   324.38975     -32346.487      984.09046      3310.6973      3228.8182    
      1200   297.48602     -32347.777      82.534531      3839.3981      3227.1948    
      1300   279.1376      -32345.098     -11527.201     -1373.7967      3225.5715    
      1400   289.89666     -32333.091     -2895.2939     -4705.2689      3223.9482    
      1500   302.36342     -32327.665      7250.6287      2401.9225      3222.3248    
      1600   302.37134     -32321.692      14033.344     -460.23408      3220.7015    
      1700   306.61435     -32328.04       4459.4166      3939.7175      3219.0781    
      1800   271.35927     -32312.323      12441.362      6153.3798      3217.4548    
      1900   265.2487      -32326.486     -1048.7633      753.27503      3215.8315    
      2000   280.97159     -32334.24       5302.2835      2911.1422      3214.2081    
Loop time of 77.9816 on 8 procs for 2000 steps with 274 atoms

Performance: 1.108 ns/day, 21.662 hours/ns, 25.647 timesteps/s, 7.027 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.754     | 55.189     | 65.319     | 130.4 | 70.77
Bond    | 0.00056991 | 0.00071236 | 0.00083942 |   0.0 |  0.00
Neigh   | 3.6203     | 4.6823     | 5.4649     |  36.3 |  6.00
Comm    | 0.53742    | 10.667     | 24.101     | 296.3 | 13.68
Output  | 0.003854   | 0.0046329  | 0.0053998  |   0.8 |  0.01
Modify  | 6.6016     | 7.403      | 8.47       |  29.3 |  9.49
Other   |            | 0.03525    |            |       |  0.05

Nlocal:          34.25 ave          38 max          26 min
Histogram: 1 1 0 0 0 0 0 2 0 4
Nghost:        2840.12 ave        2879 max        2804 min
Histogram: 1 2 0 1 0 0 1 1 1 1
Neighs:          20469 ave       22565 max       15865 min
Histogram: 1 1 0 0 0 0 0 2 0 4

Total # of neighbors = 163752
Ave neighs/atom = 597.63504
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 35.736091538715
variable C2neg equal ${d2}
variable C2neg equal 9.78237029619595
variable C3neg equal ${d3}
variable C3neg equal -5.8833322244827
variable C4neg equal ${d4}
variable C4neg equal 14.5933425448678
variable C5neg equal ${d5}
variable C5neg equal 13.1205639509011
variable C6neg equal ${d6}
variable C6neg equal 2.07098132305726

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.6782659945956
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.146782659945956 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.146782659945956 xy delta -0.0724175076197624 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.146782659945956 xy delta -0.0724175076197624 xz delta 0.0111247216999799 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2869.0168      1924.8763      3248.2982    
       200   314.85447     -32306.824     -6459.7379     -2550.8666      3249.9216    
       300   291.64718     -32309.149      8972.0851      569.85003      3251.5449    
       400   298.0321      -32318.785      2132.8716     -2127.4898      3253.1682    
       500   277.10326     -32309.393     -137.16581     -1284.9196      3254.7916    
       600   284.28788     -32305.68      -1034.5802     -2890.4637      3256.4149    
       700   308.46305     -32293.225      1820.3165     -479.41917      3258.0382    
       800   318.84121     -32309.995     -8033.3426     -1644.2666      3259.6616    
       900   308.41238     -32318.476     -4314.9886     -3248.8752      3261.2849    
      1000   311.43156     -32326.811     -14608.32      -5515.4002      3262.9083    
      1100   310.49675     -32329.23       6443.5125     -520.66026      3264.5316    
      1200   291.27991     -32328.935      240.95097     -2042.9512      3266.1549    
      1300   269.30122     -32337.461      11099.999     -8246.0798      3267.7783    
      1400   284.67436     -32337.683      7324.8932     -3355.6562      3269.4016    
      1500   305.66328     -32331.682     -2577.9703     -3515.5171      3271.0249    
      1600   303.97547     -32320.451     -10064.453      1389.9128      3272.6483    
      1700   275.81343     -32292.239      15090.869     -1813.5035      3274.2716    
      1800   314.06109     -32319.614     -8543.1        -4941.0425      3275.895     
      1900   320.38172     -32330.27      -615.20192     -4199.2885      3277.5183    
      2000   315.49455     -32348.8       -13582.22      -8042.4549      3279.1416    
Loop time of 76.7273 on 8 procs for 2000 steps with 274 atoms

Performance: 1.126 ns/day, 21.313 hours/ns, 26.066 timesteps/s, 7.142 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.48      | 54.135     | 64.196     | 134.2 | 70.55
Bond    | 0.00058817 | 0.00072707 | 0.00083664 |   0.0 |  0.00
Neigh   | 3.5834     | 4.6284     | 5.397      |  35.9 |  6.03
Comm    | 0.53013    | 10.589     | 24.244     | 303.1 | 13.80
Output  | 0.0038775  | 0.0046952  | 0.0055262  |   0.9 |  0.01
Modify  | 6.5499     | 7.3344     | 8.3841     |  29.0 |  9.56
Other   |            | 0.03526    |            |       |  0.05

Nlocal:          34.25 ave          40 max          26 min
Histogram: 1 0 1 0 0 2 0 2 1 1
Nghost:        2817.25 ave        2848 max        2779 min
Histogram: 1 1 1 1 0 0 0 0 1 3
Neighs:        20129.5 ave       23222 max       15626 min
Histogram: 1 0 1 0 0 2 0 2 1 1

Total # of neighbors = 161036
Ave neighs/atom = 587.72263
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 75.2512313606693
variable C2pos equal ${d2}
variable C2pos equal 34.8224239481068
variable C3pos equal ${d3}
variable C3pos equal 47.1486271907629
variable C4pos equal ${d4}
variable C4pos equal -8.54491539733668
variable C5pos equal ${d5}
variable C5pos equal 2.9262444795067
variable C6pos equal ${d6}
variable C6pos equal 6.19390396891009

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(35.736091538715+${C1pos})
variable C11 equal 0.5*(35.736091538715+75.2512313606693)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(9.78237029619595+${C2pos})
variable C21 equal 0.5*(9.78237029619595+34.8224239481068)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-5.8833322244827+${C3pos})
variable C31 equal 0.5*(-5.8833322244827+47.1486271907629)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(14.5933425448678+${C4pos})
variable C41 equal 0.5*(14.5933425448678+-8.54491539733668)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(13.1205639509011+${C5pos})
variable C51 equal 0.5*(13.1205639509011+2.9262444795067)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(2.07098132305726+${C6pos})
variable C61 equal 0.5*(2.07098132305726+6.19390396891009)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.7846750651723
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.7846750651723
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.137846750651723 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.137846750651723 yz delta -0.00754424936303695 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2871.8872      1925.784       3245.0515    
       200   317.28453     -32308.664     -7777.7068     -2504.75        3243.4282    
       300   289.48734     -32307.484      9361.832       1305.0334      3241.8049    
       400   299.21521     -32318.891      1735.7061     -3271.5451      3240.1815    
       500   287.84735     -32318.368      2451.9261      2620.8166      3238.5582    
       600   299.93629     -32322.748      6140.3244     -1743.356       3236.9349    
       700   308.40708     -32296.145     -2606.8259      688.61407      3235.3115    
       800   314.9123      -32311.124     -557.08779      2911.8825      3233.6882    
       900   323.01268     -32332.114     -5597.0928     -3230.7361      3232.0648    
      1000   307.23774     -32323.911     -3773.3099     -1029.6447      3230.4415    
      1100   279.39303     -32306.412      6051.2737     -2609.3791      3228.8182    
      1200   263.65271     -32318.976      5521.7652      1588.3873      3227.1948    
      1300   286.28594     -32348.248     -592.9751      -126.18012      3225.5715    
      1400   296.84517     -32334.668     -5806.4001      3622.4555      3223.9482    
      1500   294.90883     -32315.771      3213.8365     -618.25362      3222.3248    
      1600   286.40261     -32308.489     -13743.381     -346.6309       3220.7015    
      1700   322.93816     -32346.755      10244.264     -1162.3683      3219.0781    
      1800   277.90441     -32331.763     -1083.0987     -7997.0635      3217.4548    
      1900   277.99657     -32332.069      9318.9831      5336.4246      3215.8315    
      2000   289.64157     -32311.265      4378.4499      4026.1009      3214.2081    
Loop time of 77.7878 on 8 procs for 2000 steps with 274 atoms

Performance: 1.111 ns/day, 21.608 hours/ns, 25.711 timesteps/s, 7.045 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.175     | 54.961     | 65.143     | 134.5 | 70.65
Bond    | 0.00056633 | 0.00072676 | 0.00085149 |   0.0 |  0.00
Neigh   | 3.6397     | 4.6897     | 5.4493     |  36.1 |  6.03
Comm    | 0.53878    | 10.721     | 24.508     | 304.3 | 13.78
Output  | 0.0037307  | 0.0045649  | 0.0053833  |   0.9 |  0.01
Modify  | 6.5964     | 7.376      | 8.4291     |  29.2 |  9.48
Other   |            | 0.03505    |            |       |  0.05

Nlocal:          34.25 ave          39 max          27 min
Histogram: 2 0 0 0 0 1 0 1 3 1
Nghost:        2872.25 ave        2925 max        2817 min
Histogram: 2 0 0 2 0 0 1 1 0 2
Neighs:        20491.4 ave       23168 max       16441 min
Histogram: 2 0 0 0 0 1 0 1 3 1

Total # of neighbors = 163931
Ave neighs/atom = 598.28832
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 47.0334105709575
variable C2neg equal ${d2}
variable C2neg equal 97.1147065189171
variable C3neg equal ${d3}
variable C3neg equal 64.1905545312927
variable C4neg equal ${d4}
variable C4neg equal 19.2500333707137
variable C5neg equal ${d5}
variable C5neg equal -13.3325450906118
variable C6neg equal ${d6}
variable C6neg equal -1.5356854290212

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.7846750651723
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.137846750651723 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.137846750651723 yz delta 0.00754424936303695 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2869.0168      1924.8763      3248.2982    
       200   314.67426     -32306.422     -6160.9828     -2315.6932      3249.9216    
       300   292.42343     -32309.022      6486.2261      913.09809      3251.5449    
       400   296.43213     -32316.829     -3963.3931     -2350.5303      3253.1682    
       500   278.19892     -32309.166     -10334.084     -2429.4876      3254.7916    
       600   288.015       -32307.311     -6015.8983     -2096.9212      3256.4149    
       700   316.19911     -32297.752      13459.463      1500.4341      3258.0382    
       800   303.71658     -32299.74       134.05503     -1441.0319      3259.6616    
       900   302.74466     -32311.631     -6502.9001     -4108.6188      3261.2849    
      1000   298.7972      -32315.053     -8899.4049     -3599.8583      3262.9083    
      1100   291.91084     -32322.011     -4050.5911      830.32836      3264.5316    
      1200   282.80982     -32327.914     -4093.0557     -5024.6884      3266.1549    
      1300   266.51072     -32321.854     -2902.5966     -4074.1457      3267.7783    
      1400   301.61692     -32330.177     -8903.3105     -1772.9081      3269.4016    
      1500   300.95034     -32305.016     -20091.473     -1083.1278      3271.0249    
      1600   312.77879     -32304.952     -11668.805     -1931.4872      3272.6483    
      1700   306.90888     -32309.02      -7294.4849      1079.9603      3274.2716    
      1800   274.83614     -32308.365     -10311.246     -7752.9418      3275.895     
      1900   281.30605     -32326.192      2138.4824     -789.93493      3277.5183    
      2000   284.9582      -32321.646      641.35646     -995.71041      3279.1416    
Loop time of 76.3553 on 8 procs for 2000 steps with 274 atoms

Performance: 1.132 ns/day, 21.210 hours/ns, 26.193 timesteps/s, 7.177 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.074     | 53.7       | 63.786     | 133.9 | 70.33
Bond    | 0.00056466 | 0.00075082 | 0.00086838 |   0.0 |  0.00
Neigh   | 3.5638     | 4.6268     | 5.4149     |  36.5 |  6.06
Comm    | 0.56571    | 10.652     | 24.284     | 300.5 | 13.95
Output  | 0.003711   | 0.0045462  | 0.0053824  |   0.9 |  0.01
Modify  | 6.5373     | 7.3358     | 8.3981     |  29.4 |  9.61
Other   |            | 0.03531    |            |       |  0.05

Nlocal:          34.25 ave          40 max          26 min
Histogram: 1 1 0 0 0 1 1 2 1 1
Nghost:        2789.25 ave        2823 max        2760 min
Histogram: 4 0 0 0 0 0 0 1 1 2
Neighs:        20115.1 ave       23316 max       15588 min
Histogram: 1 1 0 0 1 0 1 2 1 1

Total # of neighbors = 160921
Ave neighs/atom = 587.30292
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 3.85009228988688
variable C2pos equal ${d2}
variable C2pos equal -10.7922893034029
variable C3pos equal ${d3}
variable C3pos equal 40.3820505816801
variable C4pos equal ${d4}
variable C4pos equal -6.40662794011515
variable C5pos equal ${d5}
variable C5pos equal -0.77620079316252
variable C6pos equal ${d6}
variable C6pos equal 10.1683259732711

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(47.0334105709575+${C1pos})
variable C12 equal 0.5*(47.0334105709575+3.85009228988688)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(97.1147065189171+${C2pos})
variable C22 equal 0.5*(97.1147065189171+-10.7922893034029)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(64.1905545312927+${C3pos})
variable C32 equal 0.5*(64.1905545312927+40.3820505816801)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(19.2500333707137+${C4pos})
variable C42 equal 0.5*(19.2500333707137+-6.40662794011515)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-13.3325450906118+${C5pos})
variable C52 equal 0.5*(-13.3325450906118+-0.77620079316252)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-1.5356854290212+${C6pos})
variable C62 equal 0.5*(-1.5356854290212+10.1683259732711)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.046026835095
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.046026835095
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.16046026835095 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2871.8872      1925.784       3245.0515    
       200   316.90291     -32308.35      -8149.8334     -2378.27        3243.4282    
       300   288.56721     -32306.34       9876.3966      1039.3831      3241.8049    
       400   302.53108     -32321.903     -9535.8939     -2648.9313      3240.1815    
       500   282.29494     -32314.762      2604.3393      328.10162      3238.5582    
       600   283.16942     -32310.365     -11450.66       329.26297      3236.9349    
       700   306.591       -32295.242      15542.161      4398.0797      3235.3115    
       800   313.65756     -32302.869      3320.9442     -1915.1403      3233.6882    
       900   307.30557     -32311.272     -7089.426      -1268.8142      3232.0648    
      1000   308.56246     -32324.91      -8432.487       2439.334       3230.4415    
      1100   299.49678     -32333.083      4457.5831      385.87196      3228.8182    
      1200   302.49586     -32336.652     -6179.3252     -3618.1461      3227.1948    
      1300   315.36136     -32346.557      10400.302     -3819.0057      3225.5715    
      1400   304.72505     -32332.253      140.8291      -1467.1512      3223.9482    
      1500   297.84971     -32316.465     -7447.5678     -730.5509       3222.3248    
      1600   325.87938     -32316.859     -4848.2497      5304.0502      3220.7015    
      1700   324.92629     -32311.17       9339.595       1618.8063      3219.0781    
      1800   312.86081     -32333.949      24699.59       3354.5966      3217.4548    
      1900   283.16004     -32320.906      5154.1258      4344.8028      3215.8315    
      2000   300.84979     -32332.691      3898.0815      1885.7027      3214.2081    
Loop time of 77.8332 on 8 procs for 2000 steps with 274 atoms

Performance: 1.110 ns/day, 21.620 hours/ns, 25.696 timesteps/s, 7.041 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.061     | 54.717     | 65.081     | 134.5 | 70.30
Bond    | 0.00056311 | 0.00074524 | 0.00090411 |   0.0 |  0.00
Neigh   | 3.6145     | 4.6998     | 5.4973     |  37.2 |  6.04
Comm    | 0.54908    | 10.914     | 24.574     | 300.8 | 14.02
Output  | 0.0039055  | 0.0047371  | 0.0055567  |   0.9 |  0.01
Modify  | 6.6468     | 7.4624     | 8.5484     |  29.9 |  9.59
Other   |            | 0.03422    |            |       |  0.04

Nlocal:          34.25 ave          40 max          25 min
Histogram: 1 0 1 0 0 1 0 1 3 1
Nghost:        2840.88 ave        2889 max        2797 min
Histogram: 2 0 1 1 0 0 1 1 1 1
Neighs:        20492.6 ave       23813 max       15320 min
Histogram: 1 0 1 0 0 1 0 3 1 1

Total # of neighbors = 163941
Ave neighs/atom = 598.32482
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 25.3458265074782
variable C2neg equal ${d2}
variable C2neg equal 35.566211000806
variable C3neg equal ${d3}
variable C3neg equal 27.8987815367138
variable C4neg equal ${d4}
variable C4neg equal 9.76663021101243
variable C5neg equal ${d5}
variable C5neg equal -13.5219560365608
variable C6neg equal ${d6}
variable C6neg equal -14.813457321003

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.046026835095
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.16046026835095 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2869.0168      1924.8763      3248.2982    
       200   315.04811     -32306.74      -6033.7978     -2391.2549      3249.9216    
       300   292.44606     -32309.197      7531.2233      584.29692      3251.5449    
       400   295.66936     -32316.722     -2025.4317     -2939.481       3253.1682    
       500   288.78086     -32319.125      503.00269     -3126.1275      3254.7916    
       600   291.98893     -32313.421     -1.2075415     -2232.3147      3256.4149    
       700   314.29799     -32298.914      4720.8231     -139.00154      3258.0382    
       800   316.74496     -32309.756     -3677.6015     -2901.7059      3259.6616    
       900   298.20842     -32309.093     -15420.073     -3439.281       3261.2849    
      1000   307.00401     -32322.426     -3503.9374     -4285.0649      3262.9083    
      1100   301.16718     -32325.32      -1108.1415     -6081.9765      3264.5316    
      1200   288.42228     -32325.491     -16639.368     -4099.121       3266.1549    
      1300   284.27485     -32343.99       5188.0954     -109.47298      3267.7783    
      1400   270.98936     -32330.214     -4518.0529     -3676.0908      3269.4016    
      1500   299.04264     -32323.742     -6282.4287     -5336.2643      3271.0249    
      1600   307.0568      -32320.788     -687.10283      2664.6831      3272.6483    
      1700   292.0837      -32308.194     -1539.7678     -3448.42        3274.2716    
      1800   296.85835     -32305.175     -5494.7357      2783.2578      3275.895     
      1900   315.12571     -32294.758     -13520.72      -2800.3497      3277.5183    
      2000   339.17768     -32314.443      7325.9249     -1945.3213      3279.1416    
Loop time of 76.5667 on 8 procs for 2000 steps with 274 atoms

Performance: 1.128 ns/day, 21.269 hours/ns, 26.121 timesteps/s, 7.157 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.47      | 53.815     | 63.985     | 133.7 | 70.28
Bond    | 0.00056749 | 0.00072976 | 0.00080418 |   0.0 |  0.00
Neigh   | 3.5829     | 4.6344     | 5.4077     |  36.3 |  6.05
Comm    | 0.55382    | 10.727     | 24.075     | 299.2 | 14.01
Output  | 0.0037833  | 0.0045591  | 0.0053939  |   0.9 |  0.01
Modify  | 6.5582     | 7.3511     | 8.4037     |  29.2 |  9.60
Other   |            | 0.03387    |            |       |  0.04

Nlocal:          34.25 ave          42 max          25 min
Histogram: 1 0 1 0 2 0 2 0 1 1
Nghost:        2803.75 ave        2822 max        2785 min
Histogram: 2 1 0 1 0 0 0 1 1 2
Neighs:        20083.1 ave       24456 max       14962 min
Histogram: 1 0 1 0 2 0 2 0 1 1

Total # of neighbors = 160665
Ave neighs/atom = 586.36861
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 13.4720248051367
variable C2pos equal ${d2}
variable C2pos equal 21.5074994408655
variable C3pos equal ${d3}
variable C3pos equal 45.9700512655857
variable C4pos equal ${d4}
variable C4pos equal -22.2407801730484
variable C5pos equal ${d5}
variable C5pos equal -1.07576530947865
variable C6pos equal ${d6}
variable C6pos equal -0.54271950444732

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(25.3458265074782+${C1pos})
variable C13 equal 0.5*(25.3458265074782+13.4720248051367)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(35.566211000806+${C2pos})
variable C23 equal 0.5*(35.566211000806+21.5074994408655)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(27.8987815367138+${C3pos})
variable C33 equal 0.5*(27.8987815367138+45.9700512655857)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(9.76663021101243+${C4pos})
variable C43 equal 0.5*(9.76663021101243+-22.2407801730484)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-13.5219560365608+${C5pos})
variable C53 equal 0.5*(-13.5219560365608+-1.07576530947865)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-14.813457321003+${C6pos})
variable C63 equal 0.5*(-14.813457321003+-0.54271950444732)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.046026835095
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.046026835095
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.16046026835095 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2870.4513      1925.3299      3246.6749    
       200   316.51506     -32307.905     -7778.5852     -2488.6808      3246.6749    
       300   291.06792     -32308.138      9110.2508      1300.0782      3246.6749    
       400   296.98518     -32317.189      2599.0268     -1249.6698      3246.6749    
       500   281.35264     -32313.099     -9381.6437      1543.3799      3246.6749    
       600   288.607       -32310.466     -5010.8795      1103.6516      3246.6749    
       700   323.6076      -32306.499      11985.336      2492.7756      3246.6749    
       800   295.18561     -32291.152     -558.33354     -2628.9386      3246.6749    
       900   304.24111     -32316.564     -10757.132      140.89105      3246.6749    
      1000   295.57583     -32315.744      2429.6757     -277.6675       3246.6749    
      1100   282.42489     -32309.165     -11129.569     -5338.9453      3246.6749    
      1200   295.43654     -32324.695     -10486.559      20.623751      3246.6749    
      1300   281.25835     -32330.808      1444.987      -77.058344      3246.6749    
      1400   296.58968     -32345.532      7337.4726      4765.6945      3246.6749    
      1500   271.46002     -32300.89      -816.78908     -2889.4533      3246.6749    
      1600   342.16258     -32338.805      1140.2897      5715.577       3246.6749    
      1700   299.3461      -32314.264      5287.9462     -3066.9235      3246.6749    
      1800   311.13579     -32338.091      11765.985     -4067.7686      3246.6749    
      1900   278.55227     -32315.607      2812.5406      1782.176       3246.6749    
      2000   313.26035     -32336.993      1624.4152     -1967.8426      3246.6749    
Loop time of 76.9956 on 8 procs for 2000 steps with 274 atoms

Performance: 1.122 ns/day, 21.388 hours/ns, 25.976 timesteps/s, 7.117 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.772     | 54.368     | 64.435     | 132.8 | 70.61
Bond    | 0.00055048 | 0.00074401 | 0.00090175 |   0.0 |  0.00
Neigh   | 3.5921     | 4.6584     | 5.436      |  36.6 |  6.05
Comm    | 0.57423    | 10.641     | 24.238     | 300.0 | 13.82
Output  | 0.0037743  | 0.0045393  | 0.0052995  |   0.9 |  0.01
Modify  | 6.5005     | 7.2874     | 8.3577     |  29.7 |  9.46
Other   |            | 0.03515    |            |       |  0.05

Nlocal:          34.25 ave          40 max          27 min
Histogram: 2 0 0 1 0 0 1 1 2 1
Nghost:        2813.62 ave        2836 max        2793 min
Histogram: 2 0 1 1 0 0 1 1 1 1
Neighs:          20300 ave       23536 max       16294 min
Histogram: 2 0 1 0 0 0 1 1 2 1

Total # of neighbors = 162400
Ave neighs/atom = 592.70073
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -13.7002215853612
variable C2neg equal ${d2}
variable C2neg equal -9.79469814722796
variable C3neg equal ${d3}
variable C3neg equal -23.7028244570695
variable C4neg equal ${d4}
variable C4neg equal 34.5691230397373
variable C5neg equal ${d5}
variable C5neg equal 0.721416528874542
variable C6neg equal ${d6}
variable C6neg equal 2.1014813923499

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.046026835095
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.16046026835095 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2870.4513      1925.3299      3246.6749    
       200   315.03422     -32306.822     -6849.4531     -2460.7141      3246.6749    
       300   292.2838      -32309.447      9822.9582      971.15323      3246.6749    
       400   305.14384     -32324.014     -984.02495     -2918.3534      3246.6749    
       500   291.9013      -32322.182     -261.37606      363.02011      3246.6749    
       600   289.29009     -32311.175     -470.4848      -1589.5122      3246.6749    
       700   314.31938     -32298.756      8510.8061      286.86438      3246.6749    
       800   314.95677     -32306.987     -1189.4713     -3149.0817      3246.6749    
       900   293.4506      -32307.15      -883.32287     -672.43283      3246.6749    
      1000   307.18977     -32323.665     -10854.445     -1180.6897      3246.6749    
      1100   312.73366     -32331.823      5664.3398     -3189.534       3246.6749    
      1200   284.53407     -32326.211     -10886.695     -417.55904      3246.6749    
      1300   285.22739     -32334.992     -1774.8034     -4955.8644      3246.6749    
      1400   296.01274     -32326.188     -8011.7693     -636.52936      3246.6749    
      1500   306.8352      -32314.513      2845.3011      1865.0027      3246.6749    
      1600   309.08626     -32309.03       6790.9435     -1044.9082      3246.6749    
      1700   301.4062      -32318.704      10731.357      4149.2055      3246.6749    
      1800   297.82781     -32317.751      7440.041      -494.08846      3246.6749    
      1900   281.57777     -32299.912     -594.0405      -4578.0721      3246.6749    
      2000   304.29262     -32311.479     -864.99533      1547.1444      3246.6749    
Loop time of 77.5608 on 8 procs for 2000 steps with 274 atoms

Performance: 1.114 ns/day, 21.545 hours/ns, 25.786 timesteps/s, 7.065 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.204     | 54.718     | 64.927     | 132.9 | 70.55
Bond    | 0.00053987 | 0.00073961 | 0.00089381 |   0.0 |  0.00
Neigh   | 3.6021     | 4.6659     | 5.472      |  36.5 |  6.02
Comm    | 0.56679    | 10.779     | 24.298     | 299.3 | 13.90
Output  | 0.0038256  | 0.0046091  | 0.0054261  |   0.9 |  0.01
Modify  | 6.5329     | 7.3568     | 8.421      |  29.5 |  9.49
Other   |            | 0.03498    |            |       |  0.05

Nlocal:          34.25 ave          42 max          28 min
Histogram: 2 0 0 1 1 2 1 0 0 1
Nghost:        2841.25 ave        2894 max        2791 min
Histogram: 2 1 1 0 0 0 0 2 0 2
Neighs:        20269.1 ave       24654 max       16910 min
Histogram: 2 0 0 1 2 1 1 0 0 1

Total # of neighbors = 162153
Ave neighs/atom = 591.79927
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -21.9153838547471
variable C2pos equal ${d2}
variable C2pos equal -62.2262180336666
variable C3pos equal ${d3}
variable C3pos equal -47.5740002154927
variable C4pos equal ${d4}
variable C4pos equal -7.85760965550646
variable C5pos equal ${d5}
variable C5pos equal 14.4964136648086
variable C6pos equal ${d6}
variable C6pos equal 8.26412911396678

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-13.7002215853612+${C1pos})
variable C14 equal 0.5*(-13.7002215853612+-21.9153838547471)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-9.79469814722796+${C2pos})
variable C24 equal 0.5*(-9.79469814722796+-62.2262180336666)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-23.7028244570695+${C3pos})
variable C34 equal 0.5*(-23.7028244570695+-47.5740002154927)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(34.5691230397373+${C4pos})
variable C44 equal 0.5*(34.5691230397373+-7.85760965550646)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(0.721416528874542+${C5pos})
variable C54 equal 0.5*(0.721416528874542+14.4964136648086)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(2.1014813923499+${C6pos})
variable C64 equal 0.5*(2.1014813923499+8.26412911396678)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.046026835095
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.046026835095
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.16046026835095 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2870.4513      1925.3299      3246.6749    
       200   315.19789     -32306.991     -7018.4894     -2421.9482      3246.6749    
       300   291.98582     -32309.335      8726.9947      791.30201      3246.6749    
       400   299.65485     -32319.96      -2648.991      -2296.5269      3246.6749    
       500   293.99942     -32324.337      2268.896      -139.75779      3246.6749    
       600   288.86359     -32314.324     -2692.3259     -2269.7608      3246.6749    
       700   319.16412     -32305.797      14467.063     -770.23858      3246.6749    
       800   316.95017     -32311.167     -1945.9262     -2070.6748      3246.6749    
       900   309.0852      -32322.018     -5719.554      -2720.7309      3246.6749    
      1000   312.58518     -32333.077      13576.31       1867.7674      3246.6749    
      1100   291.65509     -32327.166     -5781.9893     -6254.6871      3246.6749    
      1200   300.22963     -32329.88      -9326.3824     -279.57775      3246.6749    
      1300   325.47524     -32318.034      7956.1103     -3709.2625      3246.6749    
      1400   320.9606      -32316.362     -1406.1008     -835.06429      3246.6749    
      1500   318.64528     -32334.495      14400.313     -3487.5869      3246.6749    
      1600   304.58056     -32331.785     -4938.2916      1753.9743      3246.6749    
      1700   290.90885     -32330.614     -3697.0387     -3934.7443      3246.6749    
      1800   286.42448     -32334.635      14453.137      2820.0306      3246.6749    
      1900   306.77466     -32340.273     -1765.3716     -2603.4815      3246.6749    
      2000   299.3728      -32311.797     -6643.5496     -4033.0965      3246.6749    
Loop time of 76.1646 on 8 procs for 2000 steps with 274 atoms

Performance: 1.134 ns/day, 21.157 hours/ns, 26.259 timesteps/s, 7.195 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.572     | 51.98      | 63.697     | 130.6 | 68.25
Bond    | 0.00056908 | 0.00073736 | 0.00083785 |   0.0 |  0.00
Neigh   | 3.5914     | 4.4207     | 5.2545     |  35.3 |  5.80
Comm    | 0.73748    | 12.463     | 23.879     | 266.6 | 16.36
Output  | 0.0037204  | 0.0045103  | 0.0052847  |   0.9 |  0.01
Modify  | 6.4325     | 7.2627     | 8.0852     |  27.7 |  9.54
Other   |            | 0.03346    |            |       |  0.04

Nlocal:          34.25 ave          39 max          29 min
Histogram: 1 1 1 0 0 0 2 0 1 2
Nghost:        2824.75 ave        2845 max        2805 min
Histogram: 2 0 0 1 1 1 0 1 0 2
Neighs:        20311.9 ave       23049 max       17457 min
Histogram: 1 2 0 0 0 2 0 1 1 1

Total # of neighbors = 162495
Ave neighs/atom = 593.04745
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -34.6264070223569
variable C2neg equal ${d2}
variable C2neg equal -5.04578536825198
variable C3neg equal ${d3}
variable C3neg equal -27.7746823338532
variable C4neg equal ${d4}
variable C4neg equal 20.4831100880702
variable C5neg equal ${d5}
variable C5neg equal -13.5980221985485
variable C6neg equal ${d6}
variable C6neg equal -9.03109347344632

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.046026835095
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.16046026835095 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2870.4513      1925.3299      3246.6749    
       200   316.38708     -32307.798     -7647.9259     -2520.6029      3246.6749    
       300   292.04295     -32309.088      10894.634      1543.9133      3246.6749    
       400   298.89365     -32319.312      2828.5057     -2173.9863      3246.6749    
       500   287.51993     -32319.419     -1871.7963      2087.4501      3246.6749    
       600   280.25557     -32308.211     -9951.5307     -2964.4852      3246.6749    
       700   308.67727     -32297.057      633.2921       1481.7166      3246.6749    
       800   318.24403     -32312.793     -3007.1744     -3615.6814      3246.6749    
       900   316.94437     -32324.632     -12348.292     -544.80043      3246.6749    
      1000   302.52597     -32320.817     -4342.5422     -1684.4292      3246.6749    
      1100   309.82002     -32338.933     -20298.331     -4276.3035      3246.6749    
      1200   290.84266     -32349.025     -5754.6441     -3038.7363      3246.6749    
      1300   259.76167     -32332.912     -10776.467     -1879.6571      3246.6749    
      1400   302.64701     -32335.692     -13696.776     -890.50729      3246.6749    
      1500   297.86664     -32318.121      1716.4731     -644.66264      3246.6749    
      1600   296.81908     -32307.613      6378.9996      4022.365       3246.6749    
      1700   300.51906     -32305.695     -4002.0357     -872.74945      3246.6749    
      1800   287.62551     -32305.157     -13573.747     -1791.9227      3246.6749    
      1900   273.48774     -32315.158     -3888.5045      1734.8674      3246.6749    
      2000   314.01505     -32354.183      5806.4035      1457.0252      3246.6749    
Loop time of 76.6232 on 8 procs for 2000 steps with 274 atoms

Performance: 1.128 ns/day, 21.284 hours/ns, 26.102 timesteps/s, 7.152 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.523     | 51.989     | 64.319     | 132.3 | 67.85
Bond    | 0.00063685 | 0.00075376 | 0.00085418 |   0.0 |  0.00
Neigh   | 3.6228     | 4.4155     | 5.2769     |  36.0 |  5.76
Comm    | 0.5667     | 12.907     | 24.38      | 265.5 | 16.84
Output  | 0.0037314  | 0.0045443  | 0.0052939  |   0.9 |  0.01
Modify  | 6.4175     | 7.2738     | 8.0602     |  28.2 |  9.49
Other   |            | 0.03329    |            |       |  0.04

Nlocal:          34.25 ave          43 max          24 min
Histogram: 1 1 0 0 0 2 2 1 0 1
Nghost:        2841.75 ave        2892 max        2796 min
Histogram: 1 1 1 1 0 1 1 0 1 1
Neighs:        20301.5 ave       25251 max       14548 min
Histogram: 1 1 0 0 0 2 2 1 0 1

Total # of neighbors = 162412
Ave neighs/atom = 592.74453
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -21.0022508545794
variable C2pos equal ${d2}
variable C2pos equal -43.3112562272209
variable C3pos equal ${d3}
variable C3pos equal -2.4917958696009
variable C4pos equal ${d4}
variable C4pos equal -21.3499003250768
variable C5pos equal ${d5}
variable C5pos equal 8.48737873966083
variable C6pos equal ${d6}
variable C6pos equal 12.4178622207869

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-34.6264070223569+${C1pos})
variable C15 equal 0.5*(-34.6264070223569+-21.0022508545794)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-5.04578536825198+${C2pos})
variable C25 equal 0.5*(-5.04578536825198+-43.3112562272209)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-27.7746823338532+${C3pos})
variable C35 equal 0.5*(-27.7746823338532+-2.4917958696009)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(20.4831100880702+${C4pos})
variable C45 equal 0.5*(20.4831100880702+-21.3499003250768)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(-13.5980221985485+${C5pos})
variable C55 equal 0.5*(-13.5980221985485+8.48737873966083)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-9.03109347344632+${C6pos})
variable C65 equal 0.5*(-9.03109347344632+12.4178622207869)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.7846750651723

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.7846750651723
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.137846750651723 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2870.4513      1925.3299      3246.6749    
       200   314.90564     -32306.665     -6865.8347     -2360.8487      3246.6749    
       300   291.37833     -32308.268      8016.2369      1083.9426      3246.6749    
       400   295.48272     -32316.528     -4136.0235     -2702.145       3246.6749    
       500   294.52727     -32325.009      85.069248      1598.7076      3246.6749    
       600   287.23634     -32311.725     -11529.974     -2738.3938      3246.6749    
       700   317.1643      -32303.703      6668.608       165.95762      3246.6749    
       800   300.22106     -32298.301      1469.7121      786.72524      3246.6749    
       900   308.82631     -32319.472     -2612.9346     -5214.4987      3246.6749    
      1000   301.7621      -32320.12      -6856.6005      341.21915      3246.6749    
      1100   298.38777     -32326.896      8089.8424     -1385.3465      3246.6749    
      1200   286.48131     -32329.674     -8367.5896     -684.86181      3246.6749    
      1300   286.73013     -32347.559     -6304.9138     -1715.7468      3246.6749    
      1400   264.30572     -32324.218      11961.053     -1210.9037      3246.6749    
      1500   310.70658     -32330.634     -5174.4059     -4242.975       3246.6749    
      1600   322.77701     -32328.224      7948.4361      1686.7167      3246.6749    
      1700   303.57166     -32320.993      3863.602      -2403.2038      3246.6749    
      1800   309.14366     -32342.109     -7896.7137     -6209.1719      3246.6749    
      1900   282.05751     -32325.421     -93.022552      6558.769       3246.6749    
      2000   315.86851     -32335.17      -7064.7245      1190.5819      3246.6749    
Loop time of 76.5211 on 8 procs for 2000 steps with 274 atoms

Performance: 1.129 ns/day, 21.256 hours/ns, 26.137 timesteps/s, 7.161 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 41.327     | 52.159     | 64.047     | 133.1 | 68.16
Bond    | 0.00067148 | 0.00074723 | 0.00083352 |   0.0 |  0.00
Neigh   | 3.6693     | 4.4446     | 5.2938     |  36.4 |  5.81
Comm    | 0.70955    | 12.604     | 23.442     | 270.7 | 16.47
Output  | 0.0037763  | 0.0045749  | 0.0053613  |   0.9 |  0.01
Modify  | 6.4277     | 7.2736     | 8.0556     |  28.6 |  9.51
Other   |            | 0.03398    |            |       |  0.04

Nlocal:          34.25 ave          41 max          25 min
Histogram: 1 1 0 0 0 0 4 0 1 1
Nghost:        2854.25 ave        2915 max        2787 min
Histogram: 2 0 1 1 0 0 0 1 1 2
Neighs:        20281.6 ave       23954 max       15165 min
Histogram: 1 1 0 0 0 0 4 0 1 1

Total # of neighbors = 162253
Ave neighs/atom = 592.16423
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 18.30251446419
variable C2neg equal ${d2}
variable C2neg equal 36.1233054302625
variable C3neg equal ${d3}
variable C3neg equal -40.5549726328501
variable C4neg equal ${d4}
variable C4neg equal 12.0449658357891
variable C5neg equal ${d5}
variable C5neg equal 9.16827241258931
variable C6neg equal ${d6}
variable C6neg equal -1.54738519259859

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.403917 0.14261247 0.36248658) to (15.082183 13.927288 16.408513) with tilt (-7.2417508 1.1124722 0.75442494)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.7846750651723
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.137846750651723 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.8 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.12035     -32315.29      -8489.2102      0              3246.6749    
       100   320.38822     -32301.54       2870.4513      1925.3299      3246.6749    
       200   316.49174     -32307.973     -7869.2143     -2544.6454      3246.6749    
       300   293.14494     -32310.183      11375.063      1227.7091      3246.6749    
       400   298.76072     -32319.179      2077.5192     -1390.3901      3246.6749    
       500   286.0446      -32317.675     -5383.8391     -819.98647      3246.6749    
       600   288.65015     -32313.963     -7167.9395     -2773.7741      3246.6749    
       700   318.49931     -32304.592     -623.0445      -1661.6539      3246.6749    
       800   322.46441     -32313.584     -9326.8329     -2151.7192      3246.6749    
       900   304.45856     -32316.272     -13190.488     -6363.7124      3246.6749    
      1000   308.4366      -32327.713     -6724.1875     -2067.9287      3246.6749    
      1100   303.72049     -32330.894      15745.682     -4246.9063      3246.6749    
      1200   302.42547     -32331.213     -4711.1618     -2417.226       3246.6749    
      1300   288.89231     -32308.196      18176.637      1263.2894      3246.6749    
      1400   318.52338     -32325.098      2182.8779     -1793.2875      3246.6749    
      1500   285.72988     -32303.404      17942.772     -1905.5754      3246.6749    
      1600   296.35364     -32314.199      3730.2291      1493.9811      3246.6749    
      1700   291.70804     -32325.226     -8326.4983     -1079.437       3246.6749    
      1800   268.17237     -32320.85      -5540.1415     -6882.1586      3246.6749    
      1900   310.24922     -32340.149      382.67501     -2444.3599      3246.6749    
      2000   294.71919     -32301.675     -7334.5997     -3599.3468      3246.6749    
Loop time of 76.3341 on 8 procs for 2000 steps with 274 atoms

Performance: 1.132 ns/day, 21.204 hours/ns, 26.201 timesteps/s, 7.179 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.36      | 51.775     | 64.001     | 131.4 | 67.83
Bond    | 0.00059257 | 0.00075712 | 0.00089344 |   0.0 |  0.00
Neigh   | 3.5942     | 4.3974     | 5.2992     |  36.3 |  5.76
Comm    | 0.55435    | 12.794     | 24.217     | 264.3 | 16.76
Output  | 0.0037788  | 0.0046472  | 0.0054426  |   0.9 |  0.01
Modify  | 6.4364     | 7.329      | 8.1245     |  28.2 |  9.60
Other   |            | 0.03346    |            |       |  0.04

Nlocal:          34.25 ave          41 max          26 min
Histogram: 1 1 0 0 1 0 2 1 1 1
Nghost:        2808.75 ave        2837 max        2782 min
Histogram: 2 0 0 1 2 0 1 0 0 2
Neighs:        20311.6 ave       24191 max       15748 min
Histogram: 1 1 0 0 1 2 0 1 1 1

Total # of neighbors = 162493
Ave neighs/atom = 593.04015
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 30.2314379501098
variable C2pos equal ${d2}
variable C2pos equal 66.9668424267361
variable C3pos equal ${d3}
variable C3pos equal 42.1811276601161
variable C4pos equal ${d4}
variable C4pos equal -10.6591146444235
variable C5pos equal ${d5}
variable C5pos equal -1.71743968193974
variable C6pos equal ${d6}
variable C6pos equal 3.16491408995795

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(18.30251446419+${C1pos})
variable C16 equal 0.5*(18.30251446419+30.2314379501098)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(36.1233054302625+${C2pos})
variable C26 equal 0.5*(36.1233054302625+66.9668424267361)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-40.5549726328501+${C3pos})
variable C36 equal 0.5*(-40.5549726328501+42.1811276601161)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(12.0449658357891+${C4pos})
variable C46 equal 0.5*(12.0449658357891+-10.6591146444235)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(9.16827241258931+${C5pos})
variable C56 equal 0.5*(9.16827241258931+-1.71743968193974)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-1.54738519259859+${C6pos})
variable C66 equal 0.5*(-1.54738519259859+3.16491408995795)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 55.4936614496921
variable C22all equal ${C22}
variable C22all equal 43.1612086077571
variable C33all equal ${C33}
variable C33all equal 36.9344164011497

variable C44all equal ${C44}
variable C44all equal 13.3557566921154
variable C55all equal ${C55}
variable C55all equal -2.55532172944384
variable C66all equal ${C66}
variable C66all equal 0.80876444867968

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(25.4417514304222+${C21})
variable C12all equal 0.5*(25.4417514304222+22.3023971221514)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(19.4089256563074+${C31})
variable C13all equal 0.5*(19.4089256563074+20.6326474831401)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(28.5368552208358+${C32})
variable C23all equal 0.5*(28.5368552208358+52.2863025564864)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-17.8078027200541+${C41})
variable C14all equal 0.5*(-17.8078027200541+3.02421357376556)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-27.8143289384682+${C51})
variable C15all equal 0.5*(-27.8143289384682+8.0234042152039)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(24.2669762071499+${C61})
variable C16all equal 0.5*(24.2669762071499+4.13244264598367)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-36.0104580904473+${C42})
variable C24all equal 0.5*(-36.0104580904473+6.42170271529928)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-24.1785207977364+${C52})
variable C25all equal 0.5*(-24.1785207977364+-7.05437294188716)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(51.5450739284993+${C62})
variable C26all equal 0.5*(51.5450739284993+4.31632027212495)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-35.6384123362811+${C43})
variable C34all equal 0.5*(-35.6384123362811+-6.23707498101798)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-15.133239101727+${C53})
variable C35all equal 0.5*(-15.133239101727+-7.29886067301972)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(0.813077513632997+${C63})
variable C36all equal 0.5*(0.813077513632997+-7.67808841272516)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-0.433395118503299+${C54})
variable C45all equal 0.5*(-0.433395118503299+7.60891509684157)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(0.6929255956828+${C64})
variable C46all equal 0.5*(0.6929255956828+5.18280525315834)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(3.72541636532479+${C65})
variable C56all equal 0.5*(3.72541636532479+1.69338437367029)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:16:42
