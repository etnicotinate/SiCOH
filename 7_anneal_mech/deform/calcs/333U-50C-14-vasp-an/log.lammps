LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-14-vasp-an
read_data       ${structure}.data
read_data       333U-50C-14-vasp-an.data
Reading data file ...
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  371 atoms
  reading velocities ...
  371 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              330.86992      3808.1396    
         1   300            0              0              330.86992      3808.1396    
Loop time of 7.12567e-05 on 8 procs for 1 steps with 371 atoms

58.8% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.33e-07   | 2.0713e-07 | 3.19e-07   |   0.0 |  0.29
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.53e-07   | 1.2364e-06 | 1.651e-06  |   0.0 |  1.74
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.981e-05  |            |       | 97.97

Nlocal:         46.375 ave          55 max          43 min
Histogram: 2 2 2 1 0 0 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128 | 128.9 | 129.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -43325.046     -15693.531      0              1.6763015      3971.7077    
       100   305.57611     -43335.38      -6444.3279      739.66752      1.6763015      3971.7077    
       200   286.21303     -43334.464     -3384.7786      319.46934      1.6763015      3971.7077    
       300   293.87135     -43367.621     -3681.532       3921.6598      1.6763015      3971.7077    
       400   279.90405     -43352.536      7077.1728     -1025.1317      1.6763015      3971.7077    
       500   322.12662     -43358.472     -675.36721     -1583.3057      1.6763015      3971.7077    
       600   306.90802     -43335.451     -6818.3097      2353.8651      1.6763015      3971.7077    
       700   306.31951     -43329.421      2661.7693      3256.9347      1.6763015      3971.7077    
       800   287.70154     -43319.094     -807.99962     -1365.8093      1.6763015      3971.7077    
       900   298.92109     -43351.652      5220.0141     -1681.3627      1.6763015      3971.7077    
      1000   280.00832     -43348.831      1531.3229      2803.1501      1.6763015      3971.7077    
      1100   280.25582     -43325.77      -151.06012      1069.9152      1.6763015      3971.7077    
      1200   296.84474     -43320.917      2250.8016     -130.9788       1.6763015      3971.7077    
      1300   320.40667     -43342.23       2150.6504      1527.0544      1.6763015      3971.7077    
      1400   293.33637     -43331.596      8858.2054      927.83824      1.6763015      3971.7077    
      1500   277.16569     -43333.059      2252.5429     -4763.2411      1.6763015      3971.7077    
      1600   297.65391     -43338.516      6453.9294      5022.53        1.6763015      3971.7077    
      1700   295.5922      -43312.378     -6955.6067      1477.2439      1.6763015      3971.7077    
      1800   284.70356     -43302.584     -909.11784      5145.4849      1.6763015      3971.7077    
      1900   320.91732     -43339.725      4929.5458      1122.2366      1.6763015      3971.7077    
      2000   305.2515      -43337.255      309.85598     -4006.7089      1.6763015      3971.7077    
Loop time of 64.4265 on 8 procs for 2000 steps with 371 atoms

Performance: 1.341 ns/day, 17.896 hours/ns, 31.043 timesteps/s, 11.517 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.975     | 51.534     | 52.775     |   7.3 | 79.99
Bond    | 0.00060855 | 0.00073236 | 0.00097063 |   0.0 |  0.00
Neigh   | 4.1918     | 4.2354     | 4.2676     |   1.2 |  6.57
Comm    | 1.1419     | 2.3809     | 2.9353     |  34.1 |  3.70
Output  | 0.0010379  | 0.001119   | 0.0015255  |   0.5 |  0.00
Modify  | 6.2082     | 6.2377     | 6.2777     |   0.8 |  9.68
Other   |            | 0.03681    |            |       |  0.06

Nlocal:         46.375 ave          55 max          42 min
Histogram: 1 2 1 2 0 1 0 0 0 1
Nghost:        3288.38 ave        3300 max        3277 min
Histogram: 2 0 1 1 0 0 1 1 0 2
Neighs:          30254 ave       35404 max       27496 min
Histogram: 1 2 1 2 0 1 0 0 0 1

Total # of neighbors = 242032
Ave neighs/atom = 652.37736
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-14-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.4710092615794
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.2849287488288
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.1508862322674

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--4006.70891782338)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--4006.70891782338)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--4451.77905664765)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--4451.77905664765)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--4379.19553135758)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--4379.19553135758)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-695.212952469887)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-695.212952469887)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-291.583894988274)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-291.583894988274)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1344.78436317295)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1344.78436317295)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 16.4710092615794
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.4710092615794
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.164710092615794 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.164710092615794 xy delta -0.0703764762256972 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.164710092615794 xy delta -0.0703764762256972 xz delta -0.00273709198293003 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1713.8467      6051.309       3969.7218    
       200   282.9407      -43355.502     -10653.884      2214.7908      3967.736     
       300   282.64546     -43343.204      8040.1146      3996.3337      3965.7501    
       400   302.38955     -43325.877      6397.0603     -72.298374      3963.7643    
       500   305.25947     -43320.658      2763.012       1548.5241      3961.7784    
       600   291.22793     -43318.355     -4751.0471      2454.1924      3959.7925    
       700   295.13436     -43344.333      12250.219      5960.5422      3957.8067    
       800   280.27953     -43339.247     -15546.332      2340.2426      3955.8208    
       900   309.02411     -43341.509     -851.82401      3123.4121      3953.835     
      1000   299.5374      -43309.155     -6069.5074     -1336.78        3951.8491    
      1100   294.74548     -43306.192      7690.1388      2403.3439      3949.8633    
      1200   295.91759     -43327.95      -12414.104      1738.9158      3947.8774    
      1300   296.46426     -43361.937      6519.6503      11062.132      3945.8916    
      1400   280.79388     -43337.334     -7376.5739      7816.6487      3943.9057    
      1500   289.81467     -43324.353      2680.0697      3001.9614      3941.9199    
      1600   319.64231     -43346.675      5388.7057      6000.3079      3939.934     
      1700   302.83483     -43318.157      1813.1921      524.83076      3937.9482    
      1800   311.14798     -43310.164     -2430.305       5130.1699      3935.9623    
      1900   312.73354     -43303.231     -1217.4686      7335.1473      3933.9764    
      2000   296.81542     -43310.15      -11130.841      8083.8169      3931.9906    
Loop time of 64.4472 on 8 procs for 2000 steps with 371 atoms

Performance: 1.341 ns/day, 17.902 hours/ns, 31.033 timesteps/s, 11.513 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.231     | 51.742     | 53.458     |   9.4 | 80.29
Bond    | 0.00055788 | 0.00064985 | 0.00073181 |   0.0 |  0.00
Neigh   | 4.2259     | 4.268      | 4.3104     |   1.2 |  6.62
Comm    | 0.44652    | 2.1573     | 2.6747     |  45.8 |  3.35
Output  | 0.0034036  | 0.0042023  | 0.0047417  |   0.7 |  0.01
Modify  | 6.1868     | 6.236      | 6.2738     |   1.0 |  9.68
Other   |            | 0.03902    |            |       |  0.06

Nlocal:         46.375 ave          53 max          43 min
Histogram: 1 1 2 2 0 0 1 0 0 1
Nghost:        3321.38 ave        3339 max        3304 min
Histogram: 1 1 1 0 1 2 0 0 0 2
Neighs:        30548.6 ave       34693 max       28476 min
Histogram: 2 1 1 2 0 1 0 0 0 1

Total # of neighbors = 244389
Ave neighs/atom = 658.73046
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 122.50725269724
variable C2neg equal ${d2}
variable C2neg equal 7.5807406090016
variable C3neg equal ${d3}
variable C3neg equal 12.0306916253589
variable C4neg equal ${d4}
variable C4neg equal -20.6690832894024
variable C5neg equal ${d5}
variable C5neg equal -14.9597898440711
variable C6neg equal ${d6}
variable C6neg equal -1.13189244994443

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.4710092615794
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.164710092615794 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.164710092615794 xy delta 0.0703764762256972 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.164710092615794 xy delta 0.0703764762256972 xz delta 0.00273709198293003 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1712.1337      6050.6058      3973.6935    
       200   282.57747     -43355.167     -10547.8        1626.6019      3975.6794    
       300   282.25997     -43343.057      6845.4525      3505.1314      3977.6652    
       400   295.46856     -43317.227      3206.0527      628.33076      3979.6511    
       500   313.46599     -43329.339     -4047.8503     -1610.4673      3981.6369    
       600   297.44171     -43325.817     -6172.7258     -823.72587      3983.6228    
       700   295.79993     -43344.35       6372.116       374.30433      3985.6086    
       800   273.41876     -43329.647     -8347.1124      2562.7198      3987.5945    
       900   306.73703     -43332.806     -5009.9192     -2896.6962      3989.5804    
      1000   311.41318     -43321.718     -4003.9099     -1099.7317      3991.5662    
      1100   298.06987     -43311.592      2449.8216      736.1579       3993.5521    
      1200   305.29021     -43334.44      -125.61841      538.73696      3995.5379    
      1300   276.88104     -43339.888     -1894.8819      9832.7879      3997.5238    
      1400   297.30963     -43359.954     -1725.8943     -2136.1106      3999.5096    
      1500   293.97441     -43335.448     -1326.4172     -2561.1982      4001.4955    
      1600   301.03451     -43328.083     -5578.806      -3567.2722      4003.4813    
      1700   304.87588     -43323.849      2396.8338     -922.28103      4005.4672    
      1800   291.20183     -43304.77       3409.3586     -1681.5889      4007.453     
      1900   309.29902     -43323.736     -3176.354      -2314.6603      4009.4389    
      2000   292.53884     -43329.341     -16148.653     -3961.0757      4011.4247    
Loop time of 78.3591 on 8 procs for 2000 steps with 371 atoms

Performance: 1.103 ns/day, 21.766 hours/ns, 25.524 timesteps/s, 9.469 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.262     | 56.104     | 64.235     |  72.4 | 71.60
Bond    | 0.00058797 | 0.00067129 | 0.00079138 |   0.0 |  0.00
Neigh   | 4.1804     | 4.5581     | 5.3146     |  22.0 |  5.82
Comm    | 1.8708     | 10.012     | 14.862     | 171.5 | 12.78
Output  | 0.0034752  | 0.0042401  | 0.0047448  |   0.7 |  0.01
Modify  | 6.8826     | 7.6436     | 8.0183     |  17.0 |  9.75
Other   |            | 0.03626    |            |       |  0.05

Nlocal:         46.375 ave          56 max          43 min
Histogram: 3 1 2 1 0 0 0 0 0 1
Nghost:        3270.12 ave        3293 max        3252 min
Histogram: 1 1 3 0 0 0 0 1 1 1
Neighs:        29957.9 ave       35781 max       27812 min
Histogram: 3 1 2 1 0 0 0 0 0 1

Total # of neighbors = 239663
Ave neighs/atom = 645.99191
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -0.462378832247868
variable C2pos equal ${d2}
variable C2pos equal 17.3819170590191
variable C3pos equal ${d3}
variable C3pos equal 51.7988559379538
variable C4pos equal ${d4}
variable C4pos equal -2.45777430171452
variable C5pos equal ${d5}
variable C5pos equal 8.29157483740595
variable C6pos equal ${d6}
variable C6pos equal 16.6795600107522

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(122.50725269724+${C1pos})
variable C11 equal 0.5*(122.50725269724+-0.462378832247868)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(7.5807406090016+${C2pos})
variable C21 equal 0.5*(7.5807406090016+17.3819170590191)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(12.0306916253589+${C3pos})
variable C31 equal 0.5*(12.0306916253589+51.7988559379538)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-20.6690832894024+${C4pos})
variable C41 equal 0.5*(-20.6690832894024+-2.45777430171452)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-14.9597898440711+${C5pos})
variable C51 equal 0.5*(-14.9597898440711+8.29157483740595)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-1.13189244994443+${C6pos})
variable C61 equal 0.5*(-1.13189244994443+16.6795600107522)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.2849287488288
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.2849287488288
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.132849287488288 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.132849287488288 yz delta 0.00525986406681728 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1713.8467      6051.309       3969.7218    
       200   282.67352     -43355.585     -10683.521      2013.7032      3967.736     
       300   279.70983     -43339.535      8692.8579      3930.8216      3965.7501    
       400   299.57362     -43322.511      5978.9913      223.30927      3963.7643    
       500   307.57783     -43322.031      1515.1353      328.40393      3961.7784    
       600   284.77208     -43301.328     -816.53252      2768.0176      3959.7925    
       700   295.47098     -43333.192      5223.4093      5142.9838      3957.8067    
       800   272.74758     -43325.149     -6361.3509      3911.9028      3955.8208    
       900   305.40764     -43345.95      -947.41682      1706.0641      3953.835     
      1000   304.05171     -43308.733      3491.3485      2382.7213      3951.8491    
      1100   320.40001     -43321.501      10481.154      3674.4554      3949.8633    
      1200   292.29303     -43301.509      4130.6752      10324.088      3947.8774    
      1300   283.31218     -43322.588      4016.0401      8463.0148      3945.8916    
      1400   295.76301     -43356.46      -1273.2528      1521.3657      3943.9057    
      1500   298.58467     -43347.357      4182.7974      1513.651       3941.9199    
      1600   288.94776     -43319.028      4303.8544     -42.691392      3939.934     
      1700   317.28174     -43331.782     -2240.0439     -244.58541      3937.9482    
      1800   282.76464     -43294.066      10141.357     -544.60478      3935.9623    
      1900   283.24253     -43336.25       3863.7126      1394.1618      3933.9764    
      2000   285.89741     -43348.481     -1692.8433      4548.3022      3931.9906    
Loop time of 87.9237 on 8 procs for 2000 steps with 371 atoms

Performance: 0.983 ns/day, 24.423 hours/ns, 22.747 timesteps/s, 8.439 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.492     | 60.544     | 73.14      | 122.8 | 68.86
Bond    | 0.0004651  | 0.00060655 | 0.00072144 |   0.0 |  0.00
Neigh   | 4.2518     | 4.8985     | 6.0604     |  37.0 |  5.57
Comm    | 1.0822     | 13.658     | 21.716     | 258.5 | 15.53
Output  | 0.0036786  | 0.0043508  | 0.0048179  |   0.6 |  0.00
Modify  | 7.6159     | 8.7825     | 9.4281     |  27.8 |  9.99
Other   |            | 0.03517    |            |       |  0.04

Nlocal:         46.375 ave          57 max          42 min
Histogram: 2 1 2 1 1 0 0 0 0 1
Nghost:        3298.75 ave        3321 max        3276 min
Histogram: 1 0 2 0 1 2 0 0 0 2
Neighs:        30556.5 ave       37182 max       27911 min
Histogram: 2 2 1 2 0 0 0 0 0 1

Total # of neighbors = 244452
Ave neighs/atom = 658.90027
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 86.6836498999614
variable C2neg equal ${d2}
variable C2neg equal 94.1958841734426
variable C3neg equal ${d3}
variable C3neg equal 19.4762849258122
variable C4neg equal ${d4}
variable C4neg equal 0.0265164250494718
variable C5neg equal ${d5}
variable C5neg equal 1.07242211981294
variable C6neg equal ${d6}
variable C6neg equal 0.783004139902411

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.2849287488288
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.132849287488288 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.132849287488288 yz delta -0.00525986406681728 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1712.1337      6050.6058      3973.6935    
       200   283.49219     -43356.074     -10890.052      1778.9296      3975.6794    
       300   284.6773      -43345.458      6294.6861      3970.5682      3977.6652    
       400   296.65983     -43318.383      2791.3956      422.87499      3979.6511    
       500   303.8262      -43317.858     -230.67806     -189.24863      3981.6369    
       600   286.56606     -43309.934      2176.8054      282.58308      3983.6228    
       700   287.75251     -43332.374      14266.916      5922.5453      3985.6086    
       800   270.74095     -43323.822     -11131.583      2093.9747      3987.5945    
       900   329.23466     -43357.36      -9304.6074     -2027.4413      3989.5804    
      1000   306.72003     -43315.681      9182.9387     -531.96652      3991.5662    
      1100   301.09692     -43318.545     -1555.7458     -611.34729      3993.5521    
      1200   296.60651     -43331.254     -4172.0418      3732.811       3995.5379    
      1300   295.62939     -43368.966      3454.3427      8907.3098      3997.5238    
      1400   275.60801     -43345.315     -3977.4207     -1676.0594      3999.5096    
      1500   284.33198     -43328.902      2976.2163     -878.27597      4001.4955    
      1600   319.15314     -43348.969      2323.427       804.75323      4003.4813    
      1700   285.38353     -43302.221      1450.5832      4067.488       4005.4672    
      1800   307.40962     -43320.923      7298.492       3040.3844      4007.453     
      1900   315.50522     -43335.1       -4390.1146      2508.9614      4009.4389    
      2000   285.84298     -43324.511     -6302.3424     -761.96754      4011.4247    
Loop time of 88.7904 on 8 procs for 2000 steps with 371 atoms

Performance: 0.973 ns/day, 24.664 hours/ns, 22.525 timesteps/s, 8.357 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.488     | 61.096     | 74.143     | 124.0 | 68.81
Bond    | 0.00048524 | 0.00067495 | 0.00078276 |   0.0 |  0.00
Neigh   | 4.2008     | 4.8859     | 6.0174     |  38.1 |  5.50
Comm    | 0.87352    | 13.905     | 22.514     | 259.8 | 15.66
Output  | 0.0036855  | 0.0044385  | 0.0049489  |   0.6 |  0.00
Modify  | 7.714      | 8.8645     | 9.5405     |  28.5 |  9.98
Other   |            | 0.03389    |            |       |  0.04

Nlocal:         46.375 ave          53 max          43 min
Histogram: 3 1 0 0 1 0 2 0 0 1
Nghost:        3275.12 ave        3289 max        3260 min
Histogram: 1 1 0 0 1 1 2 1 0 1
Neighs:        29942.5 ave       33958 max       27727 min
Histogram: 3 1 0 0 1 1 1 0 0 1

Total # of neighbors = 239540
Ave neighs/atom = 645.66038
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -32.877342009455
variable C2pos equal ${d2}
variable C2pos equal 1.66078108919297
variable C3pos equal ${d3}
variable C3pos equal 15.0492394199059
variable C4pos equal ${d4}
variable C4pos equal -17.2158513244448
variable C5pos equal ${d5}
variable C5pos equal 6.82525910694251
variable C6pos equal ${d6}
variable C6pos equal 11.6366821336961

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(86.6836498999614+${C1pos})
variable C12 equal 0.5*(86.6836498999614+-32.877342009455)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(94.1958841734426+${C2pos})
variable C22 equal 0.5*(94.1958841734426+1.66078108919297)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(19.4762849258122+${C3pos})
variable C32 equal 0.5*(19.4762849258122+15.0492394199059)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(0.0265164250494718+${C4pos})
variable C42 equal 0.5*(0.0265164250494718+-17.2158513244448)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(1.07242211981294+${C5pos})
variable C52 equal 0.5*(1.07242211981294+6.82525910694251)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(0.783004139902411+${C6pos})
variable C62 equal 0.5*(0.783004139902411+11.6366821336961)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.1508862322674
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.1508862322674
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.181508862322674 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1713.8467      6051.309       3969.7218    
       200   282.73612     -43355.84      -10635.404      2036.7672      3967.736     
       300   280.54528     -43340.926      9141.5663      3438.2819      3965.7501    
       400   301.55068     -43325.264      5766.3144      375.64998      3963.7643    
       500   310.86256     -43328.815      3440.1002      1941.8138      3961.7784    
       600   285.25082     -43313.264      2717.4012      2130.1533      3959.7925    
       700   306.25106     -43356.202      6361.9086      1527.9674      3957.8067    
       800   284.47368     -43341.713     -2622.5988      2678.0254      3955.8208    
       900   312.25874     -43341.654      7194.9221      2828.7373      3953.835     
      1000   303.025       -43312.602      4255.7046     -795.91579      3951.8491    
      1100   316.1932      -43324.086      399.26499      3423.3824      3949.8633    
      1200   312.82465     -43341.852     -627.60565      3647.5299      3947.8774    
      1300   289.02772     -43353.402      7085.2237      8659.7302      3945.8916    
      1400   273.7176      -43337.989     -1083.0129     -2572.714       3943.9057    
      1500   294.65279     -43338.46      -231.64018      5327.6213      3941.9199    
      1600   301.80821     -43324.555     -9811.1789      1201.1106      3939.934     
      1700   313.67668     -43331.736     -3574.8524      3871.7015      3937.9482    
      1800   280.08982     -43313.185     -1494.1448      4214.3528      3935.9623    
      1900   291.17802     -43333.439      4479.9341      3112.3961      3933.9764    
      2000   303.50661     -43376.104      4699.1932      2837.2969      3931.9906    
Loop time of 87.7315 on 8 procs for 2000 steps with 371 atoms

Performance: 0.985 ns/day, 24.370 hours/ns, 22.797 timesteps/s, 8.458 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.726     | 59.936     | 72.816     | 126.4 | 68.32
Bond    | 0.00049152 | 0.00061405 | 0.00071323 |   0.0 |  0.00
Neigh   | 4.3476     | 5.0186     | 6.1364     |  37.5 |  5.72
Comm    | 1.1252     | 13.989     | 22.198     | 261.4 | 15.94
Output  | 0.0037941  | 0.0045232  | 0.0049883  |   0.6 |  0.01
Modify  | 7.6238     | 8.7487     | 9.4243     |  28.6 |  9.97
Other   |            | 0.03456    |            |       |  0.04

Nlocal:         46.375 ave          53 max          43 min
Histogram: 1 1 2 1 1 1 0 0 0 1
Nghost:         3323.5 ave        3335 max        3307 min
Histogram: 1 0 1 0 0 1 1 3 0 1
Neighs:        30563.1 ave       34667 max       28462 min
Histogram: 2 0 3 1 0 1 0 0 0 1

Total # of neighbors = 244505
Ave neighs/atom = 659.04313
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 69.3468889684723
variable C2neg equal ${d2}
variable C2neg equal 32.2769456457399
variable C3neg equal ${d3}
variable C3neg equal -17.0904115090432
variable C4neg equal ${d4}
variable C4neg equal 4.08608998018025
variable C5neg equal ${d5}
variable C5neg equal -6.77492493051373
variable C6neg equal ${d6}
variable C6neg equal -7.67706008521416

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.1508862322674
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.181508862322674 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1712.1337      6050.6058      3973.6935    
       200   282.94962     -43355.353     -10633.041      1794.8879      3975.6794    
       300   283.40958     -43344.025      7962.2635      3487.4993      3977.6652    
       400   297.73001     -43319.615      11536.868      420.40594      3979.6511    
       500   302.29434     -43317.012      4307.0792      1869.3875      3981.6369    
       600   286.98659     -43308.071     -1129.2334      1844.0241      3983.6228    
       700   311.34595     -43354.731      6840.157       2148.0626      3985.6086    
       800   289.11818     -43346.782     -5171.7083      2930.9858      3987.5945    
       900   321.18827     -43376.288      1553.8275     -989.35595      3989.5804    
      1000   309.69708     -43330.862      6768.1183     -1314.1583      3991.5662    
      1100   302.05977     -43304.245      12668.847      3557.3812      3993.5521    
      1200   310.81158     -43318.431      1528.0726      3064.1679      3995.5379    
      1300   285.20317     -43329.464     -1533.8813      5141.0173      3997.5238    
      1400   282.16001     -43330.751     -4184.429       481.30626      3999.5096    
      1500   278.48644     -43306.904     -9943.5822      826.47688      4001.4955    
      1600   303.65543     -43312.761      3872.1618      1173.8839      4003.4813    
      1700   316.79962     -43322.373      5803.6365      235.07407      4005.4672    
      1800   319.09751     -43338.102     -9539.3204      2840.6962      4007.453     
      1900   273.39527     -43325.744     -1988.4773      1107.8934      4009.4389    
      2000   286.37375     -43339.028      361.4949       4864.5378      4011.4247    
Loop time of 87.8216 on 8 procs for 2000 steps with 371 atoms

Performance: 0.984 ns/day, 24.395 hours/ns, 22.773 timesteps/s, 8.449 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.505     | 60.207     | 73.069     | 126.5 | 68.56
Bond    | 0.00047375 | 0.00066468 | 0.00077816 |   0.0 |  0.00
Neigh   | 4.2011     | 4.8437     | 5.9252     |  36.5 |  5.52
Comm    | 1.1807     | 14.026     | 22.731     | 261.9 | 15.97
Output  | 0.0036899  | 0.0044009  | 0.0049042  |   0.6 |  0.01
Modify  | 7.6306     | 8.7064     | 9.3439     |  27.4 |  9.91
Other   |            | 0.03358    |            |       |  0.04

Nlocal:         46.375 ave          52 max          43 min
Histogram: 2 2 1 0 0 0 0 2 0 1
Nghost:           3291 ave        3314 max        3278 min
Histogram: 2 2 1 0 0 1 0 0 1 1
Neighs:        29927.2 ave       33313 max       27925 min
Histogram: 4 0 1 0 0 0 0 2 0 1

Total # of neighbors = 239418
Ave neighs/atom = 645.33154
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -89.8879071091149
variable C2pos equal ${d2}
variable C2pos equal -30.2057350450049
variable C3pos equal ${d3}
variable C3pos equal 32.6073059181001
variable C4pos equal ${d4}
variable C4pos equal -12.0320279725748
variable C5pos equal ${d5}
variable C5pos equal 10.1283792822401
variable C6pos equal ${d6}
variable C6pos equal 13.2780520577302

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(69.3468889684723+${C1pos})
variable C13 equal 0.5*(69.3468889684723+-89.8879071091149)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(32.2769456457399+${C2pos})
variable C23 equal 0.5*(32.2769456457399+-30.2057350450049)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-17.0904115090432+${C3pos})
variable C33 equal 0.5*(-17.0904115090432+32.6073059181001)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(4.08608998018025+${C4pos})
variable C43 equal 0.5*(4.08608998018025+-12.0320279725748)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-6.77492493051373+${C5pos})
variable C53 equal 0.5*(-6.77492493051373+10.1283792822401)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-7.67706008521416+${C6pos})
variable C63 equal 0.5*(-7.67706008521416+13.2780520577302)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.1508862322674
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.1508862322674
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.181508862322674 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1712.9898      6050.9572      3971.7077    
       200   282.37203     -43355.155     -10885.227      1899.5481      3971.7077    
       300   281.16709     -43340.754      7872.4609      3574.4266      3971.7077    
       400   299.43714     -43321.138      1408.6368      162.05009      3971.7077    
       500   313.45135     -43329.23       1121.6831      980.90181      3971.7077    
       600   282.45838     -43307.967     -8822.5977     -388.0967       3971.7077    
       700   299.40235     -43346.698      6547.9081      3540.7672      3971.7077    
       800   283.48976     -43330.613     -3197.4887      2543.4287      3971.7077    
       900   329.00445     -43342.192     -1651.4178     -1574.8086      3971.7077    
      1000   306.36234     -43313.462     -495.00874     -2584.1946      3971.7077    
      1100   299.97315     -43317.007      3257.5157      1410.5416      3971.7077    
      1200   290.38561     -43333.664     -3168.9217      2872.0609      3971.7077    
      1300   284.8646      -43355.748     -3553.7578      4982.7139      3971.7077    
      1400   292.34288     -43356.55       6640.7964      2029.7638      3971.7077    
      1500   291.53228     -43336.756     -7813.7917     -1931.8997      3971.7077    
      1600   290.70829     -43311.566     -3780.181      -4082.5275      3971.7077    
      1700   297.6718      -43305.676      3709.1046     -615.63565      3971.7077    
      1800   289.55994     -43295.127      2947.3543      3701.4774      3971.7077    
      1900   299.20449     -43329.366     -6466.5994      795.44744      3971.7077    
      2000   296.72697     -43354.752     -1502.7686      1451.6094      3971.7077    
Loop time of 87.2356 on 8 procs for 2000 steps with 371 atoms

Performance: 0.990 ns/day, 24.232 hours/ns, 22.926 timesteps/s, 8.506 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.367     | 59.838     | 72.585     | 125.4 | 68.59
Bond    | 0.00047035 | 0.00064087 | 0.00075794 |   0.0 |  0.00
Neigh   | 4.2389     | 4.8908     | 5.9703     |  36.9 |  5.61
Comm    | 1.1011     | 13.83      | 22.307     | 260.7 | 15.85
Output  | 0.0037831  | 0.0044746  | 0.0049256  |   0.6 |  0.01
Modify  | 7.552      | 8.6363     | 9.2875     |  27.9 |  9.90
Other   |            | 0.03449    |            |       |  0.04

Nlocal:         46.375 ave          54 max          43 min
Histogram: 3 1 2 0 0 1 0 0 0 1
Nghost:           3292 ave        3310 max        3276 min
Histogram: 3 0 0 0 1 1 1 0 0 2
Neighs:        30248.9 ave       34960 max       28201 min
Histogram: 2 2 2 0 0 1 0 0 0 1

Total # of neighbors = 241991
Ave neighs/atom = 652.26685
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 55.3064107544356
variable C2neg equal ${d2}
variable C2neg equal 15.3179201213581
variable C3neg equal ${d3}
variable C3neg equal -14.5962535604053
variable C4neg equal ${d4}
variable C4neg equal 13.906735518005
variable C5neg equal ${d5}
variable C5neg equal -22.0337728516474
variable C6neg equal ${d6}
variable C6neg equal -4.66068333116911

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.1508862322674
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.181508862322674 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1712.9898      6050.9572      3971.7077    
       200   283.1558      -43356.035     -10694.417      1881.3873      3971.7077    
       300   282.78529     -43343.661      9068.8138      3914.6887      3971.7077    
       400   294.32908     -43316.498      2934.5026     -322.19805      3971.7077    
       500   307.27894     -43322.541     -5841.3485      635.54717      3971.7077    
       600   290.59352     -43315.676     -2998.9329      741.37932      3971.7077    
       700   297.60297     -43346.066      7243.4405      4529.0583      3971.7077    
       800   282.50818     -43331.604     -4269.5264      3754.5104      3971.7077    
       900   327.07485     -43341.729     -3266.3039      160.82716      3971.7077    
      1000   293.31193     -43300.615     -5555.3631     -2228.6532      3971.7077    
      1100   287.26566     -43302.177     -2951.0604     -909.36647      3971.7077    
      1200   300.92381     -43326.008      7871.0961      6185.5844      3971.7077    
      1300   270.99047     -43319.82       10458.767      7107.8634      3971.7077    
      1400   292.60039     -43353.444      186.30444      2926.7982      3971.7077    
      1500   292.38564     -43330.81      -11571.227      554.27625      3971.7077    
      1600   297.79253     -43312.299     -5459.3003      1489.9125      3971.7077    
      1700   304.11062     -43318.286      3981.88        5679.1021      3971.7077    
      1800   294.88295     -43322.173      3337.2227      4721.2864      3971.7077    
      1900   302.47522     -43348.572     -2038.6439      2563.8757      3971.7077    
      2000   307.7635      -43363.835      1809.3975     -504.88602      3971.7077    
Loop time of 88.4931 on 8 procs for 2000 steps with 371 atoms

Performance: 0.976 ns/day, 24.581 hours/ns, 22.601 timesteps/s, 8.385 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.097     | 61.031     | 74.138     | 121.0 | 68.97
Bond    | 0.00047201 | 0.00063564 | 0.000707   |   0.0 |  0.00
Neigh   | 4.2055     | 4.8678     | 6.0218     |  37.7 |  5.50
Comm    | 0.7063     | 13.797     | 21.736     | 254.4 | 15.59
Output  | 0.0037113  | 0.0044101  | 0.0049233  |   0.6 |  0.00
Modify  | 7.5846     | 8.7587     | 9.4131     |  28.4 |  9.90
Other   |            | 0.03398    |            |       |  0.04

Nlocal:         46.375 ave          56 max          43 min
Histogram: 4 1 0 1 1 0 0 0 0 1
Nghost:        3293.25 ave        3310 max        3275 min
Histogram: 2 1 0 0 0 2 0 0 0 3
Neighs:        30251.2 ave       36140 max       28116 min
Histogram: 4 1 0 1 1 0 0 0 0 1

Total # of neighbors = 242010
Ave neighs/atom = 652.31806
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -35.4822205481015
variable C2pos equal ${d2}
variable C2pos equal -64.822340174716
variable C3pos equal ${d3}
variable C3pos equal 4.53503214902987
variable C4pos equal ${d4}
variable C4pos equal -8.76942690772019
variable C5pos equal ${d5}
variable C5pos equal 3.77640969959655
variable C6pos equal ${d6}
variable C6pos equal 3.78308998103914

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(55.3064107544356+${C1pos})
variable C14 equal 0.5*(55.3064107544356+-35.4822205481015)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(15.3179201213581+${C2pos})
variable C24 equal 0.5*(15.3179201213581+-64.822340174716)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-14.5962535604053+${C3pos})
variable C34 equal 0.5*(-14.5962535604053+4.53503214902987)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(13.906735518005+${C4pos})
variable C44 equal 0.5*(13.906735518005+-8.76942690772019)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-22.0337728516474+${C5pos})
variable C54 equal 0.5*(-22.0337728516474+3.77640969959655)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-4.66068333116911+${C6pos})
variable C64 equal 0.5*(-4.66068333116911+3.78308998103914)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.1508862322674
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.1508862322674
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.181508862322674 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1712.9898      6050.9572      3971.7077    
       200   282.7869      -43355.441     -10846.183      1917.2739      3971.7077    
       300   280.42808     -43340.769      9778.3181      4028.2803      3971.7077    
       400   302.05125     -43324.281      10302.771      250.34436      3971.7077    
       500   315.15712     -43332.158     -581.76534      1165.4847      3971.7077    
       600   283.08321     -43310.203     -1906.5697      1195.2747      3971.7077    
       700   298.70007     -43345.744     -670.50115      1443.0765      3971.7077    
       800   290.27599     -43338.7       -4961.9887      3023.5289      3971.7077    
       900   307.88039     -43321.857     -7574.1269      1037.0968      3971.7077    
      1000   306.75995     -43309.665     -1313.4023      2308.884       3971.7077    
      1100   327.50752     -43339.632     -7026.7289      3075.9557      3971.7077    
      1200   311.39056     -43347.411     -5182.9366      1109.3413      3971.7077    
      1300   286.36524     -43352.872      3825.3726      8778.1281      3971.7077    
      1400   292.86841     -43352.139     -8184.1054      808.30837      3971.7077    
      1500   283.89044     -43322.321      993.34584      4679.8713      3971.7077    
      1600   300.75145     -43324.229     -9940.306       5232.7224      3971.7077    
      1700   312.5763      -43331.059     -7169.7834      2049.6585      3971.7077    
      1800   307.31579     -43325.257      5986.0383      1269.1141      3971.7077    
      1900   274.03878     -43308.686     -3614.6186     -398.1793       3971.7077    
      2000   272.48442     -43320.335      502.20755      2948.8194      3971.7077    
Loop time of 88.412 on 8 procs for 2000 steps with 371 atoms

Performance: 0.977 ns/day, 24.559 hours/ns, 22.621 timesteps/s, 8.393 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.707     | 60.839     | 73.77      | 122.4 | 68.81
Bond    | 0.00045649 | 0.00060432 | 0.0006971  |   0.0 |  0.00
Neigh   | 4.2012     | 4.9003     | 6.1843     |  39.4 |  5.54
Comm    | 0.88883    | 13.803     | 21.938     | 256.9 | 15.61
Output  | 0.0037231  | 0.004416   | 0.0048983  |   0.6 |  0.00
Modify  | 7.5428     | 8.8302     | 9.5311     |  29.5 |  9.99
Other   |            | 0.0341     |            |       |  0.04

Nlocal:         46.375 ave          57 max          42 min
Histogram: 3 2 0 0 1 1 0 0 0 1
Nghost:         3286.5 ave        3307 max        3264 min
Histogram: 1 0 0 2 1 1 1 0 1 1
Neighs:        30262.5 ave       36814 max       27465 min
Histogram: 3 2 0 0 1 1 0 0 0 1

Total # of neighbors = 242100
Ave neighs/atom = 652.56065
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 70.4768902670411
variable C2neg equal ${d2}
variable C2neg equal 31.7820679515614
variable C3neg equal ${d3}
variable C3neg equal 15.2196296673558
variable C4neg equal ${d4}
variable C4neg equal -9.18773612507738
variable C5neg equal ${d5}
variable C5neg equal 9.25208591738865
variable C6neg equal ${d6}
variable C6neg equal -7.20837628290348

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.1508862322674
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.181508862322674 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1712.9898      6050.9572      3971.7077    
       200   282.77941     -43355.744     -10771.337      1916.727       3971.7077    
       300   282.24596     -43341.646      8808.6094      3503.2746      3971.7077    
       400   302.04975     -43324.301      3598.2225      614.72589      3971.7077    
       500   311.09406     -43326.924     -231.08544      1649.9003      3971.7077    
       600   285.4645      -43312.699     -653.79292      1109.2612      3971.7077    
       700   303.108       -43351.056     -473.48465      3535.5517      3971.7077    
       800   277.32073     -43326.378      1744.1697      2675.5328      3971.7077    
       900   331.20817     -43349.871      9295.6971      594.05643      3971.7077    
      1000   310.52468     -43316.041      1524.6258     -300.50296      3971.7077    
      1100   309.95374     -43321.756      7057.8408      6040.2684      3971.7077    
      1200   284.65002     -43320.794     -6004.4227     -1905.9533      3971.7077    
      1300   271.91283     -43331.921      8566.093       3045.8462      3971.7077    
      1400   295.41593     -43354.093     -3532.3361      5995.2375      3971.7077    
      1500   304.62882     -43350.89      -6743.8405      4138.2999      3971.7077    
      1600   314.35831     -43347.722     -1151.4787      1374.8044      3971.7077    
      1700   301.15673     -43320.37      -1827.3092      1623.992       3971.7077    
      1800   296.51554     -43294.725      6850.241      -521.12192      3971.7077    
      1900   324.24844     -43309.352     -480.10296      3848.0453      3971.7077    
      2000   311.81583     -43312.005     -8145.3927     -709.87036      3971.7077    
Loop time of 87.8223 on 8 procs for 2000 steps with 371 atoms

Performance: 0.984 ns/day, 24.395 hours/ns, 22.773 timesteps/s, 8.449 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.056     | 60.472     | 73.097     | 123.8 | 68.86
Bond    | 0.00049439 | 0.0006361  | 0.00078347 |   0.0 |  0.00
Neigh   | 4.2359     | 4.8881     | 5.9566     |  36.5 |  5.57
Comm    | 1.126      | 13.751     | 22.175     | 259.6 | 15.66
Output  | 0.0036811  | 0.0044413  | 0.0049156  |   0.7 |  0.01
Modify  | 7.6023     | 8.6718     | 9.3193     |  27.5 |  9.87
Other   |            | 0.03458    |            |       |  0.04

Nlocal:         46.375 ave          53 max          41 min
Histogram: 2 0 1 0 0 4 0 0 0 1
Nghost:           3294 ave        3318 max        3274 min
Histogram: 2 0 1 1 0 1 1 1 0 1
Neighs:        30265.2 ave       34331 max       26867 min
Histogram: 2 0 1 0 0 3 1 0 0 1

Total # of neighbors = 242122
Ave neighs/atom = 652.61995
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -33.4052166638436
variable C2pos equal ${d2}
variable C2pos equal -31.6865916413945
variable C3pos equal ${d3}
variable C3pos equal 27.5564393026127
variable C4pos equal ${d4}
variable C4pos equal 3.91326575680815
variable C5pos equal ${d5}
variable C5pos equal 15.8909828307948
variable C6pos equal ${d6}
variable C6pos equal 7.83173895908542

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(70.4768902670411+${C1pos})
variable C15 equal 0.5*(70.4768902670411+-33.4052166638436)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(31.7820679515614+${C2pos})
variable C25 equal 0.5*(31.7820679515614+-31.6865916413945)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(15.2196296673558+${C3pos})
variable C35 equal 0.5*(15.2196296673558+27.5564393026127)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-9.18773612507738+${C4pos})
variable C45 equal 0.5*(-9.18773612507738+3.91326575680815)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(9.25208591738865+${C5pos})
variable C55 equal 0.5*(9.25208591738865+15.8909828307948)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-7.20837628290348+${C6pos})
variable C65 equal 0.5*(-7.20837628290348+7.83173895908542)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.2849287488288

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.2849287488288
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.132849287488288 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1712.9898      6050.9572      3971.7077    
       200   283.35271     -43356.184     -10736.015      1897.8223      3971.7077    
       300   282.01712     -43342.167      7651.1395      3513.754       3971.7077    
       400   301.60165     -43324.594      6224.3309      818.15062      3971.7077    
       500   311.83289     -43326.499      3582.1257      1311.8639      3971.7077    
       600   295.21099     -43318.566     -1063.0538      1917.0832      3971.7077    
       700   304.15001     -43349.533      13794.627      5515.8621      3971.7077    
       800   273.87522     -43328.174     -307.49104      4280.4879      3971.7077    
       900   304.43477     -43342.164     -4452.8612      1492.4363      3971.7077    
      1000   323.83781     -43335.406      3003.8901      1050.779       3971.7077    
      1100   312.43653     -43321.614      1543.321       3755.6676      3971.7077    
      1200   317.11473     -43345.321      4892.0902      4733.9192      3971.7077    
      1300   295.2772      -43357.009      2659.7852      4798.4569      3971.7077    
      1400   277.62108     -43334.337     -483.5161      -262.08805      3971.7077    
      1500   298.56961     -43332.258     -11307.937      668.01932      3971.7077    
      1600   301.9678      -43321.473     -1514.8074      3554.5714      3971.7077    
      1700   311.57588     -43328.31       786.63415      439.76942      3971.7077    
      1800   297.0237      -43329.216      585.89736      2427.1561      3971.7077    
      1900   291.21687     -43354.949      9305.5927      1988.2302      3971.7077    
      2000   294.12858     -43362.287      4676.6267      1897.9695      3971.7077    
Loop time of 88.0162 on 8 procs for 2000 steps with 371 atoms

Performance: 0.982 ns/day, 24.449 hours/ns, 22.723 timesteps/s, 8.430 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.389     | 60.748     | 73.538     | 123.1 | 69.02
Bond    | 0.00050107 | 0.00066656 | 0.00088409 |   0.0 |  0.00
Neigh   | 4.2077     | 4.8693     | 5.9982     |  37.6 |  5.53
Comm    | 0.97236    | 13.746     | 22.11      | 258.7 | 15.62
Output  | 0.0038062  | 0.0045293  | 0.005004   |   0.6 |  0.01
Modify  | 7.4767     | 8.613      | 9.2737     |  28.5 |  9.79
Other   |            | 0.03451    |            |       |  0.04

Nlocal:         46.375 ave          58 max          41 min
Histogram: 2 1 2 1 0 1 0 0 0 1
Nghost:        3283.62 ave        3306 max        3262 min
Histogram: 2 0 0 1 0 1 2 1 0 1
Neighs:        30264.8 ave       37501 max       26826 min
Histogram: 2 1 2 1 0 1 0 0 0 1

Total # of neighbors = 242118
Ave neighs/atom = 652.60916
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 59.8291537561125
variable C2neg equal ${d2}
variable C2neg equal -7.40508759084099
variable C3neg equal ${d3}
variable C3neg equal -0.825992615060791
variable C4neg equal ${d4}
variable C4neg equal -0.292239107549647
variable C5neg equal ${d5}
variable C5neg equal -4.34258259854391
variable C6neg equal ${d6}
variable C6neg equal -6.83130414381852

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.42379537 -0.23501437 0.24470688) to (16.894805 13.049914 18.395593) with tilt (7.0376476 0.2737092 -0.52598641)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.2849287488288
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.132849287488288 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 128.3 | 128.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.2515      -43337.255      309.83192      0              3971.7077    
       100   303.87161     -43359.263      1712.9898      6050.9572      3971.7077    
       200   282.136       -43354.793     -10927.142      1893.1504      3971.7077    
       300   282.38436     -43342.912      9576.3493      3820.3566      3971.7077    
       400   302.33445     -43324.738      8095.2936      767.48258      3971.7077    
       500   315.47326     -43331.841     -7276.2386      1072.7888      3971.7077    
       600   289.10712     -43317.733     -8523.7947      1070.593       3971.7077    
       700   294.45187     -43341.585      2935.4776      2040.9291      3971.7077    
       800   287.85344     -43336.625     -10863.543      2001.7194      3971.7077    
       900   309.28642     -43327.38       3139.5683     -397.88184      3971.7077    
      1000   302.8379      -43307.36      -4720.1318     -2366.594       3971.7077    
      1100   306.39461     -43316.913     -5813.9982      4524.9349      3971.7077    
      1200   292.09337     -43336.071      5465.3847      2321.4693      3971.7077    
      1300   288.36345     -43348.945     -3733.906       5610.7234      3971.7077    
      1400   303.43479     -43356.103     -821.91585     -3521.2796      3971.7077    
      1500   302.11272     -43334.016      296.05512      4543.9592      3971.7077    
      1600   302.90337     -43323.842     -2731.3258      255.12774      3971.7077    
      1700   293.36729     -43316.347      11398.16      -4277.4397      3971.7077    
      1800   300.19949     -43326.582      7181.6183      2934.5265      3971.7077    
      1900   293.09222     -43329.281     -8440.0299      1056.0428      3971.7077    
      2000   285.4262      -43323.142     -2104.1843      2808.4482      3971.7077    
Loop time of 89.1457 on 8 procs for 2000 steps with 371 atoms

Performance: 0.969 ns/day, 24.763 hours/ns, 22.435 timesteps/s, 8.323 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.609     | 61.959     | 74.558     | 133.1 | 69.50
Bond    | 0.00051981 | 0.00066099 | 0.00082799 |   0.0 |  0.00
Neigh   | 4.242      | 5.0837     | 6.0252     |  36.9 |  5.70
Comm    | 0.95868    | 13.548     | 24.885     | 284.6 | 15.20
Output  | 0.0039368  | 0.004791   | 0.0053325  |   0.7 |  0.01
Modify  | 7.579      | 8.5145     | 9.3588     |  28.6 |  9.55
Other   |            | 0.03555    |            |       |  0.04

Nlocal:         46.375 ave          55 max          42 min
Histogram: 3 0 0 3 0 0 1 0 0 1
Nghost:        3307.12 ave        3321 max        3287 min
Histogram: 1 0 0 2 0 1 0 1 1 2
Neighs:        30245.4 ave       35564 max       27581 min
Histogram: 3 0 2 1 0 0 1 0 0 1

Total # of neighbors = 241963
Ave neighs/atom = 652.19137
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -69.054579392702
variable C2pos equal ${d2}
variable C2pos equal -26.1528971777509
variable C3pos equal ${d3}
variable C3pos equal -1.23916300122105
variable C4pos equal ${d4}
variable C4pos equal -1.86994409642569
variable C5pos equal ${d5}
variable C5pos equal 17.3901579465118
variable C6pos equal ${d6}
variable C6pos equal 23.6035453718633

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(59.8291537561125+${C1pos})
variable C16 equal 0.5*(59.8291537561125+-69.054579392702)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-7.40508759084099+${C2pos})
variable C26 equal 0.5*(-7.40508759084099+-26.1528971777509)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-0.825992615060791+${C3pos})
variable C36 equal 0.5*(-0.825992615060791+-1.23916300122105)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-0.292239107549647+${C4pos})
variable C46 equal 0.5*(-0.292239107549647+-1.86994409642569)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-4.34258259854391+${C5pos})
variable C56 equal 0.5*(-4.34258259854391+17.3901579465118)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-6.83130414381852+${C6pos})
variable C66 equal 0.5*(-6.83130414381852+23.6035453718633)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 61.0224369324961
variable C22all equal ${C22}
variable C22all equal 47.9283326313178
variable C33all equal ${C33}
variable C33all equal 7.75844720452845

variable C44all equal ${C44}
variable C44all equal 2.56865430514241
variable C55all equal ${C55}
variable C55all equal 12.5715343740917
variable C66all equal ${C66}
variable C66all equal 8.38612061402239

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(26.9031539452532+${C21})
variable C12all equal 0.5*(26.9031539452532+12.4813288340103)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(-10.2705090703213+${C31})
variable C13all equal 0.5*(-10.2705090703213+31.9147737816564)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(1.0356053003675+${C32})
variable C23all equal 0.5*(1.0356053003675+17.2627621728591)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(9.91209510316705+${C41})
variable C14all equal 0.5*(9.91209510316705+-11.5634287955585)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(18.5358368015987+${C51})
variable C15all equal 0.5*(18.5358368015987+-3.33410750333258)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-4.61271281829475+${C61})
variable C16all equal 0.5*(-4.61271281829475+7.77383378040389)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-24.752210026679+${C42})
variable C24all equal 0.5*(-24.752210026679+-8.59466744969766)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(0.0477381550834508+${C52})
variable C25all equal 0.5*(0.0477381550834508+3.94884061337773)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-16.7789923842959+${C62})
variable C26all equal 0.5*(-16.7789923842959+6.20984313679926)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-5.03061070568771+${C43})
variable C34all equal 0.5*(-5.03061070568771+-3.97296899619728)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(21.3880344849842+${C53})
variable C35all equal 0.5*(21.3880344849842+1.67672717586319)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-1.03257780814092+${C63})
variable C36all equal 0.5*(-1.03257780814092+2.80049598625802)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-2.63723518413462+${C54})
variable C45all equal 0.5*(-2.63723518413462+-9.12868157602542)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-1.08109160198767+${C64})
variable C46all equal 0.5*(-1.08109160198767+-0.438796675064985)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(6.52378767398394+${C65})
variable C56all equal 0.5*(6.52378767398394+0.31168133809097)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:18:10
