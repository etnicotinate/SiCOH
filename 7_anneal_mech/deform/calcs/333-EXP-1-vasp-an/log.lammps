LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-1-vasp-an
read_data       ${structure}.data
read_data       333-EXP-1-vasp-an.data
Reading data file ...
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  271 atoms
  reading velocities ...
  271 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.014 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              241.44561      3579.5546    
         1   300            0              0              241.44561      3579.5546    
Loop time of 6.99701e-05 on 8 procs for 1 steps with 271 atoms

45.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.19e-07   | 2.69e-07   | 3.08e-07   |   0.0 |  0.38
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.13e-07   | 1.6176e-06 | 1.894e-06  |   0.0 |  2.31
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.808e-05  |            |       | 97.30

Nlocal:         33.875 ave          41 max          26 min
Histogram: 1 0 0 1 0 3 2 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.7 | 117.7 | 119.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -31976.978      6305.2198      0              1.6358887      3083.3525    
       100   310.89909     -31979.747      2789.9477     -7043.6606      1.6358887      3083.3525    
       200   313.14919     -31981.924      5533.673       8470.3525      1.6358887      3083.3525    
       300   283.45945     -31976.377      6728.2615      515.47801      1.6358887      3083.3525    
       400   281.21223     -31986.664      3492.6275      1953.3771      1.6358887      3083.3525    
       500   304.4175      -31990.084     -4558.7173     -773.74293      1.6358887      3083.3525    
       600   331.99284     -31987.447      9652.3945     -3005.3169      1.6358887      3083.3525    
       700   316.90452     -31980.418     -4907.7676     -3603.9415      1.6358887      3083.3525    
       800   293.98166     -31976.105      1626.4307      2083.2694      1.6358887      3083.3525    
       900   304.86214     -31991.672     -4506.4419     -468.51064      1.6358887      3083.3525    
      1000   285.60707     -31985.193     -11747.575      5478.8666      1.6358887      3083.3525    
      1100   268.82318     -31992.875      4749.5342      43.558635      1.6358887      3083.3525    
      1200   283.96106     -32004.29       1458.1083     -23.617862      1.6358887      3083.3525    
      1300   299.98136     -31989.443     -3551.5827     -210.08373      1.6358887      3083.3525    
      1400   303.14092     -31979.379      11983.148      3387.6422      1.6358887      3083.3525    
      1500   309.81962     -31983.161     -4231.6131      1414.7325      1.6358887      3083.3525    
      1600   286.09555     -31964.049     -14994.944      1524.7799      1.6358887      3083.3525    
      1700   313.85911     -31991.661     -1485.399       2239.9244      1.6358887      3083.3525    
      1800   292.81581     -31987.211     -2024.3368      1649.6023      1.6358887      3083.3525    
      1900   299.80845     -31997.63       3238.3158     -445.81108      1.6358887      3083.3525    
      2000   299.85537     -31976.691      856.67426      2451.2303      1.6358887      3083.3525    
Loop time of 77.5079 on 8 procs for 2000 steps with 271 atoms

Performance: 1.115 ns/day, 21.530 hours/ns, 25.804 timesteps/s, 6.993 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.972     | 49.024     | 65.148     |  88.7 | 63.25
Bond    | 0.00058507 | 0.00068351 | 0.00092503 |   0.0 |  0.00
Neigh   | 3.8079     | 4.0863     | 5.4986     |  26.5 |  5.27
Comm    | 0.82851    | 16.971     | 21.006     | 151.0 | 21.90
Output  | 0.00098962 | 0.0010993  | 0.0015803  |   0.6 |  0.00
Modify  | 5.9959     | 7.3934     | 7.6677     |  19.5 |  9.54
Other   |            | 0.03149    |            |       |  0.04

Nlocal:         33.875 ave          39 max          27 min
Histogram: 1 0 0 0 2 1 1 2 0 1
Nghost:        3012.38 ave        3062 max        2960 min
Histogram: 2 0 0 1 1 0 2 0 0 2
Neighs:        20947.8 ave       23761 max       16977 min
Histogram: 1 0 0 1 1 0 2 2 0 1

Total # of neighbors = 167582
Ave neighs/atom = 618.38376
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-1-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.0857166972957
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.3517105651832
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 15.3080658871341

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-2451.23025475289)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-2451.23025475289)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-607.701099486294)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-607.701099486294)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-911.668707480523)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-911.668707480523)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-3258.03570337743)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-3258.03570337743)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1602.95701679891)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1602.95701679891)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1067.42562309102)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1067.42562309102)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.0857166972957
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.0857166972957
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.150857166972957 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.150857166972957 xy delta 0.0785562116101559 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.150857166972957 xy delta 0.0785562116101559 xz delta -3.49359646871449e-05 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1151.8057      2891.6969      3081.8108    
       200   325.81819     -31974.004     -3555.2747      1270.3422      3080.2692    
       300   299.87816     -31977.128     -3860.5179     -2921.5842      3078.7275    
       400   292.8037      -31981.561     -6236.8622      794.96356      3077.1858    
       500   305.95574     -31986.939     -7657.4796     -545.62382      3075.6441    
       600   282.6317      -31960.726     -563.21748      662.44761      3074.1025    
       700   304.82198     -31968.101      5473.3862      9576.7215      3072.5608    
       800   332.21265     -31990.098      6380.3002      4786.9804      3071.0191    
       900   310.71387     -32004.969     -6653.9431      4385.1074      3069.4774    
      1000   287.25703     -31993.455     -5988.2076      773.07268      3067.9358    
      1100   308.58254     -31993.954      1126.206       675.248        3066.3941    
      1200   311.77148     -31982.671      8398.8315      9873.7653      3064.8524    
      1300   308.4707      -31981.373      8761.0392      352.67019      3063.3107    
      1400   314.14336     -31990.657      911.02607      6572.0405      3061.769     
      1500   320.43941     -31995.284     -65.250472     -1355.8422      3060.2274    
      1600   287.51842     -31969.047     -9277.7192      3149.5229      3058.6857    
      1700   288.77347     -31962.629      1622.6988      5110.6197      3057.144     
      1800   319.5731      -31955.767      4586.4196      2530.7608      3055.6023    
      1900   324.84202     -31960.407      17601.814      13999.592      3054.0607    
      2000   311.21974     -31977.746      11436.276      5587.8193      3052.519     
Loop time of 79.2712 on 8 procs for 2000 steps with 271 atoms

Performance: 1.090 ns/day, 22.020 hours/ns, 25.230 timesteps/s, 6.837 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.341     | 51.744     | 65.682     | 100.3 | 65.27
Bond    | 0.0005394  | 0.00073048 | 0.0010151  |   0.0 |  0.00
Neigh   | 3.7966     | 4.2596     | 5.4569     |  27.5 |  5.37
Comm    | 1.9001     | 15.853     | 22.266     | 181.2 | 20.00
Output  | 0.0035897  | 0.0043456  | 0.0053748  |   0.9 |  0.01
Modify  | 6.1908     | 7.3761     | 7.8584     |  21.0 |  9.30
Other   |            | 0.03342    |            |       |  0.04

Nlocal:         33.875 ave          38 max          29 min
Histogram: 2 0 1 0 0 1 0 2 0 2
Nghost:        3010.88 ave        3052 max        2950 min
Histogram: 1 0 1 0 0 1 2 0 2 1
Neighs:        21169.9 ave       23743 max       18140 min
Histogram: 2 0 1 0 0 1 0 2 0 2

Total # of neighbors = 169359
Ave neighs/atom = 624.94096
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 31.7814887547785
variable C2neg equal ${d2}
variable C2neg equal -31.9108191338191
variable C3neg equal ${d3}
variable C3neg equal -37.3511245699352
variable C4neg equal ${d4}
variable C4neg equal 10.3540651557264
variable C5neg equal ${d5}
variable C5neg equal 0.727099251557099
variable C6neg equal ${d6}
variable C6neg equal -0.132326277538535

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.0857166972957
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.150857166972957 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.150857166972957 xy delta -0.0785562116101559 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.150857166972957 xy delta -0.0785562116101559 xz delta 3.49359646871449e-05 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1150.6544      2892.2747      3084.8942    
       200   324.55641     -31972.799     -3891.4613      628.46091      3086.4359    
       300   299.47285     -31976.732     -4897.8955     -6019.9486      3087.9775    
       400   284.10313     -31974.077     -7175.34       -590.86184      3089.5192    
       500   296.78625     -31979.629     -3944.46       -832.16588      3091.0609    
       600   294.54822     -31969.292      9959.8838     -1119.7497      3092.6026    
       700   292.61195     -31955.587      5952.9001      5581.7557      3094.1442    
       800   327.71181     -31977.601     -2436.7412     -1156.1865      3095.6859    
       900   298.43742     -31983.955     -4170.3704      3421.2417      3097.2276    
      1000   277.1421      -31983.959     -691.22095     -6530.4427      3098.7693    
      1100   285.2862      -31984.689      9312.5713     -1262.3832      3100.311     
      1200   271.66022     -31953.084      5478.8634      1112.1166      3101.8526    
      1300   318.96764     -31979.267      12429.741      284.57296      3103.3943    
      1400   307.68438     -31981.608      2094.8799     -3530.9839      3104.936     
      1500   329.79415     -32003.432     -10451.273     -10808.078      3106.4777    
      1600   298.64453     -31982.586     -1698.1119     -1677.0179      3108.0193    
      1700   292.58663     -31987.543     -12634.505     -3720.7648      3109.561     
      1800   281.58072     -31998.138      3905.2816      647.47559      3111.1027    
      1900   281.91176     -31997.248      19160.637     -667.95991      3112.6444    
      2000   298.98489     -31976.493     -6910.5421     -5295.239       3114.186     
Loop time of 80.0888 on 8 procs for 2000 steps with 271 atoms

Performance: 1.079 ns/day, 22.247 hours/ns, 24.972 timesteps/s, 6.767 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.815     | 53.2       | 67.435     | 134.9 | 66.43
Bond    | 0.00056771 | 0.00069196 | 0.00084491 |   0.0 |  0.00
Neigh   | 3.7701     | 4.4214     | 5.4492     |  36.8 |  5.52
Comm    | 0.63887    | 14.873     | 23.268     | 254.9 | 18.57
Output  | 0.0036405  | 0.0044332  | 0.0051956  |   0.9 |  0.01
Modify  | 6.5212     | 7.555      | 8.2155     |  28.5 |  9.43
Other   |            | 0.03383    |            |       |  0.04

Nlocal:         33.875 ave          41 max          23 min
Histogram: 1 1 0 0 0 2 0 0 3 1
Nghost:        2967.88 ave        3007 max        2905 min
Histogram: 1 1 0 0 0 1 1 1 0 3
Neighs:        20750.5 ave       24888 max       14214 min
Histogram: 1 1 0 0 0 2 0 0 2 2

Total # of neighbors = 166004
Ave neighs/atom = 612.56089
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 78.4910996080344
variable C2pos equal ${d2}
variable C2pos equal 67.312728480287
variable C3pos equal ${d3}
variable C3pos equal 58.548564428883
variable C4pos equal ${d4}
variable C4pos equal 13.5292234737779
variable C5pos equal ${d5}
variable C5pos equal 11.9639860398154
variable C6pos equal ${d6}
variable C6pos equal -3.82531032463427

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(31.7814887547785+${C1pos})
variable C11 equal 0.5*(31.7814887547785+78.4910996080344)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-31.9108191338191+${C2pos})
variable C21 equal 0.5*(-31.9108191338191+67.312728480287)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-37.3511245699352+${C3pos})
variable C31 equal 0.5*(-37.3511245699352+58.548564428883)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(10.3540651557264+${C4pos})
variable C41 equal 0.5*(10.3540651557264+13.5292234737779)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(0.727099251557099+${C5pos})
variable C51 equal 0.5*(0.727099251557099+11.9639860398154)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-0.132326277538535+${C6pos})
variable C61 equal 0.5*(-0.132326277538535+-3.82531032463427)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.3517105651832
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.3517105651832
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.133517105651832 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.133517105651832 yz delta 0.0084834475743105 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1151.8057      2891.6969      3081.8108    
       200   324.22492     -31972.979     -2649.1835      1061.091       3080.2692    
       300   303.96399     -31981.09      -4264.7018     -3967.532       3078.7275    
       400   293.88437     -31982.97      -9584.1391      204.3851       3077.1858    
       500   300.89941     -31984.665     -9593.9253     -2489.7191      3075.6441    
       600   288.52735     -31966.098     -10186.474      481.05121      3074.1025    
       700   284.58814     -31954.024     -7557.2648      6500.9762      3072.5608    
       800   322.69673     -31976.828      9297.5018      7618.0077      3071.0191    
       900   312.4334      -31995.195      1802.4094      1247.7373      3069.4774    
      1000   284.70899     -31990.978     -4992.7504     -2263.5859      3067.9358    
      1100   273.11405     -31977.496      7262.9994      3963.8664      3066.3941    
      1200   292.7822      -31973.508     -2783.0441      1564.9062      3064.8524    
      1300   322.09395     -31980.758      13529.906      763.67443      3063.3107    
      1400   304.86295     -31974.006     -2312.811       6643.1446      3061.769     
      1500   295.01904     -31972.592      5929.5032     -1645.3487      3060.2274    
      1600   294.10191     -31981.626      4006.1352      2526.613       3058.6857    
      1700   284.58106     -31976.917      1467.2604      771.21777      3057.144     
      1800   320.43296     -31983.428      1077.7762      9611.8498      3055.6023    
      1900   289.20079     -31948.537     -4367.7727      4852.5108      3054.0607    
      2000   319.6193      -31985.686      9544.3439     -3722.0276      3052.519     
Loop time of 80.9181 on 8 procs for 2000 steps with 271 atoms

Performance: 1.068 ns/day, 22.477 hours/ns, 24.716 timesteps/s, 6.698 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.909     | 53.766     | 68.084     | 135.9 | 66.45
Bond    | 0.0005776  | 0.00068901 | 0.00085271 |   0.0 |  0.00
Neigh   | 3.8032     | 4.4486     | 5.4576     |  36.2 |  5.50
Comm    | 0.64248    | 14.961     | 23.827     | 257.6 | 18.49
Output  | 0.0038175  | 0.0045406  | 0.0053182  |   0.8 |  0.01
Modify  | 6.6897     | 7.7033     | 8.3625     |  27.8 |  9.52
Other   |            | 0.03376    |            |       |  0.04

Nlocal:         33.875 ave          41 max          25 min
Histogram: 1 0 0 2 0 2 0 1 1 1
Nghost:        2988.62 ave        3016 max        2944 min
Histogram: 1 0 1 0 0 1 2 0 1 2
Neighs:        21162.6 ave       25449 max       15724 min
Histogram: 1 0 0 2 0 2 0 1 1 1

Total # of neighbors = 169301
Ave neighs/atom = 624.72694
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -62.5505352505851
variable C2neg equal ${d2}
variable C2neg equal -1.15346581542377
variable C3neg equal ${d3}
variable C3neg equal -41.6155391978533
variable C4neg equal ${d4}
variable C4neg equal -10.232497271218
variable C5neg equal ${d5}
variable C5neg equal -14.2696045419296
variable C6neg equal ${d6}
variable C6neg equal 2.51334015555518

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.3517105651832
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.133517105651832 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.133517105651832 yz delta -0.0084834475743105 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1150.6544      2892.2747      3084.8942    
       200   324.1626      -31972.326     -5169.5181      676.28885      3086.4359    
       300   302.33294     -31979.226     -5760.2105     -4493.1663      3087.9775    
       400   287.71823     -31978.744      325.20478     -316.81429      3089.5192    
       500   306.85562     -31987.26      -12514.085     -2738.0557      3091.0609    
       600   285.81137     -31961.886     -4121.0303     -674.7845       3092.6026    
       700   286.57205     -31949.455     -8003.2006      7262.1853      3094.1442    
       800   328.41634     -31972.955      4560.775       3134.8992      3095.6859    
       900   305.61639     -31978.774     -308.93174      1508.0041      3097.2276    
      1000   295.80029     -31992.387      12839.752     -1760.9539      3098.7693    
      1100   290.35767     -31988.683      6129.6286     -948.71129      3100.311     
      1200   304.74549     -31979.744     -7109.3972     -1704.9761      3101.8526    
      1300   302.38838     -31959.226      3794.0034      3647.0965      3103.3943    
      1400   304.62059     -31965.086     -1009.6158      3977.7809      3104.936     
      1500   310.33504     -31979.553     -4805.4302     -922.34793      3106.4777    
      1600   299.78628     -31979.861     -7947.6014     -1768.8091      3108.0193    
      1700   291.12809     -31983.237      1.2367793      1202.68        3109.561     
      1800   265.61406     -31986.065      1326.8375      3368.8172      3111.1027    
      1900   282.66823     -32003.419      9267.3876      5988.5347      3112.6444    
      2000   300.75265     -31987.513      4659.2237      843.79339      3114.186     
Loop time of 79.8091 on 8 procs for 2000 steps with 271 atoms

Performance: 1.083 ns/day, 22.169 hours/ns, 25.060 timesteps/s, 6.791 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.327     | 53.074     | 67.086     | 136.1 | 66.50
Bond    | 0.00056886 | 0.00070001 | 0.00087661 |   0.0 |  0.00
Neigh   | 3.7579     | 4.4099     | 5.4219     |  36.6 |  5.53
Comm    | 0.70877    | 14.717     | 23.475     | 258.2 | 18.44
Output  | 0.0035995  | 0.0044309  | 0.0052153  |   0.9 |  0.01
Modify  | 6.5344     | 7.5696     | 8.2356     |  28.2 |  9.48
Other   |            | 0.03353    |            |       |  0.04

Nlocal:         33.875 ave          39 max          26 min
Histogram: 1 0 0 2 0 0 1 0 3 1
Nghost:        2944.38 ave        2976 max        2894 min
Histogram: 1 0 1 1 0 1 0 0 1 3
Neighs:        20764.9 ave       23685 max       16026 min
Histogram: 1 0 0 2 0 0 1 0 3 1

Total # of neighbors = 166119
Ave neighs/atom = 612.98524
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 16.2873540103142
variable C2pos equal ${d2}
variable C2pos equal 68.9797259718745
variable C3pos equal ${d3}
variable C3pos equal 22.4232710935303
variable C4pos equal ${d4}
variable C4pos equal -5.0875427004282
variable C5pos equal ${d5}
variable C5pos equal 1.23106516474711
variable C6pos equal ${d6}
variable C6pos equal -3.954746034423

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-62.5505352505851+${C1pos})
variable C12 equal 0.5*(-62.5505352505851+16.2873540103142)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-1.15346581542377+${C2pos})
variable C22 equal 0.5*(-1.15346581542377+68.9797259718745)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-41.6155391978533+${C3pos})
variable C32 equal 0.5*(-41.6155391978533+22.4232710935303)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-10.232497271218+${C4pos})
variable C42 equal 0.5*(-10.232497271218+-5.0875427004282)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-14.2696045419296+${C5pos})
variable C52 equal 0.5*(-14.2696045419296+1.23106516474711)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(2.51334015555518+${C6pos})
variable C62 equal 0.5*(2.51334015555518+-3.954746034423)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 15.3080658871341
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.3080658871341
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.153080658871341 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.3 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1151.8057      2891.6969      3081.8108    
       200   323.97067     -31972.255     -1932.1583      1275.0721      3080.2692    
       300   304.63909     -31981.021     -4030.9998     -3883.1489      3078.7275    
       400   293.44316     -31982.169     -8713.9216     -3.5712486      3077.1858    
       500   293.19541     -31978.037     -3235.2594     -1646.9214      3075.6441    
       600   277.21056     -31957.476     -15916.73       283.29717      3074.1025    
       700   295.44318     -31960.373     -5989.3459      6868.9279      3072.5608    
       800   323.02402     -31976.739      11808.076      3549.4453      3071.0191    
       900   296.94296     -31987.099      1175.7561     -1377.7914      3069.4774    
      1000   291.15281     -31995.032     -5016.0002      1122.9717      3067.9358    
      1100   302.36193     -31991.963     -3303.2645      584.01699      3066.3941    
      1200   307.80892     -31977.244     -9404.3705      5349.0862      3064.8524    
      1300   298.8492      -31968.319      2237.6793      2969.1615      3063.3107    
      1400   286.39408     -31970.288     -2306.658       2241.5021      3061.769     
      1500   304.44387     -31989.562      5243.3254     -1080.584       3060.2274    
      1600   304.76728     -31988.915      5523.7463      484.8124       3058.6857    
      1700   287.11233     -31971.443      11200.953      7391.9466      3057.144     
      1800   312.78139     -31973.902     -7644.5965      329.17116      3055.6023    
      1900   310.86765     -31952.518      9198.7606      1898.2262      3054.0607    
      2000   319.27253     -31959.206      1166.6009      5003.3222      3052.519     
Loop time of 81.5978 on 8 procs for 2000 steps with 271 atoms

Performance: 1.059 ns/day, 22.666 hours/ns, 24.510 timesteps/s, 6.642 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.123     | 54.035     | 68.75      | 135.9 | 66.22
Bond    | 0.0005454  | 0.00069836 | 0.00087451 |   0.0 |  0.00
Neigh   | 3.8266     | 4.5259     | 5.6651     |  37.2 |  5.55
Comm    | 0.68621    | 15.384     | 24.307     | 254.6 | 18.85
Output  | 0.0035838  | 0.0043899  | 0.0051761  |   0.9 |  0.01
Modify  | 6.4536     | 7.6146     | 8.3298     |  28.9 |  9.33
Other   |            | 0.03394    |            |       |  0.04

Nlocal:         33.875 ave          41 max          26 min
Histogram: 1 0 0 0 3 1 2 0 0 1
Nghost:        3040.62 ave        3086 max        2988 min
Histogram: 1 0 1 1 1 0 2 0 1 1
Neighs:        21150.4 ave       25224 max       16480 min
Histogram: 1 0 0 0 3 1 2 0 0 1

Total # of neighbors = 169203
Ave neighs/atom = 624.36531
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 25.8590713210671
variable C2neg equal ${d2}
variable C2neg equal 46.2421403561189
variable C3neg equal ${d3}
variable C3neg equal 17.6180250752657
variable C4neg equal ${d4}
variable C4neg equal -15.9577792575414
variable C5neg equal ${d5}
variable C5neg equal -16.8391913852026
variable C6neg equal ${d6}
variable C6neg equal 2.30207185392561

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.3080658871341
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.153080658871341 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.3 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1150.6544      2892.2747      3084.8942    
       200   327.38071     -31975.376     -4567.4136      718.84741      3086.4359    
       300   303.07717     -31979.438     -6487.1572     -5828.8488      3087.9775    
       400   291.06358     -31980.696     -2524.6909     -493.18739      3089.5192    
       500   302.14426     -31984.164      2366.0388     -2691.273       3091.0609    
       600   287.73699     -31962.232     -3197.6598     -1689.7995      3092.6026    
       700   301.97855     -31957.866     -9408.454       6581.4535      3094.1442    
       800   311.20951     -31955.916     -7748.3064      4750.9112      3095.6859    
       900   275.04125     -31958.623     -1943.9852      542.85188      3097.2276    
      1000   291.58429     -31986.328     -3434.9014     -6047.3514      3098.7693    
      1100   278.90976     -31973.968      8498.7125      502.01624      3100.311     
      1200   286.06366     -31965.479     -12607.451      5878.3503      3101.8526    
      1300   299.94077     -31949.175     -5360.1389     -1333.6595      3103.3943    
      1400   321.56907     -31969.164     -887.87157      4963.5532      3104.936     
      1500   313.39834     -31974.55       657.31355     -1558.2814      3106.4777    
      1600   302.34939     -31975.242      1481.7548      53.724566      3108.0193    
      1700   289.67967     -31973.524     -3609.3371     -3486.3602      3109.561     
      1800   299.07722     -31986.114      5007.9288     -371.36449      3111.1027    
      1900   283.30255     -31983.945     -6596.0337      337.12925      3112.6444    
      2000   291.85149     -31997.457     -6935.0719      3503.8898      3114.186     
Loop time of 80.1085 on 8 procs for 2000 steps with 271 atoms

Performance: 1.079 ns/day, 22.252 hours/ns, 24.966 timesteps/s, 6.766 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.103     | 53.134     | 67.249     | 143.4 | 66.33
Bond    | 0.0005699  | 0.00073077 | 0.00087184 |   0.0 |  0.00
Neigh   | 3.7849     | 4.4976     | 5.6865     |  40.1 |  5.61
Comm    | 0.79124    | 14.888     | 23.931     | 270.7 | 18.58
Output  | 0.0034925  | 0.0042896  | 0.0050564  |   0.9 |  0.01
Modify  | 6.3669     | 7.5499     | 8.2678     |  31.2 |  9.42
Other   |            | 0.03453    |            |       |  0.04

Nlocal:         33.875 ave          40 max          27 min
Histogram: 1 0 0 2 1 1 1 0 1 1
Nghost:        2984.88 ave        3025 max        2938 min
Histogram: 2 0 0 0 1 1 2 0 0 2
Neighs:        20745.9 ave       24128 max       16790 min
Histogram: 1 0 1 1 1 1 0 1 1 1

Total # of neighbors = 165967
Ave neighs/atom = 612.42435
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -10.6660725812599
variable C2pos equal ${d2}
variable C2pos equal -10.9803996288955
variable C3pos equal ${d3}
variable C3pos equal 41.9247907281207
variable C4pos equal ${d4}
variable C4pos equal 13.2991548973838
variable C5pos equal ${d5}
variable C5pos equal 21.5550967913767
variable C6pos equal ${d6}
variable C6pos equal -9.36025838635826

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(25.8590713210671+${C1pos})
variable C13 equal 0.5*(25.8590713210671+-10.6660725812599)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(46.2421403561189+${C2pos})
variable C23 equal 0.5*(46.2421403561189+-10.9803996288955)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(17.6180250752657+${C3pos})
variable C33 equal 0.5*(17.6180250752657+41.9247907281207)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-15.9577792575414+${C4pos})
variable C43 equal 0.5*(-15.9577792575414+13.2991548973838)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-16.8391913852026+${C5pos})
variable C53 equal 0.5*(-16.8391913852026+21.5550967913767)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(2.30207185392561+${C6pos})
variable C63 equal 0.5*(2.30207185392561+-9.36025838635826)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 15.3080658871341
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.3080658871341
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.153080658871341 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1151.2298      2891.9859      3083.3525    
       200   326.58878     -31974.785     -3514.6943      1000.8364      3083.3525    
       300   301.89402     -31978.42      -3550.6809     -4252.0128      3083.3525    
       400   287.55447     -31978.099     -6741.9549      273.0761       3083.3525    
       500   295.48271     -31978.726      518.42164     -1284.1767      3083.3525    
       600   289.1097      -31965.114     -4355.2621     -1349.5155      3083.3525    
       700   299.84688     -31961.488      6886.3025      3926.9608      3083.3525    
       800   320.07313     -31967.605      1999.163       7665.0366      3083.3525    
       900   284.96635     -31964.211     -10462.001     -395.99406      3083.3525    
      1000   294.88516     -31991.141      7373.6083      3539.9376      3083.3525    
      1100   307.80748     -32002.899      3748.4759      588.81096      3083.3525    
      1200   291.18989     -31980.062      733.0807       2357.9157      3083.3525    
      1300   312.76806     -31967.756     -1761.2205      3239.3895      3083.3525    
      1400   334.57427     -31985.959     -345.88322      5115.1402      3083.3525    
      1500   307.75909     -31979.558     -10073.837     -2458.0822      3083.3525    
      1600   311.80621     -31986.954     -8470.4088      4373.3898      3083.3525    
      1700   276.85476     -31961.017      11394.121     -730.13652      3083.3525    
      1800   314.97404     -31988.232     -13754.678      1990.4547      3083.3525    
      1900   300.49999     -31975.417      369.56558      771.87089      3083.3525    
      2000   304.41407     -31971.54       1262.6644      822.86519      3083.3525    
Loop time of 78.3981 on 8 procs for 2000 steps with 271 atoms

Performance: 1.102 ns/day, 21.777 hours/ns, 25.511 timesteps/s, 6.913 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.996     | 53.193     | 65.765     | 124.3 | 67.85
Bond    | 0.0005353  | 0.00066398 | 0.00089605 |   0.0 |  0.00
Neigh   | 3.7894     | 4.4556     | 5.4787     |  35.9 |  5.68
Comm    | 1.037      | 13.594     | 21.8       | 245.7 | 17.34
Output  | 0.0035462  | 0.0044792  | 0.0053718  |   1.0 |  0.01
Modify  | 6.0734     | 7.1158     | 7.7945     |  28.7 |  9.08
Other   |            | 0.03493    |            |       |  0.04

Nlocal:         33.875 ave          40 max          25 min
Histogram: 1 0 0 1 0 1 2 0 2 1
Nghost:        2967.88 ave        2996 max        2924 min
Histogram: 1 0 0 0 2 0 1 2 0 2
Neighs:        20969.5 ave       24589 max       15583 min
Histogram: 1 0 0 1 0 2 1 1 1 1

Total # of neighbors = 167756
Ave neighs/atom = 619.02583
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -16.4994090112822
variable C2neg equal ${d2}
variable C2neg equal 33.331949687326
variable C3neg equal ${d3}
variable C3neg equal 13.7306806602123
variable C4neg equal ${d4}
variable C4neg equal 5.42767576198074
variable C5neg equal ${d5}
variable C5neg equal -2.99971222440562
variable C6neg equal ${d6}
variable C6neg equal 8.09817328827918

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.3080658871341
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.153080658871341 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1151.2298      2891.9859      3083.3525    
       200   323.34595     -31971.696     -3320.1084      952.72656      3083.3525    
       300   299.20388     -31977.062     -4631.9671     -4674.2291      3083.3525    
       400   292.07839     -31981.361     -14750.373     -218.44004      3083.3525    
       500   295.23097     -31978.689     -9405.509      -701.81171      3083.3525    
       600   295.04559     -31969.786      3798.4297      694.45243      3083.3525    
       700   297.0338      -31958.118     -8924.9393      5246.3643      3083.3525    
       800   322.00487     -31968.858      369.92159      5135.862       3083.3525    
       900   305.91823     -31982.925      4644.0928      2318.6463      3083.3525    
      1000   313.67329     -32005.141     -4513.3058     -6988.1734      3083.3525    
      1100   292.67165     -31989.099      15046.007      5265.4487      3083.3525    
      1200   298.99668     -31983.31       5326.2387      4316.008       3083.3525    
      1300   325.12494     -31975.522      3589.1009      151.20142      3083.3525    
      1400   313.96273     -31971.76      -2540.9486      3053.9672      3083.3525    
      1500   307.36827     -31982.019      8470.3827     -2616.3848      3083.3525    
      1600   303.55062     -31986.9       -3369.0232     -4021.6622      3083.3525    
      1700   309.64822     -31994.024     -2670.3784      3717.0713      3083.3525    
      1800   305.86287     -31992.419     -17740.715      2835.5465      3083.3525    
      1900   294.31781     -31987.984     -5414.4732     -964.27718      3083.3525    
      2000   283.74017     -31985.581     -4337.9078     -5034.0771      3083.3525    
Loop time of 79.0852 on 8 procs for 2000 steps with 271 atoms

Performance: 1.092 ns/day, 21.968 hours/ns, 25.289 timesteps/s, 6.853 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.184     | 53.654     | 66.234     | 122.1 | 67.84
Bond    | 0.00056546 | 0.00069725 | 0.00086508 |   0.0 |  0.00
Neigh   | 3.7956     | 4.4714     | 5.4894     |  35.1 |  5.65
Comm    | 1.095      | 13.658     | 22.137     | 241.8 | 17.27
Output  | 0.0035387  | 0.0044254  | 0.0052538  |   1.0 |  0.01
Modify  | 6.2499     | 7.262      | 7.9478     |  27.9 |  9.18
Other   |            | 0.0349     |            |       |  0.04

Nlocal:         33.875 ave          41 max          26 min
Histogram: 1 0 1 0 2 0 1 1 1 1
Nghost:        3000.62 ave        3036 max        2960 min
Histogram: 1 0 1 1 1 0 2 0 1 1
Neighs:          20957 ave       25185 max       16181 min
Histogram: 1 0 1 0 2 0 1 2 0 1

Total # of neighbors = 167656
Ave neighs/atom = 618.65683
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 75.8448767054667
variable C2pos equal ${d2}
variable C2pos equal 19.6072290096718
variable C3pos equal ${d3}
variable C3pos equal 12.3788727002601
variable C4pos equal ${d4}
variable C4pos equal 21.6550703582778
variable C5pos equal ${d5}
variable C5pos equal 5.58194193998723
variable C6pos equal ${d6}
variable C6pos equal -0.868453413792836

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-16.4994090112822+${C1pos})
variable C14 equal 0.5*(-16.4994090112822+75.8448767054667)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(33.331949687326+${C2pos})
variable C24 equal 0.5*(33.331949687326+19.6072290096718)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(13.7306806602123+${C3pos})
variable C34 equal 0.5*(13.7306806602123+12.3788727002601)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(5.42767576198074+${C4pos})
variable C44 equal 0.5*(5.42767576198074+21.6550703582778)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-2.99971222440562+${C5pos})
variable C54 equal 0.5*(-2.99971222440562+5.58194193998723)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(8.09817328827918+${C6pos})
variable C64 equal 0.5*(8.09817328827918+-0.868453413792836)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 15.3080658871341
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.3080658871341
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.153080658871341 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1151.2298      2891.9859      3083.3525    
       200   326.13461     -31974.207     -3790.5378      868.11891      3083.3525    
       300   300.16944     -31977.52      -4461.6081     -4462.6772      3083.3525    
       400   291.61265     -31981.773     -9681.4284      1574.0212      3083.3525    
       500   296.06792     -31978.275     -5480.1291     -1690.3513      3083.3525    
       600   285.12598     -31960.332      1935.3718      2359.1063      3083.3525    
       700   293.40567     -31956.193     -2728.5989      4597.0841      3083.3525    
       800   321.68045     -31976.944     -3924.212       2604.12        3083.3525    
       900   291.07496     -31981.941      2534.2863      2935.1909      3083.3525    
      1000   298.78288     -31999.26      -7324.9003     -58.475251      3083.3525    
      1100   309.57759     -31999.622      174.24075      893.61134      3083.3525    
      1200   319.14412     -31991.279     -13003.127      6376.5858      3083.3525    
      1300   323.44609     -31968.204      15595.601      2416.0988      3083.3525    
      1400   323.67173     -31952.335     -3647.3065      4594.2027      3083.3525    
      1500   320.32032     -31975.663     -3353.7488     -3108.3797      3083.3525    
      1600   307.55593     -31981.416      2537.148       2614.2389      3083.3525    
      1700   304.50711     -31984.774     -386.53681     -1494.9881      3083.3525    
      1800   303.07439     -31992.777      629.16162      998.4193       3083.3525    
      1900   283.09429     -31995.103     -2277.8064      1501.0163      3083.3525    
      2000   284.17837     -32010.362     -5840.0109      2006.0985      3083.3525    
Loop time of 81.3425 on 8 procs for 2000 steps with 271 atoms

Performance: 1.062 ns/day, 22.595 hours/ns, 24.587 timesteps/s, 6.663 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.33      | 56.161     | 68.172     | 135.5 | 69.04
Bond    | 0.00054584 | 0.0007137  | 0.00090313 |   0.0 |  0.00
Neigh   | 3.7911     | 4.6454     | 5.5443     |  36.6 |  5.71
Comm    | 0.87151    | 12.884     | 23.722     | 282.7 | 15.84
Output  | 0.0036615  | 0.004552   | 0.0052418  |   0.9 |  0.01
Modify  | 6.6872     | 7.6119     | 8.4701     |  29.0 |  9.36
Other   |            | 0.03467    |            |       |  0.04

Nlocal:         33.875 ave          41 max          26 min
Histogram: 2 0 0 1 1 0 1 1 0 2
Nghost:           2993 ave        3028 max        2951 min
Histogram: 2 0 0 0 1 1 1 1 1 1
Neighs:        20954.6 ave       25242 max       16167 min
Histogram: 2 0 0 1 1 0 1 1 0 2

Total # of neighbors = 167637
Ave neighs/atom = 618.58672
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -4.51029799305822
variable C2neg equal ${d2}
variable C2neg equal 15.518778860647
variable C3neg equal ${d3}
variable C3neg equal -3.73846405577435
variable C4neg equal ${d4}
variable C4neg equal -12.3174540149602
variable C5neg equal ${d5}
variable C5neg equal 10.4692013372335
variable C6neg equal ${d6}
variable C6neg equal 8.92424405372228

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.3080658871341
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.153080658871341 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1151.2298      2891.9859      3083.3525    
       200   324.99349     -31973.052     -3120.5436      1079.9442      3083.3525    
       300   301.01454     -31977.892     -5943.7875     -3852.6411      3083.3525    
       400   293.7347      -31982.087     -15139.606      443.20965      3083.3525    
       500   291.16059     -31975.647     -5988.1426     -1566.6444      3083.3525    
       600   274.30456     -31952.819     -3246.2748      427.24164      3083.3525    
       700   303.62883     -31960.318      3674.3954      8282.1944      3083.3525    
       800   331.13932     -31971.694      194.36491      4927.1025      3083.3525    
       900   301.16137     -31980.839     -715.4042       2346.8197      3083.3525    
      1000   301.17032     -31994.679     -9385.3587     -346.22212      3083.3525    
      1100   294.37883     -31980.344      16112.442      2971.4736      3083.3525    
      1200   299.24653     -31967.953      7450.1289      4623.0919      3083.3525    
      1300   294.42822     -31945.648      1336.9053     -3370.2762      3083.3525    
      1400   297.79202     -31959.435      5186.5855      6435.3363      3083.3525    
      1500   279.41189     -31978.586      23436.688      509.89242      3083.3525    
      1600   273.10241     -31972.209     -21963.811     -4413.6479      3083.3525    
      1700   299.12031     -31972.932     -3479.042      -4409.8992      3083.3525    
      1800   311.25825     -31970.965     -1658.0096      85.062583      3083.3525    
      1900   312.75866     -31986.71       9694.4952      715.72301      3083.3525    
      2000   309.51198     -31994.438      5570.611      -1295.4088      3083.3525    
Loop time of 81.5559 on 8 procs for 2000 steps with 271 atoms

Performance: 1.059 ns/day, 22.654 hours/ns, 24.523 timesteps/s, 6.646 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.986     | 56.048     | 68.478     | 138.8 | 68.72
Bond    | 0.00053131 | 0.00071997 | 0.00092812 |   0.0 |  0.00
Neigh   | 3.8103     | 4.6402     | 5.48       |  36.3 |  5.69
Comm    | 0.84807    | 13.278     | 24.32      | 284.8 | 16.28
Output  | 0.003621   | 0.0045775  | 0.0053411  |   1.0 |  0.01
Modify  | 6.6903     | 7.5494     | 8.3857     |  28.9 |  9.26
Other   |            | 0.03504    |            |       |  0.04

Nlocal:         33.875 ave          41 max          28 min
Histogram: 3 0 0 1 0 1 1 0 0 2
Nghost:        2988.88 ave        3025 max        2951 min
Histogram: 1 1 1 0 0 1 2 0 1 1
Neighs:        20962.2 ave       25252 max       17418 min
Histogram: 3 0 0 0 1 1 1 0 0 2

Total # of neighbors = 167698
Ave neighs/atom = 618.81181
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 37.9628204599948
variable C2pos equal ${d2}
variable C2pos equal -10.21291425644
variable C3pos equal ${d3}
variable C3pos equal -22.5418699473759
variable C4pos equal ${d4}
variable C4pos equal 6.17020661298003
variable C5pos equal ${d5}
variable C5pos equal 22.5827492873841
variable C6pos equal ${d6}
variable C6pos equal -8.81732462127804

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-4.51029799305822+${C1pos})
variable C15 equal 0.5*(-4.51029799305822+37.9628204599948)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(15.518778860647+${C2pos})
variable C25 equal 0.5*(15.518778860647+-10.21291425644)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-3.73846405577435+${C3pos})
variable C35 equal 0.5*(-3.73846405577435+-22.5418699473759)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-12.3174540149602+${C4pos})
variable C45 equal 0.5*(-12.3174540149602+6.17020661298003)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(10.4692013372335+${C5pos})
variable C55 equal 0.5*(10.4692013372335+22.5827492873841)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(8.92424405372228+${C6pos})
variable C65 equal 0.5*(8.92424405372228+-8.81732462127804)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.3517105651832

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.3517105651832
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.133517105651832 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1151.2298      2891.9859      3083.3525    
       200   324.86717     -31973.217     -3133.2322      933.36646      3083.3525    
       300   302.34674     -31978.677     -4913.2751     -5128.2318      3083.3525    
       400   287.53897     -31977.626     -2828.627       1777.3335      3083.3525    
       500   294.12879     -31977.662     -10539.042     -4252.5155      3083.3525    
       600   285.66019     -31961.77       312.15196      3116.631       3083.3525    
       700   288.52856     -31949.334     -67.171716      4173.9432      3083.3525    
       800   318.84945     -31962.8        6371.0567      3021.482       3083.3525    
       900   284.65527     -31966.44       549.22841      816.56072      3083.3525    
      1000   297.87176     -31988.815     -9484.4158     -5292.6846      3083.3525    
      1100   280.73244     -31972.615     -195.02875      1123.3379      3083.3525    
      1200   301.81391     -31970.162      2190.238       5759.8677      3083.3525    
      1300   310.28032     -31957.903      5287.1899     -1863.323       3083.3525    
      1400   330.52109     -31982.134     -17249.057      5129.3786      3083.3525    
      1500   309.29742     -31973.651      10202.512      2380.5693      3083.3525    
      1600   304.83488     -31977.32      -6147.364      -5083.1888      3083.3525    
      1700   306.92497     -31991.693     -11297.712     -2907.3702      3083.3525    
      1800   297.11152     -31999.094      10613.235      5192.3235      3083.3525    
      1900   291.64377     -31994.409      5146.5971      2685.5782      3083.3525    
      2000   297.16418     -31971.365     -8050.3058     -3363.402       3083.3525    
Loop time of 81.3588 on 8 procs for 2000 steps with 271 atoms

Performance: 1.062 ns/day, 22.600 hours/ns, 24.582 timesteps/s, 6.662 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.625     | 55.803     | 68.241     | 140.0 | 68.59
Bond    | 0.00055449 | 0.00070016 | 0.00088935 |   0.0 |  0.00
Neigh   | 3.7855     | 4.6174     | 5.4262     |  36.3 |  5.68
Comm    | 0.93132    | 13.368     | 24.526     | 285.8 | 16.43
Output  | 0.0037049  | 0.0045753  | 0.0053198  |   0.9 |  0.01
Modify  | 6.693      | 7.5295     | 8.3681     |  29.0 |  9.25
Other   |            | 0.03483    |            |       |  0.04

Nlocal:         33.875 ave          40 max          26 min
Histogram: 1 0 1 1 0 1 1 1 0 2
Nghost:        2983.38 ave        3020 max        2933 min
Histogram: 1 1 0 0 0 1 2 1 0 2
Neighs:        20964.4 ave       24563 max       16165 min
Histogram: 1 0 1 1 0 1 1 1 0 2

Total # of neighbors = 167715
Ave neighs/atom = 618.87454
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -58.9167608991613
variable C2neg equal ${d2}
variable C2neg equal -10.396129455742
variable C3neg equal ${d3}
variable C3neg equal -21.035780237297
variable C4neg equal ${d4}
variable C4neg equal -14.7525350654484
variable C5neg equal ${d5}
variable C5neg equal 3.32755730409245
variable C6neg equal ${d6}
variable C6neg equal 5.71829212289629

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.16850835 0.040044717 0.65076706) to (14.917208 13.391755 15.958833) with tilt (-7.8556212 0.0034935965 -0.84834476)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.3517105651832
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.133517105651832 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 115.6 | 117.4 | 119.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.85537     -31976.691      856.66901      0              3083.3525    
       100   308.02582     -31964.332      1151.2298      2891.9859      3083.3525    
       200   325.40615     -31973.661     -3744.3718      920.29188      3083.3525    
       300   299.35509     -31976.753     -4433.31       -3963.0367      3083.3525    
       400   290.01722     -31980.586     -11606.559     -887.10311      3083.3525    
       500   298.77111     -31982.553     -3740.4732      458.01844      3083.3525    
       600   285.66825     -31963.125     -1443.4157      156.34567      3083.3525    
       700   303.11623     -31963.437     -1154.2028      7322.1958      3083.3525    
       800   313.47861     -31961.019      2813.9819      4463.9238      3083.3525    
       900   313.46739     -31982.081      8279.2871      3062.4002      3083.3525    
      1000   292.54306     -31989.909      1620.7538     -1154.9313      3083.3525    
      1100   298.95428     -31995.538      3580.1727     -1393.3279      3083.3525    
      1200   297.29965     -31984.696     -7351.2566      3919.5031      3083.3525    
      1300   323.36991     -31977.45       2897.267       3504.8751      3083.3525    
      1400   320.66726     -31975.154      3206.0212     -1509.3171      3083.3525    
      1500   308.80806     -31977.472      2217.1927      277.94526      3083.3525    
      1600   288.13602     -31970.525      248.03188     -6614.2605      3083.3525    
      1700   288.97986     -31970.532      7994.0401      1959.369       3083.3525    
      1800   315.27678     -31975.734     -1814.6876      7796.2239      3083.3525    
      1900   354.11563     -31986.449     -10739.51       1579.0514      3083.3525    
      2000   305.6105      -31972.787     -66.713018     -880.79948      3083.3525    
Loop time of 78.9588 on 8 procs for 2000 steps with 271 atoms

Performance: 1.094 ns/day, 21.933 hours/ns, 25.330 timesteps/s, 6.864 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 43.736     | 51.329     | 66.091     | 104.4 | 65.01
Bond    | 0.00057498 | 0.00070583 | 0.00091495 |   0.0 |  0.00
Neigh   | 3.8021     | 4.3628     | 5.4702     |  26.9 |  5.53
Comm    | 1.0613     | 15.806     | 23.381     | 187.8 | 20.02
Output  | 0.0036086  | 0.0044578  | 0.0052609  |   0.9 |  0.01
Modify  | 6.2935     | 7.4222     | 7.9971     |  21.0 |  9.40
Other   |            | 0.03362    |            |       |  0.04

Nlocal:         33.875 ave          40 max          27 min
Histogram: 2 0 0 1 1 0 1 1 1 1
Nghost:        3004.38 ave        3046 max        2944 min
Histogram: 1 1 0 0 0 2 0 1 1 2
Neighs:        20960.8 ave       24636 max       16792 min
Histogram: 2 0 0 1 1 0 1 1 1 1

Total # of neighbors = 167686
Ave neighs/atom = 618.76753
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 33.7617913276728
variable C2pos equal ${d2}
variable C2pos equal 13.0010573309819
variable C3pos equal ${d3}
variable C3pos equal 38.6885128615886
variable C4pos equal ${d4}
variable C4pos equal 15.286184394732
variable C5pos equal ${d5}
variable C5pos equal 1.06468702700638
variable C6pos equal ${d6}
variable C6pos equal 4.91274006032514

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-58.9167608991613+${C1pos})
variable C16 equal 0.5*(-58.9167608991613+33.7617913276728)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-10.396129455742+${C2pos})
variable C26 equal 0.5*(-10.396129455742+13.0010573309819)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-21.035780237297+${C3pos})
variable C36 equal 0.5*(-21.035780237297+38.6885128615886)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-14.7525350654484+${C4pos})
variable C46 equal 0.5*(-14.7525350654484+15.286184394732)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(3.32755730409245+${C5pos})
variable C56 equal 0.5*(3.32755730409245+1.06468702700638)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(5.71829212289629+${C6pos})
variable C66 equal 0.5*(5.71829212289629+4.91274006032514)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 55.1362941814065
variable C22all equal ${C22}
variable C22all equal 33.9131300782254
variable C33all equal ${C33}
variable C33all equal 29.7714079016932

variable C44all equal ${C44}
variable C44all equal 13.5413730601293
variable C55all equal ${C55}
variable C55all equal 16.5259753123088
variable C66all equal ${C66}
variable C66all equal 5.31551609161072

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-23.1315906201354+${C21})
variable C12all equal 0.5*(-23.1315906201354+17.700954673234)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(7.5964993699036+${C31})
variable C13all equal 0.5*(7.5964993699036+10.5987199294739)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(17.6308703636117+${C32})
variable C23all equal 0.5*(17.6308703636117+-9.5961340521615)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(29.6727338470923+${C41})
variable C14all equal 0.5*(29.6727338470923+11.9416443147521)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(16.7262612334683+${C51})
variable C15all equal 0.5*(16.7262612334683+6.34554264568625)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-12.5774847857442+${C61})
variable C16all equal 0.5*(-12.5774847857442+-1.9788183010864)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(26.4695893484989+${C42})
variable C24all equal 0.5*(26.4695893484989+-7.6600199858231)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(2.6529323021035+${C52})
variable C25all equal 0.5*(2.6529323021035+-6.51926968859124)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(1.30246393761995+${C62})
variable C26all equal 0.5*(1.30246393761995+-0.72070293943391)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(13.0547766802362+${C43})
variable C34all equal 0.5*(13.0547766802362+-1.3293121800788)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-13.1401670015751+${C53})
variable C35all equal 0.5*(-13.1401670015751+2.35795270308705)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(8.8263663121458+${C63})
variable C36all equal 0.5*(8.8263663121458+-3.52909326621632)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-3.07362370099009+${C54})
variable C45all equal 0.5*(-3.07362370099009+1.2911148577908)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(0.2668246646418+${C64})
variable C46all equal 0.5*(0.2668246646418+3.61485993724317)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(2.19612216554941+${C65})
variable C56all equal 0.5*(2.19612216554941+0.05345971622212)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:17:21
