LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-14-VASP-an
read_data       ${structure}.data
read_data       333-HD-100C-14-VASP-an.data
Reading data file ...
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
  reading velocities ...
  366 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              326.3987       4018.5663    
         1   300            0              0              326.3987       4018.5663    
Loop time of 5.32712e-05 on 8 procs for 1 steps with 366 atoms

51.9% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.28e-07   | 1.7275e-07 | 2.67e-07   |   0.0 |  0.32
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.57e-07   | 1.0594e-06 | 1.366e-06  |   0.0 |  1.99
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.204e-05  |            |       | 97.69

Nlocal:          45.75 ave          54 max          39 min
Histogram: 2 0 0 2 1 0 1 0 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134.3 | 139.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -44413.832      6135.6906      0              1.9245713      3712.8734    
       100   308.3096      -44409.653     -5165.6423      707.60024      1.9245713      3712.8734    
       200   334.28654     -44411.64      -539.31865      5093.8071      1.9245713      3712.8734    
       300   301.24809     -44375.739     -1437.3907      635.54353      1.9245713      3712.8734    
       400   287.01388     -44403.163      1480.8253      2324.7749      1.9245713      3712.8734    
       500   274.89147     -44401.116     -6053.0418      2433.7611      1.9245713      3712.8734    
       600   286.09329     -44391.486      14719.203      3379.5346      1.9245713      3712.8734    
       700   319.92995     -44404.47       837.17097      88.924081      1.9245713      3712.8734    
       800   329.91628     -44418.038     -12195.094     -36.807221      1.9245713      3712.8734    
       900   293.46329     -44408.717     -2150.9778      3913.0753      1.9245713      3712.8734    
      1000   302.93654     -44425.559      1840.324       2321.9679      1.9245713      3712.8734    
      1100   292.73767     -44411.064      2518.6498     -212.46967      1.9245713      3712.8734    
      1200   289.5972      -44397.967     -7638.0576      8643.9607      1.9245713      3712.8734    
      1300   314.81606     -44424.248      83.073146      2595.7658      1.9245713      3712.8734    
      1400   302.10213     -44421.787      2092.0786      4914.538       1.9245713      3712.8734    
      1500   295.72744     -44423.814      7818.6726      1132.3994      1.9245713      3712.8734    
      1600   286.40767     -44410.29      -9489.8152     -181.68365      1.9245713      3712.8734    
      1700   318.4584      -44418.267     -1130.4694      2517.6475      1.9245713      3712.8734    
      1800   302.86001     -44391.303      8057.276       5260.6031      1.9245713      3712.8734    
      1900   319.08141     -44424.859     -2045.8182     -29.246026      1.9245713      3712.8734    
      2000   287.10151     -44427.719     -9504.8247      1426.9804      1.9245713      3712.8734    
Loop time of 96.3743 on 8 procs for 2000 steps with 366 atoms

Performance: 0.897 ns/day, 26.771 hours/ns, 20.752 timesteps/s, 7.595 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.67      | 60.794     | 81.495     | 101.5 | 63.08
Bond    | 0.00053742 | 0.00066652 | 0.00083651 |   0.0 |  0.00
Neigh   | 5.0188     | 5.488      | 7.4275     |  31.7 |  5.69
Comm    | 0.58647    | 21.304     | 26.428     | 171.5 | 22.11
Output  | 0.00093488 | 0.0010503  | 0.0014055  |   0.4 |  0.00
Modify  | 6.8247     | 8.7538     | 9.2264     |  24.9 |  9.08
Other   |            | 0.0336     |            |       |  0.03

Nlocal:          45.75 ave          54 max          39 min
Histogram: 1 1 2 0 1 0 0 1 1 1
Nghost:        3442.25 ave        3554 max        3330 min
Histogram: 1 1 0 0 2 1 1 0 1 1
Neighs:          31528 ave       37201 max       27106 min
Histogram: 1 2 1 0 1 0 0 1 1 1

Total # of neighbors = 252224
Ave neighs/atom = 689.13661
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-14-VASP-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.6218700460972
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.6674276415569
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3896295881975

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-1426.98043796464)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-1426.98043796464)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3721.43806000706)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3721.43806000706)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3971.94654562666)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3971.94654562666)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--36.4818635174347)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--36.4818635174347)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2972.12552478369)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2972.12552478369)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--715.914080116549)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--715.914080116549)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.6218700460972
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.6218700460972
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.156218700460972 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.156218700460972 xy delta 0.0772807647952826 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.156218700460972 xy delta 0.0772807647952826 xz delta 0.00148916510085043 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12833.266      1354.7299      3711.0169    
       200   301.54382     -44420.795      232.62819      1495.1815      3709.1605    
       300   312.80709     -44412.346      2888.8527      3945.6859      3707.304     
       400   298.13818     -44390.874      4973.5981      8575.0569      3705.4476    
       500   301.19802     -44400.795      6784.3163      5133.881       3703.5912    
       600   275.21068     -44396.273      5233.2376      6130.5601      3701.7347    
       700   282.22195     -44435.72       4143.0607      7850.8462      3699.8783    
       800   281.42468     -44424.254      9024.1205      6393.4337      3698.0219    
       900   316.85171     -44433.219     -3862.3728      3971.6025      3696.1654    
      1000   300.22868     -44407.928      6388.5517      9587.7417      3694.309     
      1100   303.37958     -44409.25       2289.1517      3662.8249      3692.4525    
      1200   305.3717      -44426.397      799.56619      5625.7467      3690.5961    
      1300   279.8347      -44426.632      12011.618      3037.3708      3688.7397    
      1400   290.03037     -44435.918      10066.078      4744.0891      3686.8832    
      1500   299.10224     -44412.593      10201.5        10863.527      3685.0268    
      1600   308.52002     -44410.211      1905.0791      9511.8486      3683.1704    
      1700   325.13884     -44426.738      3086.6045      7534.169       3681.3139    
      1800   306.07257     -44417.046      5055.6367      9446.8226      3679.4575    
      1900   293.18267     -44438.042      13522.852      11050.88       3677.6011    
      2000   288.58713     -44434.899      4325.785       12171.054      3675.7446    
Loop time of 96.7587 on 8 procs for 2000 steps with 366 atoms

Performance: 0.893 ns/day, 26.877 hours/ns, 20.670 timesteps/s, 7.565 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.905     | 60.804     | 81.769     | 102.7 | 62.84
Bond    | 0.00054207 | 0.0006813  | 0.00090857 |   0.0 |  0.00
Neigh   | 5.021      | 5.5075     | 7.4145     |  31.3 |  5.69
Comm    | 0.56688    | 21.548     | 26.445     | 172.6 | 22.27
Output  | 0.003634   | 0.0044411  | 0.0049394  |   0.7 |  0.00
Modify  | 6.9616     | 8.8589     | 9.3517     |  24.6 |  9.16
Other   |            | 0.03499    |            |       |  0.04

Nlocal:          45.75 ave          54 max          38 min
Histogram: 1 0 1 3 0 0 1 0 1 1
Nghost:         3463.5 ave        3581 max        3346 min
Histogram: 1 1 0 0 2 0 2 0 1 1
Neighs:        31848.1 ave       37465 max       26708 min
Histogram: 1 0 1 3 0 0 1 0 1 1

Total # of neighbors = 254785
Ave neighs/atom = 696.13388
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 108.864321486292
variable C2neg equal ${d2}
variable C2neg equal 56.0528538498756
variable C3neg equal ${d3}
variable C3neg equal 17.4077643820232
variable C4neg equal ${d4}
variable C4neg equal 10.8351392045283
variable C5neg equal ${d5}
variable C5neg equal -32.7921935319739
variable C6neg equal ${d6}
variable C6neg equal 3.90198664274119

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.6218700460972
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.156218700460972 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.156218700460972 xy delta -0.0772807647952826 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.156218700460972 xy delta -0.0772807647952826 xz delta -0.00148916510085043 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12820.439      1353.8847      3714.7298    
       200   301.65045     -44420.936     -592.15953      338.70029      3716.5862    
       300   316.83626     -44416.594      3070.5596      1899.0131      3718.4427    
       400   301.97407     -44394.404     -2691.4319      900.71121      3720.2991    
       500   287.83594     -44390.126      5081.5089     -114.42933      3722.1555    
       600   292.62613     -44421.452      1097.518      -580.70374      3724.012     
       700   284.16636     -44446.618      6279.9916     -315.10165      3725.8684    
       800   276.1105      -44428.88       9264.0526      5580.6736      3727.7248    
       900   292.68287     -44418.658     -3664.9288      3550.5983      3729.5813    
      1000   313.05915     -44423.053     -5933.6981      2362.8129      3731.4377    
      1100   297.83999     -44396.065      2913.8393      905.56096      3733.2942    
      1200   275.87134     -44373.08       1438.6407     -691.96935      3735.1506    
      1300   278.09836     -44406.151     -6331.3513     -4221.5315      3737.007     
      1400   285.74242     -44428.55       1884.5941     -1471.2374      3738.8635    
      1500   279.28032     -44403.424     -2323.9728     -1113.9584      3740.7199    
      1600   294.8993      -44396.386     -7756.9771     -1633.3318      3742.5763    
      1700   295.34903     -44396.457     -6821.3371     -6675.1851      3744.4328    
      1800   303.50974     -44410.023     -3851.7889     -6909.4449      3746.2892    
      1900   287.85823     -44414.074     -6324.6093     -7349.1218      3748.1456    
      2000   278.53721     -44428.132     -13994.364     -10327.746      3750.0021    
Loop time of 94.9859 on 8 procs for 2000 steps with 366 atoms

Performance: 0.910 ns/day, 26.385 hours/ns, 21.056 timesteps/s, 7.706 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.423     | 59.747     | 80.194     | 100.7 | 62.90
Bond    | 0.0004662  | 0.00062626 | 0.0008288  |   0.0 |  0.00
Neigh   | 5.0068     | 5.4451     | 7.3367     |  31.1 |  5.73
Comm    | 0.55947    | 21.025     | 25.352     | 169.9 | 22.13
Output  | 0.0034407  | 0.0043246  | 0.0048644  |   0.8 |  0.00
Modify  | 6.8489     | 8.7289     | 9.1675     |  24.4 |  9.19
Other   |            | 0.03527    |            |       |  0.04

Nlocal:          45.75 ave          52 max          39 min
Histogram: 2 0 0 1 0 1 1 1 1 1
Nghost:        3429.62 ave        3526 max        3341 min
Histogram: 2 0 0 1 1 2 0 0 1 1
Neighs:        31226.5 ave       35492 max       26878 min
Histogram: 2 0 0 1 0 2 0 1 1 1

Total # of neighbors = 249812
Ave neighs/atom = 682.54645
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 119.104767576928
variable C2pos equal ${d2}
variable C2pos equal 28.7618289907803
variable C3pos equal ${d3}
variable C3pos equal 63.6504559485081
variable C4pos equal ${d4}
variable C4pos equal -2.74071522438151
variable C5pos equal ${d5}
variable C5pos equal -3.05974222711093
variable C6pos equal ${d6}
variable C6pos equal -18.8122917844127

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(108.864321486292+${C1pos})
variable C11 equal 0.5*(108.864321486292+119.104767576928)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(56.0528538498756+${C2pos})
variable C21 equal 0.5*(56.0528538498756+28.7618289907803)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(17.4077643820232+${C3pos})
variable C31 equal 0.5*(17.4077643820232+63.6504559485081)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(10.8351392045283+${C4pos})
variable C41 equal 0.5*(10.8351392045283+-2.74071522438151)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-32.7921935319739+${C5pos})
variable C51 equal 0.5*(-32.7921935319739+-3.05974222711093)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(3.90198664274119+${C6pos})
variable C61 equal 0.5*(3.90198664274119+-18.8122917844127)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.6674276415569
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.6674276415569
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.136674276415569 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.136674276415569 yz delta 0.000457187373626142 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12833.266      1354.7299      3711.0169    
       200   301.11479     -44420.147      434.72677      1081.8485      3709.1605    
       300   313.21407     -44413.118      1334.4511      2894.2898      3707.304     
       400   304.92883     -44398.741      4205.554       5426.0257      3705.4476    
       500   300.59788     -44400.646      9332.5674      5132.1486      3703.5912    
       600   290.37378     -44412.285      2317.0536      3259.2892      3701.7347    
       700   288.32177     -44441.868      15592.385      6769.7463      3699.8783    
       800   279.42206     -44427.368      3708.4439      6414.6115      3698.0219    
       900   298.91127     -44417.413      4289.8049      7472.5504      3696.1654    
      1000   299.72131     -44407.15       2714.3801      7609.7649      3694.309     
      1100   290.2267      -44399.424      1315.1316     -462.92666      3692.4525    
      1200   305.07381     -44426.692     -1701.1194      5179.9257      3690.5961    
      1300   287.34813     -44441.277      3622.5728     -1689.2262      3688.7397    
      1400   285.3361      -44437.334      5383.5865      642.20351      3686.8832    
      1500   295.56884     -44429.95       2051.1207      6282.7065      3685.0268    
      1600   308.21138     -44434.076      3552.3         3772.4354      3683.1704    
      1700   307.86837     -44428.44       2184.8646      477.26456      3681.3139    
      1800   324.69765     -44445.139      2309.7551     -1781.6731      3679.4575    
      1900   281.55188     -44410.594      3531.5102      3012.7971      3677.6011    
      2000   288.00469     -44442.265      12178.447     -796.22506      3675.7446    
Loop time of 96.444 on 8 procs for 2000 steps with 366 atoms

Performance: 0.896 ns/day, 26.790 hours/ns, 20.737 timesteps/s, 7.590 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.983     | 61.168     | 81.529     |  99.1 | 63.42
Bond    | 0.0004635  | 0.00066239 | 0.00082818 |   0.0 |  0.00
Neigh   | 5.0801     | 5.5253     | 7.4238     |  31.0 |  5.73
Comm    | 0.57169    | 20.95      | 25.137     | 169.5 | 21.72
Output  | 0.0035385  | 0.0043309  | 0.0048676  |   0.7 |  0.00
Modify  | 6.872      | 8.7592     | 9.2076     |  24.5 |  9.08
Other   |            | 0.03585    |            |       |  0.04

Nlocal:          45.75 ave          51 max          40 min
Histogram: 2 0 1 0 2 0 0 0 0 3
Nghost:        3491.62 ave        3601 max        3383 min
Histogram: 2 0 0 0 2 1 1 0 1 1
Neighs:        31851.6 ave       35454 max       28126 min
Histogram: 2 0 1 0 2 0 0 0 0 3

Total # of neighbors = 254813
Ave neighs/atom = 696.21038
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -22.5266296989591
variable C2neg equal ${d2}
variable C2neg equal 60.660426951727
variable C3neg equal ${d3}
variable C3neg equal -39.2594323709219
variable C4neg equal ${d4}
variable C4neg equal -1.76983984501551
variable C5neg equal ${d5}
variable C5neg equal -20.736053060723
variable C6neg equal ${d6}
variable C6neg equal 2.28064928943904

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.6674276415569
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.136674276415569 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.136674276415569 yz delta -0.000457187373626142 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12820.439      1353.8847      3714.7298    
       200   301.7689      -44421.362     -720.8294       770.22976      3716.5862    
       300   316.64855     -44416.515      2068.8197      2170.7163      3718.4427    
       400   297.57163     -44389.591     -3827.1197      4285.0377      3720.2991    
       500   307.27581     -44407.989      9795.144       1791.2446      3722.1555    
       600   275.62874     -44402.664      3125.0442      998.23892      3724.012     
       700   259.60641     -44412.645      143.34014      3377.7729      3725.8684    
       800   275.77366     -44418.127      2468.7764      7933.1232      3727.7248    
       900   285.30432     -44401.782     -3758.3737     -29.294661      3729.5813    
      1000   300.829       -44403.59      -1729.569       556.28655      3731.4377    
      1100   298.09414     -44406.429     -5211.8417     -2282.5599      3733.2942    
      1200   297.55298     -44423.412     -7198.1187     -1537.0847      3735.1506    
      1300   274.34655     -44422.501     -3800.9047     -8645.672       3737.007     
      1400   282.96502     -44444.401      3056.2369      2227.1966      3738.8635    
      1500   294.43591     -44427.049      8143.1022      1865.3264      3740.7199    
      1600   306.05069     -44412.55      -1628.5418      787.40887      3742.5763    
      1700   308.98557     -44406.705     -1070.0639      1088.2964      3744.4328    
      1800   318.43751     -44409.239     -12022.018     -3154.0199      3746.2892    
      1900   304.44647     -44402.998     -1278.7494     -3462.4531      3748.1456    
      2000   287.95785     -44418.134      1095.5246     -4325.1742      3750.0021    
Loop time of 94.5216 on 8 procs for 2000 steps with 366 atoms

Performance: 0.914 ns/day, 26.256 hours/ns, 21.159 timesteps/s, 7.744 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.863     | 60.139     | 79.765     |  96.5 | 63.62
Bond    | 0.00052454 | 0.0006508  | 0.00082614 |   0.0 |  0.00
Neigh   | 4.9577     | 5.4386     | 7.3216     |  31.1 |  5.75
Comm    | 0.55915    | 20.204     | 24.482     | 166.6 | 21.37
Output  | 0.0033999  | 0.0042563  | 0.0047967  |   0.7 |  0.00
Modify  | 6.8284     | 8.6999     | 9.1815     |  24.4 |  9.20
Other   |            | 0.03568    |            |       |  0.04

Nlocal:          45.75 ave          53 max          37 min
Histogram: 1 0 0 3 0 1 0 0 0 3
Nghost:        3418.62 ave        3509 max        3329 min
Histogram: 2 0 0 1 0 2 1 0 0 2
Neighs:        31213.9 ave       35917 max       25535 min
Histogram: 1 0 1 2 0 1 0 0 0 3

Total # of neighbors = 249711
Ave neighs/atom = 682.27049
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 58.2837068106786
variable C2pos equal ${d2}
variable C2pos equal 50.2187432074773
variable C3pos equal ${d3}
variable C3pos equal 54.4610322736411
variable C4pos equal ${d4}
variable C4pos equal 3.62814771391465
variable C5pos equal ${d5}
variable C5pos equal 2.4192830139305
variable C6pos equal ${d6}
variable C6pos equal -31.3585927448501

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-22.5266296989591+${C1pos})
variable C12 equal 0.5*(-22.5266296989591+58.2837068106786)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(60.660426951727+${C2pos})
variable C22 equal 0.5*(60.660426951727+50.2187432074773)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-39.2594323709219+${C3pos})
variable C32 equal 0.5*(-39.2594323709219+54.4610322736411)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-1.76983984501551+${C4pos})
variable C42 equal 0.5*(-1.76983984501551+3.62814771391465)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-20.736053060723+${C5pos})
variable C52 equal 0.5*(-20.736053060723+2.4192830139305)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(2.28064928943904+${C6pos})
variable C62 equal 0.5*(2.28064928943904+-31.3585927448501)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3896295881975
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3896295881975
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.173896295881975 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12833.266      1354.7299      3711.0169    
       200   301.56269     -44420.463      360.48938      1174.7612      3709.1605    
       300   313.03967     -44412.799      2765.0723      3167.1681      3707.304     
       400   300.58849     -44393.267      1558.4044      5477.0663      3705.4476    
       500   295.07447     -44393.067      7053.0478      5024.5067      3703.5912    
       600   289.51231     -44415.708     -1202.4213      4861.144       3701.7347    
       700   290.03593     -44443.744      6961.2241      8744.4521      3699.8783    
       800   280.0832      -44425.217      12129.999      4640.8733      3698.0219    
       900   307.53715     -44425.139      12452.641      4446.4153      3696.1654    
      1000   295.98657     -44404.478      798.4585       5325.2364      3694.309     
      1100   289.36019     -44402.756      501.7167       2117.4664      3692.4525    
      1200   300.7481      -44427.985     -4688.1916      2886.0096      3690.5961    
      1300   268.86617     -44427.914      11777.696     -997.66787      3688.7397    
      1400   276.15497     -44436.04       8165.6138      5105.4879      3686.8832    
      1500   291.22342     -44426.737      15780.505      13669.353      3685.0268    
      1600   310.56194     -44432.323      7846.7907      4971.7238      3683.1704    
      1700   299.64775     -44414.661      13308.852      1661.1696      3681.3139    
      1800   290.76183     -44397.606      9269.8259      2763.6374      3679.4575    
      1900   304.43424     -44403.155      335.55447      3866.095       3677.6011    
      2000   298.53847     -44398.566      180.18189      899.00182      3675.7446    
Loop time of 96.9438 on 8 procs for 2000 steps with 366 atoms

Performance: 0.891 ns/day, 26.929 hours/ns, 20.631 timesteps/s, 7.551 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.284     | 61.406     | 81.947     |  99.7 | 63.34
Bond    | 0.00051077 | 0.00064505 | 0.00080785 |   0.0 |  0.00
Neigh   | 5.0472     | 5.5112     | 7.4052     |  31.0 |  5.68
Comm    | 0.56762    | 21.129     | 25.232     | 170.2 | 21.80
Output  | 0.0035176  | 0.0043147  | 0.0048549  |   0.7 |  0.00
Modify  | 6.9776     | 8.8571     | 9.3234     |  24.3 |  9.14
Other   |            | 0.03534    |            |       |  0.04

Nlocal:          45.75 ave          51 max          40 min
Histogram: 2 1 0 1 0 0 1 0 0 3
Nghost:        3459.12 ave        3546 max        3374 min
Histogram: 2 0 0 0 1 3 0 0 0 2
Neighs:        31872.1 ave       35332 max       28241 min
Histogram: 2 1 0 1 0 0 1 0 1 2

Total # of neighbors = 254977
Ave neighs/atom = 696.65847
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -5.34974337188166
variable C2neg equal ${d2}
variable C2neg equal 55.54492872127
variable C3neg equal ${d3}
variable C3neg equal 73.0782721130869
variable C4neg equal ${d4}
variable C4neg equal -1.3914862018054
variable C5neg equal ${d5}
variable C5neg equal -15.0125237564397
variable C6neg equal ${d6}
variable C6neg equal 10.9564778155348

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3896295881975
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.173896295881975 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12820.439      1353.8847      3714.7298    
       200   301.56414     -44421.208     -561.00443      635.53038      3716.5862    
       300   316.78116     -44417.078      2769.4652      2604.9781      3718.4427    
       400   303.25338     -44396.626     -4981.4399      2513.2737      3720.2991    
       500   307.19593     -44412.018      6154.6684     -377.2913       3722.1555    
       600   289.56454     -44415.282      2833.6477     -6.5619077      3724.012     
       700   278.3509      -44438.781      11541.583      5698.4975      3725.8684    
       800   274.58824     -44425.092      6368.3778      4829.3024      3727.7248    
       900   281.72902     -44404.153      2861.2525      5695.1667      3729.5813    
      1000   300.04332     -44406.292      5502.611       6538.754       3731.4377    
      1100   300.71956     -44395.58      -6830.2387      618.88636      3733.2942    
      1200   312.91713     -44404.669     -105.20021      4286.9493      3735.1506    
      1300   294.77945     -44412.823     -5950.2961     -8270.252       3737.007     
      1400   277.30406     -44414.756     -6097.555      -1134.227       3738.8635    
      1500   288.67253     -44421.585      915.66234      1023.2118      3740.7199    
      1600   311.4437      -44419.396     -10657.265      452.00608      3742.5763    
      1700   289.4726      -44381.751     -5740.319      -2433.6673      3744.4328    
      1800   303.05319     -44394.738     -2791.3882     -1964.918       3746.2892    
      1900   291.76422     -44398.226      651.38801      755.57192      3748.1456    
      2000   294.33527     -44418.256      1081.2016      39.400685      3750.0021    
Loop time of 94.7557 on 8 procs for 2000 steps with 366 atoms

Performance: 0.912 ns/day, 26.321 hours/ns, 21.107 timesteps/s, 7.725 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.161     | 60.243     | 79.954     |  96.7 | 63.58
Bond    | 0.00053303 | 0.00065618 | 0.00090185 |   0.0 |  0.00
Neigh   | 5.0234     | 5.4567     | 7.3308     |  30.7 |  5.76
Comm    | 0.57753    | 20.308     | 24.394     | 166.6 | 21.43
Output  | 0.0034976  | 0.0043801  | 0.0049369  |   0.8 |  0.00
Modify  | 6.8479     | 8.7079     | 9.1416     |  24.1 |  9.19
Other   |            | 0.03487    |            |       |  0.04

Nlocal:          45.75 ave          52 max          39 min
Histogram: 2 0 0 1 1 1 0 1 0 2
Nghost:        3425.75 ave        3526 max        3330 min
Histogram: 2 0 0 1 1 1 1 0 1 1
Neighs:        31189.8 ave       35372 max       26807 min
Histogram: 2 0 0 1 1 1 0 1 0 2

Total # of neighbors = 249518
Ave neighs/atom = 681.74317
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 14.0596518454914
variable C2pos equal ${d2}
variable C2pos equal 11.5112895829138
variable C3pos equal ${d3}
variable C3pos equal 114.343468916152
variable C4pos equal ${d4}
variable C4pos equal 6.55576767083821
variable C5pos equal ${d5}
variable C5pos equal 5.15694250063987
variable C6pos equal ${d6}
variable C6pos equal -1.88370678803243

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-5.34974337188166+${C1pos})
variable C13 equal 0.5*(-5.34974337188166+14.0596518454914)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(55.54492872127+${C2pos})
variable C23 equal 0.5*(55.54492872127+11.5112895829138)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(73.0782721130869+${C3pos})
variable C33 equal 0.5*(73.0782721130869+114.343468916152)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-1.3914862018054+${C4pos})
variable C43 equal 0.5*(-1.3914862018054+6.55576767083821)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-15.0125237564397+${C5pos})
variable C53 equal 0.5*(-15.0125237564397+5.15694250063987)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(10.9564778155348+${C6pos})
variable C63 equal 0.5*(10.9564778155348+-1.88370678803243)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3896295881975
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3896295881975
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.173896295881975 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12826.849      1354.3071      3712.8734    
       200   301.52754     -44420.747     -182.93767      903.31782      3712.8734    
       300   312.76117     -44412.582      854.92181      2505.2656      3712.8734    
       400   302.06753     -44394.476     -5342.3604      3878.595       3712.8734    
       500   308.7959      -44409.704      8952.0797      3825.1682      3712.8734    
       600   272.81438     -44397.733      4224.5993      5082.0161      3712.8734    
       700   280.37392     -44439.442      7865.8722      6379.4782      3712.8734    
       800   286.26485     -44438.381     -6758.0216      3147.1558      3712.8734    
       900   301.64992     -44425.893     -3895.22        2994.0194      3712.8734    
      1000   299.42505     -44413.066      710.1964       6171.1807      3712.8734    
      1100   311.1918      -44420.251     -6790.1327     -972.40809      3712.8734    
      1200   303.13697     -44415.274     -10104.354      985.11782      3712.8734    
      1300   294.68261     -44425.773     -6978.0259     -3052.5348      3712.8734    
      1400   298.93905     -44438.011      9400.2899      570.28151      3712.8734    
      1500   308.37071     -44428.265      10101.975      5483.0502      3712.8734    
      1600   303.95889     -44394.701      16512.14       216.60794      3712.8734    
      1700   316.06838     -44406.225     -2059.49       -4729.3059      3712.8734    
      1800   303.64744     -44407.724      58.872069     -2075.5356      3712.8734    
      1900   309.71346     -44434.626      7530.6139      3549.7864      3712.8734    
      2000   295.65972     -44426.924     -7159.3133      223.10185      3712.8734    
Loop time of 95.6585 on 8 procs for 2000 steps with 366 atoms

Performance: 0.903 ns/day, 26.572 hours/ns, 20.908 timesteps/s, 7.652 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.5       | 60.63      | 80.756     |  98.4 | 63.38
Bond    | 0.00053055 | 0.00065806 | 0.0007865  |   0.0 |  0.00
Neigh   | 5.0449     | 5.4984     | 7.4195     |  31.4 |  5.75
Comm    | 0.57985    | 20.727     | 24.859     | 168.4 | 21.67
Output  | 0.0034037  | 0.0042187  | 0.0047156  |   0.7 |  0.00
Modify  | 6.8555     | 8.762      | 9.2166     |  24.7 |  9.16
Other   |            | 0.03606    |            |       |  0.04

Nlocal:          45.75 ave          53 max          39 min
Histogram: 2 0 0 1 1 1 1 0 1 1
Nghost:        3451.88 ave        3567 max        3345 min
Histogram: 1 1 0 1 1 1 1 1 0 1
Neighs:        31534.1 ave       36245 max       27126 min
Histogram: 2 0 0 1 1 1 1 0 1 1

Total # of neighbors = 252273
Ave neighs/atom = 689.27049
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -12.1982998378228
variable C2neg equal ${d2}
variable C2neg equal 37.1731181286522
variable C3neg equal ${d3}
variable C3neg equal 4.99885838940224
variable C4neg equal ${d4}
variable C4neg equal 18.4294225274717
variable C5neg equal ${d5}
variable C5neg equal -9.0196022102046
variable C6neg equal ${d6}
variable C6neg equal -1.00812399974636

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3896295881975
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.173896295881975 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12826.849      1354.3071      3712.8734    
       200   301.55207     -44420.981     -47.279383      974.66828      3712.8734    
       300   316.67664     -44416.837      1741.1307      2626.8538      3712.8734    
       400   296.74329     -44390.513     -8141.9964      3350.9281      3712.8734    
       500   297.81245     -44402.739      2082.6409      2323.6341      3712.8734    
       600   287.26127     -44418.853      5851.6865      903.09271      3712.8734    
       700   278.93649     -44440.439      15329.734      4393.5993      3712.8734    
       800   267.28028     -44415.334      7160.1158      4901.1528      3712.8734    
       900   309.14979     -44432.838      152.13775      3549.128       3712.8734    
      1000   292.88196     -44402.19       1367.4099      5847.4486      3712.8734    
      1100   295.33297     -44398.939      4502.2206      2603.0222      3712.8734    
      1200   297.33334     -44409.553      3300.7948      2330.3297      3712.8734    
      1300   285.80666     -44430.622     -1052.8375     -344.27057      3712.8734    
      1400   290.54601     -44436.167     -7980.4041     -332.37578      3712.8734    
      1500   283.66873     -44407.619      4737.876       4066.5764      3712.8734    
      1600   308.39761     -44421.84       1905.5391      8074.3606      3712.8734    
      1700   292.00108     -44404.163      4784.0388      4359.3174      3712.8734    
      1800   302.77372     -44413.412     -3991.0467      4274.8426      3712.8734    
      1900   315.74149     -44432.914      2838.0541      2165.4437      3712.8734    
      2000   292.84116     -44437.601      7205.4069      310.0184       3712.8734    
Loop time of 95.4294 on 8 procs for 2000 steps with 366 atoms

Performance: 0.905 ns/day, 26.508 hours/ns, 20.958 timesteps/s, 7.671 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.043     | 60.21      | 80.696     | 100.5 | 63.09
Bond    | 0.0004746  | 0.00062702 | 0.00085486 |   0.0 |  0.00
Neigh   | 5.0444     | 5.4762     | 7.3421     |  30.6 |  5.74
Comm    | 0.56195    | 21.072     | 25.242     | 170.1 | 22.08
Output  | 0.0035695  | 0.0043532  | 0.0048547  |   0.7 |  0.00
Modify  | 6.7821     | 8.6309     | 9.06       |  24.1 |  9.04
Other   |            | 0.03579    |            |       |  0.04

Nlocal:          45.75 ave          51 max          40 min
Histogram: 2 0 0 2 1 0 0 0 0 3
Nghost:           3449 ave        3542 max        3346 min
Histogram: 2 0 0 0 0 4 0 0 0 2
Neighs:        31554.2 ave       35219 max       27985 min
Histogram: 2 0 1 1 1 0 0 0 1 2

Total # of neighbors = 252434
Ave neighs/atom = 689.71038
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 11.3176178899101
variable C2pos equal ${d2}
variable C2pos equal -8.01900473079261
variable C3pos equal ${d3}
variable C3pos equal 31.5827397349717
variable C4pos equal ${d4}
variable C4pos equal 14.5490493207368
variable C5pos equal ${d5}
variable C5pos equal 22.4731620317812
variable C6pos equal ${d6}
variable C6pos equal -20.3039211984821

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-12.1982998378228+${C1pos})
variable C14 equal 0.5*(-12.1982998378228+11.3176178899101)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(37.1731181286522+${C2pos})
variable C24 equal 0.5*(37.1731181286522+-8.01900473079261)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(4.99885838940224+${C3pos})
variable C34 equal 0.5*(4.99885838940224+31.5827397349717)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(18.4294225274717+${C4pos})
variable C44 equal 0.5*(18.4294225274717+14.5490493207368)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-9.0196022102046+${C5pos})
variable C54 equal 0.5*(-9.0196022102046+22.4731620317812)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-1.00812399974636+${C6pos})
variable C64 equal 0.5*(-1.00812399974636+-20.3039211984821)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3896295881975
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3896295881975
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.173896295881975 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12826.849      1354.3071      3712.8734    
       200   301.1618      -44420.53      -44.360918      969.7625       3712.8734    
       300   313.25188     -44413.012      2433.0663      2442.3174      3712.8734    
       400   298.70036     -44391.747     -894.17615      3748.3718      3712.8734    
       500   299.30028     -44401.244      4028.9209      1926.2345      3712.8734    
       600   295.38456     -44417.748      2842.8194      2820.3661      3712.8734    
       700   273.83974     -44428.409      5023.3535      2605.766       3712.8734    
       800   283.99834     -44436.452      5578.241       3800.0058      3712.8734    
       900   318.22271     -44443.482      11993.762      4315.0918      3712.8734    
      1000   307.6696      -44421.896      7788.6207      5759.2722      3712.8734    
      1100   293.10345     -44403.15       852.37425      1990.497       3712.8734    
      1200   307.82407     -44418.005      1791.6163      4963.7601      3712.8734    
      1300   288.66877     -44421.197      5832.2319      361.64969      3712.8734    
      1400   288.55764     -44435.644     -1331.1538      2953.3872      3712.8734    
      1500   307.65926     -44440.272      1570.322       3771.9605      3712.8734    
      1600   327.2289      -44428.839     -1711.051       4449.9749      3712.8734    
      1700   317.4919      -44418.245      2439.7292      4051.0045      3712.8734    
      1800   299.30135     -44407.65       8149.7347      2521.6193      3712.8734    
      1900   301.37141     -44419.702     -7442.8239      3435.8498      3712.8734    
      2000   283.44439     -44430.567      4403.7618      9113.1611      3712.8734    
Loop time of 95.6263 on 8 procs for 2000 steps with 366 atoms

Performance: 0.904 ns/day, 26.563 hours/ns, 20.915 timesteps/s, 7.655 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.937     | 60.434     | 80.773     |  99.6 | 63.20
Bond    | 0.00046087 | 0.00064476 | 0.00087765 |   0.0 |  0.00
Neigh   | 5.0357     | 5.4838     | 7.3746     |  31.0 |  5.73
Comm    | 0.56653    | 20.924     | 25.418     | 169.4 | 21.88
Output  | 0.0035152  | 0.0043986  | 0.0049479  |   0.7 |  0.00
Modify  | 6.865      | 8.7435     | 9.1981     |  24.4 |  9.14
Other   |            | 0.03579    |            |       |  0.04

Nlocal:          45.75 ave          55 max          40 min
Histogram: 1 1 3 0 0 1 1 0 0 1
Nghost:        3451.75 ave        3552 max        3360 min
Histogram: 2 0 0 1 1 2 0 0 1 1
Neighs:          31524 ave       37772 max       27790 min
Histogram: 1 2 2 0 0 1 1 0 0 1

Total # of neighbors = 252192
Ave neighs/atom = 689.04918
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 77.8802251408899
variable C2neg equal ${d2}
variable C2neg equal 40.107781318602
variable C3neg equal ${d3}
variable C3neg equal -5.97244509627342
variable C4neg equal ${d4}
variable C4neg equal -0.699189351651538
variable C5neg equal ${d5}
variable C5neg equal 15.9937662891753
variable C6neg equal ${d6}
variable C6neg equal 14.1587058798782

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3896295881975
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.173896295881975 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12826.849      1354.3071      3712.8734    
       200   301.87124     -44421.192     -185.81888      889.34108      3712.8734    
       300   315.11825     -44415.376      1002.0732      2628.1684      3712.8734    
       400   303.04957     -44397.301     -6228.0948      3399.4004      3712.8734    
       500   302.28326     -44405.956      8444.784       3472.0588      3712.8734    
       600   286.7981      -44419.537      5568.994       4528.037       3712.8734    
       700   286.3355      -44445.971      14774.063      3731.1188      3712.8734    
       800   285.92889     -44430.383      7950.6061      6904.9387      3712.8734    
       900   296.01557     -44414.879      8150.6644      3992.9574      3712.8734    
      1000   298.52854     -44401.532      3473.2797      7877.927       3712.8734    
      1100   317.19523     -44418.953      1933.8692     -301.87817      3712.8734    
      1200   308.88088     -44423.08      -6137.9354      2490.3814      3712.8734    
      1300   274.9866      -44421.536     -2372.7162      1059.7118      3712.8734    
      1400   272.73851     -44417.979      2871.1796      1235.9392      3712.8734    
      1500   289.17126     -44416.641      1117.2496      5378.6556      3712.8734    
      1600   283.27283     -44400.296      10755.225      5874.2125      3712.8734    
      1700   297.71443     -44407.744      193.31447      366.8849       3712.8734    
      1800   303.34176     -44401.372      1571.0111      8073.9098      3712.8734    
      1900   314.138       -44403.012      5014.9522      2618.2992      3712.8734    
      2000   323.03498     -44396.09       5525.4626      6674.1096      3712.8734    
Loop time of 95.7039 on 8 procs for 2000 steps with 366 atoms

Performance: 0.903 ns/day, 26.584 hours/ns, 20.898 timesteps/s, 7.649 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.96      | 60.471     | 80.881     | 100.1 | 63.19
Bond    | 0.00044796 | 0.00066717 | 0.00087483 |   0.0 |  0.00
Neigh   | 5.016      | 5.4823     | 7.3697     |  31.0 |  5.73
Comm    | 0.57039    | 21         | 25.51      | 170.1 | 21.94
Output  | 0.0035291  | 0.004393   | 0.0049771  |   0.8 |  0.00
Modify  | 6.8353     | 8.7102     | 9.1813     |  24.4 |  9.10
Other   |            | 0.03591    |            |       |  0.04

Nlocal:          45.75 ave          52 max          40 min
Histogram: 1 1 1 0 0 3 0 0 1 1
Nghost:        3477.62 ave        3573 max        3383 min
Histogram: 2 0 0 1 1 1 1 0 1 1
Neighs:        31552.6 ave       35413 max       27883 min
Histogram: 1 1 1 0 1 1 1 0 1 1

Total # of neighbors = 252421
Ave neighs/atom = 689.67486
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -53.1665361193028
variable C2pos equal ${d2}
variable C2pos equal -65.8571498195778
variable C3pos equal ${d3}
variable C3pos equal -18.5573915847669
variable C4pos equal ${d4}
variable C4pos equal 5.4468017168663
variable C5pos equal ${d5}
variable C5pos equal 13.3245625175251
variable C6pos equal ${d6}
variable C6pos equal -26.7250580917124

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(77.8802251408899+${C1pos})
variable C15 equal 0.5*(77.8802251408899+-53.1665361193028)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(40.107781318602+${C2pos})
variable C25 equal 0.5*(40.107781318602+-65.8571498195778)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-5.97244509627342+${C3pos})
variable C35 equal 0.5*(-5.97244509627342+-18.5573915847669)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-0.699189351651538+${C4pos})
variable C45 equal 0.5*(-0.699189351651538+5.4468017168663)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(15.9937662891753+${C5pos})
variable C55 equal 0.5*(15.9937662891753+13.3245625175251)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(14.1587058798782+${C6pos})
variable C65 equal 0.5*(14.1587058798782+-26.7250580917124)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.6674276415569

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.6674276415569
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.136674276415569 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12826.849      1354.3071      3712.8734    
       200   301.74455     -44421.102     -269.0919       855.01488      3712.8734    
       300   314.25845     -44414.102      1747.6481      2694.5318      3712.8734    
       400   295.95975     -44388.868     -3732.2561      3158.0478      3712.8734    
       500   300.28282     -44403.499      8273.0194      3311.6715      3712.8734    
       600   274.60668     -44407.203      1478.2183      2728.879       3712.8734    
       700   269.59431     -44426.231      755.58964      6039.3282      3712.8734    
       800   276.14281     -44421.907      8260.323       7371.6232      3712.8734    
       900   303.09584     -44425.893     -1010.6245      2330.5998      3712.8734    
      1000   304.14096     -44415.236      819.26192      3959.0371      3712.8734    
      1100   275.39419     -44386.341     -7011.6094     -2756.5372      3712.8734    
      1200   287.37797     -44414.848     -3003.3124      701.36923      3712.8734    
      1300   259.46259     -44415.18      -2315.8176     -5045.069       3712.8734    
      1400   274.40798     -44432.711      1984.2214     -254.99323      3712.8734    
      1500   312.95483     -44434.936      12932.518      5754.4536      3712.8734    
      1600   285.72022     -44402.346      6427.602       5247.2307      3712.8734    
      1700   300.88724     -44422.558      641.47452     -2722.512       3712.8734    
      1800   304.47212     -44423.954     -4590.2296     -7111.8551      3712.8734    
      1900   298.57612     -44400.048      4468.4181     -3188.42        3712.8734    
      2000   320.53202     -44407.765     -2866.1986      5617.6647      3712.8734    
Loop time of 87.2245 on 8 procs for 2000 steps with 366 atoms

Performance: 0.991 ns/day, 24.229 hours/ns, 22.929 timesteps/s, 8.392 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.333     | 59.502     | 73.428     |  68.9 | 68.22
Bond    | 0.00054534 | 0.00065383 | 0.00082609 |   0.0 |  0.00
Neigh   | 5.0701     | 5.4139     | 6.6846     |  21.1 |  6.21
Comm    | 0.54608    | 14.486     | 17.657     | 139.9 | 16.61
Output  | 0.0034526  | 0.0043023  | 0.004895   |   0.8 |  0.00
Modify  | 6.5182     | 7.7801     | 8.1252     |  17.5 |  8.92
Other   |            | 0.03777    |            |       |  0.04

Nlocal:          45.75 ave          50 max          40 min
Histogram: 2 0 0 0 0 1 1 0 2 2
Nghost:        3457.25 ave        3528 max        3394 min
Histogram: 1 3 0 0 0 0 1 1 1 1
Neighs:        31521.1 ave       34204 max       27655 min
Histogram: 2 0 0 0 0 1 1 0 2 2

Total # of neighbors = 252169
Ave neighs/atom = 688.98634
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 42.462108783532
variable C2neg equal ${d2}
variable C2neg equal 19.5763371223114
variable C3neg equal ${d3}
variable C3neg equal 19.3345344233474
variable C4neg equal ${d4}
variable C4neg equal 0.712205921763339
variable C5neg equal ${d5}
variable C5neg equal -13.9180432534901
variable C6neg equal ${d6}
variable C6neg equal 18.7460532846568

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.051064977 0.11783618 -0.071564794) to (15.672935 13.785264 17.318065) with tilt (-7.7280765 -0.14891651 -0.045718737)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.6674276415569
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.136674276415569 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 134 | 138.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.10151     -44427.719     -9504.6276      0              3712.8734    
       100   278.76935     -44417.402      12826.849      1354.3071      3712.8734    
       200   301.24124     -44420.518      56.418258      957.32355      3712.8734    
       300   314.6522      -44414.443      2192.9654      2399.4408      3712.8734    
       400   300.23488     -44393.358     -4016.4757      5378.0736      3712.8734    
       500   307.35804     -44410.299      12377.367      1801.5229      3712.8734    
       600   277.97458     -44404.668      1906.1183      3003.0635      3712.8734    
       700   272.21033     -44426.27       11693.631      7190.6334      3712.8734    
       800   298.6273      -44440.704     -3618.407       3422.8486      3712.8734    
       900   304.551       -44422.381     -4254.8961     -1234.9828      3712.8734    
      1000   298.13819     -44407.901     -4102.8831      3803.4142      3712.8734    
      1100   288.34459     -44401.523     -2926.4999     -392.0372       3712.8734    
      1200   294.76661     -44413.836     -7358.4916      5692.8748      3712.8734    
      1300   291.72725     -44422.863      3935.7458      314.32701      3712.8734    
      1400   285.36604     -44420.294      5382.9204      1334.7022      3712.8734    
      1500   293.34308     -44405.185      6993.0629      6893.5884      3712.8734    
      1600   316.33133     -44405.237      5314.722       6958.0374      3712.8734    
      1700   295.35798     -44388.446      13141.87       5407.3486      3712.8734    
      1800   300.43313     -44406.881      2272.5296      257.09037      3712.8734    
      1900   291.23572     -44408.342      12398.052      2641.751       3712.8734    
      2000   290.2296      -44406.74       3434.7824     -1402.9344      3712.8734    
Loop time of 66.4642 on 8 procs for 2000 steps with 366 atoms

Performance: 1.300 ns/day, 18.462 hours/ns, 30.091 timesteps/s, 11.013 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.333     | 52.294     | 54.461     |  17.7 | 78.68
Bond    | 0.00040531 | 0.00060784 | 0.000767   |   0.0 |  0.00
Neigh   | 5.0299     | 5.2181     | 5.4627     |   6.2 |  7.85
Comm    | 0.58307    | 2.7532     | 4.718      |  77.1 |  4.14
Output  | 0.0031318  | 0.0040614  | 0.0047282  |   0.9 |  0.01
Modify  | 5.9155     | 6.1584     | 6.3439     |   5.6 |  9.27
Other   |            | 0.03575    |            |       |  0.05

Nlocal:          45.75 ave          51 max          41 min
Histogram: 1 1 0 2 0 1 0 1 0 2
Nghost:         3438.5 ave        3521 max        3344 min
Histogram: 1 1 0 0 1 2 1 0 0 2
Neighs:          31536 ave       34827 max       28453 min
Histogram: 1 1 2 0 0 1 0 1 0 2

Total # of neighbors = 252288
Ave neighs/atom = 689.31148
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 28.6741124586757
variable C2pos equal ${d2}
variable C2pos equal 1.98262511024106
variable C3pos equal ${d3}
variable C3pos equal 40.0953874035072
variable C4pos equal ${d4}
variable C4pos equal -9.20587944820919
variable C5pos equal ${d5}
variable C5pos equal 36.9860361861559
variable C6pos equal ${d6}
variable C6pos equal 10.369094452867

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(42.462108783532+${C1pos})
variable C16 equal 0.5*(42.462108783532+28.6741124586757)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(19.5763371223114+${C2pos})
variable C26 equal 0.5*(19.5763371223114+1.98262511024106)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(19.3345344233474+${C3pos})
variable C36 equal 0.5*(19.3345344233474+40.0953874035072)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(0.712205921763339+${C4pos})
variable C46 equal 0.5*(0.712205921763339+-9.20587944820919)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-13.9180432534901+${C5pos})
variable C56 equal 0.5*(-13.9180432534901+36.9860361861559)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(18.7460532846568+${C6pos})
variable C66 equal 0.5*(18.7460532846568+10.369094452867)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 113.98454453161
variable C22all equal ${C22}
variable C22all equal 55.4395850796022
variable C33all equal ${C33}
variable C33all equal 93.7108705146194

variable C44all equal ${C44}
variable C44all equal 16.4892359241042
variable C55all equal ${C55}
variable C55all equal 14.6591644033502
variable C66all equal ${C66}
variable C66all equal 14.5575738687619

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(17.8785385558598+${C21})
variable C12all equal 0.5*(17.8785385558598+42.407341420328)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(4.35495423680487+${C31})
variable C13all equal 0.5*(4.35495423680487+40.5291101652656)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(33.5281091520919+${C32})
variable C23all equal 0.5*(33.5281091520919+7.6007999513596)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-0.44034097395635+${C41})
variable C14all equal 0.5*(-0.44034097395635+4.04721199007339)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(12.3568445107936+${C51})
variable C15all equal 0.5*(12.3568445107936+-17.9259678795424)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(35.5681106211039+${C61})
variable C16all equal 0.5*(35.5681106211039+-7.45515257083576)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(14.5770566989298+${C42})
variable C24all equal 0.5*(14.5770566989298+0.92915393444957)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-12.8746842504879+${C52})
variable C25all equal 0.5*(-12.8746842504879+-9.15838502339625)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(10.7794811162762+${C62})
variable C26all equal 0.5*(10.7794811162762+-14.5389717277055)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(18.290799062187+${C43})
variable C34all equal 0.5*(18.290799062187+2.5821407345164)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-12.2649183405202+${C53})
variable C35all equal 0.5*(-12.2649183405202+-4.92779062789992)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(29.7149609134273+${C63})
variable C36all equal 0.5*(29.7149609134273+4.53638551375118)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(2.37380618260738+${C54})
variable C45all equal 0.5*(2.37380618260738+6.7267799107883)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-4.24683676322293+${C64})
variable C46all equal 0.5*(-4.24683676322293+-10.6560225991142)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(11.5339964663329+${C65})
variable C56all equal 0.5*(11.5339964663329+-6.2831761059171)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:20:08
