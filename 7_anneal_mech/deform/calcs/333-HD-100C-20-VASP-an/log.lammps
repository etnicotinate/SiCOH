LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-20-VASP-an
read_data       ${structure}.data
read_data       333-HD-100C-20-VASP-an.data
Reading data file ...
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
  reading velocities ...
  366 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.013 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              326.3987       4075.8264    
         1   300            0              0              326.3987       4075.8264    
Loop time of 6.14157e-05 on 8 procs for 1 steps with 366 atoms

56.6% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.05e-07   | 1.9575e-07 | 2.88e-07   |   0.0 |  0.32
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 6.5e-07    | 1.137e-06  | 1.644e-06  |   0.0 |  1.85
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.008e-05  |            |       | 97.83

Nlocal:          45.75 ave          55 max          38 min
Histogram: 1 2 0 0 1 2 0 0 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137 | 139.1 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -44421.616     -3829.1497      0              1.9519943      3660.7123    
       100   303.2988      -44414.806     -5106.354      -8646.2021      1.9519943      3660.7123    
       200   315.94888     -44405.139     -2306.3483     -2834.4445      1.9519943      3660.7123    
       300   296.63446     -44376.269     -5399.5211     -1880.3549      1.9519943      3660.7123    
       400   299.01035     -44417.584      3665.7381     -3829.2561      1.9519943      3660.7123    
       500   303.99433     -44444.27       2316.088       681.27106      1.9519943      3660.7123    
       600   284.9745      -44421.969     -2125.3134      85.928837      1.9519943      3660.7123    
       700   293.13679     -44417.454     -12060.061     -4257.1628      1.9519943      3660.7123    
       800   313.79714     -44428.633     -9597.4703     -8194.1453      1.9519943      3660.7123    
       900   316.62708     -44412.893     -375.55459     -4460.7598      1.9519943      3660.7123    
      1000   316.68345     -44409.501      2095.2743      3865.8602      1.9519943      3660.7123    
      1100   301.83837     -44430.099      2157.9661     -2778.4821      1.9519943      3660.7123    
      1200   302.3653      -44440.251     -507.9371      -6447.5029      1.9519943      3660.7123    
      1300   289.30522     -44417.784      1465.9281     -1521.8493      1.9519943      3660.7123    
      1400   305.52339     -44416.719     -1980.9824     -2067.0745      1.9519943      3660.7123    
      1500   322.13045     -44422.522     -404.4868      -2550.7405      1.9519943      3660.7123    
      1600   303.4143      -44422.426      231.94464     -1839.9904      1.9519943      3660.7123    
      1700   288.90323     -44432.635     -5685.9205     -5204.1356      1.9519943      3660.7123    
      1800   293.09861     -44438.347     -10519.762     -7839.9586      1.9519943      3660.7123    
      1900   302.66951     -44443.268     -317.07286     -4769.4813      1.9519943      3660.7123    
      2000   299.50471     -44440.091      5097.6084      275.56522      1.9519943      3660.7123    
Loop time of 103.806 on 8 procs for 2000 steps with 366 atoms

Performance: 0.832 ns/day, 28.835 hours/ns, 19.267 timesteps/s, 7.052 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.901     | 67.035     | 88.33      | 138.3 | 64.58
Bond    | 0.00050649 | 0.00065871 | 0.00075077 |   0.0 |  0.00
Neigh   | 4.8585     | 5.4663     | 7.061      |  37.1 |  5.27
Comm    | 0.63191    | 21.91      | 30.058     | 241.8 | 21.11
Output  | 0.0010106  | 0.0010914  | 0.0014544  |   0.4 |  0.00
Modify  | 7.7417     | 9.3578     | 9.9526     |  28.5 |  9.01
Other   |            | 0.03494    |            |       |  0.03

Nlocal:          45.75 ave          59 max          37 min
Histogram: 3 0 0 0 3 0 0 1 0 1
Nghost:        3579.88 ave        3655 max        3522 min
Histogram: 2 0 1 2 0 0 1 1 0 1
Neighs:          32015 ave       40667 max       26139 min
Histogram: 2 1 0 0 3 0 0 1 0 1

Total # of neighbors = 256120
Ave neighs/atom = 699.78142
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-20-VASP-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.923905603898
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4672714795699
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.0701126080387

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-275.565222856733)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-275.565222856733)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-8509.80202981556)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-8509.80202981556)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-5105.3069685499)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-5105.3069685499)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-2573.43810131014)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-2573.43810131014)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--4216.30819283366)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--4216.30819283366)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-887.408722783476)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-887.408722783476)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.923905603898
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.923905603898
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.15923905603898 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.15923905603898 xy delta 0.084375460746531 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.15923905603898 xy delta 0.084375460746531 xz delta -0.00830448823212902 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4916.4354     -4289.1026      3658.8819    
       200   324.00477     -44460.405      7124.4925     -2811.5579      3657.0516    
       300   291.37798     -44427.954      342.85856     -3686.5607      3655.2212    
       400   292.39552     -44443.979      4870.8045     -3.2082855      3653.3908    
       500   313.53557     -44469.308      17.233485     -279.94543      3651.5605    
       600   312.90405     -44458.057      2443.3188     -5975.3085      3649.7301    
       700   310.4253      -44429.138     -1812.6307     -4174.0276      3647.8998    
       800   321.47131     -44427.888     -5838.0106     -102.53972      3646.0694    
       900   306.97904     -44429.925      8634.6191     -92.1694        3644.2391    
      1000   308.45742     -44467.063     -483.04406      5496.2828      3642.4087    
      1100   284.82873     -44442.887      3238.2774      3417.5374      3640.5784    
      1200   303.01468     -44445.091      5403.6774      2641.9213      3638.748     
      1300   313.95234     -44434.631     -456.61787     -1809.4428      3636.9176    
      1400   303.82398     -44425.27       6206.043       2475.6839      3635.0873    
      1500   302.15392     -44434.623      11690.018      1871.657       3633.2569    
      1600   290.08847     -44427.532      11836.727     -486.9262       3631.4266    
      1700   300.75824     -44448.427      7020.6802      7831.2474      3629.5962    
      1800   302.70536     -44469.683      1905.7907      5067.7551      3627.7659    
      1900   262.56024     -44450.042      7343.4433      1988.1018      3625.9355    
      2000   292.1768      -44467.366      12708.344      4161.8781      3624.1052    
Loop time of 102.461 on 8 procs for 2000 steps with 366 atoms

Performance: 0.843 ns/day, 28.461 hours/ns, 19.520 timesteps/s, 7.144 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.57      | 66.266     | 86.479     | 142.5 | 64.67
Bond    | 0.00046324 | 0.00066157 | 0.00077411 |   0.0 |  0.00
Neigh   | 4.7583     | 5.3518     | 6.8565     |  37.2 |  5.22
Comm    | 1.2231     | 21.417     | 29.113     | 250.6 | 20.90
Output  | 0.0037764  | 0.0045211  | 0.0050434  |   0.6 |  0.00
Modify  | 7.8569     | 9.3844     | 9.9777     |  28.3 |  9.16
Other   |            | 0.03623    |            |       |  0.04

Nlocal:          45.75 ave          55 max          31 min
Histogram: 1 0 0 1 1 0 0 3 1 1
Nghost:        3521.62 ave        3541 max        3486 min
Histogram: 1 0 0 1 0 2 0 1 0 3
Neighs:        32326.2 ave       38263 max       22285 min
Histogram: 1 0 0 1 1 0 0 2 2 1

Total # of neighbors = 258610
Ave neighs/atom = 706.5847
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 39.3780649605308
variable C2neg equal ${d2}
variable C2neg equal -28.5592481920066
variable C3neg equal ${d3}
variable C3neg equal 69.8640133863016
variable C4neg equal ${d4}
variable C4neg equal -3.99762816603393
variable C5neg equal ${d5}
variable C5neg equal 13.3091705341563
variable C6neg equal ${d6}
variable C6neg equal -10.9787775393559

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.923905603898
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.15923905603898 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.15923905603898 xy delta -0.084375460746531 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.15923905603898 xy delta -0.084375460746531 xz delta 0.00830448823212902 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4911.5214     -4288.1127      3662.5426    
       200   323.08027     -44458.57       5711.3807     -3865.5087      3664.373     
       300   290.14051     -44424.994     -3394.7602     -6111.4554      3666.2033    
       400   297.02871     -44446.947      7309.3185     -2163.0676      3668.0337    
       500   294.44855     -44450.528      399.37108     -3924.1291      3669.8641    
       600   300.5006      -44447.695      3953.3614     -8224.4951      3671.6944    
       700   300.34617     -44425.549      298.64564     -9801.6665      3673.5248    
       800   313.38207     -44426.247      4099.2746     -6084.6339      3675.3551    
       900   305.49708     -44428.065     -891.33502     -8082.2071      3677.1855    
      1000   287.639       -44446.346      7207.966      -7728.0747      3679.0158    
      1100   286.30613     -44447.316     -5547.1981     -8873.038       3680.8462    
      1200   289.8411      -44432.241      6087.1286     -9443.935       3682.6765    
      1300   310.34253     -44430.471     -2570.9034     -9405.8543      3684.5069    
      1400   308.6355      -44426.376     -972.54275     -7068.0041      3686.3373    
      1500   302.58135     -44423.781     -9050.2463     -7935.3377      3688.1676    
      1600   299.05173     -44423.004     -19833.611     -16754.418      3689.998     
      1700   310.83954     -44447.862     -4655.262      -20464.28       3691.8283    
      1800   300.6297      -44451.031     -9045.5705     -12012.582      3693.6587    
      1900   285.85881     -44447.388     -23822.975     -16442.836      3695.489     
      2000   277.84313     -44445.054     -2233.3816     -13842.146      3697.3194    
Loop time of 100.959 on 8 procs for 2000 steps with 366 atoms

Performance: 0.856 ns/day, 28.044 hours/ns, 19.810 timesteps/s, 7.251 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.751     | 65.346     | 85.263     | 140.0 | 64.73
Bond    | 0.00048711 | 0.00064024 | 0.00073411 |   0.0 |  0.00
Neigh   | 4.7287     | 5.3147     | 6.8457     |  37.4 |  5.26
Comm    | 0.99627    | 20.9       | 28.499     | 247.5 | 20.70
Output  | 0.0038058  | 0.004564   | 0.0051031  |   0.7 |  0.00
Modify  | 7.8077     | 9.3561     | 9.9383     |  28.3 |  9.27
Other   |            | 0.03616    |            |       |  0.04

Nlocal:          45.75 ave          51 max          34 min
Histogram: 1 0 0 0 1 1 0 1 1 3
Nghost:        3480.88 ave        3522 max        3430 min
Histogram: 1 0 1 0 0 2 2 1 0 1
Neighs:        31709.9 ave       34792 max       23909 min
Histogram: 1 0 0 0 0 1 1 1 0 4

Total # of neighbors = 253679
Ave neighs/atom = 693.11202
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 143.047712803374
variable C2pos equal ${d2}
variable C2pos equal 99.0592150506152
variable C3pos equal ${d3}
variable C3pos equal 50.4054710470935
variable C4pos equal ${d4}
variable C4pos equal 11.2923594513296
variable C5pos equal ${d5}
variable C5pos equal 1.14257704607392
variable C6pos equal ${d6}
variable C6pos equal 24.2138767205355

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(39.3780649605308+${C1pos})
variable C11 equal 0.5*(39.3780649605308+143.047712803374)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-28.5592481920066+${C2pos})
variable C21 equal 0.5*(-28.5592481920066+99.0592150506152)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(69.8640133863016+${C3pos})
variable C31 equal 0.5*(69.8640133863016+50.4054710470935)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-3.99762816603393+${C4pos})
variable C41 equal 0.5*(-3.99762816603393+11.2923594513296)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(13.3091705341563+${C5pos})
variable C51 equal 0.5*(13.3091705341563+1.14257704607392)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-10.9787775393559+${C6pos})
variable C61 equal 0.5*(-10.9787775393559+24.2138767205355)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4672714795699
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4672714795699
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.134672714795699 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.134672714795699 yz delta 0.00317964958553157 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4916.4354     -4289.1026      3658.8819    
       200   322.82798     -44458.865      7174.758      -3095.4397      3657.0516    
       300   292.38037     -44428.935     -2239.4238     -4802.7883      3655.2212    
       400   299.83222     -44452.284      3723.6338     -717.9585       3653.3908    
       500   305.32833     -44459.498     -1472.8524     -1081.3903      3651.5605    
       600   299.00501     -44434.93       1391.6171     -8273.9763      3649.7301    
       700   331.12441     -44448.221      1880.8826     -5831.2196      3647.8998    
       800   310.45489     -44427.509      4725.3559     -4239.3217      3646.0694    
       900   304.92198     -44460.952      6213.8638     -3438.7632      3644.2391    
      1000   272.05482     -44443.902      10156.242      241.13532      3642.4087    
      1100   287.52826     -44448.323      11321.605      1174.8176      3640.5784    
      1200   316.44648     -44456.007      1207.6953     -923.68572      3638.748     
      1300   317.0616      -44449.57       13325.117      1581.3736      3636.9176    
      1400   298.31233     -44439.833      16867.246      432.93402      3635.0873    
      1500   293.66535     -44463.706      3513.9291      2574.44        3633.2569    
      1600   292.84148     -44489.983      3801.5249     -2737.3148      3631.4266    
      1700   287.18644     -44461.793      14407.634      3969.5431      3629.5962    
      1800   318.68557     -44469.86       7439.6048     -2061.6624      3627.7659    
      1900   306.10757     -44448.938      8827.79       -2330.7131      3625.9355    
      2000   302.61207     -44444.925      12253.04       2941.5504      3624.1052    
Loop time of 103.453 on 8 procs for 2000 steps with 366 atoms

Performance: 0.835 ns/day, 28.737 hours/ns, 19.332 timesteps/s, 7.076 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.038     | 69.274     | 87.742     | 146.6 | 66.96
Bond    | 0.00062127 | 0.000665   | 0.0008011  |   0.0 |  0.00
Neigh   | 4.7617     | 5.5286     | 6.8386     |  37.1 |  5.34
Comm    | 0.92013    | 19.374     | 29.596     | 277.2 | 18.73
Output  | 0.0039487  | 0.0047099  | 0.005185   |   0.6 |  0.00
Modify  | 7.9049     | 9.233      | 9.9925     |  28.8 |  8.92
Other   |            | 0.03821    |            |       |  0.04

Nlocal:          45.75 ave          51 max          33 min
Histogram: 1 0 0 1 0 1 0 0 2 3
Nghost:        3554.62 ave        3586 max        3501 min
Histogram: 1 0 0 0 2 0 1 1 1 2
Neighs:          32325 ave       35824 max       23667 min
Histogram: 1 0 0 0 1 1 0 0 1 4

Total # of neighbors = 258600
Ave neighs/atom = 706.55738
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 27.0130947737986
variable C2neg equal ${d2}
variable C2neg equal 18.7688119317897
variable C3neg equal ${d3}
variable C3neg equal 81.374723680111
variable C4neg equal ${d4}
variable C4neg equal -11.4040011184905
variable C5neg equal ${d5}
variable C5neg equal 9.1393817837673
variable C6neg equal ${d6}
variable C6neg equal -13.2484051519362

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4672714795699
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.134672714795699 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.134672714795699 yz delta -0.00317964958553157 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4911.5214     -4288.1127      3662.5426    
       200   324.02284     -44459.916      5588.437      -3505.3199      3664.373     
       300   293.61981     -44429.414     -2026.3109     -5371.6908      3666.2033    
       400   299.21812     -44451.245      6045.098      -1510.8103      3668.0337    
       500   300.20254     -44459.933     -2554.9504     -1008.772       3669.8641    
       600   300.49677     -44446.307     -2972.0938     -11189.568      3671.6944    
       700   307.68698     -44426.753     -3946.3772     -10063.084      3673.5248    
       800   318.46379     -44431.864     -6062.9158     -6296.9863      3675.3551    
       900   308.35878     -44454.976      7388.7248     -5057.9277      3677.1855    
      1000   290.57539     -44457.617     -2151.5064     -7323.5023      3679.0158    
      1100   297.41916     -44459.551      5664.4209     -3152.087       3680.8462    
      1200   308.77493     -44450.18      -7028.3424     -9825.5683      3682.6765    
      1300   293.76427     -44417.211      9062.2101     -4800.9043      3684.5069    
      1400   331.38374     -44461.558      8240.8138     -7061.2622      3686.3373    
      1500   293.89826     -44439.96      -5690.5217     -9649.7111      3688.1676    
      1600   294.10141     -44445.279      7377.2434     -7083.619       3689.998     
      1700   307.07215     -44451.932     -5787.4954     -8244.127       3691.8283    
      1800   306.34764     -44435.867      6260.5826     -4485.1592      3693.6587    
      1900   337.66021     -44463.497     -10409.09      -11231.792      3695.489     
      2000   290.44378     -44453.371      4666.2585     -1413.9575      3697.3194    
Loop time of 102.282 on 8 procs for 2000 steps with 366 atoms

Performance: 0.845 ns/day, 28.412 hours/ns, 19.554 timesteps/s, 7.157 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.033     | 68.998     | 86.72      | 154.9 | 67.46
Bond    | 0.00056959 | 0.00065296 | 0.00076746 |   0.0 |  0.00
Neigh   | 4.7632     | 5.5658     | 6.768      |  38.2 |  5.44
Comm    | 0.8229     | 18.535     | 29.489     | 298.8 | 18.12
Output  | 0.0039153  | 0.0046912  | 0.0051752  |   0.7 |  0.00
Modify  | 7.9236     | 9.1396     | 9.9365     |  30.0 |  8.94
Other   |            | 0.03829    |            |       |  0.04

Nlocal:          45.75 ave          50 max          39 min
Histogram: 1 1 0 0 2 0 0 0 0 4
Nghost:        3474.12 ave        3502 max        3445 min
Histogram: 2 0 0 1 0 1 2 1 0 1
Neighs:        31714.1 ave       34368 max       27249 min
Histogram: 1 0 1 0 2 0 0 0 0 4

Total # of neighbors = 253713
Ave neighs/atom = 693.20492
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 17.1190894888643
variable C2pos equal ${d2}
variable C2pos equal 51.1030241897352
variable C3pos equal ${d3}
variable C3pos equal -24.6381127255757
variable C4pos equal ${d4}
variable C4pos equal -2.29944788120733
variable C5pos equal ${d5}
variable C5pos equal -14.4981378686274
variable C6pos equal ${d6}
variable C6pos equal -6.73978553345144

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(27.0130947737986+${C1pos})
variable C12 equal 0.5*(27.0130947737986+17.1190894888643)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(18.7688119317897+${C2pos})
variable C22 equal 0.5*(18.7688119317897+51.1030241897352)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(81.374723680111+${C3pos})
variable C32 equal 0.5*(81.374723680111+-24.6381127255757)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-11.4040011184905+${C4pos})
variable C42 equal 0.5*(-11.4040011184905+-2.29944788120733)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(9.1393817837673+${C5pos})
variable C52 equal 0.5*(9.1393817837673+-14.4981378686274)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-13.2484051519362+${C6pos})
variable C62 equal 0.5*(-13.2484051519362+-6.73978553345144)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0701126080387
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0701126080387
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.170701126080387 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4916.4354     -4289.1026      3658.8819    
       200   323.41403     -44459.491      7023.0789     -3033.4211      3657.0516    
       300   293.27572     -44429.59      -1399.9825     -4186.6088      3655.2212    
       400   298.20565     -44449.271      6475.1047     -770.82519      3653.3908    
       500   304.73389     -44455.557      34.780911      150.43158      3651.5605    
       600   297.74689     -44430.682     -4566.6623     -2684.7291      3649.7301    
       700   305.9281      -44416.163     -3542.9147     -7106.1519      3647.8998    
       800   318.13988     -44416.623      9760.2897     -403.9827       3646.0694    
       900   318.07426     -44439.715      11519.585     -2215.1549      3644.2391    
      1000   298.67134     -44453.151      6117.5816      858.62197      3642.4087    
      1100   287.23788     -44442.276      15157.077      2431.5914      3640.5784    
      1200   301.42555     -44438.48       12873.527     -35.220987      3638.748     
      1300   305.80617     -44427.822      5738.6711     -4145.1058      3636.9176    
      1400   306.14591     -44420.282      8136.8076     -861.50962      3635.0873    
      1500   302.81585     -44439.904     -1570.4494     -239.68889      3633.2569    
      1600   306.70986     -44474.057     -264.37465      853.89798      3631.4266    
      1700   284.23882     -44455.685     -7155.4441      1359.7466      3629.5962    
      1800   309.8828      -44459.129      9558.8209     -301.20306      3627.7659    
      1900   296.54642     -44436.159     -1578.8593      1152.9369      3625.9355    
      2000   304.28551     -44446.196      9430.1155     -1840.1017      3624.1052    
Loop time of 106.606 on 8 procs for 2000 steps with 366 atoms

Performance: 0.810 ns/day, 29.613 hours/ns, 18.761 timesteps/s, 6.866 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.817     | 71.38      | 90.74      | 152.9 | 66.96
Bond    | 0.00055707 | 0.00070872 | 0.00084483 |   0.0 |  0.00
Neigh   | 4.9234     | 5.7837     | 7.1879     |  40.5 |  5.43
Comm    | 0.60547    | 19.957     | 31.546     | 289.1 | 18.72
Output  | 0.0038526  | 0.0045984  | 0.0051342  |   0.7 |  0.00
Modify  | 8.0263     | 9.4435     | 10.28      |  32.0 |  8.86
Other   |            | 0.03684    |            |       |  0.03

Nlocal:          45.75 ave          56 max          39 min
Histogram: 2 2 0 0 2 0 0 0 1 1
Nghost:        3615.25 ave        3688 max        3553 min
Histogram: 2 0 1 1 0 1 1 1 0 1
Neighs:        32317.2 ave       38994 max       27737 min
Histogram: 2 2 0 0 2 0 0 0 0 2

Total # of neighbors = 258538
Ave neighs/atom = 706.38798
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -21.4369954470315
variable C2neg equal ${d2}
variable C2neg equal 1.09964354543085
variable C3neg equal ${d3}
variable C3neg equal 89.090292131719
variable C4neg equal ${d4}
variable C4neg equal -5.96747176070851
variable C5neg equal ${d5}
variable C5neg equal 10.9354138431294
variable C6neg equal ${d6}
variable C6neg equal -15.7033854053061

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0701126080387
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.170701126080387 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4911.5214     -4288.1127      3662.5426    
       200   323.28495     -44459.117      5454.6995     -3561.9277      3664.373     
       300   295.3305      -44431.448     -3265.886      -5613.2185      3666.2033    
       400   296.45264     -44448.806      7693.8395     -1965.0114      3668.0337    
       500   286.48241     -44442.248     -6072.772      -1932.6331      3669.8641    
       600   298.32805     -44433.952      6879.9842     -6464.0203      3671.6944    
       700   309.9399      -44422.573     -7555.6374     -8023.6423      3673.5248    
       800   319.833       -44436.538      3102.3416     -6768.3606      3675.3551    
       900   296.9999      -44449.132      1817.6039     -8870.8135      3677.1855    
      1000   295.25726     -44460.198      4795.6621     -2869.3638      3679.0158    
      1100   290.3693      -44447.184     -543.80154     -5847.3735      3680.8462    
      1200   304.55827     -44443.64      -4831.5818     -8871.336       3682.6765    
      1300   286.61317     -44422.206     -4981.5018     -9912.1254      3684.5069    
      1400   295.69152     -44434.276     -3840.1085     -7462.4818      3686.3373    
      1500   302.29324     -44453.321     -8000.1324     -9648.1887      3688.1676    
      1600   316.41597     -44479.684     -4403.6701     -8206.3958      3689.998     
      1700   288.22837     -44449.703     -5391.888      -7783.8244      3691.8283    
      1800   301.18974     -44440.371     -12431.569     -8977.1872      3693.6587    
      1900   308.2264      -44428.937     -8405.82       -9176.7274      3695.489     
      2000   313.47745     -44432.475     -4488.7566     -13616.531      3697.3194    
Loop time of 105.097 on 8 procs for 2000 steps with 366 atoms

Performance: 0.822 ns/day, 29.194 hours/ns, 19.030 timesteps/s, 6.965 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.61      | 69.981     | 89.202     | 152.7 | 66.59
Bond    | 0.00054988 | 0.0006664  | 0.00077286 |   0.0 |  0.00
Neigh   | 4.8456     | 5.7027     | 7.1037     |  40.3 |  5.43
Comm    | 0.60078    | 19.811     | 31.207     | 286.8 | 18.85
Output  | 0.0038401  | 0.0045775  | 0.0051064  |   0.7 |  0.00
Modify  | 8.1443     | 9.561      | 10.395     |  31.4 |  9.10
Other   |            | 0.03634    |            |       |  0.03

Nlocal:          45.75 ave          56 max          38 min
Histogram: 2 0 2 0 0 1 1 1 0 1
Nghost:        3564.25 ave        3652 max        3491 min
Histogram: 1 0 2 1 1 1 0 1 0 1
Neighs:        31706.8 ave       38306 max       26549 min
Histogram: 2 0 2 0 1 0 1 1 0 1

Total # of neighbors = 253654
Ave neighs/atom = 693.04372
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 140.761668997428
variable C2pos equal ${d2}
variable C2pos equal 127.221560303382
variable C3pos equal ${d3}
variable C3pos equal 121.61756531563
variable C4pos equal ${d4}
variable C4pos equal 3.95683609770079
variable C5pos equal ${d5}
variable C5pos equal 6.83799569834506
variable C6pos equal ${d6}
variable C6pos equal 7.99963633630662

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-21.4369954470315+${C1pos})
variable C13 equal 0.5*(-21.4369954470315+140.761668997428)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(1.09964354543085+${C2pos})
variable C23 equal 0.5*(1.09964354543085+127.221560303382)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(89.090292131719+${C3pos})
variable C33 equal 0.5*(89.090292131719+121.61756531563)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-5.96747176070851+${C4pos})
variable C43 equal 0.5*(-5.96747176070851+3.95683609770079)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(10.9354138431294+${C5pos})
variable C53 equal 0.5*(10.9354138431294+6.83799569834506)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-15.7033854053061+${C6pos})
variable C63 equal 0.5*(-15.7033854053061+7.99963633630662)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0701126080387
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0701126080387
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.170701126080387 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4913.9771     -4288.6074      3660.7123    
       200   322.71936     -44458.436      6362.4163     -3301.4494      3660.7123    
       300   294.11588     -44430.41       38.488934     -5216.0407      3660.7123    
       400   291.38601     -44441.853      9848.1657     -2259.5793      3660.7123    
       500   303.95853     -44460.149     -4258.6234     -905.11935      3660.7123    
       600   294.24773     -44439.203      11066.204     -6751.3478      3660.7123    
       700   318.80762     -44441.152     -2657.9142     -8811.8063      3660.7123    
       800   313.88935     -44424.368     -1229.808      -4533.4656      3660.7123    
       900   319.31533     -44444.928      1570.1756     -6060.8779      3660.7123    
      1000   287.02546     -44447.509     -6755.9628     -4002.4635      3660.7123    
      1100   288.71208     -44449.496      4177.1299      2134.2157      3660.7123    
      1200   293.48803     -44435.032      7852.4858     -4833.8112      3660.7123    
      1300   314.05012     -44438.896      12103.975     -7347.6655      3660.7123    
      1400   321.25407     -44455.522     -11144.82      -9557.5361      3660.7123    
      1500   287.36643     -44459.042     -1706.4987     -7931.8998      3660.7123    
      1600   315.6977      -44486.985      404.61486     -6646.4548      3660.7123    
      1700   292.56318     -44451.953     -1712.9123     -2866.5805      3660.7123    
      1800   305.37629     -44438.588      9289.1649     -9789.3992      3660.7123    
      1900   295.74255     -44428.166     -554.21255     -7361.1015      3660.7123    
      2000   299.26909     -44448.435      6310.229      -5792.2023      3660.7123    
Loop time of 101.602 on 8 procs for 2000 steps with 366 atoms

Performance: 0.850 ns/day, 28.223 hours/ns, 19.685 timesteps/s, 7.205 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.082     | 66.345     | 85.232     | 125.9 | 65.30
Bond    | 0.00054617 | 0.00063772 | 0.00072957 |   0.0 |  0.00
Neigh   | 4.7528     | 5.3595     | 6.7462     |  32.9 |  5.27
Comm    | 1.7425     | 20.639     | 28.888     | 225.7 | 20.31
Output  | 0.0039972  | 0.0047199  | 0.0052314  |   0.6 |  0.00
Modify  | 7.8356     | 9.2155     | 9.8185     |  25.2 |  9.07
Other   |            | 0.0372     |            |       |  0.04

Nlocal:          45.75 ave          51 max          35 min
Histogram: 1 0 0 1 0 1 0 0 3 2
Nghost:        3506.25 ave        3551 max        3456 min
Histogram: 1 0 1 0 1 2 1 0 1 1
Neighs:        32007.5 ave       35424 max       24826 min
Histogram: 1 0 0 1 0 1 0 0 3 2

Total # of neighbors = 256060
Ave neighs/atom = 699.61749
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -61.4816544293169
variable C2neg equal ${d2}
variable C2neg equal -116.501591890897
variable C3neg equal ${d3}
variable C3neg equal -19.2046190152867
variable C4neg equal ${d4}
variable C4neg equal 1.98974733880254
variable C5neg equal ${d5}
variable C5neg equal 0.496715760129057
variable C6neg equal ${d6}
variable C6neg equal 0.570800951428496

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0701126080387
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.170701126080387 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4913.9771     -4288.6074      3660.7123    
       200   324.12281     -44460.303      6018.9383     -3292.7007      3660.7123    
       300   291.39504     -44427.812      17.117526     -4643.1799      3660.7123    
       400   292.23595     -44444.567      9006.0936     -1165.8621      3660.7123    
       500   299.3918      -44454.926     -6543.9896     -357.11884      3660.7123    
       600   300.99945     -44434.217      1374.08       -6589.9012      3660.7123    
       700   300.62033     -44410.202     -6312.14       -7792.696       3660.7123    
       800   326.08853     -44435.117     -1001.4425     -3829.1636      3660.7123    
       900   304.20921     -44447.248     -383.43385     -9563.6584      3660.7123    
      1000   279.51764     -44440.817     -7988.6841     -6355.1546      3660.7123    
      1100   300.69059     -44456.891      7137.2447     -1338.1625      3660.7123    
      1200   303.51148     -44439.518     -4823.8749     -4650.346       3660.7123    
      1300   307.75172     -44428.295     -7001.3208     -6827.7101      3660.7123    
      1400   292.41277     -44434.833     -1738.6518     -4480.9548      3660.7123    
      1500   298.88152     -44474.754     -6917.8991     -7769.7448      3660.7123    
      1600   291.80833     -44466.278     -4739.0985     -6082.056       3660.7123    
      1700   291.14745     -44444.438     -6974.1102     -2917.0701      3660.7123    
      1800   301.91161     -44436.477     -4233.5516     -5951.9646      3660.7123    
      1900   310.10627     -44448.078     -143.45817     -2002.7213      3660.7123    
      2000   298.2431      -44446.376      3607.0426     -5436.4148      3660.7123    
Loop time of 100.085 on 8 procs for 2000 steps with 366 atoms

Performance: 0.863 ns/day, 27.801 hours/ns, 19.983 timesteps/s, 7.314 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.641     | 62.701     | 85.005     | 107.0 | 62.65
Bond    | 0.00047666 | 0.00061368 | 0.00073324 |   0.0 |  0.00
Neigh   | 4.7982     | 5.1201     | 6.7176     |  27.0 |  5.12
Comm    | 0.55999    | 22.888     | 27.928     | 177.3 | 22.87
Output  | 0.0038221  | 0.0046738  | 0.0052264  |   0.7 |  0.00
Modify  | 7.7549     | 9.3341     | 9.6657     |  19.8 |  9.33
Other   |            | 0.03689    |            |       |  0.04

Nlocal:          45.75 ave          52 max          36 min
Histogram: 1 0 0 2 0 1 0 0 3 1
Nghost:        3492.88 ave        3513 max        3468 min
Histogram: 1 1 0 0 0 1 2 1 1 1
Neighs:          32016 ave       35894 max       25479 min
Histogram: 1 0 0 1 1 1 0 0 2 2

Total # of neighbors = 256128
Ave neighs/atom = 699.80328
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 57.8766375634936
variable C2pos equal ${d2}
variable C2pos equal 61.0531968937205
variable C3pos equal ${d3}
variable C3pos equal 17.3925844320099
variable C4pos equal ${d4}
variable C4pos equal 43.3973622553097
variable C5pos equal ${d5}
variable C5pos equal -4.25191066227182
variable C6pos equal ${d6}
variable C6pos equal 16.9398723032809

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-61.4816544293169+${C1pos})
variable C14 equal 0.5*(-61.4816544293169+57.8766375634936)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-116.501591890897+${C2pos})
variable C24 equal 0.5*(-116.501591890897+61.0531968937205)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-19.2046190152867+${C3pos})
variable C34 equal 0.5*(-19.2046190152867+17.3925844320099)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(1.98974733880254+${C4pos})
variable C44 equal 0.5*(1.98974733880254+43.3973622553097)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(0.496715760129057+${C5pos})
variable C54 equal 0.5*(0.496715760129057+-4.25191066227182)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(0.570800951428496+${C6pos})
variable C64 equal 0.5*(0.570800951428496+16.9398723032809)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0701126080387
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0701126080387
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.170701126080387 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4913.9771     -4288.6074      3660.7123    
       200   323.33713     -44459.254      6226.8796     -3324.3934      3660.7123    
       300   294.21548     -44430.804     -2322.3807     -5224.7183      3660.7123    
       400   294.66854     -44447.116      8483.7973     -962.07905      3660.7123    
       500   301.02767     -44459.061      1590.5969     -346.38646      3660.7123    
       600   304.37367     -44457.195      7104.9114     -5003.4081      3660.7123    
       700   308.70882     -44441.385     -11083.583     -10987.051      3660.7123    
       800   310.93929     -44421.929      12631.905     -6009.7031      3660.7123    
       900   302.44919     -44420.3        10356.251     -5771.6786      3660.7123    
      1000   297.5923      -44452.751      11039.49      -1550.0801      3660.7123    
      1100   275.4827      -44435.779     -671.86975     -1233.8228      3660.7123    
      1200   298.11526     -44447.482     -9042.9223     -3956.5357      3660.7123    
      1300   309.96906     -44445.06      -7825.6945     -5834.5219      3660.7123    
      1400   313.89543     -44435.452      181.75029     -5198.3984      3660.7123    
      1500   312.49565     -44421.886     -2133.1503     -4084.0556      3660.7123    
      1600   316.32244     -44420.555      2845.9218     -8137.8772      3660.7123    
      1700   301.19212     -44429.611     -3423.5386     -2163.5301      3660.7123    
      1800   283.6018      -44438.837     -9147.1457     -7932.0609      3660.7123    
      1900   290.14704     -44452.082     -319.79182     -8525.1094      3660.7123    
      2000   297.57423     -44445.251      93.20753      -729.10255      3660.7123    
Loop time of 99.661 on 8 procs for 2000 steps with 366 atoms

Performance: 0.867 ns/day, 27.684 hours/ns, 20.068 timesteps/s, 7.345 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.741     | 62.629     | 84.682     | 105.9 | 62.84
Bond    | 0.0004765  | 0.00062089 | 0.00080127 |   0.0 |  0.00
Neigh   | 4.7459     | 5.0637     | 6.7039     |  27.6 |  5.08
Comm    | 0.56313    | 22.638     | 27.506     | 176.3 | 22.71
Output  | 0.0037709  | 0.0046303  | 0.0052544  |   0.8 |  0.00
Modify  | 7.6645     | 9.2881     | 9.606      |  20.2 |  9.32
Other   |            | 0.03708    |            |       |  0.04

Nlocal:          45.75 ave          52 max          35 min
Histogram: 1 0 0 0 2 1 0 1 0 3
Nghost:         3505.5 ave        3532 max        3471 min
Histogram: 2 0 0 0 0 0 3 2 0 1
Neighs:        32031.8 ave       36105 max       24840 min
Histogram: 1 0 0 0 2 1 0 1 0 3

Total # of neighbors = 256254
Ave neighs/atom = 700.14754
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -10.1797962521905
variable C2neg equal ${d2}
variable C2neg equal -17.5181247700377
variable C3neg equal ${d3}
variable C3neg equal 53.9927335349003
variable C4neg equal ${d4}
variable C4neg equal -27.9738004737306
variable C5neg equal ${d5}
variable C5neg equal 29.2066067773425
variable C6neg equal ${d6}
variable C6neg equal -11.3401997953865

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0701126080387
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.170701126080387 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4913.9771     -4288.6074      3660.7123    
       200   323.3984      -44459.025      6273.8193     -3187.086       3660.7123    
       300   289.43308     -44425.222     -3395.826      -5169.2017      3660.7123    
       400   291.95958     -44443.781      4545.9538     -2036.6602      3660.7123    
       500   309.75183     -44466.948      2410.1524     -1437.5668      3660.7123    
       600   307.86676     -44449.856     -1466.4179     -5200.1657      3660.7123    
       700   301.77515     -44418.169     -5302.0801     -7806.3677      3660.7123    
       800   329.68103     -44435.835      5061.9114     -2901.1718      3660.7123    
       900   311.81293     -44434.674     -1566.8388     -5817.535       3660.7123    
      1000   291.60414     -44450.012      3312.2724     -1542.6918      3660.7123    
      1100   288.44028     -44448.725     -1578.4426     -4238.5314      3660.7123    
      1200   304.57359     -44444.519     -4684.3289     -7176.581       3660.7123    
      1300   299.3066      -44418.259      4656.9777     -1653.792       3660.7123    
      1400   328.69739     -44457.239      10257.534     -1542.4734      3660.7123    
      1500   293.79432     -44435.272      4682.7134     -3946.0516      3660.7123    
      1600   307.00251     -44453.696     -2334.5056     -7757.2435      3660.7123    
      1700   289.26871     -44443.619      6115.9914     -848.0774       3660.7123    
      1800   290.5447      -44454.979     -5063.2878     -3519.7226      3660.7123    
      1900   285.75706     -44454.068      2099.3325     -9465.0493      3660.7123    
      2000   302.14098     -44441.852     -4327.3026     -5416.1059      3660.7123    
Loop time of 96.8424 on 8 procs for 2000 steps with 366 atoms

Performance: 0.892 ns/day, 26.901 hours/ns, 20.652 timesteps/s, 7.559 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.766     | 62.251     | 82.173     |  96.0 | 64.28
Bond    | 0.00050665 | 0.00062728 | 0.00069386 |   0.0 |  0.00
Neigh   | 4.7804     | 5.0635     | 6.5571     |  25.1 |  5.23
Comm    | 0.61907    | 20.562     | 25.03      | 167.2 | 21.23
Output  | 0.0036482  | 0.0044721  | 0.0050731  |   0.8 |  0.00
Modify  | 7.4453     | 8.923      | 9.2061     |  18.7 |  9.21
Other   |            | 0.03781    |            |       |  0.04

Nlocal:          45.75 ave          52 max          33 min
Histogram: 1 0 0 0 0 2 1 0 2 2
Nghost:        3494.12 ave        3519 max        3457 min
Histogram: 1 1 0 0 0 1 0 4 0 1
Neighs:        31999.9 ave       35841 max       23444 min
Histogram: 1 0 0 0 0 2 1 0 2 2

Total # of neighbors = 255999
Ave neighs/atom = 699.45082
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 57.6708572896779
variable C2pos equal ${d2}
variable C2pos equal 51.7522087484248
variable C3pos equal ${d3}
variable C3pos equal 18.4131315152699
variable C4pos equal ${d4}
variable C4pos equal 4.04187602664199
variable C5pos equal ${d5}
variable C5pos equal 21.5422331664133
variable C6pos equal ${d6}
variable C6pos equal 7.32057209140478

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-10.1797962521905+${C1pos})
variable C15 equal 0.5*(-10.1797962521905+57.6708572896779)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-17.5181247700377+${C2pos})
variable C25 equal 0.5*(-17.5181247700377+51.7522087484248)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(53.9927335349003+${C3pos})
variable C35 equal 0.5*(53.9927335349003+18.4131315152699)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-27.9738004737306+${C4pos})
variable C45 equal 0.5*(-27.9738004737306+4.04187602664199)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(29.2066067773425+${C5pos})
variable C55 equal 0.5*(29.2066067773425+21.5422331664133)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-11.3401997953865+${C6pos})
variable C65 equal 0.5*(-11.3401997953865+7.32057209140478)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4672714795699

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4672714795699
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.134672714795699 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4913.9771     -4288.6074      3660.7123    
       200   323.06565     -44458.976      6108.8526     -3217.3192      3660.7123    
       300   289.35371     -44424.998     -256.05205     -5298.411       3660.7123    
       400   293.42602     -44445.678      10794.536     -1497.1377      3660.7123    
       500   299.87669     -44456.201      1755.4714     -295.69265      3660.7123    
       600   303.7913      -44445.177      3093.1089     -7437.3513      3660.7123    
       700   304.93812     -44419.989     -6472.1101     -8342.5319      3660.7123    
       800   317.81712     -44425.877      1406.5808     -2559.5518      3660.7123    
       900   312.13819     -44443.082      13051.126     -5463.3163      3660.7123    
      1000   303.49734     -44468.85       4275.5278      171.25676      3660.7123    
      1100   276.88112     -44440.032      1113.5185      1527.7362      3660.7123    
      1200   296.50391     -44436.453      2123.2433     -3330.4672      3660.7123    
      1300   309.97476     -44437.557      13409.8       -8006.2507      3660.7123    
      1400   322.34014     -44458.737      4012.7124      3172.1438      3660.7123    
      1500   297.04546     -44454.818     -2795.5097     -6876.3254      3660.7123    
      1600   293.58336     -44450.852     -829.62881     -7869.4321      3660.7123    
      1700   290.90504     -44437.807      6580.0846     -817.10844      3660.7123    
      1800   299.34913     -44430.215     -4513.8477     -3098.003       3660.7123    
      1900   319.81386     -44446.574     -2806.1942     -6743.7107      3660.7123    
      2000   289.26867     -44434.527     -7594.303      -6111.4679      3660.7123    
Loop time of 68.4701 on 8 procs for 2000 steps with 366 atoms

Performance: 1.262 ns/day, 19.019 hours/ns, 29.210 timesteps/s, 10.691 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.448     | 55.806     | 56.851     |  10.4 | 81.50
Bond    | 0.00047362 | 0.00058774 | 0.00068977 |   0.0 |  0.00
Neigh   | 4.7469     | 4.8395     | 4.9016     |   2.1 |  7.07
Comm    | 0.6513     | 1.7008     | 3.0627     |  59.4 |  2.48
Output  | 0.0033221  | 0.0040942  | 0.0045969  |   0.7 |  0.01
Modify  | 6.0207     | 6.0799     | 6.1707     |   1.9 |  8.88
Other   |            | 0.03921    |            |       |  0.06

Nlocal:          45.75 ave          52 max          36 min
Histogram: 1 1 0 1 0 0 0 1 3 1
Nghost:         3493.5 ave        3514 max        3460 min
Histogram: 1 0 0 1 1 0 1 1 1 2
Neighs:        32029.4 ave       36017 max       25480 min
Histogram: 1 1 0 0 1 0 0 1 2 2

Total # of neighbors = 256235
Ave neighs/atom = 700.09563
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -64.7166135178813
variable C2neg equal ${d2}
variable C2neg equal -64.4172931625471
variable C3neg equal ${d3}
variable C3neg equal -4.68115126120205
variable C4neg equal ${d4}
variable C4neg equal -34.2959036637584
variable C5neg equal ${d5}
variable C5neg equal 12.0288414827257
variable C6neg equal ${d6}
variable C6neg equal -3.27225636664807

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0.1004972 -0.02243574 -0.080556304) to (16.024403 13.444836 16.989556) with tilt (-8.4375461 0.83044882 -0.31796496)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4672714795699
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.134672714795699 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.3 | 141.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.50471     -44440.091      5097.5048      0              3660.7123    
       100   292.40174     -44431.737     -4913.9771     -4288.6074      3660.7123    
       200   323.82152     -44459.825      6349.6296     -3332.8476      3660.7123    
       300   293.62029     -44429.911     -1522.0559     -4955.6104      3660.7123    
       400   290.52798     -44442.18       3769.9367     -2120.5432      3660.7123    
       500   310.02612     -44469.859     -6186.6347     -3201.171       3660.7123    
       600   300.72063     -44458.016      3658.6682     -7270.2387      3660.7123    
       700   296.18832     -44430.843     -7437.312      -6373.9541      3660.7123    
       800   324.90732     -44435.572     -3442.9463     -5025.046       3660.7123    
       900   300.83738     -44421.54      -1630.2381     -7550.1836      3660.7123    
      1000   295.47356     -44441.863     -5875.8146     -2403.496       3660.7123    
      1100   296.24717     -44447.856      4174.4958     -725.69772      3660.7123    
      1200   298.73482     -44449.548      11207.055     -5530.5079      3660.7123    
      1300   305.49607     -44458.347     -5819.5866     -6715.7723      3660.7123    
      1400   295.51716     -44456.94      -8627.75       -4644.0904      3660.7123    
      1500   285.90695     -44460.298     -10601.962     -9244.4413      3660.7123    
      1600   298.37568     -44456.36      -9416.1542     -5335.4318      3660.7123    
      1700   305.80569     -44440.416      2547.2015     -4304.8843      3660.7123    
      1800   323.9203      -44456.105     -9946.2954     -4656.228       3660.7123    
      1900   292.27434     -44453.63       7622.9187     -9027.1865      3660.7123    
      2000   289.34826     -44451.939     -4240.6158     -6126.1898      3660.7123    
Loop time of 61.4075 on 8 procs for 2000 steps with 366 atoms

Performance: 1.407 ns/day, 17.058 hours/ns, 32.569 timesteps/s, 11.920 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.427     | 48.929     | 50.056     |  11.9 | 79.68
Bond    | 0.00038094 | 0.00046895 | 0.00051505 |   0.0 |  0.00
Neigh   | 4.6894     | 4.778      | 4.8445     |   2.2 |  7.78
Comm    | 0.57945    | 1.7081     | 3.207      |  63.8 |  2.78
Output  | 0.0029691  | 0.0037919  | 0.0043402  |   0.8 |  0.01
Modify  | 5.8865     | 5.952      | 6.0405     |   2.0 |  9.69
Other   |            | 0.03608    |            |       |  0.06

Nlocal:          45.75 ave          52 max          36 min
Histogram: 1 0 0 1 0 2 1 0 1 2
Nghost:        3514.12 ave        3541 max        3467 min
Histogram: 1 0 0 0 1 2 0 1 2 1
Neighs:        31998.9 ave       36041 max       25452 min
Histogram: 1 0 0 0 1 2 1 0 1 2

Total # of neighbors = 255991
Ave neighs/atom = 699.42896
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 64.8657828677886
variable C2pos equal ${d2}
variable C2pos equal 75.8558395492267
variable C3pos equal ${d3}
variable C3pos equal 6.02843689147517
variable C4pos equal ${d4}
variable C4pos equal 15.4518676004061
variable C5pos equal ${d5}
variable C5pos equal 2.94210970647612
variable C6pos equal ${d6}
variable C6pos equal 19.3579808093167

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-64.7166135178813+${C1pos})
variable C16 equal 0.5*(-64.7166135178813+64.8657828677886)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-64.4172931625471+${C2pos})
variable C26 equal 0.5*(-64.4172931625471+75.8558395492267)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-4.68115126120205+${C3pos})
variable C36 equal 0.5*(-4.68115126120205+6.02843689147517)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-34.2959036637584+${C4pos})
variable C46 equal 0.5*(-34.2959036637584+15.4518676004061)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(12.0288414827257+${C5pos})
variable C56 equal 0.5*(12.0288414827257+2.94210970647612)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-3.27225636664807+${C6pos})
variable C66 equal 0.5*(-3.27225636664807+19.3579808093167)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 91.2128888819524
variable C22all equal ${C22}
variable C22all equal 34.9359180607624
variable C33all equal ${C33}
variable C33all equal 105.353928723674

variable C44all equal ${C44}
variable C44all equal 22.6935547970561
variable C55all equal ${C55}
variable C55all equal 25.3744199718779
variable C66all equal ${C66}
variable C66all equal 8.04286222133432

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(22.0660921313315+${C21})
variable C12all equal 0.5*(22.0660921313315+35.2499834293043)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(59.6623367751982+${C31})
variable C13all equal 0.5*(59.6623367751982+60.1347422166975)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(64.1606019244064+${C32})
variable C23all equal 0.5*(64.1606019244064+28.3683054772677)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-1.80250843291165+${C41})
variable C14all equal 0.5*(-1.80250843291165+3.64736564264784)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(23.7455305187437+${C51})
variable C15all equal 0.5*(23.7455305187437+7.22587379011511)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(0.0745846749536483+${C61})
variable C16all equal 0.5*(0.0745846749536483+6.6175495905898)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-27.7241974985883+${C42})
variable C24all equal 0.5*(-27.7241974985883+-6.85172449984892)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(17.1170419891935+${C52})
variable C25all equal 0.5*(17.1170419891935+-2.67937804243005)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(5.7192731933398+${C62})
variable C26all equal 0.5*(5.7192731933398+-9.99409534269382)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-0.906017291638399+${C43})
variable C34all equal 0.5*(-0.906017291638399+-1.00531783150386)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(36.2029325250851+${C53})
variable C35all equal 0.5*(36.2029325250851+8.88670477073723)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(0.67364281513656+${C63})
variable C36all equal 0.5*(0.67364281513656+-3.85187453449974)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-11.9659622235443+${C54})
variable C45all equal 0.5*(-11.9659622235443+-1.87759745107138)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-9.42201803167615+${C64})
variable C46all equal 0.5*(-9.42201803167615+8.7553366273547)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(7.48547559460091+${C65})
variable C56all equal 0.5*(7.48547559460091+-2.00981385199086)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:20:54
