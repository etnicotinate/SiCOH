LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-48-vasp-an
read_data       ${structure}.data
read_data       333U-50C-48-vasp-an.data
Reading data file ...
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
  reading velocities ...
  386 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              344.28356      3972.3183    
         1   300            0              0              344.28356      3972.3183    
Loop time of 5.73351e-05 on 8 procs for 1 steps with 386 atoms

61.5% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.58e-07   | 2.4862e-07 | 3.18e-07   |   0.0 |  0.43
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.151e-06  | 1.517e-06  | 1.748e-06  |   0.0 |  2.65
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.557e-05  |            |       | 96.92

Nlocal:          48.25 ave          60 max          44 min
Histogram: 3 2 1 1 0 0 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.2 | 135.5 | 138.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -44838.325      7323.1908      0              1.7098395      3961.9145    
       100   302.83793     -44839.353     -1975.1033      2019.0834      1.7098395      3961.9145    
       200   308.29389     -44850.741      1813.7827      3220.5448      1.7098395      3961.9145    
       300   278.10756     -44840.864     -5922.7859      1252.7248      1.7098395      3961.9145    
       400   284.87473     -44857.694     -1535.3684      108.75992      1.7098395      3961.9145    
       500   296.72769     -44845.273     -378.51041      2491.3412      1.7098395      3961.9145    
       600   305.89208     -44840.824     -4374.9059      47.849899      1.7098395      3961.9145    
       700   302.06624     -44833.549      5518.4001     -4589.1204      1.7098395      3961.9145    
       800   289.95843     -44827.606      3437.8364     -989.80139      1.7098395      3961.9145    
       900   298.16147     -44841.333      4847.9341     -3064.6819      1.7098395      3961.9145    
      1000   300.20192     -44851.359      10631.925      1857.7805      1.7098395      3961.9145    
      1100   296.05803     -44855.887      8460.763       603.06067      1.7098395      3961.9145    
      1200   291.0935      -44882.805     -7637.1195      1479.3586      1.7098395      3961.9145    
      1300   300.36443     -44904.495     -8634.1514      3278.6593      1.7098395      3961.9145    
      1400   280.86294     -44856.137      5777.7655     -700.20292      1.7098395      3961.9145    
      1500   283.38593     -44835.075      4196.2816     -675.63769      1.7098395      3961.9145    
      1600   294.11068     -44837.7        7030.739      -1028.5653      1.7098395      3961.9145    
      1700   295.91608     -44837.004     -3444.2574      77.697841      1.7098395      3961.9145    
      1800   300.25509     -44846.195     -11628.53      -2778.1755      1.7098395      3961.9145    
      1900   300.83719     -44873.774      5052.2177     -241.73466      1.7098395      3961.9145    
      2000   291.26286     -44877.617     -3327.6028      486.92005      1.7098395      3961.9145    
Loop time of 96.5535 on 8 procs for 2000 steps with 386 atoms

Performance: 0.895 ns/day, 26.820 hours/ns, 20.714 timesteps/s, 7.996 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.681     | 60.357     | 81.776     | 105.0 | 62.51
Bond    | 0.00049914 | 0.00066042 | 0.00082078 |   0.0 |  0.00
Neigh   | 4.7678     | 5.0427     | 6.628      |  26.7 |  5.22
Comm    | 0.66877    | 22.09      | 26.766     | 173.6 | 22.88
Output  | 0.0011106  | 0.0012356  | 0.0018241  |   0.6 |  0.00
Modify  | 7.4396     | 9.0275     | 9.302      |  20.0 |  9.35
Other   |            | 0.0344     |            |       |  0.04

Nlocal:          48.25 ave          60 max          44 min
Histogram: 3 1 1 2 0 0 0 0 0 1
Nghost:        3482.25 ave        3523 max        3444 min
Histogram: 2 0 1 1 0 0 1 1 1 1
Neighs:        32830.9 ave       40192 max       29910 min
Histogram: 3 0 2 2 0 0 0 0 0 1

Total # of neighbors = 262647
Ave neighs/atom = 680.43264
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-48-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.0516330040906
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.1238923442901
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.7042063635054

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-486.920052395774)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-486.920052395774)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-2349.61719692543)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-2349.61719692543)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-4149.14840364185)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-4149.14840364185)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1755.80325406581)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1755.80325406581)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--3018.31527686688)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--3018.31527686688)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1935.07189592762)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1935.07189592762)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 17.0516330040906
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0516330040906
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.170516330040906 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.170516330040906 xy delta 0.0748600885902973 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.170516330040906 xy delta 0.0748600885902973 xz delta -0.00020638724903703 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7225.5666      4421.9517      3959.9335    
       200   307.78883     -44850.011      3018.1574     -313.32724      3957.9526    
       300   303.2821      -44841.544     -744.50589      2172.6993      3955.9716    
       400   327.57975     -44875.714      12637.841      2003.859       3953.9907    
       500   301.05486     -44865.902     -3753.553      -316.00075      3952.0097    
       600   277.56929     -44861.544      1782.3121      2248.6608      3950.0288    
       700   308.23287     -44889.073      36.004153      3134.4721      3948.0478    
       800   311.45486     -44850.916     -9994.7012      4430.4607      3946.0668    
       900   305.60263     -44835.082     -4741.7956     -1651.0873      3944.0859    
      1000   275.77127     -44809.892      2127.8719      2985.8728      3942.1049    
      1100   300.49789     -44866.419      13536.935      1295.0638      3940.124     
      1200   285.48374     -44861.731      6551.2267      1843.1523      3938.143     
      1300   296.71248     -44859.815     -800.77193      8407.4983      3936.1621    
      1400   319.572       -44856.015      3895.2912      12296.062      3934.1811    
      1500   334.31908     -44819.024     -8136.2938      2680.6099      3932.2001    
      1600   319.59819     -44810.176      12691.076      5088.2415      3930.2192    
      1700   316.59528     -44839.924      2953.2038      718.92006      3928.2382    
      1800   306.51153     -44857.109      2580.7836      2602.8119      3926.2573    
      1900   284.74605     -44856.773      4944.9665      6888.9194      3924.2763    
      2000   285.15493     -44855.352      12117.203      8549.0349      3922.2954    
Loop time of 98.5854 on 8 procs for 2000 steps with 386 atoms

Performance: 0.876 ns/day, 27.385 hours/ns, 20.287 timesteps/s, 7.831 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.749     | 61.912     | 77.937     |  83.0 | 62.80
Bond    | 0.0004527  | 0.00067667 | 0.00085285 |   0.0 |  0.00
Neigh   | 4.89       | 5.2504     | 6.3232     |  19.0 |  5.33
Comm    | 5.5625     | 21.628     | 27.771     | 140.7 | 21.94
Output  | 0.0039247  | 0.0046799  | 0.0052089  |   0.7 |  0.00
Modify  | 8.7166     | 9.7526     | 10.133     |  13.5 |  9.89
Other   |            | 0.03689    |            |       |  0.04

Nlocal:          48.25 ave          56 max          42 min
Histogram: 2 0 0 2 0 2 0 1 0 1
Nghost:           3488 ave        3527 max        3457 min
Histogram: 2 0 0 1 2 0 2 0 0 1
Neighs:          33176 ave       38051 max       29211 min
Histogram: 2 0 0 2 0 2 0 1 0 1

Total # of neighbors = 265408
Ave neighs/atom = 687.58549
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 81.6893782400144
variable C2neg equal ${d2}
variable C2neg equal 16.4065517197637
variable C3neg equal ${d3}
variable C3neg equal -7.56894647191379
variable C4neg equal ${d4}
variable C4neg equal 5.78977594542841
variable C5neg equal ${d5}
variable C5neg equal 5.49697130050691
variable C6neg equal ${d6}
variable C6neg equal -14.0329934519306

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0516330040906
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.170516330040906 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.170516330040906 xy delta -0.0748600885902973 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.170516330040906 xy delta -0.0748600885902973 xz delta 0.00020638724903703 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7218.3446      4423.0017      3963.8955    
       200   308.73036     -44850.243      1124.3933     -1384.7666      3965.8764    
       300   298.02335     -44834.321     -6143.9834      1729.021       3967.8574    
       400   313.7379      -44856.51       6328.6649     -299.86201      3969.8383    
       500   282.00046     -44841.755      6144.4382      1238.3429      3971.8193    
       600   273.73181     -44855.015      2132.2007      2412.4664      3973.8002    
       700   283.15027     -44854.292      11500.838     -1500.8744      3975.7812    
       800   304.69828     -44835.033      6708.152       1319.632       3977.7622    
       900   315.33753     -44839.229     -64.766525     -677.19265      3979.7431    
      1000   289.93598     -44817.295     -6248.9669     -5199.6273      3981.7241    
      1100   291.63704     -44837.905      13997.54      -5069.3842      3983.705     
      1200   289.40905     -44858.607     -16623.236     -4416.342       3985.686     
      1300   290.72692     -44857.512      9623.4245      1339.4841      3987.6669    
      1400   308.26852     -44835.277     -9831.9293     -815.60536      3989.6479    
      1500   318.33404     -44837.775      5829.1164     -821.52504      3991.6289    
      1600   297.10984     -44832.65       7817.4909     -2195.6688      3993.6098    
      1700   307.60828     -44866.052      4572.1016     -1859.4757      3995.5908    
      1800   294.3235      -44861.974     -7041.6966     -6068.7422      3997.5717    
      1900   309.01278     -44866.373      528.737       -3298.6255      3999.5527    
      2000   313.48436     -44835.106     -1286.6505     -7690.2723      4001.5336    
Loop time of 97.5055 on 8 procs for 2000 steps with 386 atoms

Performance: 0.886 ns/day, 27.085 hours/ns, 20.512 timesteps/s, 7.918 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.824     | 65.828     | 82.067     | 143.9 | 67.51
Bond    | 0.00051031 | 0.00064934 | 0.0008557  |   0.0 |  0.00
Neigh   | 4.8057     | 5.5337     | 6.7818     |  39.1 |  5.68
Comm    | 0.6735     | 16.919     | 27.935     | 283.9 | 17.35
Output  | 0.003948   | 0.0046817  | 0.0052258  |   0.7 |  0.00
Modify  | 7.9271     | 9.1821     | 9.924      |  30.5 |  9.42
Other   |            | 0.03671    |            |       |  0.04

Nlocal:          48.25 ave          59 max          39 min
Histogram: 1 0 0 2 1 3 0 0 0 1
Nghost:           3469 ave        3509 max        3437 min
Histogram: 4 0 0 0 0 0 0 2 1 1
Neighs:        32533.4 ave       39229 max       26372 min
Histogram: 1 0 0 2 1 3 0 0 0 1

Total # of neighbors = 260267
Ave neighs/atom = 674.26684
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 82.8554018525643
variable C2pos equal ${d2}
variable C2pos equal 22.1518757470544
variable C3pos equal ${d3}
variable C3pos equal 60.1246431766276
variable C4pos equal ${d4}
variable C4pos equal -0.563159373053092
variable C5pos equal ${d5}
variable C5pos equal -22.0698921449133
variable C6pos equal ${d6}
variable C6pos equal 18.1252938073803

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(81.6893782400144+${C1pos})
variable C11 equal 0.5*(81.6893782400144+82.8554018525643)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(16.4065517197637+${C2pos})
variable C21 equal 0.5*(16.4065517197637+22.1518757470544)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-7.56894647191379+${C3pos})
variable C31 equal 0.5*(-7.56894647191379+60.1246431766276)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(5.78977594542841+${C4pos})
variable C41 equal 0.5*(5.78977594542841+-0.563159373053092)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(5.49697130050691+${C5pos})
variable C51 equal 0.5*(5.49697130050691+-22.0698921449133)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-14.0329934519306+${C6pos})
variable C61 equal 0.5*(-14.0329934519306+18.1252938073803)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.1238923442901
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.1238923442901
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.131238923442901 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.131238923442901 yz delta 0.00897551734451828 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7225.5666      4421.9517      3959.9335    
       200   308.31091     -44850.204      2596.6681     -1190.1043      3957.9526    
       300   297.4881      -44834.509      1414.2561      2274.7476      3955.9716    
       400   317.90366     -44865.201      12958.424      1804.666       3953.9907    
       500   296.15244     -44861.106      1136.2199     -769.88754      3952.0097    
       600   278.34005     -44864.308      981.94395      3479.1454      3950.0288    
       700   295.94134     -44871.448      5654.6057      1932.7382      3948.0478    
       800   315.25162     -44848.525      2995.1042      6276.3571      3946.0668    
       900   314.34549     -44847.05       9328.5513     -89.151067      3944.0859    
      1000   308.56352     -44855.447      4082.427       752.25952      3942.1049    
      1100   309.02313     -44881.106     -3580.0735     -219.6961       3940.124     
      1200   284.30955     -44860.484     -1539.406      -912.95941      3938.143     
      1300   306.76957     -44861.324      7883.2586     -2829.587       3936.1621    
      1400   301.75237     -44845.305     -3782.0227     -2224.0799      3934.1811    
      1500   310.55693     -44861.457      5330.0213      972.50299      3932.2001    
      1600   293.43836     -44846.034     -5143.4273      6463.5341      3930.2192    
      1700   293.71467     -44848.74      -1131.946       4208.6304      3928.2382    
      1800   298.02782     -44843.889      8753.1127      3107.1377      3926.2573    
      1900   301.45196     -44839.824      6753.6803      5003.558       3924.2763    
      2000   300.80843     -44856.906     -9073.6393      1572.4213      3922.2954    
Loop time of 98.6586 on 8 procs for 2000 steps with 386 atoms

Performance: 0.876 ns/day, 27.405 hours/ns, 20.272 timesteps/s, 7.825 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.459     | 66.683     | 83.118     | 145.1 | 67.59
Bond    | 0.00053935 | 0.00065422 | 0.00078042 |   0.0 |  0.00
Neigh   | 4.8286     | 5.5895     | 6.8436     |  39.5 |  5.67
Comm    | 0.70445    | 17.143     | 28.374     | 286.1 | 17.38
Output  | 0.0040433  | 0.004711   | 0.005228   |   0.6 |  0.00
Modify  | 7.938      | 9.2005     | 9.9574     |  30.9 |  9.33
Other   |            | 0.03681    |            |       |  0.04

Nlocal:          48.25 ave          60 max          42 min
Histogram: 2 0 1 3 1 0 0 0 0 1
Nghost:        3525.88 ave        3568 max        3500 min
Histogram: 3 1 0 0 1 0 1 1 0 1
Neighs:        33172.2 ave       40640 max       28911 min
Histogram: 2 0 1 1 3 0 0 0 0 1

Total # of neighbors = 265378
Ave neighs/atom = 687.50777
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 10.9988414617408
variable C2neg equal ${d2}
variable C2neg equal -44.6047158011571
variable C3neg equal ${d3}
variable C3neg equal -25.0656628662271
variable C4neg equal ${d4}
variable C4neg equal 12.9935503565958
variable C5neg equal ${d5}
variable C5neg equal 14.2828353275487
variable C6neg equal ${d6}
variable C6neg equal -17.4468637528891

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.1238923442901
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.131238923442901 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.131238923442901 yz delta -0.00897551734451828 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7218.3446      4423.0017      3963.8955    
       200   308.50447     -44850.023      1379.5596     -623.76464      3965.8764    
       300   297.91782     -44834.072     -7632.9436      2099.7412      3967.8574    
       400   320.34127     -44863.398      6788.6118      1096.5903      3969.8383    
       500   292.77446     -44852.933      1189.5565      2633.2109      3971.8193    
       600   278.15967     -44859.826      1179.817       1741.4825      3973.8002    
       700   294.38333     -44877.415      2808.8268      1466.4136      3975.7812    
       800   309.08749     -44850.987     -2576.0126      4500.6232      3977.7622    
       900   299.56385     -44827.573     -256.38766     -1309.81        3979.7431    
      1000   291.35983     -44829.112      270.06639     -408.9184       3981.7241    
      1100   302.74477     -44862.294     -894.05736      2167.2457      3983.705     
      1200   286.54097     -44861.091     -7779.599      -1757.4933      3985.686     
      1300   297.00408     -44863.824     -9278.348      -755.54173      3987.6669    
      1400   316.47795     -44845.333      9781.4374      167.60175      3989.6479    
      1500   314.2801      -44832.94      -650.66074     -3081.0071      3991.6289    
      1600   327.28125     -44865.543     -2192.6952      2968.1313      3993.6098    
      1700   278.35162     -44839.653     -7506.5634     -4016.1714      3995.5908    
      1800   282.79758     -44842.648      1195.1311     -186.38336      3997.5717    
      1900   289.44183     -44831.645     -6703.9295     -4023.5319      3999.5527    
      2000   313.26324     -44836.39      -9567.2551     -4225.351       4001.5336    
Loop time of 97.7546 on 8 procs for 2000 steps with 386 atoms

Performance: 0.884 ns/day, 27.154 hours/ns, 20.459 timesteps/s, 7.897 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.573     | 65.706     | 82.182     | 146.3 | 67.22
Bond    | 0.00049784 | 0.00066827 | 0.00086135 |   0.0 |  0.00
Neigh   | 4.7772     | 5.5148     | 6.7439     |  39.0 |  5.64
Comm    | 0.7092     | 17.186     | 28.327     | 286.0 | 17.58
Output  | 0.0039799  | 0.0047109  | 0.0052566  |   0.7 |  0.00
Modify  | 8.0738     | 9.3063     | 10.038     |  30.2 |  9.52
Other   |            | 0.03665    |            |       |  0.04

Nlocal:          48.25 ave          56 max          45 min
Histogram: 3 3 0 0 0 0 1 0 0 1
Nghost:        3448.88 ave        3487 max        3414 min
Histogram: 1 2 0 0 0 2 1 1 0 1
Neighs:          32541 ave       37345 max       30572 min
Histogram: 2 4 0 0 0 0 1 0 0 1

Total # of neighbors = 260328
Ave neighs/atom = 674.42487
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 47.7470868026536
variable C2pos equal ${d2}
variable C2pos equal 91.6503195473937
variable C3pos equal ${d3}
variable C3pos equal 100.322263430873
variable C4pos equal ${d4}
variable C4pos equal -4.78211513687432
variable C5pos equal ${d5}
variable C5pos equal -14.484945558139
variable C6pos equal ${d6}
variable C6pos equal 5.28182515960099

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(10.9988414617408+${C1pos})
variable C12 equal 0.5*(10.9988414617408+47.7470868026536)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-44.6047158011571+${C2pos})
variable C22 equal 0.5*(-44.6047158011571+91.6503195473937)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-25.0656628662271+${C3pos})
variable C32 equal 0.5*(-25.0656628662271+100.322263430873)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(12.9935503565958+${C4pos})
variable C42 equal 0.5*(12.9935503565958+-4.78211513687432)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(14.2828353275487+${C5pos})
variable C52 equal 0.5*(14.2828353275487+-14.484945558139)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-17.4468637528891+${C6pos})
variable C62 equal 0.5*(-17.4468637528891+5.28182515960099)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.7042063635054
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.7042063635054
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.177042063635054 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7225.5666      4421.9517      3959.9335    
       200   306.96799     -44848.87       2598.764      -1129.3916      3957.9526    
       300   299.06168     -44836.396     -2818.5724      2095.43        3955.9716    
       400   317.17742     -44862.656      19817.362      1728.0782      3953.9907    
       500   289.9916      -44851.718      1426.7562     -147.37688      3952.0097    
       600   285.08685     -44867.734      5164.6312      4596.4961      3950.0288    
       700   306.26827     -44871.668     -35.511796      1835.923       3948.0478    
       800   302.49284     -44828.339      1929.905       5338.3718      3946.0668    
       900   306.70054     -44830.572      5406.0362      3220.7226      3944.0859    
      1000   322.40803     -44862.461      2365.3308      5190.6057      3942.1049    
      1100   289.69502     -44854.422      19327.88       5219.5603      3940.124     
      1200   288.33424     -44853.293     -16337.828     -2972.7889      3938.143     
      1300   291.07837     -44841.386      13679.679      4331.2313      3936.1621    
      1400   293.90144     -44834.326      11713.656      784.945        3934.1811    
      1500   301.01142     -44843.685      4506.1072      1097.7703      3932.2001    
      1600   290.329       -44832.132      150.06037      747.67661      3930.2192    
      1700   307.53305     -44848.539      18117.762      2882.508       3928.2382    
      1800   310.47219     -44837.084      13330.648      2632.8166      3926.2573    
      1900   304.59392     -44817.422      4699.4507      2024.6067      3924.2763    
      2000   305.9503      -44826.64       2441.7663      2975.9417      3922.2954    
Loop time of 98.5885 on 8 procs for 2000 steps with 386 atoms

Performance: 0.876 ns/day, 27.386 hours/ns, 20.286 timesteps/s, 7.831 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.468     | 66.554     | 82.918     | 144.6 | 67.51
Bond    | 0.00053179 | 0.00067526 | 0.00086449 |   0.0 |  0.00
Neigh   | 4.8163     | 5.5793     | 6.8407     |  39.7 |  5.66
Comm    | 0.72179    | 17.092     | 28.189     | 285.4 | 17.34
Output  | 0.0039366  | 0.0047315  | 0.0053104  |   0.7 |  0.00
Modify  | 8.0626     | 9.322      | 10.091     |  30.8 |  9.46
Other   |            | 0.03634    |            |       |  0.04

Nlocal:          48.25 ave          58 max          42 min
Histogram: 1 2 1 0 0 3 0 0 0 1
Nghost:         3501.5 ave        3559 max        3450 min
Histogram: 1 0 1 1 1 2 0 0 1 1
Neighs:        33196.6 ave       39405 max       29040 min
Histogram: 1 2 1 0 0 3 0 0 0 1

Total # of neighbors = 265573
Ave neighs/atom = 688.01295
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 25.2200121237159
variable C2neg equal ${d2}
variable C2neg equal 21.406392231109
variable C3neg equal ${d3}
variable C3neg equal -12.8860449823035
variable C4neg equal ${d4}
variable C4neg equal 3.75897106398931
variable C5neg equal ${d5}
variable C5neg equal 3.93731862128228
variable C6neg equal ${d6}
variable C6neg equal -25.8850580717195

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.7042063635054
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.177042063635054 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7218.3446      4423.0017      3963.8955    
       200   308.16285     -44849.62       2221.9435     -682.84829      3965.8764    
       300   297.39957     -44833.514     -7686.5928      1994.4053      3967.8574    
       400   321.95971     -44866.063      7869.4199      74.610017      3969.8383    
       500   293.29248     -44854.247     -5221.0623      2816.8304      3971.8193    
       600   280.79276     -44862.319     -6718.2135      1616.051       3973.8002    
       700   300.38158     -44876.135      9501.0436      2854.7534      3975.7812    
       800   300.83672     -44832.435      13910.568      8076.0736      3977.7622    
       900   308.07308     -44831.822      10729.768     -455.30074      3979.7431    
      1000   304.08205     -44837.23       1830.898      -170.3141       3981.7241    
      1100   284.02611     -44838.883     -1337.7935      339.63455      3983.705     
      1200   286.8593      -44854.563      458.86259     -6507.4106      3985.686     
      1300   301.61206     -44855.442     -948.51074      1163.8307      3987.6669    
      1400   307.60372     -44817.567     -231.05608     -1345.2085      3989.6479    
      1500   305.33123     -44823.631     -3370.8118      840.95797      3991.6289    
      1600   296.73726     -44840.001      11045.422      378.57751      3993.6098    
      1700   297.78693     -44860.112     -1290.062      -5690.1831      3995.5908    
      1800   300.80226     -44868.548      10480.231      3708.306       3997.5717    
      1900   282.71483     -44839.275     -6630.8725     -3166.1085      3999.5527    
      2000   311.63564     -44831.327      82.37591      -2415.2021      4001.5336    
Loop time of 96.1713 on 8 procs for 2000 steps with 386 atoms

Performance: 0.898 ns/day, 26.714 hours/ns, 20.796 timesteps/s, 8.027 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.483     | 64.009     | 79.833     | 119.2 | 66.56
Bond    | 0.00049383 | 0.00064862 | 0.00081109 |   0.0 |  0.00
Neigh   | 4.7995     | 5.3706     | 6.7693     |  34.4 |  5.58
Comm    | 1.6059     | 17.436     | 25.97      | 228.4 | 18.13
Output  | 0.0039242  | 0.0046956  | 0.005295   |   0.7 |  0.00
Modify  | 7.9062     | 9.3137     | 9.8942     |  26.2 |  9.68
Other   |            | 0.03619    |            |       |  0.04

Nlocal:          48.25 ave          59 max          42 min
Histogram: 2 0 2 2 0 0 1 0 0 1
Nghost:           3456 ave        3506 max        3409 min
Histogram: 1 0 2 0 2 0 1 0 1 1
Neighs:        32520.8 ave       39209 max       28638 min
Histogram: 2 0 1 3 0 0 1 0 0 1

Total # of neighbors = 260166
Ave neighs/atom = 674.00518
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 29.4057527458918
variable C2pos equal ${d2}
variable C2pos equal 28.0999498122999
variable C3pos equal ${d3}
variable C3pos equal 51.9416414367512
variable C4pos equal ${d4}
variable C4pos equal -10.4143052746234
variable C5pos equal ${d5}
variable C5pos equal -22.1663738208657
variable C6pos equal ${d6}
variable C6pos equal 24.2905392384985

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(25.2200121237159+${C1pos})
variable C13 equal 0.5*(25.2200121237159+29.4057527458918)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(21.406392231109+${C2pos})
variable C23 equal 0.5*(21.406392231109+28.0999498122999)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-12.8860449823035+${C3pos})
variable C33 equal 0.5*(-12.8860449823035+51.9416414367512)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(3.75897106398931+${C4pos})
variable C43 equal 0.5*(3.75897106398931+-10.4143052746234)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(3.93731862128228+${C5pos})
variable C53 equal 0.5*(3.93731862128228+-22.1663738208657)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-25.8850580717195+${C6pos})
variable C63 equal 0.5*(-25.8850580717195+24.2905392384985)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.7042063635054
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.7042063635054
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.177042063635054 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7221.9538      4422.477       3961.9145    
       200   307.61042     -44849.104      2488.7416     -499.48871      3961.9145    
       300   299.02599     -44835.659     -6923.304       1862.088       3961.9145    
       400   326.64009     -44872.798      9542.379       2528.725       3961.9145    
       500   301.81569     -44865.974     -1678.5938      1760.2766      3961.9145    
       600   292.44662     -44878.629      6108.1373      3007.7978      3961.9145    
       700   287.63284     -44882.319     -6637.0523      1982.9897      3961.9145    
       800   286.93111     -44860.29      -3991.7073      3860.2428      3961.9145    
       900   299.36571     -44840.331      8328.4709     -402.20141      3961.9145    
      1000   293.33557     -44821.985      1081.0069      773.42183      3961.9145    
      1100   310.49365     -44845.619      3207.0858      2961.7685      3961.9145    
      1200   307.53061     -44860.647      1044.6423     -577.72295      3961.9145    
      1300   291.3043      -44874.642      8434.6468     -1014.7559      3961.9145    
      1400   279.67789     -44859.793     -1213.0563      4863.7754      3961.9145    
      1500   293.95143     -44861.201     -8608.3581     -2775.6507      3961.9145    
      1600   293.6563      -44856.78      -10665.117     -937.07727      3961.9145    
      1700   304.11056     -44857.558      7693.7181      2056.7617      3961.9145    
      1800   306.94951     -44854.581      2650.2167      4811.0916      3961.9145    
      1900   314.50168     -44865.239     -1477.555       2060.0422      3961.9145    
      2000   289.12264     -44854.738      9317.105       1188.6681      3961.9145    
Loop time of 95.9922 on 8 procs for 2000 steps with 386 atoms

Performance: 0.900 ns/day, 26.665 hours/ns, 20.835 timesteps/s, 8.042 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.006     | 63.349     | 80.445     | 124.7 | 65.99
Bond    | 0.00050048 | 0.00065941 | 0.00086308 |   0.0 |  0.00
Neigh   | 4.8213     | 5.3328     | 6.8207     |  36.0 |  5.56
Comm    | 0.88496    | 17.977     | 26.326     | 234.1 | 18.73
Output  | 0.0039763  | 0.0047576  | 0.0052791  |   0.7 |  0.00
Modify  | 7.7943     | 9.2913     | 9.799      |  27.4 |  9.68
Other   |            | 0.0369     |            |       |  0.04

Nlocal:          48.25 ave          58 max          42 min
Histogram: 2 1 0 1 0 3 0 0 0 1
Nghost:        3495.62 ave        3554 max        3447 min
Histogram: 2 0 0 2 2 0 0 0 0 2
Neighs:        32829.6 ave       38971 max       28967 min
Histogram: 2 1 0 1 1 2 0 0 0 1

Total # of neighbors = 262637
Ave neighs/atom = 680.40674
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 7.11046218947561
variable C2neg equal ${d2}
variable C2neg equal -40.2472714123963
variable C3neg equal ${d3}
variable C3neg equal 3.51043176527515
variable C4neg equal ${d4}
variable C4neg equal 2.14459106802757
variable C5neg equal ${d5}
variable C5neg equal 18.8920864468849
variable C6neg equal ${d6}
variable C6neg equal -11.4196805767091

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.7042063635054
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.177042063635054 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7221.9538      4422.477       3961.9145    
       200   307.69874     -44849.359      1695.3267     -1261.7166      3961.9145    
       300   297.34985     -44834.185     -4198.585       2266.3731      3961.9145    
       400   326.20524     -44871.737      17957.148      2169.4706      3961.9145    
       500   294.96391     -44856.806      5581.4459     -314.75082      3961.9145    
       600   290.34566     -44873.929      2058.1066      2582.0504      3961.9145    
       700   293.63221     -44865.731      1892.2262      1668.3374      3961.9145    
       800   316.59726     -44849.478      5081.997       4673.7879      3961.9145    
       900   302.94977     -44827.726      168.06053      922.64223      3961.9145    
      1000   309.04247     -44848.703     -7960.3567     -3244.3173      3961.9145    
      1100   292.4585      -44854.866      3730.7788     -1093.4069      3961.9145    
      1200   291.11849     -44863.398     -3722.8702     -1974.1196      3961.9145    
      1300   298.38945     -44847.38      -5621.7635     -1982.3321      3961.9145    
      1400   307.8246      -44824.172      1718.187       1043.4674      3961.9145    
      1500   308.09588     -44831.662      8611.0997      4525.6536      3961.9145    
      1600   297.58895     -44843.379      76.758136      6449.1035      3961.9145    
      1700   290.04744     -44853.886      5453.5672      1033.4141      3961.9145    
      1800   294.13796     -44858.5       -5895.655      -33.317996      3961.9145    
      1900   313.06853     -44852.303     -2803.622      -686.69848      3961.9145    
      2000   321.7993      -44837.369      3219.1081     -3072.7248      3961.9145    
Loop time of 95.4013 on 8 procs for 2000 steps with 386 atoms

Performance: 0.906 ns/day, 26.500 hours/ns, 20.964 timesteps/s, 8.092 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.704     | 63.161     | 80.031     | 123.8 | 66.21
Bond    | 0.00049109 | 0.0006511  | 0.00081663 |   0.0 |  0.00
Neigh   | 4.7795     | 5.2935     | 6.7688     |  35.8 |  5.55
Comm    | 0.92217    | 17.79      | 26.258     | 233.2 | 18.65
Output  | 0.0039202  | 0.0046857  | 0.0052327  |   0.7 |  0.00
Modify  | 7.6321     | 9.1148     | 9.6269     |  27.4 |  9.55
Other   |            | 0.0368     |            |       |  0.04

Nlocal:          48.25 ave          61 max          45 min
Histogram: 5 1 0 1 0 0 0 0 0 1
Nghost:        3469.38 ave        3512 max        3432 min
Histogram: 1 1 0 2 0 1 1 1 0 1
Neighs:          32857 ave       40879 max       30568 min
Histogram: 5 0 1 1 0 0 0 0 0 1

Total # of neighbors = 262856
Ave neighs/atom = 680.97409
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 36.0681010968882
variable C2pos equal ${d2}
variable C2pos equal 32.8453406231053
variable C3pos equal ${d3}
variable C3pos equal 22.6155689792401
variable C4pos equal ${d4}
variable C4pos equal 12.2729206880317
variable C5pos equal ${d5}
variable C5pos equal -25.9710774039951
variable C6pos equal ${d6}
variable C6pos equal 22.9498623958961

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(7.11046218947561+${C1pos})
variable C14 equal 0.5*(7.11046218947561+36.0681010968882)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-40.2472714123963+${C2pos})
variable C24 equal 0.5*(-40.2472714123963+32.8453406231053)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(3.51043176527515+${C3pos})
variable C34 equal 0.5*(3.51043176527515+22.6155689792401)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(2.14459106802757+${C4pos})
variable C44 equal 0.5*(2.14459106802757+12.2729206880317)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(18.8920864468849+${C5pos})
variable C54 equal 0.5*(18.8920864468849+-25.9710774039951)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-11.4196805767091+${C6pos})
variable C64 equal 0.5*(-11.4196805767091+22.9498623958961)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.7042063635054
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.7042063635054
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.177042063635054 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7221.9538      4422.477       3961.9145    
       200   307.91829     -44849.664      2570.811      -912.46298      3961.9145    
       300   298.93349     -44836.316     -5136.0672      1759.8494      3961.9145    
       400   316.83589     -44861.783      16011.454      3455.713       3961.9145    
       500   293.78985     -44854.889      11086.668      371.27859      3961.9145    
       600   279.55437     -44858.762      5280.252       1520.6377      3961.9145    
       700   297.06812     -44872.933      5378.6667      3771.7541      3961.9145    
       800   291.0512      -44827.178     -749.09447      3627.28        3961.9145    
       900   304.84077     -44829.169      9768.7794      2426.4404      3961.9145    
      1000   296.55761     -44817.419      5476.9178      1279.591       3961.9145    
      1100   319.66185     -44852.372      2753.3204      3158.5519      3961.9145    
      1200   277.99565     -44833.41      -2329.3384     -5203.82        3961.9145    
      1300   286.72459     -44842.768      7044.1014      3865.0036      3961.9145    
      1400   290.29685     -44812.255     -7504.6779      4619.3603      3961.9145    
      1500   306.20091     -44818.889      7059.3502      1616.6277      3961.9145    
      1600   327.19018     -44856.37       5610.6746      6176.3788      3961.9145    
      1700   284.12503     -44826.882      1097.7533     -1129.7505      3961.9145    
      1800   290.35892     -44837.488     -4971.5355     -307.99717      3961.9145    
      1900   305.64385     -44826.853     -134.7194      -471.15361      3961.9145    
      2000   321.27106     -44819.355      9569.2648      355.13133      3961.9145    
Loop time of 95.4935 on 8 procs for 2000 steps with 386 atoms

Performance: 0.905 ns/day, 26.526 hours/ns, 20.944 timesteps/s, 8.084 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.729     | 63.208     | 80.072     | 123.7 | 66.19
Bond    | 0.00055659 | 0.00064622 | 0.00080253 |   0.0 |  0.00
Neigh   | 4.8065     | 5.3175     | 6.824      |  35.9 |  5.57
Comm    | 0.91171    | 17.773     | 26.261     | 233.2 | 18.61
Output  | 0.004046   | 0.004748   | 0.0052748  |   0.6 |  0.00
Modify  | 7.6365     | 9.1528     | 9.661      |  27.5 |  9.58
Other   |            | 0.03682    |            |       |  0.04

Nlocal:          48.25 ave          60 max          43 min
Histogram: 2 1 2 2 0 0 0 0 0 1
Nghost:        3484.88 ave        3530 max        3441 min
Histogram: 1 0 2 1 1 0 0 1 1 1
Neighs:        32840.2 ave       40230 max       29523 min
Histogram: 2 1 1 3 0 0 0 0 0 1

Total # of neighbors = 262722
Ave neighs/atom = 680.62694
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -1.33534927884745
variable C2neg equal ${d2}
variable C2neg equal -76.5125630235126
variable C3neg equal ${d3}
variable C3neg equal -2.80071660224448
variable C4neg equal ${d4}
variable C4neg equal 10.75044272058
variable C5neg equal ${d5}
variable C5neg equal 20.1652541448896
variable C6neg equal ${d6}
variable C6neg equal -3.78344021525571

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.7042063635054
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.177042063635054 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7221.9538      4422.477       3961.9145    
       200   307.59227     -44849.205      2086.1676     -947.51111      3961.9145    
       300   298.92251     -44835.966     -5417.4642      2423.7419      3961.9145    
       400   325.46146     -44870.578      14956.447      2430.1491      3961.9145    
       500   292.38592     -44852.666     -1003.5212     -667.18075      3961.9145    
       600   291.57682     -44875.932      2970.9642      2622.0748      3961.9145    
       700   295.84815     -44876.804      8022.6154      626.23702      3961.9145    
       800   300.14555     -44835.814      11344.848      5661.3872      3961.9145    
       900   307.64112     -44836.654     -1784.8697      32.928962      3961.9145    
      1000   298.17711     -44844.627      8469.3119     -1311.247       3961.9145    
      1100   292.136       -44856.364      10361.16       604.2688       3961.9145    
      1200   300.08345     -44869.604      336.73855     -1844.8173      3961.9145    
      1300   294.28499     -44825.07       5162.7061      1066.7733      3961.9145    
      1400   308.93773     -44826.691      11444.447      4571.2227      3961.9145    
      1500   313.33507     -44849.138      242.0092      -1057.6315      3961.9145    
      1600   290.92241     -44849.776      7381.6675     -3202.8854      3961.9145    
      1700   299.22762     -44866.98       7195.539       6139.4116      3961.9145    
      1800   282.65183     -44848.491     -1526.9831      1183.9868      3961.9145    
      1900   301.11237     -44846.881     -7126.1551     -2050.6705      3961.9145    
      2000   320.55689     -44833.35       15816.898      3046.0887      3961.9145    
Loop time of 96.1999 on 8 procs for 2000 steps with 386 atoms

Performance: 0.898 ns/day, 26.722 hours/ns, 20.790 timesteps/s, 8.025 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.851     | 63.391     | 80.575     | 126.0 | 65.90
Bond    | 0.00048059 | 0.00066014 | 0.0009194  |   0.0 |  0.00
Neigh   | 4.8107     | 5.3285     | 6.8288     |  36.3 |  5.54
Comm    | 0.9389     | 18.117     | 26.664     | 235.7 | 18.83
Output  | 0.0038436  | 0.0046114  | 0.0051898  |   0.7 |  0.00
Modify  | 7.8132     | 9.3206     | 9.8349     |  27.6 |  9.69
Other   |            | 0.03686    |            |       |  0.04

Nlocal:          48.25 ave          64 max          42 min
Histogram: 3 1 0 3 0 0 0 0 0 1
Nghost:        3469.12 ave        3499 max        3440 min
Histogram: 1 0 2 1 0 1 1 0 1 1
Neighs:        32825.6 ave       42750 max       28517 min
Histogram: 3 0 1 3 0 0 0 0 0 1

Total # of neighbors = 262605
Ave neighs/atom = 680.32383
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -25.9307766712956
variable C2pos equal ${d2}
variable C2pos equal -10.4040070243184
variable C3pos equal ${d3}
variable C3pos equal 26.6986712040089
variable C4pos equal ${d4}
variable C4pos equal -16.0770114949962
variable C5pos equal ${d5}
variable C5pos equal -4.20675514484954
variable C6pos equal ${d6}
variable C6pos equal -3.7843911429431

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-1.33534927884745+${C1pos})
variable C15 equal 0.5*(-1.33534927884745+-25.9307766712956)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-76.5125630235126+${C2pos})
variable C25 equal 0.5*(-76.5125630235126+-10.4040070243184)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-2.80071660224448+${C3pos})
variable C35 equal 0.5*(-2.80071660224448+26.6986712040089)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(10.75044272058+${C4pos})
variable C45 equal 0.5*(10.75044272058+-16.0770114949962)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(20.1652541448896+${C5pos})
variable C55 equal 0.5*(20.1652541448896+-4.20675514484954)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-3.78344021525571+${C6pos})
variable C65 equal 0.5*(-3.78344021525571+-3.7843911429431)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.1238923442901

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.1238923442901
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.131238923442901 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7221.9538      4422.477       3961.9145    
       200   307.91269     -44849.558      2918.484      -666.14823      3961.9145    
       300   299.29486     -44836.191     -5508.8592      2093.5534      3961.9145    
       400   325.20597     -44870.714      13830.754      2050.5851      3961.9145    
       500   285.06054     -44842.853      5975.8594     -113.24058      3961.9145    
       600   274.09721     -44853.13      -1035.3144      1713.6846      3961.9145    
       700   288.35253     -44878.344      8793.3678      3659.8048      3961.9145    
       800   300.12462     -44863.567      7256.3922      6738.2156      3961.9145    
       900   312.63154     -44851.866      3501.0237      1759.7812      3961.9145    
      1000   274.4488      -44808.487     -1002.831      -587.42869      3961.9145    
      1100   295.24834     -44839.122     -54.146984      1142.7545      3961.9145    
      1200   277.15574     -44844.527      1223.0599     -1039.7363      3961.9145    
      1300   298.61433     -44882.504     -1091.3887      1879.1216      3961.9145    
      1400   294.31614     -44852.958      1312.4749      7465.8744      3961.9145    
      1500   297.45475     -44829.618      12066.626      2192.7285      3961.9145    
      1600   306.88598     -44849.545     -8557.9035     -145.36048      3961.9145    
      1700   295.16256     -44860.801     -6165.0361     -1673.6784      3961.9145    
      1800   275.07721     -44849.698     -742.56713     -4.7923589      3961.9145    
      1900   281.52595     -44838.13      -5774.4189      3239.2904      3961.9145    
      2000   325.13068     -44848.8       -3866.7618     -3213.7108      3961.9145    
Loop time of 89.3337 on 8 procs for 2000 steps with 386 atoms

Performance: 0.967 ns/day, 24.815 hours/ns, 22.388 timesteps/s, 8.642 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.609     | 61.672     | 74.221     |  92.5 | 69.04
Bond    | 0.00048551 | 0.00065162 | 0.00082268 |   0.0 |  0.00
Neigh   | 4.8018     | 5.2066     | 6.3319     |  27.0 |  5.83
Comm    | 1.319      | 13.867     | 20.934     | 195.1 | 15.52
Output  | 0.0036929  | 0.0044674  | 0.0050071  |   0.7 |  0.01
Modify  | 7.4144     | 8.5459     | 8.9475     |  21.2 |  9.57
Other   |            | 0.03786    |            |       |  0.04

Nlocal:          48.25 ave          61 max          41 min
Histogram: 1 0 2 3 1 0 0 0 0 1
Nghost:        3486.62 ave        3515 max        3464 min
Histogram: 2 0 1 1 2 0 0 0 0 2
Neighs:        32844.2 ave       40851 max       28231 min
Histogram: 1 0 2 3 1 0 0 0 0 1

Total # of neighbors = 262754
Ave neighs/atom = 680.70984
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -37.4966421089302
variable C2neg equal ${d2}
variable C2neg equal -23.9327630256975
variable C3neg equal ${d3}
variable C3neg equal -43.6926012063843
variable C4neg equal ${d4}
variable C4neg equal -9.07193033030358
variable C5neg equal ${d5}
variable C5neg equal 15.758821137066
variable C6neg equal ${d6}
variable C6neg equal -6.18643757000581

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.1647165 0.23255383 -0.19405318) to (16.886917 13.356446 17.510153) with tilt (-7.4860089 0.020638725 -0.89755173)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.1238923442901
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.131238923442901 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.26286     -44877.617     -3327.6107      0              3961.9145    
       100   308.84875     -44878.599     -7221.9538      4422.477       3961.9145    
       200   307.80461     -44849.718      1445.4742     -1023.9743      3961.9145    
       300   297.99287     -44834.606     -4222.9073      2147.9376      3961.9145    
       400   323.56266     -44868.662      15531.449      1781.1729      3961.9145    
       500   292.07193     -44853.663     -1597.2859      1080.0439      3961.9145    
       600   287.73318     -44871.613     -2827.982       2736.725       3961.9145    
       700   306.87875     -44880.073     -3887.9619      2406.8681      3961.9145    
       800   316.05765     -44845.245      7163.3706      4228.183       3961.9145    
       900   311.71134     -44839.167      2270.7909      18.925993      3961.9145    
      1000   303.43518     -44848.126     -6421.7566      249.58728      3961.9145    
      1100   295.90957     -44864.096      1430.3287     -2628.449       3961.9145    
      1200   277.08803     -44848.98      -5121.3431     -5997.3312      3961.9145    
      1300   289.73949     -44839.14      -752.23501     -2716.88        3961.9145    
      1400   289.60017     -44826.402     -3865.8025     -206.69076      3961.9145    
      1500   304.72062     -44844.791     -4920.8494     -2343.7535      3961.9145    
      1600   288.47067     -44837.061     -2413.5227      4315.9257      3961.9145    
      1700   306.50466     -44869.538      3841.5976     -351.95075      3961.9145    
      1800   295.88243     -44866.441     -3105.638       4282.3732      3961.9145    
      1900   290.71681     -44860.221     -13534.248     -3828.0109      3961.9145    
      2000   321.16939     -44864.226      3244.9519     -3371.2407      3961.9145    
Loop time of 66.3213 on 8 procs for 2000 steps with 386 atoms

Performance: 1.303 ns/day, 18.423 hours/ns, 30.156 timesteps/s, 11.640 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.231     | 52.553     | 54.353     |  17.9 | 79.24
Bond    | 0.00039231 | 0.00059218 | 0.00082645 |   0.0 |  0.00
Neigh   | 4.7939     | 4.8204     | 4.8519     |   1.0 |  7.27
Comm    | 0.56662    | 2.3734     | 4.697      |  84.4 |  3.58
Output  | 0.0030979  | 0.0040561  | 0.004794   |   0.9 |  0.01
Modify  | 6.4999     | 6.5324     | 6.5603     |   0.9 |  9.85
Other   |            | 0.03758    |            |       |  0.06

Nlocal:          48.25 ave          56 max          45 min
Histogram: 4 0 2 0 0 0 1 0 0 1
Nghost:        3475.25 ave        3515 max        3438 min
Histogram: 1 1 0 1 1 2 0 0 0 2
Neighs:        32837.8 ave       37767 max       30581 min
Histogram: 2 2 1 1 0 0 1 0 0 1

Total # of neighbors = 262702
Ave neighs/atom = 680.57513
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 39.0928139726198
variable C2pos equal ${d2}
variable C2pos equal 46.9766771956207
variable C3pos equal ${d3}
variable C3pos equal 16.3896206286696
variable C4pos equal ${d4}
variable C4pos equal 0.652138525301328
variable C5pos equal ${d5}
variable C5pos equal -15.3142464163666
variable C6pos equal ${d6}
variable C6pos equal 12.0696393473464

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-37.4966421089302+${C1pos})
variable C16 equal 0.5*(-37.4966421089302+39.0928139726198)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-23.9327630256975+${C2pos})
variable C26 equal 0.5*(-23.9327630256975+46.9766771956207)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-43.6926012063843+${C3pos})
variable C36 equal 0.5*(-43.6926012063843+16.3896206286696)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-9.07193033030358+${C4pos})
variable C46 equal 0.5*(-9.07193033030358+0.652138525301328)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(15.758821137066+${C5pos})
variable C56 equal 0.5*(15.758821137066+-15.3142464163666)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-6.18643757000581+${C6pos})
variable C66 equal 0.5*(-6.18643757000581+12.0696393473464)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 82.2723900462894
variable C22all equal ${C22}
variable C22all equal 23.5228018731183
variable C33all equal ${C33}
variable C33all equal 19.5277982272238

variable C44all equal ${C44}
variable C44all equal 7.20875587802963
variable C55all equal ${C55}
variable C55all equal 7.97924950002003
variable C66all equal ${C66}
variable C66all equal 2.94160088867029

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(29.3729641321972+${C21})
variable C12all equal 0.5*(29.3729641321972+19.2792137334091)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(27.3128824348038+${C31})
variable C13all equal 0.5*(27.3128824348038+26.2778483523569)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(24.7531710217044+${C32})
variable C23all equal 0.5*(24.7531710217044+37.6283002823229)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(21.5892816431819+${C41})
variable C14all equal 0.5*(21.5892816431819+2.61330828618766)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-13.6330629750715+${C51})
variable C15all equal 0.5*(-13.6330629750715+-8.2864604222032)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(0.798085931844799+${C61})
variable C16all equal 0.5*(0.798085931844799+2.04615017772485)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-3.7009653946455+${C42})
variable C24all equal 0.5*(-3.7009653946455+4.10571760986074)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-43.4582850239155+${C52})
variable C25all equal 0.5*(-43.4582850239155+-0.10105511529515)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(11.5219570849616+${C62})
variable C26all equal 0.5*(11.5219570849616+-6.08251929664406)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(13.0630003722576+${C43})
variable C34all equal 0.5*(13.0630003722576+-3.32766710531704)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(11.9489773008822+${C53})
variable C35all equal 0.5*(11.9489773008822+-9.11452759979171)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-13.6514902888574+${C63})
variable C36all equal 0.5*(-13.6514902888574+-0.797259416610499)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-2.6632843872081+${C54})
variable C45all equal 0.5*(-2.6632843872081+-3.5394954785551)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-4.20989590250113+${C64})
variable C46all equal 0.5*(-4.20989590250113+5.7650909095935)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(0.2222873603497+${C65})
variable C56all equal 0.5*(0.2222873603497+-3.7839156790994)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:20:24
