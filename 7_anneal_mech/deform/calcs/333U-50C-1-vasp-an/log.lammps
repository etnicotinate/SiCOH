LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-1-vasp-an
read_data       ${structure}.data
read_data       333U-50C-1-vasp-an.data
Reading data file ...
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  362 atoms
  reading velocities ...
  362 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.011 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              322.82173      3807.2662    
         1   300            0              0              322.82173      3807.2662    
Loop time of 7.41442e-05 on 8 procs for 1 steps with 362 atoms

55.5% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.29e-07   | 2.3563e-07 | 3.14e-07   |   0.0 |  0.32
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.74e-07   | 1.398e-06  | 1.623e-06  |   0.0 |  1.89
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.251e-05  |            |       | 97.80

Nlocal:          45.25 ave          54 max          40 min
Histogram: 2 1 1 0 0 3 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135.2 | 136.1 | 136.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -42447.341     -5763.0753      0              1.6996713      3875.9875    
       100   301.41569     -42452.307     -670.25278      4956.0249      1.6996713      3875.9875    
       200   315.99894     -42470.483     -4813.8138     -5272.5481      1.6996713      3875.9875    
       300   297.17841     -42465.883     -1443.1391     -2721.6756      1.6996713      3875.9875    
       400   306.28627     -42490.254     -7730.2254     -4426.0647      1.6996713      3875.9875    
       500   294.03531     -42479.969      8272.3501      3548.2977      1.6996713      3875.9875    
       600   281.05099     -42458.199      9677.4238      2783.3974      1.6996713      3875.9875    
       700   320.16723     -42468.799      3023.1672      49.172944      1.6996713      3875.9875    
       800   318.1655      -42470.615     -3623.3084     -7852.5248      1.6996713      3875.9875    
       900   298.11353     -42472.687      81.138817     -11962.86       1.6996713      3875.9875    
      1000   290.2176      -42474.958      2757.1445     -1504.1043      1.6996713      3875.9875    
      1100   287.50568     -42468.221      9243.4748     -2363.2577      1.6996713      3875.9875    
      1200   302.98834     -42471.816      10893.721      504.92301      1.6996713      3875.9875    
      1300   300.06865     -42454.031     -4637.7199      5581.4555      1.6996713      3875.9875    
      1400   298.35343     -42461.025      2728.1709     -5511.5237      1.6996713      3875.9875    
      1500   298.21028     -42492.42       7224.1553     -4320.1839      1.6996713      3875.9875    
      1600   275.68346     -42479.073      9930.1479      1837.5345      1.6996713      3875.9875    
      1700   281.08704     -42472.996     -1730.8434     -6720.1454      1.6996713      3875.9875    
      1800   293.50602     -42467.324      15355.18       2421.4287      1.6996713      3875.9875    
      1900   292.37474     -42449.466      2235.9869     -579.70237      1.6996713      3875.9875    
      2000   301.6662      -42464.53      -7955.4271     -4871.7643      1.6996713      3875.9875    
Loop time of 93.1595 on 8 procs for 2000 steps with 362 atoms

Performance: 0.927 ns/day, 25.878 hours/ns, 21.469 timesteps/s, 7.772 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.974     | 61.229     | 78.641     | 120.8 | 65.73
Bond    | 0.0004477  | 0.00069015 | 0.0008588  |   0.0 |  0.00
Neigh   | 4.8015     | 5.2867     | 6.6953     |  35.2 |  5.67
Comm    | 0.66602    | 18.083     | 25.339     | 222.4 | 19.41
Output  | 0.0010127  | 0.0011184  | 0.0015152  |   0.5 |  0.00
Modify  | 7.1246     | 8.5223     | 9.0079     |  27.6 |  9.15
Other   |            | 0.03659    |            |       |  0.04

Nlocal:          45.25 ave          52 max          41 min
Histogram: 2 1 2 0 1 0 0 0 0 2
Nghost:        3512.12 ave        3536 max        3491 min
Histogram: 2 1 0 1 1 0 0 0 1 2
Neighs:        29500.8 ave       33758 max       26791 min
Histogram: 2 1 2 0 1 0 0 0 0 2

Total # of neighbors = 236006
Ave neighs/atom = 651.95028
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-1-vasp-an_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.4067063256181
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.7666085706639
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.4417564847439

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--4871.76429434919)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--4871.76429434919)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--501.26965238787)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--501.26965238787)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--4470.6183232809)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--4470.6183232809)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1976.66022328612)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-1976.66022328612)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1264.57502985973)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1264.57502985973)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1838.20667910834)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1838.20667910834)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 17.4067063256181
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4067063256181
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.174067063256181 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.174067063256181 xy delta 0.0913870330131827 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.174067063256181 xy delta 0.0913870330131827 xz delta -0.00711398869196835 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15680.138     -3896.441       3874.0495    
       200   260.90601     -42461.057     -4656.802      -5581.0845      3872.1115    
       300   278.45298     -42493.811     -42.954842     -2169.9619      3870.1735    
       400   263.66537     -42461.326      3545.2        -355.36665      3868.2355    
       500   310.19876     -42480.164      2268.0859     -953.08492      3866.2975    
       600   323.48989     -42483.314     -4084.6187     -451.92555      3864.3595    
       700   301.28692     -42463.346      6538.1354     -6763.067       3862.4215    
       800   291.88727     -42483.263      4310.2444      231.868        3860.4835    
       900   281.63895     -42486.226     -5083.8118     -3349.0974      3858.5455    
      1000   295.77511     -42495.405      14127.919      1701.9389      3856.6075    
      1100   291.08595     -42476.072     -443.95744      2567.6895      3854.6695    
      1200   306.26626     -42478.741      4886.6849      4729.3404      3852.7315    
      1300   301.94478     -42478.265     -9642.369      -1596.5361      3850.7935    
      1400   295.43886     -42470.248      3246.8843     -5340.702       3848.8556    
      1500   334.692       -42487.39       10913.946      452.61116      3846.9176    
      1600   315.35434     -42449.672      7077.6101      5304.3966      3844.9796    
      1700   307.5172      -42464.04       14126.224      1774.2653      3843.0416    
      1800   283.75557     -42470.939      3506.6006      4045.2882      3841.1036    
      1900   292.34835     -42479.687      14215.054      4797.858       3839.1656    
      2000   308.58388     -42480.366      6373.0704      8429.5274      3837.2276    
Loop time of 93.2883 on 8 procs for 2000 steps with 362 atoms

Performance: 0.926 ns/day, 25.913 hours/ns, 21.439 timesteps/s, 7.761 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.737     | 60.45      | 75.635     | 110.8 | 64.80
Bond    | 0.00047538 | 0.00064978 | 0.00084518 |   0.0 |  0.00
Neigh   | 4.7112     | 5.1944     | 6.5461     |  30.3 |  5.57
Comm    | 3.4451     | 18.639     | 25.349     | 199.6 | 19.98
Output  | 0.0039793  | 0.0048097  | 0.0053997  |   0.7 |  0.01
Modify  | 7.6144     | 8.9607     | 9.4481     |  23.0 |  9.61
Other   |            | 0.039      |            |       |  0.04

Nlocal:          45.25 ave          53 max          40 min
Histogram: 2 1 1 0 1 0 2 0 0 1
Nghost:        3442.75 ave        3469 max        3414 min
Histogram: 2 0 0 1 0 1 1 1 1 1
Neighs:          29794 ave       34586 max       26515 min
Histogram: 2 1 1 0 1 0 2 0 0 1

Total # of neighbors = 238352
Ave neighs/atom = 658.43094
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 134.775338591027
variable C2neg equal ${d2}
variable C2neg equal 61.9203504474158
variable C3neg equal ${d3}
variable C3neg equal 49.0475747106019
variable C4neg equal ${d4}
variable C4neg equal 2.45997910466539
variable C5neg equal ${d5}
variable C5neg equal 22.5581590530655
variable C6neg equal ${d6}
variable C6neg equal 10.2129957982312

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4067063256181
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.174067063256181 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.174067063256181 xy delta -0.0913870330131827 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.174067063256181 xy delta -0.0913870330131827 xz delta 0.00711398869196835 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15664.466     -3893.7461      3877.9255    
       200   262.45871     -42461.486     -5616.4663     -6204.4141      3879.8635    
       300   279.41349     -42495.837     -4185.9354     -3721.1994      3881.8014    
       400   270.55684     -42473.775     -5206.8773     -3276.5082      3883.7394    
       500   310.92489     -42485.211      6711.8667     -1130.0973      3885.6774    
       600   328.69597     -42489.647      432.28614     -2009.0827      3887.6154    
       700   301.73648     -42458.388     -837.94927     -9115.9677      3889.5534    
       800   286.47434     -42460.568     -8160.3666     -6215.4081      3891.4914    
       900   275.58923     -42476.204      6619.5371     -7027.8445      3893.4294    
      1000   291.01134     -42495.588     -594.33746     -3782.8249      3895.3674    
      1100   290.31108     -42470.562     -3150.1398     -346.15086      3897.3054    
      1200   303.05654     -42466.853      5125.7899     -4740.2299      3899.2434    
      1300   295.22345     -42456.152     -7501.8957     -7778.2983      3901.1814    
      1400   276.58444     -42437.062      2577.4043     -5044.8603      3903.1194    
      1500   305.93938     -42467.352      131.45497     -2549.0063      3905.0574    
      1600   300.74344     -42456.803     -2774.3852     -4891.5673      3906.9954    
      1700   293.87922     -42453.597     -6219.9681     -7650.1522      3908.9334    
      1800   290.88894     -42469.987     -2037.8804     -9313.7137      3910.8714    
      1900   279.84442     -42470.52      -10172.661     -6429.683       3912.8093    
      2000   294.45906     -42480.806      3816.405      -2779.1908      3914.7473    
Loop time of 89.1216 on 8 procs for 2000 steps with 362 atoms

Performance: 0.969 ns/day, 24.756 hours/ns, 22.441 timesteps/s, 8.124 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.065     | 59.404     | 74.44      | 110.8 | 66.66
Bond    | 0.00040509 | 0.00057332 | 0.00073882 |   0.0 |  0.00
Neigh   | 4.6142     | 5.2287     | 6.8987     |  41.4 |  5.87
Comm    | 0.64284    | 15.675     | 23.001     | 215.7 | 17.59
Output  | 0.0040903  | 0.0048661  | 0.0054107  |   0.7 |  0.01
Modify  | 7.0763     | 8.7658     | 9.3717     |  32.3 |  9.84
Other   |            | 0.04184    |            |       |  0.05

Nlocal:          45.25 ave          52 max          40 min
Histogram: 2 1 0 1 0 1 1 1 0 1
Nghost:        3382.38 ave        3429 max        3334 min
Histogram: 1 0 0 3 0 0 2 1 0 1
Neighs:        29217.2 ave       33298 max       26003 min
Histogram: 2 1 0 1 0 1 1 1 0 1

Total # of neighbors = 233738
Ave neighs/atom = 645.68508
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -21.2030007533984
variable C2pos equal ${d2}
variable C2pos equal -13.8580692727444
variable C3pos equal ${d3}
variable C3pos equal -68.4319461264932
variable C4pos equal ${d4}
variable C4pos equal 8.13188405744509
variable C5pos equal ${d5}
variable C5pos equal -7.80140860891822
variable C6pos equal ${d6}
variable C6pos equal -6.59583912941604

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(134.775338591027+${C1pos})
variable C11 equal 0.5*(134.775338591027+-21.2030007533984)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(61.9203504474158+${C2pos})
variable C21 equal 0.5*(61.9203504474158+-13.8580692727444)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(49.0475747106019+${C3pos})
variable C31 equal 0.5*(49.0475747106019+-68.4319461264932)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(2.45997910466539+${C4pos})
variable C41 equal 0.5*(2.45997910466539+8.13188405744509)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(22.5581590530655+${C5pos})
variable C51 equal 0.5*(22.5581590530655+-7.80140860891822)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(10.2129957982312+${C6pos})
variable C61 equal 0.5*(10.2129957982312+-6.59583912941604)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.7666085706639
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7666085706639
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.127666085706639 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.127666085706639 yz delta -0.00627716511865388 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15680.138     -3896.441       3874.0495    
       200   262.30602     -42462.343     -4846.3309     -5806.0876      3872.1115    
       300   277.02765     -42492.125      462.4435      -2512.9493      3870.1735    
       400   270.77393     -42469.864     -2234.225      -1838.2376      3868.2355    
       500   306.06978     -42478.043      807.19331     -204.59283      3866.2975    
       600   322.49569     -42487.111     -2177.0201     -696.60656      3864.3595    
       700   312.80176     -42478.662     -7005.7443     -9101.7616      3862.4215    
       800   284.56629     -42476.059      3151.8912      173.07323      3860.4835    
       900   279.99341     -42489.527      2374.3865     -2826.2107      3858.5455    
      1000   282.8998      -42485.69       16141.901     -3543.76        3856.6075    
      1100   295.6705      -42471.867      9911.2567      1469.4845      3854.6695    
      1200   310.40126     -42477.229      4896.2159      2413.3714      3852.7315    
      1300   296.09638     -42472.999     -1802.1967     -2748.4422      3850.7935    
      1400   284.94608     -42467.175     -9516.8686     -5887.9284      3848.8556    
      1500   307.85398     -42484.16      -3932.2131     -7400.7535      3846.9176    
      1600   325.22572     -42482.836     -10897.303      996.96851      3844.9796    
      1700   325.51874     -42466.546     -6454.2198     -3540           3843.0416    
      1800   319.56121     -42470.94       7955.4675     -1274.9969      3841.1036    
      1900   291.10975     -42480.469      7263.0009      2340.5928      3839.1656    
      2000   281.36041     -42473.928      3334.5819      3570.3687      3837.2276    
Loop time of 90.3814 on 8 procs for 2000 steps with 362 atoms

Performance: 0.956 ns/day, 25.106 hours/ns, 22.128 timesteps/s, 8.010 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.434     | 60.543     | 75.471     | 109.6 | 66.99
Bond    | 0.00040482 | 0.00056233 | 0.00067522 |   0.0 |  0.00
Neigh   | 4.6741     | 5.2727     | 6.9686     |  40.9 |  5.83
Comm    | 0.68356    | 15.606     | 22.705     | 215.7 | 17.27
Output  | 0.0039668  | 0.0047196  | 0.0052725  |   0.6 |  0.01
Modify  | 7.1977     | 8.9125     | 9.5045     |  31.9 |  9.86
Other   |            | 0.04147    |            |       |  0.05

Nlocal:          45.25 ave          52 max          40 min
Histogram: 3 0 1 0 0 1 1 0 0 2
Nghost:        3453.25 ave        3472 max        3429 min
Histogram: 1 0 1 0 1 1 2 0 0 2
Neighs:        29773.2 ave       33935 max       26459 min
Histogram: 2 1 1 0 0 1 1 0 0 2

Total # of neighbors = 238186
Ave neighs/atom = 657.97238
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 85.5399123120825
variable C2neg equal ${d2}
variable C2neg equal 55.0025421434027
variable C3neg equal ${d3}
variable C3neg equal 59.1515037810929
variable C4neg equal ${d4}
variable C4neg equal -5.27612549430167
variable C5neg equal ${d5}
variable C5neg equal 7.33610132789419
variable C6neg equal ${d6}
variable C6neg equal 9.77857599058024

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7666085706639
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.127666085706639 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.127666085706639 yz delta 0.00627716511865388 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15664.466     -3893.7461      3877.9255    
       200   262.58221     -42461.894     -5672.401      -5962.5497      3879.8635    
       300   278.63589     -42495.239     -4763.1572     -3769.407       3881.8014    
       400   267.52581     -42472.798     -2429.872      -2505.2359      3883.7394    
       500   304.64688     -42480.288      3262.1668     -152.29747      3885.6774    
       600   326.25745     -42488.976      491.24845     -1520.4376      3887.6154    
       700   315.61028     -42474.289      2001.0345     -9026.2915      3889.5534    
       800   298.52611     -42478.587      3597.0586     -4057.8021      3891.4914    
       900   275.67734     -42480.689     -5749.2882     -4686.6886      3893.4294    
      1000   297.75961     -42506.522     -7578.9438     -2546.2435      3895.3674    
      1100   299.00298     -42489.734     -2543.9372     -1780.8116      3897.3054    
      1200   275.18922     -42453.537     -1997.2399     -4177.7038      3899.2434    
      1300   304.68907     -42474.765     -1034.6384     -1801.2841      3901.1814    
      1400   310.76367     -42467.346     -7072.7227     -8476.6508      3903.1194    
      1500   315.45955     -42462.424     -4275.4121     -5219.9607      3905.0574    
      1600   301.08764     -42464.885     -14479.502     -3609.7976      3906.9954    
      1700   298.94035     -42487.531     -12938.63      -8919.3312      3908.9334    
      1800   290.57004     -42480.977     -10361.36      -6608.5338      3910.8714    
      1900   322.01826     -42492.314      3059.9328     -2390.3618      3912.8093    
      2000   326.93415     -42471.525      5857.5597      498.19529      3914.7473    
Loop time of 89.2792 on 8 procs for 2000 steps with 362 atoms

Performance: 0.968 ns/day, 24.800 hours/ns, 22.402 timesteps/s, 8.109 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.601     | 58.929     | 74.767     | 115.9 | 66.01
Bond    | 0.00041907 | 0.00057702 | 0.00075215 |   0.0 |  0.00
Neigh   | 4.5953     | 5.1884     | 6.8261     |  40.8 |  5.81
Comm    | 0.57129    | 16.408     | 23.722     | 219.6 | 18.38
Output  | 0.0039328  | 0.0046949  | 0.0052558  |   0.6 |  0.01
Modify  | 7.0524     | 8.7061     | 9.2914     |  31.9 |  9.75
Other   |            | 0.04208    |            |       |  0.05

Nlocal:          45.25 ave          52 max          38 min
Histogram: 1 0 1 3 0 0 0 0 0 3
Nghost:        3403.25 ave        3445 max        3352 min
Histogram: 1 1 0 1 0 1 1 1 0 2
Neighs:        29192.2 ave       33322 max       24747 min
Histogram: 1 0 1 3 0 0 0 0 0 3

Total # of neighbors = 233538
Ave neighs/atom = 645.1326
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -54.411115522219
variable C2pos equal ${d2}
variable C2pos equal 2.26144309374913
variable C3pos equal ${d3}
variable C3pos equal -90.2104919078905
variable C4pos equal ${d4}
variable C4pos equal 3.46280452068762
variable C5pos equal ${d5}
variable C5pos equal -10.9832006572711
variable C6pos equal ${d6}
variable C6pos equal -13.9354329754285

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(85.5399123120825+${C1pos})
variable C12 equal 0.5*(85.5399123120825+-54.411115522219)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(55.0025421434027+${C2pos})
variable C22 equal 0.5*(55.0025421434027+2.26144309374913)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(59.1515037810929+${C3pos})
variable C32 equal 0.5*(59.1515037810929+-90.2104919078905)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-5.27612549430167+${C4pos})
variable C42 equal 0.5*(-5.27612549430167+3.46280452068762)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(7.33610132789419+${C5pos})
variable C52 equal 0.5*(7.33610132789419+-10.9832006572711)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(9.77857599058024+${C6pos})
variable C62 equal 0.5*(9.77857599058024+-13.9354329754285)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.4417564847439
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4417564847439
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.174417564847439 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15680.138     -3896.441       3874.0495    
       200   262.26314     -42461.851     -4629.7728     -5745.422       3872.1115    
       300   275.70592     -42491.988     -3278.9907     -3355.5308      3870.1735    
       400   262.66653     -42465.613      2792.5196     -1238.9513      3868.2355    
       500   308.74638     -42482.843      3291.6098     -509.83736      3866.2975    
       600   312.39911     -42471.511      5545.7895      834.92152      3864.3595    
       700   301.2866      -42452.235      1294.179      -6601.8931      3862.4215    
       800   289.35511     -42454.21       2729.4695      1351.3411      3860.4835    
       900   295.30884     -42488.295     -4222.743      -3416.3402      3858.5455    
      1000   282.01703     -42487.017      6240.7454      2887.7992      3856.6075    
      1100   301.62492     -42486.006      12040.023      1998.0446      3854.6695    
      1200   291.04915     -42444.631      15543.918      3650.1801      3852.7315    
      1300   290.31854     -42444.865     -328.54086      1768.2092      3850.7935    
      1400   283.42721     -42451.305      3673.2722     -7800.8094      3848.8556    
      1500   294.45876     -42480.638     -5714.5503     -418.66342      3846.9176    
      1600   303.18498     -42507.123      5082.7328      1536.6429      3844.9796    
      1700   290.84547     -42499.989      17077.036      75.132436      3843.0416    
      1800   288.71423     -42461.185     -590.22104     -2190.3118      3841.1036    
      1900   307.72926     -42464.21      -1433.0412      1224.7494      3839.1656    
      2000   303.29031     -42460.704      2033.1086      1673.3513      3837.2276    
Loop time of 92.8296 on 8 procs for 2000 steps with 362 atoms

Performance: 0.931 ns/day, 25.786 hours/ns, 21.545 timesteps/s, 7.799 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.245     | 60.807     | 77.98      | 125.6 | 65.50
Bond    | 0.0003871  | 0.00058146 | 0.0008117  |   0.0 |  0.00
Neigh   | 4.813      | 5.402      | 7.1306     |  42.1 |  5.82
Comm    | 0.63338    | 17.792     | 26.342     | 232.0 | 19.17
Output  | 0.0041246  | 0.0049434  | 0.0055247  |   0.7 |  0.01
Modify  | 7.0244     | 8.7825     | 9.3895     |  33.6 |  9.46
Other   |            | 0.04084    |            |       |  0.04

Nlocal:          45.25 ave          52 max          37 min
Histogram: 1 0 1 0 1 0 2 0 2 1
Nghost:        3532.25 ave        3552 max        3506 min
Histogram: 1 0 0 0 2 2 1 0 1 1
Neighs:        29798.2 ave       33972 max       24562 min
Histogram: 1 1 0 0 1 0 2 0 2 1

Total # of neighbors = 238386
Ave neighs/atom = 658.52486
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 66.3183842525461
variable C2neg equal ${d2}
variable C2neg equal 22.3709775784427
variable C3neg equal ${d3}
variable C3neg equal 66.4057968882432
variable C4neg equal ${d4}
variable C4neg equal -5.66485738598784
variable C5neg equal ${d5}
variable C5neg equal -5.74285651676079
variable C6neg equal ${d6}
variable C6neg equal 13.3220416524448

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4417564847439
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.174417564847439 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15664.466     -3893.7461      3877.9255    
       200   262.40477     -42461.755     -5139.5137     -5936.2555      3879.8635    
       300   278.73349     -42495.046     -1386.307      -3074.564       3881.8014    
       400   273.78945     -42475.675     -4194.9983     -3549.5652      3883.7394    
       500   311.37172     -42484.068      4520.2775     -1411.6832      3885.6774    
       600   313.06486     -42476.195     -9969.5181     -3863.5201      3887.6154    
       700   298.86121     -42460.616     -6311.567      -8645.7312      3889.5534    
       800   287.12638     -42464.959     -3493.3077     -4608.6197      3891.4914    
       900   283.17162     -42484.936      9485.4281     -4828.4314      3893.4294    
      1000   276.93837     -42486.65      -8904.6765     -2643.7286      3895.3674    
      1100   279.3964      -42452.958      538.94211      490.55563      3897.3054    
      1200   319.20639     -42476.285      7731.6408     -1147.5797      3899.2434    
      1300   296.38211     -42452.387     -1723.5832     -5418.0186      3901.1814    
      1400   286.48922     -42442.564     -7514.2866     -8506.2832      3903.1194    
      1500   305.71478     -42473.954     -1830.9007     -4306.0166      3905.0574    
      1600   289.39187     -42483.773      1557.8164     -7190.7535      3906.9954    
      1700   299.33059     -42493.895      2619.8369     -3078.7455      3908.9334    
      1800   304.6185      -42468.171      2473.1409     -529.23623      3910.8714    
      1900   304.04538     -42461.378     -9997.0276     -3671.596       3912.8093    
      2000   286.49645     -42445.91       2402.0316     -5211.4393      3914.7473    
Loop time of 91.7706 on 8 procs for 2000 steps with 362 atoms

Performance: 0.941 ns/day, 25.492 hours/ns, 21.793 timesteps/s, 7.889 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.496     | 60.066     | 76.893     | 124.6 | 65.45
Bond    | 0.00040897 | 0.00061427 | 0.00076517 |   0.0 |  0.00
Neigh   | 4.7713     | 5.3868     | 7.149      |  43.1 |  5.87
Comm    | 0.6779     | 17.487     | 26.042     | 230.7 | 19.06
Output  | 0.0042265  | 0.0050343  | 0.0055954  |   0.6 |  0.01
Modify  | 6.9915     | 8.7845     | 9.4191     |  34.3 |  9.57
Other   |            | 0.0405     |            |       |  0.04

Nlocal:          45.25 ave          53 max          40 min
Histogram: 3 0 1 0 0 1 2 0 0 1
Nghost:        3490.75 ave        3528 max        3443 min
Histogram: 1 0 1 0 1 0 3 0 1 1
Neighs:        29196.5 ave       33975 max       25927 min
Histogram: 3 0 1 0 0 1 2 0 0 1

Total # of neighbors = 233572
Ave neighs/atom = 645.22652
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 3.44175719891049
variable C2pos equal ${d2}
variable C2pos equal 6.70284529553423
variable C3pos equal ${d3}
variable C3pos equal 0.126489566583319
variable C4pos equal ${d4}
variable C4pos equal 18.2602963232182
variable C5pos equal ${d5}
variable C5pos equal -3.47340281792783
variable C6pos equal ${d6}
variable C6pos equal -15.1898895386952

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(66.3183842525461+${C1pos})
variable C13 equal 0.5*(66.3183842525461+3.44175719891049)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(22.3709775784427+${C2pos})
variable C23 equal 0.5*(22.3709775784427+6.70284529553423)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(66.4057968882432+${C3pos})
variable C33 equal 0.5*(66.4057968882432+0.126489566583319)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-5.66485738598784+${C4pos})
variable C43 equal 0.5*(-5.66485738598784+18.2602963232182)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-5.74285651676079+${C5pos})
variable C53 equal 0.5*(-5.74285651676079+-3.47340281792783)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(13.3220416524448+${C6pos})
variable C63 equal 0.5*(13.3220416524448+-15.1898895386952)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.4417564847439
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4417564847439
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.174417564847439 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15672.298     -3895.0929      3875.9875    
       200   262.25836     -42462.091     -5217.1757     -5958.9062      3875.9875    
       300   280.35324     -42496.205     -3022.6811     -2946.9168      3875.9875    
       400   272.40336     -42473.681      610.04899     -1476.7439      3875.9875    
       500   306.70129     -42479.348     -4357.6859     -2685.3253      3875.9875    
       600   334.91038     -42497.551     -11267.565     -1091.7896      3875.9875    
       700   310.21316     -42467.592      603.00933     -9827.1869      3875.9875    
       800   286.08287     -42464.622      9106.284      -2934.8412      3875.9875    
       900   277.597       -42481.191     -1588.6338     -6869.497       3875.9875    
      1000   290.2602      -42493.747      1598.6103     -1762.4255      3875.9875    
      1100   289.1621      -42472.823     -7549.6777      2715.9912      3875.9875    
      1200   305.489       -42476.136      2254.1575     -574.86008      3875.9875    
      1300   304.53608     -42470.802      3151.6479      780.58859      3875.9875    
      1400   286.9909      -42454.964     -12231.03      -10313.325      3875.9875    
      1500   294.26676     -42475.691      541.73065     -3178.1989      3875.9875    
      1600   287.24909     -42486.708      7364.6281     -4188.9617      3875.9875    
      1700   290.22194     -42484.767     -4072.1527     -6760.3947      3875.9875    
      1800   303.64154     -42464.089     -2006.1086      349.31342      3875.9875    
      1900   305.60143     -42458.266     -3504.4423     -1746.8521      3875.9875    
      2000   309.16632     -42468.462     -4412.2864     -1618.1596      3875.9875    
Loop time of 89.6438 on 8 procs for 2000 steps with 362 atoms

Performance: 0.964 ns/day, 24.901 hours/ns, 22.311 timesteps/s, 8.076 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.014     | 60.01      | 75.115     | 109.6 | 66.94
Bond    | 0.00040293 | 0.00056295 | 0.00076797 |   0.0 |  0.00
Neigh   | 4.6167     | 5.1999     | 6.8144     |  40.0 |  5.80
Comm    | 0.57511    | 15.673     | 22.655     | 214.3 | 17.48
Output  | 0.0040528  | 0.0048536  | 0.0054036  |   0.7 |  0.01
Modify  | 7.077      | 8.7138     | 9.2887     |  31.4 |  9.72
Other   |            | 0.04133    |            |       |  0.05

Nlocal:          45.25 ave          52 max          40 min
Histogram: 2 2 0 0 0 1 1 0 0 2
Nghost:        3415.38 ave        3448 max        3389 min
Histogram: 1 1 0 2 1 0 1 1 0 1
Neighs:        29463.9 ave       33656 max       26143 min
Histogram: 2 2 0 0 0 1 1 0 0 2

Total # of neighbors = 235711
Ave neighs/atom = 651.13536
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 32.9671499018393
variable C2neg equal ${d2}
variable C2neg equal 8.17375066458042
variable C3neg equal ${d3}
variable C3neg equal 84.7399506536782
variable C4neg equal ${d4}
variable C4neg equal 4.95511245581181
variable C5neg equal ${d5}
variable C5neg equal -10.0266135915509
variable C6neg equal ${d6}
variable C6neg equal 5.23102681834171

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4417564847439
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.174417564847439 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15672.298     -3895.0929      3875.9875    
       200   261.51451     -42461.403     -5007.4497     -5917.1398      3875.9875    
       300   277.51424     -42493.748     -4016.8857     -3541.758       3875.9875    
       400   269.41523     -42471.427     -187.39472     -2493.7896      3875.9875    
       500   305.32201     -42478.327      3474.9482     -1542.8632      3875.9875    
       600   324.37258     -42488.448     -10102.26      -3267.2421      3875.9875    
       700   303.86326     -42469.001      1126.3205     -7925.1275      3875.9875    
       800   283.90481     -42466.893      476.04132      590.81515      3875.9875    
       900   273.33235     -42477.216     -14936.299     -7999.9829      3875.9875    
      1000   276.33725     -42482.391     -4982.9375     -1898.7802      3875.9875    
      1100   295.64342     -42462.504      10262.593      210.77367      3875.9875    
      1200   307.87262     -42457.74       6694.7292     -861.24535      3875.9875    
      1300   310.59862     -42465.619     -9832.2654     -3074.5514      3875.9875    
      1400   294.44785     -42472.801      5528.3816     -9005.2036      3875.9875    
      1500   300.04447     -42491.601      13301.998      700.28912      3875.9875    
      1600   287.22504     -42489.113      4129.3169     -655.29917      3875.9875    
      1700   270.3512      -42473.401      5745.9046     -507.74584      3875.9875    
      1800   303.2161      -42480.579      159.22268     -3339.4765      3875.9875    
      1900   295.62812     -42452.213     -17514.159     -8242.9927      3875.9875    
      2000   311.84464     -42471.13       2134.9171      4385.137       3875.9875    
Loop time of 89.9328 on 8 procs for 2000 steps with 362 atoms

Performance: 0.961 ns/day, 24.981 hours/ns, 22.239 timesteps/s, 8.050 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.582     | 59.883     | 75.208     | 112.0 | 66.59
Bond    | 0.00039327 | 0.00057567 | 0.00075106 |   0.0 |  0.00
Neigh   | 4.6532     | 5.2461     | 6.9293     |  41.5 |  5.83
Comm    | 0.58612    | 15.906     | 23.195     | 217.2 | 17.69
Output  | 0.0040856  | 0.0050609  | 0.0056927  |   0.8 |  0.01
Modify  | 7.1465     | 8.8502     | 9.4342     |  32.3 |  9.84
Other   |            | 0.04166    |            |       |  0.05

Nlocal:          45.25 ave          54 max          39 min
Histogram: 2 1 1 0 0 0 2 1 0 1
Nghost:        3422.88 ave        3443 max        3397 min
Histogram: 1 0 1 1 1 0 1 0 1 2
Neighs:          29496 ave       34934 max       25609 min
Histogram: 2 2 0 0 0 0 2 1 0 1

Total # of neighbors = 235968
Ave neighs/atom = 651.8453
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -93.7955522966418
variable C2pos equal ${d2}
variable C2pos equal -77.520810019258
variable C3pos equal ${d3}
variable C3pos equal -79.5366585337825
variable C4pos equal ${d4}
variable C4pos equal 13.1522076328914
variable C5pos equal ${d5}
variable C5pos equal -16.2747783864083
variable C6pos equal ${d6}
variable C6pos equal -10.9022476848572

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(32.9671499018393+${C1pos})
variable C14 equal 0.5*(32.9671499018393+-93.7955522966418)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(8.17375066458042+${C2pos})
variable C24 equal 0.5*(8.17375066458042+-77.520810019258)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(84.7399506536782+${C3pos})
variable C34 equal 0.5*(84.7399506536782+-79.5366585337825)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(4.95511245581181+${C4pos})
variable C44 equal 0.5*(4.95511245581181+13.1522076328914)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-10.0266135915509+${C5pos})
variable C54 equal 0.5*(-10.0266135915509+-16.2747783864083)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(5.23102681834171+${C6pos})
variable C64 equal 0.5*(5.23102681834171+-10.9022476848572)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.4417564847439
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4417564847439
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.174417564847439 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15672.298     -3895.0929      3875.9875    
       200   262.32833     -42461.997     -5181.8638     -5999.6171      3875.9875    
       300   277.07645     -42493.328     -3843.8518     -3497.6766      3875.9875    
       400   265.32267     -42466.975     -2700.7421     -1956.7614      3875.9875    
       500   305.40494     -42478.537     -3374.5994     -2350.4895      3875.9875    
       600   320.12123     -42481.489     -2398.7459     -804.67092      3875.9875    
       700   292.95137     -42448.484      3223.5157     -8528.8903      3875.9875    
       800   294.52218     -42468.695      2253.9915     -1550.7283      3875.9875    
       900   300.14636     -42503.719     -778.36739     -5708.7573      3875.9875    
      1000   273.5483      -42475.898     -1951.6757      710.56793      3875.9875    
      1100   296.64925     -42475.043     -1928.862       7236.8734      3875.9875    
      1200   308.01204     -42467.547      1264.2425      3726.1414      3875.9875    
      1300   293.56766     -42438.363     -2054.6989     -1322.7193      3875.9875    
      1400   289.98061     -42435.147      8781.7221     -7831.2983      3875.9875    
      1500   311.9854      -42487.345      8178.2322     -1455.0174      3875.9875    
      1600   289.0225      -42482.949     -515.06663     -3293.4022      3875.9875    
      1700   302.30106     -42486.854      5245.4255     -3767.3771      3875.9875    
      1800   300.09613     -42469.104     -7355.4693      2430.8191      3875.9875    
      1900   310.9002      -42471.556      2392.164       4490.8111      3875.9875    
      2000   289.82729     -42449.156      2023.9543     -352.97345      3875.9875    
Loop time of 90.3419 on 8 procs for 2000 steps with 362 atoms

Performance: 0.956 ns/day, 25.095 hours/ns, 22.138 timesteps/s, 8.014 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.366     | 59.307     | 75.714     | 121.6 | 65.65
Bond    | 0.00041    | 0.0005928  | 0.00080637 |   0.0 |  0.00
Neigh   | 4.6315     | 5.2198     | 6.8703     |  41.1 |  5.78
Comm    | 0.64437    | 17.049     | 24.977     | 226.7 | 18.87
Output  | 0.0041319  | 0.0049506  | 0.0055026  |   0.7 |  0.01
Modify  | 7.0502     | 8.7179     | 9.2971     |  32.1 |  9.65
Other   |            | 0.04249    |            |       |  0.05

Nlocal:          45.25 ave          52 max          39 min
Histogram: 2 0 1 1 0 1 0 0 1 2
Nghost:        3417.88 ave        3443 max        3387 min
Histogram: 1 0 1 2 0 1 0 0 1 2
Neighs:        29483.1 ave       33617 max       25575 min
Histogram: 2 0 1 1 0 1 0 0 1 2

Total # of neighbors = 235865
Ave neighs/atom = 651.56077
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 45.7866481948924
variable C2neg equal ${d2}
variable C2neg equal -14.5041757840613
variable C3neg equal ${d3}
variable C3neg equal 37.0010681660356
variable C4neg equal ${d4}
variable C4neg equal -0.803498948733402
variable C5neg equal ${d5}
variable C5neg equal 11.5260688810822
variable C6neg equal ${d6}
variable C6neg equal 16.3570426943409

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4417564847439
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.174417564847439 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15672.298     -3895.0929      3875.9875    
       200   261.36453     -42461.049     -5307.022      -5885.3864      3875.9875    
       300   280.5305      -42497.143     -1251.3754     -2981.0347      3875.9875    
       400   266.28744     -42466.731      4413.9833     -2028.8774      3875.9875    
       500   302.80805     -42474.195      1048.6683     -2160.4503      3875.9875    
       600   332.36473     -42493.203     -7015.8993      560.77085      3875.9875    
       700   293.75263     -42455.155      3425.0055     -9658.8259      3875.9875    
       800   280.08811     -42468.286      5736.5138     -1753.5838      3875.9875    
       900   298.44488     -42501.831     -206.32278     -2776.6488      3875.9875    
      1000   293.41998     -42491.687      3562.8593     -3497.8151      3875.9875    
      1100   275.70686     -42452.086     -5781.1308      3778.7927      3875.9875    
      1200   333.48697     -42507.872     -13666.04      -2024.9084      3875.9875    
      1300   281.65908     -42464.657     -15751.312     -6197.9507      3875.9875    
      1400   308.92287     -42499.933     -12479.864     -9067.3643      3875.9875    
      1500   296.73301     -42478.657      531.71725     -1031.7781      3875.9875    
      1600   309.62262     -42471.502     -918.24098     -338.27247      3875.9875    
      1700   311.98641     -42450.221      1685.0936     -4274.7426      3875.9875    
      1800   305.85435     -42451.472     -4097.6608     -3587.5827      3875.9875    
      1900   291.23723     -42464.062      5073.0791     -3008.8778      3875.9875    
      2000   313.23941     -42490.8        10617.472      4462.8194      3875.9875    
Loop time of 90.5502 on 8 procs for 2000 steps with 362 atoms

Performance: 0.954 ns/day, 25.153 hours/ns, 22.087 timesteps/s, 7.996 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.669     | 59.395     | 75.918     | 121.0 | 65.59
Bond    | 0.00041668 | 0.00058872 | 0.00078144 |   0.0 |  0.00
Neigh   | 4.6394     | 5.2319     | 6.8569     |  40.7 |  5.78
Comm    | 0.58262    | 17.104     | 24.818     | 225.5 | 18.89
Output  | 0.0040522  | 0.0048379  | 0.0054666  |   0.7 |  0.01
Modify  | 7.1289     | 8.7723     | 9.3588     |  31.8 |  9.69
Other   |            | 0.0424     |            |       |  0.05

Nlocal:          45.25 ave          54 max          39 min
Histogram: 2 1 1 0 0 0 3 0 0 1
Nghost:        3431.62 ave        3448 max        3406 min
Histogram: 1 0 0 0 1 1 2 0 1 2
Neighs:        29465.6 ave       34888 max       25566 min
Histogram: 2 1 1 0 0 1 2 0 0 1

Total # of neighbors = 235725
Ave neighs/atom = 651.17403
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -94.582669201191
variable C2pos equal ${d2}
variable C2pos equal -24.1132683033428
variable C3pos equal ${d3}
variable C3pos equal -83.0742595146156
variable C4pos equal ${d4}
variable C4pos equal 5.09059132033593
variable C5pos equal ${d5}
variable C5pos equal -10.704971696211
variable C6pos equal ${d6}
variable C6pos equal -11.3090960285499

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(45.7866481948924+${C1pos})
variable C15 equal 0.5*(45.7866481948924+-94.582669201191)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-14.5041757840613+${C2pos})
variable C25 equal 0.5*(-14.5041757840613+-24.1132683033428)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(37.0010681660356+${C3pos})
variable C35 equal 0.5*(37.0010681660356+-83.0742595146156)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-0.803498948733402+${C4pos})
variable C45 equal 0.5*(-0.803498948733402+5.09059132033593)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(11.5260688810822+${C5pos})
variable C55 equal 0.5*(11.5260688810822+-10.704971696211)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(16.3570426943409+${C6pos})
variable C65 equal 0.5*(16.3570426943409+-11.3090960285499)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.7666085706639

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7666085706639
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.127666085706639 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15672.298     -3895.0929      3875.9875    
       200   261.43007     -42461.328     -5222.9893     -5908.5082      3875.9875    
       300   279.01666     -42495.061     -4300.6337     -3355.4448      3875.9875    
       400   269.31595     -42469.549      2499.0121     -1683.9277      3875.9875    
       500   305.93512     -42478.534      3210.2498     -1877.6674      3875.9875    
       600   322.51938     -42484.251      7867.7601     -2587.3006      3875.9875    
       700   302.72293     -42460.407     -6235.5509     -9748.0776      3875.9875    
       800   297.88245     -42473.566     -2534.0451     -2487.7724      3875.9875    
       900   299.05671     -42501.312     -2922.0248     -4002.2376      3875.9875    
      1000   278.76481     -42489.654     -8699.2621     -4077.6264      3875.9875    
      1100   292.13788     -42472.538      567.63085      3158.2766      3875.9875    
      1200   317.24689     -42480.006     -14316.502     -3053.1528      3875.9875    
      1300   301.93671     -42471.892     -3326.3234     -3327.281       3875.9875    
      1400   290.94003     -42468.851     -7259.6626     -7572.0506      3875.9875    
      1500   286.85945     -42473.489     -5421.6169     -2082.9975      3875.9875    
      1600   301.75622     -42493.593     -5772.7638     -2131.1426      3875.9875    
      1700   281.12415     -42456.98      -1565.5002     -3462.8511      3875.9875    
      1800   312.7981      -42461.03       1373.0147     -4969.4895      3875.9875    
      1900   296.77905     -42440.282     -2667.3003     -5615.7929      3875.9875    
      2000   298.33244     -42458.312      1053.994      -3483.2778      3875.9875    
Loop time of 91.4455 on 8 procs for 2000 steps with 362 atoms

Performance: 0.945 ns/day, 25.402 hours/ns, 21.871 timesteps/s, 7.917 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.411     | 59.05      | 73.722     | 107.9 | 64.57
Bond    | 0.00049051 | 0.00063887 | 0.00088371 |   0.0 |  0.00
Neigh   | 4.6433     | 5.12       | 6.5067     |  30.5 |  5.60
Comm    | 3.8235     | 18.498     | 26.129     | 192.8 | 20.23
Output  | 0.0039464  | 0.0047696  | 0.0053225  |   0.7 |  0.01
Modify  | 7.3461     | 8.7336     | 9.2007     |  23.3 |  9.55
Other   |            | 0.0387     |            |       |  0.04

Nlocal:          45.25 ave          55 max          38 min
Histogram: 1 2 1 0 1 0 2 0 0 1
Nghost:         3397.5 ave        3419 max        3363 min
Histogram: 1 0 0 0 2 1 1 0 1 2
Neighs:        29484.2 ave       35488 max       24955 min
Histogram: 1 2 1 0 1 0 2 0 0 1

Total # of neighbors = 235874
Ave neighs/atom = 651.58564
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 14.0688398543809
variable C2neg equal ${d2}
variable C2neg equal 23.9375900943061
variable C3neg equal ${d3}
variable C3neg equal 32.6253826591557
variable C4neg equal ${d4}
variable C4neg equal -1.12068166851437
variable C5neg equal ${d5}
variable C5neg equal 28.9394418793394
variable C6neg equal ${d6}
variable C6neg equal 12.3250208983273

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (-0.11725316 0.18064571 0.072471758) to (17.289453 12.947254 17.514228) with tilt (-9.1387033 0.71139887 0.62771651)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7666085706639
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.127666085706639 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135 | 135.9 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.6662      -42464.53      -7955.4119      0              3875.9875    
       100   294.11254     -42478.44      -15672.298     -3895.0929      3875.9875    
       200   261.93303     -42461.777     -5373.4403     -5971.8221      3875.9875    
       300   277.05822     -42492.82      -3861.9031     -3104.4425      3875.9875    
       400   272.79018     -42473.747      3312.8313     -1985.627       3875.9875    
       500   309.51697     -42482.164      3432.3615     -1835.6197      3875.9875    
       600   325.29853     -42485.78      -9902.4675     -2595.3001      3875.9875    
       700   301.82129     -42453.388     -5149.1979     -8756.3275      3875.9875    
       800   289.01149     -42465.178     -15135.679     -1720.1284      3875.9875    
       900   281.67167     -42480.516     -98.582717     -6300.5763      3875.9875    
      1000   312.32798     -42513.32      -1115.0503     -2180.7261      3875.9875    
      1100   279.72709     -42465.085      10673.902      1251.3371      3875.9875    
      1200   310.41376     -42480.349      9836.2036     -1724.7227      3875.9875    
      1300   303.25903     -42470.326     -10179.043     -3500.8549      3875.9875    
      1400   299.71529     -42467.727     -5583.6164     -5024.5725      3875.9875    
      1500   330.17914     -42490.62      -3882.6959     -2651.1935      3875.9875    
      1600   300.792       -42463.031      4316.9438      4457.2831      3875.9875    
      1700   304.99943     -42487.493     -4036.436      -8066.7198      3875.9875    
      1800   311.40173     -42503.957     -11417.638     -512.2887       3875.9875    
      1900   296.02892     -42487.338     -2769.2257     -372.03279      3875.9875    
      2000   282.64808     -42447.056     -650.42839      2521.2287      3875.9875    
Loop time of 62.4167 on 8 procs for 2000 steps with 362 atoms

Performance: 1.384 ns/day, 17.338 hours/ns, 32.043 timesteps/s, 11.599 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.705     | 48.929     | 50.959     |  24.7 | 78.39
Bond    | 0.00044097 | 0.00059066 | 0.00084718 |   0.0 |  0.00
Neigh   | 4.6418     | 4.728      | 4.9717     |   4.6 |  7.57
Comm    | 0.64735    | 2.6712     | 4.8896     | 105.6 |  4.28
Output  | 0.0030701  | 0.0038903  | 0.0044375  |   0.8 |  0.01
Modify  | 5.7956     | 6.0456     | 6.1374     |   4.3 |  9.69
Other   |            | 0.03841    |            |       |  0.06

Nlocal:          45.25 ave          52 max          38 min
Histogram: 1 0 3 0 0 1 0 0 1 2
Nghost:        3448.25 ave        3467 max        3431 min
Histogram: 2 0 1 0 0 1 2 1 0 1
Neighs:        29486.4 ave       33732 max       24924 min
Histogram: 1 0 3 0 0 1 0 0 1 2

Total # of neighbors = 235891
Ave neighs/atom = 651.6326
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -74.9095018178266
variable C2pos equal ${d2}
variable C2pos equal -12.5750057061995
variable C3pos equal ${d3}
variable C3pos equal -56.0462951895434
variable C4pos equal ${d4}
variable C4pos equal 2.60735278566926
variable C5pos equal ${d5}
variable C5pos equal 3.30013192984622
variable C6pos equal ${d6}
variable C6pos equal -8.89417836183858

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(14.0688398543809+${C1pos})
variable C16 equal 0.5*(14.0688398543809+-74.9095018178266)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(23.9375900943061+${C2pos})
variable C26 equal 0.5*(23.9375900943061+-12.5750057061995)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(32.6253826591557+${C3pos})
variable C36 equal 0.5*(32.6253826591557+-56.0462951895434)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-1.12068166851437+${C4pos})
variable C46 equal 0.5*(-1.12068166851437+2.60735278566926)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(28.9394418793394+${C5pos})
variable C56 equal 0.5*(28.9394418793394+3.30013192984622)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(12.3250208983273+${C6pos})
variable C66 equal 0.5*(12.3250208983273+-8.89417836183858)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 56.7861689188143
variable C22all equal ${C22}
variable C22all equal 28.6319926185759
variable C33all equal ${C33}
variable C33all equal 33.2661432274133

variable C44all equal ${C44}
variable C44all equal 9.05366004435161
variable C55all equal ${C55}
variable C55all equal 0.4105485924356
variable C66all equal ${C66}
variable C66all equal 1.71542126824436

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(15.5643983949318+${C21})
variable C12all equal 0.5*(15.5643983949318+24.0311405873357)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(34.8800707257283+${C31})
variable C13all equal 0.5*(34.8800707257283+-9.69218570794565)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(14.5369114369885+${C32})
variable C23all equal 0.5*(14.5369114369885+-15.5294940633988)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-30.4142011974013+${C41})
variable C14all equal 0.5*(-30.4142011974013+5.29593158105524)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-24.3980105031493+${C51})
variable C15all equal 0.5*(-24.3980105031493+7.37837522207364)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-30.4203309817228+${C61})
variable C16all equal 0.5*(-30.4203309817228+1.80857833440758)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-34.6735296773388+${C42})
variable C24all equal 0.5*(-34.6735296773388+-0.906660486807025)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-19.308722043702+${C52})
variable C25all equal 0.5*(-19.308722043702+-1.82354966468845)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(5.6812921940533+${C62})
variable C26all equal 0.5*(5.6812921940533+-2.07842849242413)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(2.60164605994785+${C43})
variable C34all equal 0.5*(2.60164605994785+6.29771946861518)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-23.03659567429+${C53})
variable C35all equal 0.5*(-23.03659567429+-4.60812966734431)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-11.7104562651939+${C63})
variable C36all equal 0.5*(-11.7104562651939+-0.933923943125199)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(2.14354618580126+${C54})
variable C45all equal 0.5*(2.14354618580126+-13.1506959889796)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(0.743335558577445+${C64})
variable C46all equal 0.5*(0.743335558577445+-2.83561043325774)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(16.1197869045928+${C65})
variable C56all equal 0.5*(16.1197869045928+2.5239733328955)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:19:15
